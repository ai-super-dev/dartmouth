var Gh=e=>{throw TypeError(e)};var id=(e,t,r)=>t.has(e)||Gh("Cannot "+r);var C=(e,t,r)=>(id(e,t,"read from private field"),r?r.call(e):t.get(e)),Se=(e,t,r)=>t.has(e)?Gh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ce=(e,t,r,n)=>(id(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Ue=(e,t,r)=>(id(e,t,"access private method"),r);var to=(e,t,r,n)=>({set _(a){ce(e,t,a,r)},get _(){return C(e,t,n)}});function Kb(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function $f(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lf={exports:{}},Ec={},Ff={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ol=Symbol.for("react.element"),Qb=Symbol.for("react.portal"),Vb=Symbol.for("react.fragment"),Gb=Symbol.for("react.strict_mode"),Yb=Symbol.for("react.profiler"),Jb=Symbol.for("react.provider"),Xb=Symbol.for("react.context"),Zb=Symbol.for("react.forward_ref"),ev=Symbol.for("react.suspense"),tv=Symbol.for("react.memo"),sv=Symbol.for("react.lazy"),Yh=Symbol.iterator;function rv(e){return e===null||typeof e!="object"?null:(e=Yh&&e[Yh]||e["@@iterator"],typeof e=="function"?e:null)}var If={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Of=Object.assign,Df={};function yi(e,t,r){this.props=e,this.context=t,this.refs=Df,this.updater=r||If}yi.prototype.isReactComponent={};yi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function zf(){}zf.prototype=yi.prototype;function _m(e,t,r){this.props=e,this.context=t,this.refs=Df,this.updater=r||If}var Em=_m.prototype=new zf;Em.constructor=_m;Of(Em,yi.prototype);Em.isPureReactComponent=!0;var Jh=Array.isArray,Uf=Object.prototype.hasOwnProperty,Mm={current:null},Hf={key:!0,ref:!0,__self:!0,__source:!0};function Bf(e,t,r){var n,a={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Uf.call(t,n)&&!Hf.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Ol,type:e,key:i,ref:l,props:a,_owner:Mm.current}}function nv(e,t){return{$$typeof:Ol,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Tm(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ol}function av(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Xh=/\/+/g;function ld(e,t){return typeof e=="object"&&e!==null&&e.key!=null?av(""+e.key):t.toString(36)}function Mo(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Ol:case Qb:l=!0}}if(l)return l=e,a=a(l),e=n===""?"."+ld(l,0):n,Jh(a)?(r="",e!=null&&(r=e.replace(Xh,"$&/")+"/"),Mo(a,t,r,"",function(d){return d})):a!=null&&(Tm(a)&&(a=nv(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(Xh,"$&/")+"/")+e)),t.push(a)),1;if(l=0,n=n===""?".":n+":",Jh(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+ld(i,o);l+=Mo(i,t,r,c,a)}else if(c=rv(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+ld(i,o++),l+=Mo(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function so(e,t,r){if(e==null)return e;var n=[],a=0;return Mo(e,n,"","",function(i){return t.call(r,i,a++)}),n}function iv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var cs={current:null},To={transition:null},lv={ReactCurrentDispatcher:cs,ReactCurrentBatchConfig:To,ReactCurrentOwner:Mm};function qf(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:so,forEach:function(e,t,r){so(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return so(e,function(){t++}),t},toArray:function(e){return so(e,function(t){return t})||[]},only:function(e){if(!Tm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=yi;qe.Fragment=Vb;qe.Profiler=Yb;qe.PureComponent=_m;qe.StrictMode=Gb;qe.Suspense=ev;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lv;qe.act=qf;qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Of({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Mm.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Uf.call(t,c)&&!Hf.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:Ol,type:e.type,key:a,ref:i,props:n,_owner:l}};qe.createContext=function(e){return e={$$typeof:Xb,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Jb,_context:e},e.Consumer=e};qe.createElement=Bf;qe.createFactory=function(e){var t=Bf.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:Zb,render:e}};qe.isValidElement=Tm;qe.lazy=function(e){return{$$typeof:sv,_payload:{_status:-1,_result:e},_init:iv}};qe.memo=function(e,t){return{$$typeof:tv,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=To.transition;To.transition={};try{e()}finally{To.transition=t}};qe.unstable_act=qf;qe.useCallback=function(e,t){return cs.current.useCallback(e,t)};qe.useContext=function(e){return cs.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return cs.current.useDeferredValue(e)};qe.useEffect=function(e,t){return cs.current.useEffect(e,t)};qe.useId=function(){return cs.current.useId()};qe.useImperativeHandle=function(e,t,r){return cs.current.useImperativeHandle(e,t,r)};qe.useInsertionEffect=function(e,t){return cs.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return cs.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return cs.current.useMemo(e,t)};qe.useReducer=function(e,t,r){return cs.current.useReducer(e,t,r)};qe.useRef=function(e){return cs.current.useRef(e)};qe.useState=function(e){return cs.current.useState(e)};qe.useSyncExternalStore=function(e,t,r){return cs.current.useSyncExternalStore(e,t,r)};qe.useTransition=function(){return cs.current.useTransition()};qe.version="18.3.1";Ff.exports=qe;var u=Ff.exports;const Le=$f(u),ri=Kb({__proto__:null,default:Le},[u]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ov=u,cv=Symbol.for("react.element"),dv=Symbol.for("react.fragment"),uv=Object.prototype.hasOwnProperty,mv=ov.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hv={key:!0,ref:!0,__self:!0,__source:!0};function Wf(e,t,r){var n,a={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)uv.call(t,n)&&!hv.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:cv,type:e,key:i,ref:l,props:a,_owner:mv.current}}Ec.Fragment=dv;Ec.jsx=Wf;Ec.jsxs=Wf;Lf.exports=Ec;var s=Lf.exports,Zd={},Kf={exports:{}},Ts={},Qf={exports:{}},Vf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,X){var Y=M.length;M.push(X);e:for(;0<Y;){var ee=Y-1>>>1,ie=M[ee];if(0<a(ie,X))M[ee]=X,M[Y]=ie,Y=ee;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var X=M[0],Y=M.pop();if(Y!==X){M[0]=Y;e:for(var ee=0,ie=M.length,ne=ie>>>1;ee<ne;){var ge=2*(ee+1)-1,$e=M[ge],R=ge+1,ae=M[R];if(0>a($e,Y))R<ie&&0>a(ae,$e)?(M[ee]=ae,M[R]=Y,ee=R):(M[ee]=$e,M[ge]=Y,ee=ge);else if(R<ie&&0>a(ae,Y))M[ee]=ae,M[R]=Y,ee=R;else break e}}return X}function a(M,X){var Y=M.sortIndex-X.sortIndex;return Y!==0?Y:M.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],d=[],m=1,h=null,f=3,j=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var X=r(d);X!==null;){if(X.callback===null)n(d);else if(X.startTime<=M)n(d),X.sortIndex=X.expirationTime,t(c,X);else break;X=r(d)}}function w(M){if(g=!1,v(M),!x)if(r(c)!==null)x=!0,we(N);else{var X=r(d);X!==null&&B(w,X.startTime-M)}}function N(M,X){x=!1,g&&(g=!1,b(F),F=-1),j=!0;var Y=f;try{for(v(X),h=r(c);h!==null&&(!(h.expirationTime>X)||M&&!O());){var ee=h.callback;if(typeof ee=="function"){h.callback=null,f=h.priorityLevel;var ie=ee(h.expirationTime<=X);X=e.unstable_now(),typeof ie=="function"?h.callback=ie:h===r(c)&&n(c),v(X)}else n(c);h=r(c)}if(h!==null)var ne=!0;else{var ge=r(d);ge!==null&&B(w,ge.startTime-X),ne=!1}return ne}finally{h=null,f=Y,j=!1}}var A=!1,z=null,F=-1,Z=5,q=-1;function O(){return!(e.unstable_now()-q<Z)}function V(){if(z!==null){var M=e.unstable_now();q=M;var X=!0;try{X=z(!0,M)}finally{X?J():(A=!1,z=null)}}else A=!1}var J;if(typeof p=="function")J=function(){p(V)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,ke=pe.port2;pe.port1.onmessage=V,J=function(){ke.postMessage(null)}}else J=function(){y(V,0)};function we(M){z=M,A||(A=!0,J())}function B(M,X){F=y(function(){M(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){x||j||(x=!0,we(N))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(M){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var Y=f;f=X;try{return M()}finally{f=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,X){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var Y=f;f=M;try{return X()}finally{f=Y}},e.unstable_scheduleCallback=function(M,X,Y){var ee=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ee+Y:ee):Y=ee,M){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=Y+ie,M={id:m++,callback:X,priorityLevel:M,startTime:Y,expirationTime:ie,sortIndex:-1},Y>ee?(M.sortIndex=Y,t(d,M),r(c)===null&&M===r(d)&&(g?(b(F),F=-1):g=!0,B(w,Y-ee))):(M.sortIndex=ie,t(c,M),x||j||(x=!0,we(N))),M},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(M){var X=f;return function(){var Y=f;f=X;try{return M.apply(this,arguments)}finally{f=Y}}}})(Vf);Qf.exports=Vf;var xv=Qf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fv=u,Ms=xv;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gf=new Set,ul={};function pa(e,t){ni(e,t),ni(e+"Capture",t)}function ni(e,t){for(ul[e]=t,e=0;e<t.length;e++)Gf.add(t[e])}var Dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eu=Object.prototype.hasOwnProperty,gv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zh={},e0={};function pv(e){return eu.call(e0,e)?!0:eu.call(Zh,e)?!1:gv.test(e)?e0[e]=!0:(Zh[e]=!0,!1)}function yv(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function bv(e,t,r,n){if(t===null||typeof t>"u"||yv(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ds(e,t,r,n,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var Qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Qt[e]=new ds(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Qt[t]=new ds(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Qt[e]=new ds(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Qt[e]=new ds(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Qt[e]=new ds(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Qt[e]=new ds(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Qt[e]=new ds(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Qt[e]=new ds(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Qt[e]=new ds(e,5,!1,e.toLowerCase(),null,!1,!1)});var Am=/[\-:]([a-z])/g;function Rm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Am,Rm);Qt[t]=new ds(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Am,Rm);Qt[t]=new ds(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Am,Rm);Qt[t]=new ds(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Qt[e]=new ds(e,1,!1,e.toLowerCase(),null,!1,!1)});Qt.xlinkHref=new ds("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Qt[e]=new ds(e,1,!1,e.toLowerCase(),null,!0,!0)});function Pm(e,t,r,n){var a=Qt.hasOwnProperty(t)?Qt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(bv(t,r,a,n)&&(r=null),n||a===null?pv(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var qr=fv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ro=Symbol.for("react.element"),_a=Symbol.for("react.portal"),Ea=Symbol.for("react.fragment"),$m=Symbol.for("react.strict_mode"),tu=Symbol.for("react.profiler"),Yf=Symbol.for("react.provider"),Jf=Symbol.for("react.context"),Lm=Symbol.for("react.forward_ref"),su=Symbol.for("react.suspense"),ru=Symbol.for("react.suspense_list"),Fm=Symbol.for("react.memo"),Zr=Symbol.for("react.lazy"),Xf=Symbol.for("react.offscreen"),t0=Symbol.iterator;function Mi(e){return e===null||typeof e!="object"?null:(e=t0&&e[t0]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,od;function qi(e){if(od===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);od=t&&t[1]||""}return`
`+od+e}var cd=!1;function dd(e,t){if(!e||cd)return"";cd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{cd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qi(e):""}function vv(e){switch(e.tag){case 5:return qi(e.type);case 16:return qi("Lazy");case 13:return qi("Suspense");case 19:return qi("SuspenseList");case 0:case 2:case 15:return e=dd(e.type,!1),e;case 11:return e=dd(e.type.render,!1),e;case 1:return e=dd(e.type,!0),e;default:return""}}function nu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ea:return"Fragment";case _a:return"Portal";case tu:return"Profiler";case $m:return"StrictMode";case su:return"Suspense";case ru:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Jf:return(e.displayName||"Context")+".Consumer";case Yf:return(e._context.displayName||"Context")+".Provider";case Lm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Fm:return t=e.displayName||null,t!==null?t:nu(e.type)||"Memo";case Zr:t=e._payload,e=e._init;try{return nu(e(t))}catch{}}return null}function jv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nu(t);case 8:return t===$m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Tn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function wv(e){var t=Zf(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function no(e){e._valueTracker||(e._valueTracker=wv(e))}function eg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Zf(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Vo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function au(e,t){var r=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function s0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Tn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tg(e,t){t=t.checked,t!=null&&Pm(e,"checked",t,!1)}function iu(e,t){tg(e,t);var r=Tn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lu(e,t.type,r):t.hasOwnProperty("defaultValue")&&lu(e,t.type,Tn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function r0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function lu(e,t,r){(t!=="number"||Vo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Wi=Array.isArray;function Da(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Tn(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ou(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function n0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(te(92));if(Wi(r)){if(1<r.length)throw Error(te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Tn(r)}}function sg(e,t){var r=Tn(t.value),n=Tn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function a0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ao,ng=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ao=ao||document.createElement("div"),ao.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ao.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ml(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Zi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nv=["Webkit","ms","Moz","O"];Object.keys(Zi).forEach(function(e){Nv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zi[t]=Zi[e]})});function ag(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Zi.hasOwnProperty(e)&&Zi[e]?(""+t).trim():t+"px"}function ig(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=ag(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var kv=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function du(e,t){if(t){if(kv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function uu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mu=null;function Im(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hu=null,za=null,Ua=null;function i0(e){if(e=Ul(e)){if(typeof hu!="function")throw Error(te(280));var t=e.stateNode;t&&(t=Pc(t),hu(e.stateNode,e.type,t))}}function lg(e){za?Ua?Ua.push(e):Ua=[e]:za=e}function og(){if(za){var e=za,t=Ua;if(Ua=za=null,i0(e),t)for(e=0;e<t.length;e++)i0(t[e])}}function cg(e,t){return e(t)}function dg(){}var ud=!1;function ug(e,t,r){if(ud)return e(t,r);ud=!0;try{return cg(e,t,r)}finally{ud=!1,(za!==null||Ua!==null)&&(dg(),og())}}function hl(e,t){var r=e.stateNode;if(r===null)return null;var n=Pc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,t,typeof r));return r}var xu=!1;if(Dr)try{var Ti={};Object.defineProperty(Ti,"passive",{get:function(){xu=!0}}),window.addEventListener("test",Ti,Ti),window.removeEventListener("test",Ti,Ti)}catch{xu=!1}function Sv(e,t,r,n,a,i,l,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(m){this.onError(m)}}var el=!1,Go=null,Yo=!1,fu=null,Cv={onError:function(e){el=!0,Go=e}};function _v(e,t,r,n,a,i,l,o,c){el=!1,Go=null,Sv.apply(Cv,arguments)}function Ev(e,t,r,n,a,i,l,o,c){if(_v.apply(this,arguments),el){if(el){var d=Go;el=!1,Go=null}else throw Error(te(198));Yo||(Yo=!0,fu=d)}}function ya(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function l0(e){if(ya(e)!==e)throw Error(te(188))}function Mv(e){var t=e.alternate;if(!t){if(t=ya(e),t===null)throw Error(te(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return l0(a),e;if(i===n)return l0(a),t;i=i.sibling}throw Error(te(188))}if(r.return!==n.return)r=a,n=i;else{for(var l=!1,o=a.child;o;){if(o===r){l=!0,r=a,n=i;break}if(o===n){l=!0,n=a,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=a;break}if(o===n){l=!0,n=i,r=a;break}o=o.sibling}if(!l)throw Error(te(189))}}if(r.alternate!==n)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:t}function hg(e){return e=Mv(e),e!==null?xg(e):null}function xg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=xg(e);if(t!==null)return t;e=e.sibling}return null}var fg=Ms.unstable_scheduleCallback,o0=Ms.unstable_cancelCallback,Tv=Ms.unstable_shouldYield,Av=Ms.unstable_requestPaint,jt=Ms.unstable_now,Rv=Ms.unstable_getCurrentPriorityLevel,Om=Ms.unstable_ImmediatePriority,gg=Ms.unstable_UserBlockingPriority,Jo=Ms.unstable_NormalPriority,Pv=Ms.unstable_LowPriority,pg=Ms.unstable_IdlePriority,Mc=null,pr=null;function $v(e){if(pr&&typeof pr.onCommitFiberRoot=="function")try{pr.onCommitFiberRoot(Mc,e,void 0,(e.current.flags&128)===128)}catch{}}var Xs=Math.clz32?Math.clz32:Iv,Lv=Math.log,Fv=Math.LN2;function Iv(e){return e>>>=0,e===0?32:31-(Lv(e)/Fv|0)|0}var io=64,lo=4194304;function Ki(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xo(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~a;o!==0?n=Ki(o):(i&=l,i!==0&&(n=Ki(i)))}else l=r&~a,l!==0?n=Ki(l):i!==0&&(n=Ki(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Xs(t),a=1<<r,n|=e[r],t&=~a;return n}function Ov(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dv(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Xs(i),o=1<<l,c=a[l];c===-1?(!(o&r)||o&n)&&(a[l]=Ov(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function gu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yg(){var e=io;return io<<=1,!(io&4194240)&&(io=64),e}function md(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Dl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xs(t),e[t]=r}function zv(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Xs(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Dm(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Xs(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var nt=0;function bg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vg,zm,jg,wg,Ng,pu=!1,oo=[],bn=null,vn=null,jn=null,xl=new Map,fl=new Map,tn=[],Uv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function c0(e,t){switch(e){case"focusin":case"focusout":bn=null;break;case"dragenter":case"dragleave":vn=null;break;case"mouseover":case"mouseout":jn=null;break;case"pointerover":case"pointerout":xl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fl.delete(t.pointerId)}}function Ai(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Ul(t),t!==null&&zm(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Hv(e,t,r,n,a){switch(t){case"focusin":return bn=Ai(bn,e,t,r,n,a),!0;case"dragenter":return vn=Ai(vn,e,t,r,n,a),!0;case"mouseover":return jn=Ai(jn,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return xl.set(i,Ai(xl.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,fl.set(i,Ai(fl.get(i)||null,e,t,r,n,a)),!0}return!1}function kg(e){var t=qn(e.target);if(t!==null){var r=ya(t);if(r!==null){if(t=r.tag,t===13){if(t=mg(r),t!==null){e.blockedOn=t,Ng(e.priority,function(){jg(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ao(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=yu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);mu=n,r.target.dispatchEvent(n),mu=null}else return t=Ul(r),t!==null&&zm(t),e.blockedOn=r,!1;t.shift()}return!0}function d0(e,t,r){Ao(e)&&r.delete(t)}function Bv(){pu=!1,bn!==null&&Ao(bn)&&(bn=null),vn!==null&&Ao(vn)&&(vn=null),jn!==null&&Ao(jn)&&(jn=null),xl.forEach(d0),fl.forEach(d0)}function Ri(e,t){e.blockedOn===t&&(e.blockedOn=null,pu||(pu=!0,Ms.unstable_scheduleCallback(Ms.unstable_NormalPriority,Bv)))}function gl(e){function t(a){return Ri(a,e)}if(0<oo.length){Ri(oo[0],e);for(var r=1;r<oo.length;r++){var n=oo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(bn!==null&&Ri(bn,e),vn!==null&&Ri(vn,e),jn!==null&&Ri(jn,e),xl.forEach(t),fl.forEach(t),r=0;r<tn.length;r++)n=tn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<tn.length&&(r=tn[0],r.blockedOn===null);)kg(r),r.blockedOn===null&&tn.shift()}var Ha=qr.ReactCurrentBatchConfig,Zo=!0;function qv(e,t,r,n){var a=nt,i=Ha.transition;Ha.transition=null;try{nt=1,Um(e,t,r,n)}finally{nt=a,Ha.transition=i}}function Wv(e,t,r,n){var a=nt,i=Ha.transition;Ha.transition=null;try{nt=4,Um(e,t,r,n)}finally{nt=a,Ha.transition=i}}function Um(e,t,r,n){if(Zo){var a=yu(e,t,r,n);if(a===null)wd(e,t,n,ec,r),c0(e,n);else if(Hv(a,e,t,r,n))n.stopPropagation();else if(c0(e,n),t&4&&-1<Uv.indexOf(e)){for(;a!==null;){var i=Ul(a);if(i!==null&&vg(i),i=yu(e,t,r,n),i===null&&wd(e,t,n,ec,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else wd(e,t,n,null,r)}}var ec=null;function yu(e,t,r,n){if(ec=null,e=Im(n),e=qn(e),e!==null)if(t=ya(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mg(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ec=e,null}function Sg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rv()){case Om:return 1;case gg:return 4;case Jo:case Pv:return 16;case pg:return 536870912;default:return 16}default:return 16}}var xn=null,Hm=null,Ro=null;function Cg(){if(Ro)return Ro;var e,t=Hm,r=t.length,n,a="value"in xn?xn.value:xn.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===a[i-n];n++);return Ro=a.slice(e,1<n?1-n:void 0)}function Po(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function co(){return!0}function u0(){return!1}function As(e){function t(r,n,a,i,l){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?co:u0,this.isPropagationStopped=u0,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=co)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=co)},persist:function(){},isPersistent:co}),t}var bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bm=As(bi),zl=pt({},bi,{view:0,detail:0}),Kv=As(zl),hd,xd,Pi,Tc=pt({},zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pi&&(Pi&&e.type==="mousemove"?(hd=e.screenX-Pi.screenX,xd=e.screenY-Pi.screenY):xd=hd=0,Pi=e),hd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),m0=As(Tc),Qv=pt({},Tc,{dataTransfer:0}),Vv=As(Qv),Gv=pt({},zl,{relatedTarget:0}),fd=As(Gv),Yv=pt({},bi,{animationName:0,elapsedTime:0,pseudoElement:0}),Jv=As(Yv),Xv=pt({},bi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Zv=As(Xv),e2=pt({},bi,{data:0}),h0=As(e2),t2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function n2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=r2[e])?!!t[e]:!1}function qm(){return n2}var a2=pt({},zl,{key:function(e){if(e.key){var t=t2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Po(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?s2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qm,charCode:function(e){return e.type==="keypress"?Po(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Po(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),i2=As(a2),l2=pt({},Tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x0=As(l2),o2=pt({},zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qm}),c2=As(o2),d2=pt({},bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),u2=As(d2),m2=pt({},Tc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),h2=As(m2),x2=[9,13,27,32],Wm=Dr&&"CompositionEvent"in window,tl=null;Dr&&"documentMode"in document&&(tl=document.documentMode);var f2=Dr&&"TextEvent"in window&&!tl,_g=Dr&&(!Wm||tl&&8<tl&&11>=tl),f0=" ",g0=!1;function Eg(e,t){switch(e){case"keyup":return x2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ma=!1;function g2(e,t){switch(e){case"compositionend":return Mg(t);case"keypress":return t.which!==32?null:(g0=!0,f0);case"textInput":return e=t.data,e===f0&&g0?null:e;default:return null}}function p2(e,t){if(Ma)return e==="compositionend"||!Wm&&Eg(e,t)?(e=Cg(),Ro=Hm=xn=null,Ma=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _g&&t.locale!=="ko"?null:t.data;default:return null}}var y2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!y2[e.type]:t==="textarea"}function Tg(e,t,r,n){lg(n),t=tc(t,"onChange"),0<t.length&&(r=new Bm("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var sl=null,pl=null;function b2(e){Ug(e,0)}function Ac(e){var t=Ra(e);if(eg(t))return e}function v2(e,t){if(e==="change")return t}var Ag=!1;if(Dr){var gd;if(Dr){var pd="oninput"in document;if(!pd){var y0=document.createElement("div");y0.setAttribute("oninput","return;"),pd=typeof y0.oninput=="function"}gd=pd}else gd=!1;Ag=gd&&(!document.documentMode||9<document.documentMode)}function b0(){sl&&(sl.detachEvent("onpropertychange",Rg),pl=sl=null)}function Rg(e){if(e.propertyName==="value"&&Ac(pl)){var t=[];Tg(t,pl,e,Im(e)),ug(b2,t)}}function j2(e,t,r){e==="focusin"?(b0(),sl=t,pl=r,sl.attachEvent("onpropertychange",Rg)):e==="focusout"&&b0()}function w2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ac(pl)}function N2(e,t){if(e==="click")return Ac(t)}function k2(e,t){if(e==="input"||e==="change")return Ac(t)}function S2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tr=typeof Object.is=="function"?Object.is:S2;function yl(e,t){if(tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!eu.call(t,a)||!tr(e[a],t[a]))return!1}return!0}function v0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function j0(e,t){var r=v0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=v0(r)}}function Pg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Pg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $g(){for(var e=window,t=Vo();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Vo(e.document)}return t}function Km(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function C2(e){var t=$g(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Pg(r.ownerDocument.documentElement,r)){if(n!==null&&Km(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=j0(r,i);var l=j0(r,n);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _2=Dr&&"documentMode"in document&&11>=document.documentMode,Ta=null,bu=null,rl=null,vu=!1;function w0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vu||Ta==null||Ta!==Vo(n)||(n=Ta,"selectionStart"in n&&Km(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),rl&&yl(rl,n)||(rl=n,n=tc(bu,"onSelect"),0<n.length&&(t=new Bm("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ta)))}function uo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Aa={animationend:uo("Animation","AnimationEnd"),animationiteration:uo("Animation","AnimationIteration"),animationstart:uo("Animation","AnimationStart"),transitionend:uo("Transition","TransitionEnd")},yd={},Lg={};Dr&&(Lg=document.createElement("div").style,"AnimationEvent"in window||(delete Aa.animationend.animation,delete Aa.animationiteration.animation,delete Aa.animationstart.animation),"TransitionEvent"in window||delete Aa.transitionend.transition);function Rc(e){if(yd[e])return yd[e];if(!Aa[e])return e;var t=Aa[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Lg)return yd[e]=t[r];return e}var Fg=Rc("animationend"),Ig=Rc("animationiteration"),Og=Rc("animationstart"),Dg=Rc("transitionend"),zg=new Map,N0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(e,t){zg.set(e,t),pa(t,[e])}for(var bd=0;bd<N0.length;bd++){var vd=N0[bd],E2=vd.toLowerCase(),M2=vd[0].toUpperCase()+vd.slice(1);Rn(E2,"on"+M2)}Rn(Fg,"onAnimationEnd");Rn(Ig,"onAnimationIteration");Rn(Og,"onAnimationStart");Rn("dblclick","onDoubleClick");Rn("focusin","onFocus");Rn("focusout","onBlur");Rn(Dg,"onTransitionEnd");ni("onMouseEnter",["mouseout","mouseover"]);ni("onMouseLeave",["mouseout","mouseover"]);ni("onPointerEnter",["pointerout","pointerover"]);ni("onPointerLeave",["pointerout","pointerover"]);pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pa("onBeforeInput",["compositionend","keypress","textInput","paste"]);pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),T2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qi));function k0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Ev(n,t,void 0,e),e.currentTarget=null}function Ug(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;k0(a,o,d),i=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;k0(a,o,d),i=c}}}if(Yo)throw e=fu,Yo=!1,fu=null,e}function dt(e,t){var r=t[Su];r===void 0&&(r=t[Su]=new Set);var n=e+"__bubble";r.has(n)||(Hg(t,e,2,!1),r.add(n))}function jd(e,t,r){var n=0;t&&(n|=4),Hg(r,e,n,t)}var mo="_reactListening"+Math.random().toString(36).slice(2);function bl(e){if(!e[mo]){e[mo]=!0,Gf.forEach(function(r){r!=="selectionchange"&&(T2.has(r)||jd(r,!1,e),jd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[mo]||(t[mo]=!0,jd("selectionchange",!1,t))}}function Hg(e,t,r,n){switch(Sg(t)){case 1:var a=qv;break;case 4:a=Wv;break;default:a=Um}r=a.bind(null,t,r,e),a=void 0,!xu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function wd(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=qn(o),l===null)return;if(c=l.tag,c===5||c===6){n=i=l;continue e}o=o.parentNode}}n=n.return}ug(function(){var d=i,m=Im(r),h=[];e:{var f=zg.get(e);if(f!==void 0){var j=Bm,x=e;switch(e){case"keypress":if(Po(r)===0)break e;case"keydown":case"keyup":j=i2;break;case"focusin":x="focus",j=fd;break;case"focusout":x="blur",j=fd;break;case"beforeblur":case"afterblur":j=fd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=m0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=Vv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=c2;break;case Fg:case Ig:case Og:j=Jv;break;case Dg:j=u2;break;case"scroll":j=Kv;break;case"wheel":j=h2;break;case"copy":case"cut":case"paste":j=Zv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=x0}var g=(t&4)!==0,y=!g&&e==="scroll",b=g?f!==null?f+"Capture":null:f;g=[];for(var p=d,v;p!==null;){v=p;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,b!==null&&(w=hl(p,b),w!=null&&g.push(vl(p,w,v)))),y)break;p=p.return}0<g.length&&(f=new j(f,x,null,r,m),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",f&&r!==mu&&(x=r.relatedTarget||r.fromElement)&&(qn(x)||x[zr]))break e;if((j||f)&&(f=m.window===m?m:(f=m.ownerDocument)?f.defaultView||f.parentWindow:window,j?(x=r.relatedTarget||r.toElement,j=d,x=x?qn(x):null,x!==null&&(y=ya(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(j=null,x=d),j!==x)){if(g=m0,w="onMouseLeave",b="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(g=x0,w="onPointerLeave",b="onPointerEnter",p="pointer"),y=j==null?f:Ra(j),v=x==null?f:Ra(x),f=new g(w,p+"leave",j,r,m),f.target=y,f.relatedTarget=v,w=null,qn(m)===d&&(g=new g(b,p+"enter",x,r,m),g.target=v,g.relatedTarget=y,w=g),y=w,j&&x)t:{for(g=j,b=x,p=0,v=g;v;v=ka(v))p++;for(v=0,w=b;w;w=ka(w))v++;for(;0<p-v;)g=ka(g),p--;for(;0<v-p;)b=ka(b),v--;for(;p--;){if(g===b||b!==null&&g===b.alternate)break t;g=ka(g),b=ka(b)}g=null}else g=null;j!==null&&S0(h,f,j,g,!1),x!==null&&y!==null&&S0(h,y,x,g,!0)}}e:{if(f=d?Ra(d):window,j=f.nodeName&&f.nodeName.toLowerCase(),j==="select"||j==="input"&&f.type==="file")var N=v2;else if(p0(f))if(Ag)N=k2;else{N=w2;var A=j2}else(j=f.nodeName)&&j.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=N2);if(N&&(N=N(e,d))){Tg(h,N,r,m);break e}A&&A(e,f,d),e==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&lu(f,"number",f.value)}switch(A=d?Ra(d):window,e){case"focusin":(p0(A)||A.contentEditable==="true")&&(Ta=A,bu=d,rl=null);break;case"focusout":rl=bu=Ta=null;break;case"mousedown":vu=!0;break;case"contextmenu":case"mouseup":case"dragend":vu=!1,w0(h,r,m);break;case"selectionchange":if(_2)break;case"keydown":case"keyup":w0(h,r,m)}var z;if(Wm)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Ma?Eg(e,r)&&(F="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(_g&&r.locale!=="ko"&&(Ma||F!=="onCompositionStart"?F==="onCompositionEnd"&&Ma&&(z=Cg()):(xn=m,Hm="value"in xn?xn.value:xn.textContent,Ma=!0)),A=tc(d,F),0<A.length&&(F=new h0(F,e,null,r,m),h.push({event:F,listeners:A}),z?F.data=z:(z=Mg(r),z!==null&&(F.data=z)))),(z=f2?g2(e,r):p2(e,r))&&(d=tc(d,"onBeforeInput"),0<d.length&&(m=new h0("onBeforeInput","beforeinput",null,r,m),h.push({event:m,listeners:d}),m.data=z))}Ug(h,t)})}function vl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function tc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=hl(e,r),i!=null&&n.unshift(vl(e,i,a)),i=hl(e,t),i!=null&&n.push(vl(e,i,a))),e=e.return}return n}function ka(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function S0(e,t,r,n,a){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,c=o.alternate,d=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&d!==null&&(o=d,a?(c=hl(r,i),c!=null&&l.unshift(vl(r,c,o))):a||(c=hl(r,i),c!=null&&l.push(vl(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var A2=/\r\n?/g,R2=/\u0000|\uFFFD/g;function C0(e){return(typeof e=="string"?e:""+e).replace(A2,`
`).replace(R2,"")}function ho(e,t,r){if(t=C0(t),C0(e)!==t&&r)throw Error(te(425))}function sc(){}var ju=null,wu=null;function Nu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ku=typeof setTimeout=="function"?setTimeout:void 0,P2=typeof clearTimeout=="function"?clearTimeout:void 0,_0=typeof Promise=="function"?Promise:void 0,$2=typeof queueMicrotask=="function"?queueMicrotask:typeof _0<"u"?function(e){return _0.resolve(null).then(e).catch(L2)}:ku;function L2(e){setTimeout(function(){throw e})}function Nd(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),gl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);gl(t)}function wn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function E0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var vi=Math.random().toString(36).slice(2),fr="__reactFiber$"+vi,jl="__reactProps$"+vi,zr="__reactContainer$"+vi,Su="__reactEvents$"+vi,F2="__reactListeners$"+vi,I2="__reactHandles$"+vi;function qn(e){var t=e[fr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[zr]||r[fr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=E0(e);e!==null;){if(r=e[fr])return r;e=E0(e)}return t}e=r,r=e.parentNode}return null}function Ul(e){return e=e[fr]||e[zr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ra(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function Pc(e){return e[jl]||null}var Cu=[],Pa=-1;function Pn(e){return{current:e}}function ut(e){0>Pa||(e.current=Cu[Pa],Cu[Pa]=null,Pa--)}function ot(e,t){Pa++,Cu[Pa]=e.current,e.current=t}var An={},es=Pn(An),bs=Pn(!1),ca=An;function ai(e,t){var r=e.type.contextTypes;if(!r)return An;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function vs(e){return e=e.childContextTypes,e!=null}function rc(){ut(bs),ut(es)}function M0(e,t,r){if(es.current!==An)throw Error(te(168));ot(es,t),ot(bs,r)}function Bg(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(te(108,jv(e)||"Unknown",a));return pt({},r,n)}function nc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||An,ca=es.current,ot(es,e),ot(bs,bs.current),!0}function T0(e,t,r){var n=e.stateNode;if(!n)throw Error(te(169));r?(e=Bg(e,t,ca),n.__reactInternalMemoizedMergedChildContext=e,ut(bs),ut(es),ot(es,e)):ut(bs),ot(bs,r)}var Cr=null,$c=!1,kd=!1;function qg(e){Cr===null?Cr=[e]:Cr.push(e)}function O2(e){$c=!0,qg(e)}function $n(){if(!kd&&Cr!==null){kd=!0;var e=0,t=nt;try{var r=Cr;for(nt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Cr=null,$c=!1}catch(a){throw Cr!==null&&(Cr=Cr.slice(e+1)),fg(Om,$n),a}finally{nt=t,kd=!1}}return null}var $a=[],La=0,ac=null,ic=0,Fs=[],Is=0,da=null,Rr=1,Pr="";function Hn(e,t){$a[La++]=ic,$a[La++]=ac,ac=e,ic=t}function Wg(e,t,r){Fs[Is++]=Rr,Fs[Is++]=Pr,Fs[Is++]=da,da=e;var n=Rr;e=Pr;var a=32-Xs(n)-1;n&=~(1<<a),r+=1;var i=32-Xs(t)+a;if(30<i){var l=a-a%5;i=(n&(1<<l)-1).toString(32),n>>=l,a-=l,Rr=1<<32-Xs(t)+a|r<<a|n,Pr=i+e}else Rr=1<<i|r<<a|n,Pr=e}function Qm(e){e.return!==null&&(Hn(e,1),Wg(e,1,0))}function Vm(e){for(;e===ac;)ac=$a[--La],$a[La]=null,ic=$a[--La],$a[La]=null;for(;e===da;)da=Fs[--Is],Fs[Is]=null,Pr=Fs[--Is],Fs[Is]=null,Rr=Fs[--Is],Fs[Is]=null}var Es=null,_s=null,ht=!1,Gs=null;function Kg(e,t){var r=Os(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function A0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Es=e,_s=wn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Es=e,_s=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=da!==null?{id:Rr,overflow:Pr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Os(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Es=e,_s=null,!0):!1;default:return!1}}function _u(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eu(e){if(ht){var t=_s;if(t){var r=t;if(!A0(e,t)){if(_u(e))throw Error(te(418));t=wn(r.nextSibling);var n=Es;t&&A0(e,t)?Kg(n,r):(e.flags=e.flags&-4097|2,ht=!1,Es=e)}}else{if(_u(e))throw Error(te(418));e.flags=e.flags&-4097|2,ht=!1,Es=e}}}function R0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Es=e}function xo(e){if(e!==Es)return!1;if(!ht)return R0(e),ht=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nu(e.type,e.memoizedProps)),t&&(t=_s)){if(_u(e))throw Qg(),Error(te(418));for(;t;)Kg(e,t),t=wn(t.nextSibling)}if(R0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_s=wn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_s=null}}else _s=Es?wn(e.stateNode.nextSibling):null;return!0}function Qg(){for(var e=_s;e;)e=wn(e.nextSibling)}function ii(){_s=Es=null,ht=!1}function Gm(e){Gs===null?Gs=[e]:Gs.push(e)}var D2=qr.ReactCurrentBatchConfig;function $i(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var n=r.stateNode}if(!n)throw Error(te(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function fo(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function P0(e){var t=e._init;return t(e._payload)}function Vg(e){function t(b,p){if(e){var v=b.deletions;v===null?(b.deletions=[p],b.flags|=16):v.push(p)}}function r(b,p){if(!e)return null;for(;p!==null;)t(b,p),p=p.sibling;return null}function n(b,p){for(b=new Map;p!==null;)p.key!==null?b.set(p.key,p):b.set(p.index,p),p=p.sibling;return b}function a(b,p){return b=Cn(b,p),b.index=0,b.sibling=null,b}function i(b,p,v){return b.index=v,e?(v=b.alternate,v!==null?(v=v.index,v<p?(b.flags|=2,p):v):(b.flags|=2,p)):(b.flags|=1048576,p)}function l(b){return e&&b.alternate===null&&(b.flags|=2),b}function o(b,p,v,w){return p===null||p.tag!==6?(p=Ad(v,b.mode,w),p.return=b,p):(p=a(p,v),p.return=b,p)}function c(b,p,v,w){var N=v.type;return N===Ea?m(b,p,v.props.children,w,v.key):p!==null&&(p.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Zr&&P0(N)===p.type)?(w=a(p,v.props),w.ref=$i(b,p,v),w.return=b,w):(w=zo(v.type,v.key,v.props,null,b.mode,w),w.ref=$i(b,p,v),w.return=b,w)}function d(b,p,v,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==v.containerInfo||p.stateNode.implementation!==v.implementation?(p=Rd(v,b.mode,w),p.return=b,p):(p=a(p,v.children||[]),p.return=b,p)}function m(b,p,v,w,N){return p===null||p.tag!==7?(p=ia(v,b.mode,w,N),p.return=b,p):(p=a(p,v),p.return=b,p)}function h(b,p,v){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Ad(""+p,b.mode,v),p.return=b,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case ro:return v=zo(p.type,p.key,p.props,null,b.mode,v),v.ref=$i(b,null,p),v.return=b,v;case _a:return p=Rd(p,b.mode,v),p.return=b,p;case Zr:var w=p._init;return h(b,w(p._payload),v)}if(Wi(p)||Mi(p))return p=ia(p,b.mode,v,null),p.return=b,p;fo(b,p)}return null}function f(b,p,v,w){var N=p!==null?p.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return N!==null?null:o(b,p,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ro:return v.key===N?c(b,p,v,w):null;case _a:return v.key===N?d(b,p,v,w):null;case Zr:return N=v._init,f(b,p,N(v._payload),w)}if(Wi(v)||Mi(v))return N!==null?null:m(b,p,v,w,null);fo(b,v)}return null}function j(b,p,v,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return b=b.get(v)||null,o(p,b,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ro:return b=b.get(w.key===null?v:w.key)||null,c(p,b,w,N);case _a:return b=b.get(w.key===null?v:w.key)||null,d(p,b,w,N);case Zr:var A=w._init;return j(b,p,v,A(w._payload),N)}if(Wi(w)||Mi(w))return b=b.get(v)||null,m(p,b,w,N,null);fo(p,w)}return null}function x(b,p,v,w){for(var N=null,A=null,z=p,F=p=0,Z=null;z!==null&&F<v.length;F++){z.index>F?(Z=z,z=null):Z=z.sibling;var q=f(b,z,v[F],w);if(q===null){z===null&&(z=Z);break}e&&z&&q.alternate===null&&t(b,z),p=i(q,p,F),A===null?N=q:A.sibling=q,A=q,z=Z}if(F===v.length)return r(b,z),ht&&Hn(b,F),N;if(z===null){for(;F<v.length;F++)z=h(b,v[F],w),z!==null&&(p=i(z,p,F),A===null?N=z:A.sibling=z,A=z);return ht&&Hn(b,F),N}for(z=n(b,z);F<v.length;F++)Z=j(z,b,F,v[F],w),Z!==null&&(e&&Z.alternate!==null&&z.delete(Z.key===null?F:Z.key),p=i(Z,p,F),A===null?N=Z:A.sibling=Z,A=Z);return e&&z.forEach(function(O){return t(b,O)}),ht&&Hn(b,F),N}function g(b,p,v,w){var N=Mi(v);if(typeof N!="function")throw Error(te(150));if(v=N.call(v),v==null)throw Error(te(151));for(var A=N=null,z=p,F=p=0,Z=null,q=v.next();z!==null&&!q.done;F++,q=v.next()){z.index>F?(Z=z,z=null):Z=z.sibling;var O=f(b,z,q.value,w);if(O===null){z===null&&(z=Z);break}e&&z&&O.alternate===null&&t(b,z),p=i(O,p,F),A===null?N=O:A.sibling=O,A=O,z=Z}if(q.done)return r(b,z),ht&&Hn(b,F),N;if(z===null){for(;!q.done;F++,q=v.next())q=h(b,q.value,w),q!==null&&(p=i(q,p,F),A===null?N=q:A.sibling=q,A=q);return ht&&Hn(b,F),N}for(z=n(b,z);!q.done;F++,q=v.next())q=j(z,b,F,q.value,w),q!==null&&(e&&q.alternate!==null&&z.delete(q.key===null?F:q.key),p=i(q,p,F),A===null?N=q:A.sibling=q,A=q);return e&&z.forEach(function(V){return t(b,V)}),ht&&Hn(b,F),N}function y(b,p,v,w){if(typeof v=="object"&&v!==null&&v.type===Ea&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case ro:e:{for(var N=v.key,A=p;A!==null;){if(A.key===N){if(N=v.type,N===Ea){if(A.tag===7){r(b,A.sibling),p=a(A,v.props.children),p.return=b,b=p;break e}}else if(A.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Zr&&P0(N)===A.type){r(b,A.sibling),p=a(A,v.props),p.ref=$i(b,A,v),p.return=b,b=p;break e}r(b,A);break}else t(b,A);A=A.sibling}v.type===Ea?(p=ia(v.props.children,b.mode,w,v.key),p.return=b,b=p):(w=zo(v.type,v.key,v.props,null,b.mode,w),w.ref=$i(b,p,v),w.return=b,b=w)}return l(b);case _a:e:{for(A=v.key;p!==null;){if(p.key===A)if(p.tag===4&&p.stateNode.containerInfo===v.containerInfo&&p.stateNode.implementation===v.implementation){r(b,p.sibling),p=a(p,v.children||[]),p.return=b,b=p;break e}else{r(b,p);break}else t(b,p);p=p.sibling}p=Rd(v,b.mode,w),p.return=b,b=p}return l(b);case Zr:return A=v._init,y(b,p,A(v._payload),w)}if(Wi(v))return x(b,p,v,w);if(Mi(v))return g(b,p,v,w);fo(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,p!==null&&p.tag===6?(r(b,p.sibling),p=a(p,v),p.return=b,b=p):(r(b,p),p=Ad(v,b.mode,w),p.return=b,b=p),l(b)):r(b,p)}return y}var li=Vg(!0),Gg=Vg(!1),lc=Pn(null),oc=null,Fa=null,Ym=null;function Jm(){Ym=Fa=oc=null}function Xm(e){var t=lc.current;ut(lc),e._currentValue=t}function Mu(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ba(e,t){oc=e,Ym=Fa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ps=!0),e.firstContext=null)}function zs(e){var t=e._currentValue;if(Ym!==e)if(e={context:e,memoizedValue:t,next:null},Fa===null){if(oc===null)throw Error(te(308));Fa=e,oc.dependencies={lanes:0,firstContext:e}}else Fa=Fa.next=e;return t}var Wn=null;function Zm(e){Wn===null?Wn=[e]:Wn.push(e)}function Yg(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Zm(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ur(e,n)}function Ur(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var en=!1;function eh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Je&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ur(e,r)}return a=n.interleaved,a===null?(t.next=t,Zm(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ur(e,r)}function $o(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Dm(e,r)}}function $0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function cc(e,t,r,n){var a=e.updateQueue;en=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,d=c.next;c.next=null,l===null?i=d:l.next=d,l=c;var m=e.alternate;m!==null&&(m=m.updateQueue,o=m.lastBaseUpdate,o!==l&&(o===null?m.firstBaseUpdate=d:o.next=d,m.lastBaseUpdate=c))}if(i!==null){var h=a.baseState;l=0,m=d=c=null,o=i;do{var f=o.lane,j=o.eventTime;if((n&f)===f){m!==null&&(m=m.next={eventTime:j,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(f=t,j=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){h=x.call(j,h,f);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,f=typeof x=="function"?x.call(j,h,f):x,f==null)break e;h=pt({},h,f);break e;case 2:en=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[o]:f.push(o))}else j={eventTime:j,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},m===null?(d=m=j,c=h):m=m.next=j,l|=f;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;f=o,o=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(m===null&&(c=h),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=m,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);ma|=l,e.lanes=l,e.memoizedState=h}}function L0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(te(191,a));a.call(n)}}}var Hl={},yr=Pn(Hl),wl=Pn(Hl),Nl=Pn(Hl);function Kn(e){if(e===Hl)throw Error(te(174));return e}function th(e,t){switch(ot(Nl,t),ot(wl,e),ot(yr,Hl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cu(t,e)}ut(yr),ot(yr,t)}function oi(){ut(yr),ut(wl),ut(Nl)}function Xg(e){Kn(Nl.current);var t=Kn(yr.current),r=cu(t,e.type);t!==r&&(ot(wl,e),ot(yr,r))}function sh(e){wl.current===e&&(ut(yr),ut(wl))}var ft=Pn(0);function dc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Sd=[];function rh(){for(var e=0;e<Sd.length;e++)Sd[e]._workInProgressVersionPrimary=null;Sd.length=0}var Lo=qr.ReactCurrentDispatcher,Cd=qr.ReactCurrentBatchConfig,ua=0,gt=null,Tt=null,It=null,uc=!1,nl=!1,kl=0,z2=0;function Yt(){throw Error(te(321))}function nh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!tr(e[r],t[r]))return!1;return!0}function ah(e,t,r,n,a,i){if(ua=i,gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Lo.current=e===null||e.memoizedState===null?q2:W2,e=r(n,a),nl){i=0;do{if(nl=!1,kl=0,25<=i)throw Error(te(301));i+=1,It=Tt=null,t.updateQueue=null,Lo.current=K2,e=r(n,a)}while(nl)}if(Lo.current=mc,t=Tt!==null&&Tt.next!==null,ua=0,It=Tt=gt=null,uc=!1,t)throw Error(te(300));return e}function ih(){var e=kl!==0;return kl=0,e}function dr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?gt.memoizedState=It=e:It=It.next=e,It}function Us(){if(Tt===null){var e=gt.alternate;e=e!==null?e.memoizedState:null}else e=Tt.next;var t=It===null?gt.memoizedState:It.next;if(t!==null)It=t,Tt=e;else{if(e===null)throw Error(te(310));Tt=e,e={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},It===null?gt.memoizedState=It=e:It=It.next=e}return It}function Sl(e,t){return typeof t=="function"?t(e):t}function _d(e){var t=Us(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=Tt,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=l=null,c=null,d=i;do{var m=d.lane;if((ua&m)===m)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=h,l=n):c=c.next=h,gt.lanes|=m,ma|=m}d=d.next}while(d!==null&&d!==i);c===null?l=n:c.next=o,tr(n,t.memoizedState)||(ps=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,gt.lanes|=i,ma|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ed(e){var t=Us(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);tr(i,t.memoizedState)||(ps=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Zg(){}function ep(e,t){var r=gt,n=Us(),a=t(),i=!tr(n.memoizedState,a);if(i&&(n.memoizedState=a,ps=!0),n=n.queue,lh(rp.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||It!==null&&It.memoizedState.tag&1){if(r.flags|=2048,Cl(9,sp.bind(null,r,n,a,t),void 0,null),zt===null)throw Error(te(349));ua&30||tp(r,t,a)}return a}function tp(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function sp(e,t,r,n){t.value=r,t.getSnapshot=n,np(t)&&ap(e)}function rp(e,t,r){return r(function(){np(t)&&ap(e)})}function np(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!tr(e,r)}catch{return!0}}function ap(e){var t=Ur(e,1);t!==null&&Zs(t,e,1,-1)}function F0(e){var t=dr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:e},t.queue=e,e=e.dispatch=B2.bind(null,gt,e),[t.memoizedState,e]}function Cl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ip(){return Us().memoizedState}function Fo(e,t,r,n){var a=dr();gt.flags|=e,a.memoizedState=Cl(1|t,r,void 0,n===void 0?null:n)}function Lc(e,t,r,n){var a=Us();n=n===void 0?null:n;var i=void 0;if(Tt!==null){var l=Tt.memoizedState;if(i=l.destroy,n!==null&&nh(n,l.deps)){a.memoizedState=Cl(t,r,i,n);return}}gt.flags|=e,a.memoizedState=Cl(1|t,r,i,n)}function I0(e,t){return Fo(8390656,8,e,t)}function lh(e,t){return Lc(2048,8,e,t)}function lp(e,t){return Lc(4,2,e,t)}function op(e,t){return Lc(4,4,e,t)}function cp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function dp(e,t,r){return r=r!=null?r.concat([e]):null,Lc(4,4,cp.bind(null,t,e),r)}function oh(){}function up(e,t){var r=Us();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&nh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function mp(e,t){var r=Us();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&nh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function hp(e,t,r){return ua&21?(tr(r,t)||(r=yg(),gt.lanes|=r,ma|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ps=!0),e.memoizedState=r)}function U2(e,t){var r=nt;nt=r!==0&&4>r?r:4,e(!0);var n=Cd.transition;Cd.transition={};try{e(!1),t()}finally{nt=r,Cd.transition=n}}function xp(){return Us().memoizedState}function H2(e,t,r){var n=Sn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},fp(e))gp(t,r);else if(r=Yg(e,t,r,n),r!==null){var a=os();Zs(r,e,n,a),pp(r,t,n)}}function B2(e,t,r){var n=Sn(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(fp(e))gp(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(a.hasEagerState=!0,a.eagerState=o,tr(o,l)){var c=t.interleaved;c===null?(a.next=a,Zm(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=Yg(e,t,a,n),r!==null&&(a=os(),Zs(r,e,n,a),pp(r,t,n))}}function fp(e){var t=e.alternate;return e===gt||t!==null&&t===gt}function gp(e,t){nl=uc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function pp(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Dm(e,r)}}var mc={readContext:zs,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},q2={readContext:zs,useCallback:function(e,t){return dr().memoizedState=[e,t===void 0?null:t],e},useContext:zs,useEffect:I0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Fo(4194308,4,cp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var r=dr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=dr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=H2.bind(null,gt,e),[n.memoizedState,e]},useRef:function(e){var t=dr();return e={current:e},t.memoizedState=e},useState:F0,useDebugValue:oh,useDeferredValue:function(e){return dr().memoizedState=e},useTransition:function(){var e=F0(!1),t=e[0];return e=U2.bind(null,e[1]),dr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gt,a=dr();if(ht){if(r===void 0)throw Error(te(407));r=r()}else{if(r=t(),zt===null)throw Error(te(349));ua&30||tp(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,I0(rp.bind(null,n,i,e),[e]),n.flags|=2048,Cl(9,sp.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=dr(),t=zt.identifierPrefix;if(ht){var r=Pr,n=Rr;r=(n&~(1<<32-Xs(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=kl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=z2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},W2={readContext:zs,useCallback:up,useContext:zs,useEffect:lh,useImperativeHandle:dp,useInsertionEffect:lp,useLayoutEffect:op,useMemo:mp,useReducer:_d,useRef:ip,useState:function(){return _d(Sl)},useDebugValue:oh,useDeferredValue:function(e){var t=Us();return hp(t,Tt.memoizedState,e)},useTransition:function(){var e=_d(Sl)[0],t=Us().memoizedState;return[e,t]},useMutableSource:Zg,useSyncExternalStore:ep,useId:xp,unstable_isNewReconciler:!1},K2={readContext:zs,useCallback:up,useContext:zs,useEffect:lh,useImperativeHandle:dp,useInsertionEffect:lp,useLayoutEffect:op,useMemo:mp,useReducer:Ed,useRef:ip,useState:function(){return Ed(Sl)},useDebugValue:oh,useDeferredValue:function(e){var t=Us();return Tt===null?t.memoizedState=e:hp(t,Tt.memoizedState,e)},useTransition:function(){var e=Ed(Sl)[0],t=Us().memoizedState;return[e,t]},useMutableSource:Zg,useSyncExternalStore:ep,useId:xp,unstable_isNewReconciler:!1};function qs(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Tu(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:pt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Fc={isMounted:function(e){return(e=e._reactInternals)?ya(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=os(),a=Sn(e),i=Lr(n,a);i.payload=t,r!=null&&(i.callback=r),t=Nn(e,i,a),t!==null&&(Zs(t,e,a,n),$o(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=os(),a=Sn(e),i=Lr(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Nn(e,i,a),t!==null&&(Zs(t,e,a,n),$o(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=os(),n=Sn(e),a=Lr(r,n);a.tag=2,t!=null&&(a.callback=t),t=Nn(e,a,n),t!==null&&(Zs(t,e,n,r),$o(t,e,n))}};function O0(e,t,r,n,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!yl(r,n)||!yl(a,i):!0}function yp(e,t,r){var n=!1,a=An,i=t.contextType;return typeof i=="object"&&i!==null?i=zs(i):(a=vs(t)?ca:es.current,n=t.contextTypes,i=(n=n!=null)?ai(e,a):An),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Fc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function D0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Fc.enqueueReplaceState(t,t.state,null)}function Au(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},eh(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=zs(i):(i=vs(t)?ca:es.current,a.context=ai(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Tu(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Fc.enqueueReplaceState(a,a.state,null),cc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function ci(e,t){try{var r="",n=t;do r+=vv(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Md(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ru(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Q2=typeof WeakMap=="function"?WeakMap:Map;function bp(e,t,r){r=Lr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){xc||(xc=!0,Hu=n),Ru(e,t)},r}function vp(e,t,r){r=Lr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Ru(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ru(e,t),typeof n!="function"&&(kn===null?kn=new Set([this]):kn.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function z0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Q2;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=lj.bind(null,e,t,r),t.then(e,e))}function U0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function H0(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Lr(-1,1),t.tag=2,Nn(r,t,1))),r.lanes|=1),e)}var V2=qr.ReactCurrentOwner,ps=!1;function is(e,t,r,n){t.child=e===null?Gg(t,null,r,n):li(t,e.child,r,n)}function B0(e,t,r,n,a){r=r.render;var i=t.ref;return Ba(t,a),n=ah(e,t,r,n,i,a),r=ih(),e!==null&&!ps?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hr(e,t,a)):(ht&&r&&Qm(t),t.flags|=1,is(e,t,n,a),t.child)}function q0(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!gh(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,jp(e,t,i,n,a)):(e=zo(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:yl,r(l,n)&&e.ref===t.ref)return Hr(e,t,a)}return t.flags|=1,e=Cn(i,n),e.ref=t.ref,e.return=t,t.child=e}function jp(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(yl(i,n)&&e.ref===t.ref)if(ps=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(ps=!0);else return t.lanes=e.lanes,Hr(e,t,a)}return Pu(e,t,r,n,a)}function wp(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(Oa,Cs),Cs|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ot(Oa,Cs),Cs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ot(Oa,Cs),Cs|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ot(Oa,Cs),Cs|=n;return is(e,t,a,r),t.child}function Np(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Pu(e,t,r,n,a){var i=vs(r)?ca:es.current;return i=ai(t,i),Ba(t,a),r=ah(e,t,r,n,i,a),n=ih(),e!==null&&!ps?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hr(e,t,a)):(ht&&n&&Qm(t),t.flags|=1,is(e,t,r,a),t.child)}function W0(e,t,r,n,a){if(vs(r)){var i=!0;nc(t)}else i=!1;if(Ba(t,a),t.stateNode===null)Io(e,t),yp(t,r,n),Au(t,r,n,a),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,d=r.contextType;typeof d=="object"&&d!==null?d=zs(d):(d=vs(r)?ca:es.current,d=ai(t,d));var m=r.getDerivedStateFromProps,h=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==d)&&D0(t,l,n,d),en=!1;var f=t.memoizedState;l.state=f,cc(t,n,l,a),c=t.memoizedState,o!==n||f!==c||bs.current||en?(typeof m=="function"&&(Tu(t,r,m,n),c=t.memoizedState),(o=en||O0(t,r,o,n,f,c,d))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),l.props=n,l.state=c,l.context=d,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Jg(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:qs(t.type,o),l.props=d,h=t.pendingProps,f=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=zs(c):(c=vs(r)?ca:es.current,c=ai(t,c));var j=r.getDerivedStateFromProps;(m=typeof j=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==c)&&D0(t,l,n,c),en=!1,f=t.memoizedState,l.state=f,cc(t,n,l,a);var x=t.memoizedState;o!==h||f!==x||bs.current||en?(typeof j=="function"&&(Tu(t,r,j,n),x=t.memoizedState),(d=en||O0(t,r,d,n,f,x,c)||!1)?(m||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,x,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,x,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),l.props=n,l.state=x,l.context=c,n=d):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return $u(e,t,r,n,i,a)}function $u(e,t,r,n,a,i){Np(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return a&&T0(t,r,!1),Hr(e,t,i);n=t.stateNode,V2.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=li(t,e.child,null,i),t.child=li(t,null,o,i)):is(e,t,o,i),t.memoizedState=n.state,a&&T0(t,r,!0),t.child}function kp(e){var t=e.stateNode;t.pendingContext?M0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&M0(e,t.context,!1),th(e,t.containerInfo)}function K0(e,t,r,n,a){return ii(),Gm(a),t.flags|=256,is(e,t,r,n),t.child}var Lu={dehydrated:null,treeContext:null,retryLane:0};function Fu(e){return{baseLanes:e,cachePool:null,transitions:null}}function Sp(e,t,r){var n=t.pendingProps,a=ft.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ot(ft,a&1),e===null)return Eu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Dc(l,n,0,null),e=ia(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fu(r),t.memoizedState=Lu,e):ch(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return G2(e,t,l,n,o,a,r);if(i){i=n.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Cn(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Cn(o,i):(i=ia(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?Fu(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=Lu,n}return i=e.child,e=i.sibling,n=Cn(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function ch(e,t){return t=Dc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function go(e,t,r,n){return n!==null&&Gm(n),li(t,e.child,null,r),e=ch(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function G2(e,t,r,n,a,i,l){if(r)return t.flags&256?(t.flags&=-257,n=Md(Error(te(422))),go(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Dc({mode:"visible",children:n.children},a,0,null),i=ia(i,a,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&li(t,e.child,null,l),t.child.memoizedState=Fu(l),t.memoizedState=Lu,i);if(!(t.mode&1))return go(e,t,l,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(te(419)),n=Md(i,n,void 0),go(e,t,l,n)}if(o=(l&e.childLanes)!==0,ps||o){if(n=zt,n!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Ur(e,a),Zs(n,e,a,-1))}return fh(),n=Md(Error(te(421))),go(e,t,l,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=oj.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,_s=wn(a.nextSibling),Es=t,ht=!0,Gs=null,e!==null&&(Fs[Is++]=Rr,Fs[Is++]=Pr,Fs[Is++]=da,Rr=e.id,Pr=e.overflow,da=t),t=ch(t,n.children),t.flags|=4096,t)}function Q0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Mu(e.return,t,r)}function Td(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Cp(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(is(e,t,n.children,r),n=ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Q0(e,r,t);else if(e.tag===19)Q0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ot(ft,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&dc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Td(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&dc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Td(t,!0,r,null,i);break;case"together":Td(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Io(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ma|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,r=Cn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Cn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Y2(e,t,r){switch(t.tag){case 3:kp(t),ii();break;case 5:Xg(t);break;case 1:vs(t.type)&&nc(t);break;case 4:th(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;ot(lc,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ot(ft,ft.current&1),t.flags|=128,null):r&t.child.childLanes?Sp(e,t,r):(ot(ft,ft.current&1),e=Hr(e,t,r),e!==null?e.sibling:null);ot(ft,ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Cp(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ot(ft,ft.current),n)break;return null;case 22:case 23:return t.lanes=0,wp(e,t,r)}return Hr(e,t,r)}var _p,Iu,Ep,Mp;_p=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Iu=function(){};Ep=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Kn(yr.current);var i=null;switch(r){case"input":a=au(e,a),n=au(e,n),i=[];break;case"select":a=pt({},a,{value:void 0}),n=pt({},n,{value:void 0}),i=[];break;case"textarea":a=ou(e,a),n=ou(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=sc)}du(r,n);var l;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var o=a[d];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ul.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ul.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&dt("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Mp=function(e,t,r,n){r!==n&&(t.flags|=4)};function Li(e,t){if(!ht)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function J2(e,t,r){var n=t.pendingProps;switch(Vm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(t),null;case 1:return vs(t.type)&&rc(),Jt(t),null;case 3:return n=t.stateNode,oi(),ut(bs),ut(es),rh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(xo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gs!==null&&(Wu(Gs),Gs=null))),Iu(e,t),Jt(t),null;case 5:sh(t);var a=Kn(Nl.current);if(r=t.type,e!==null&&t.stateNode!=null)Ep(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(te(166));return Jt(t),null}if(e=Kn(yr.current),xo(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[fr]=t,n[jl]=i,e=(t.mode&1)!==0,r){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(a=0;a<Qi.length;a++)dt(Qi[a],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":s0(n,i),dt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},dt("invalid",n);break;case"textarea":n0(n,i),dt("invalid",n)}du(r,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&ho(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&ho(n.textContent,o,e),a=["children",""+o]):ul.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&dt("scroll",n)}switch(r){case"input":no(n),r0(n,i,!0);break;case"textarea":no(n),a0(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=sc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rg(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[fr]=t,e[jl]=n,_p(e,t,!1,!1),t.stateNode=e;e:{switch(l=uu(r,n),r){case"dialog":dt("cancel",e),dt("close",e),a=n;break;case"iframe":case"object":case"embed":dt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Qi.length;a++)dt(Qi[a],e);a=n;break;case"source":dt("error",e),a=n;break;case"img":case"image":case"link":dt("error",e),dt("load",e),a=n;break;case"details":dt("toggle",e),a=n;break;case"input":s0(e,n),a=au(e,n),dt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=pt({},n,{value:void 0}),dt("invalid",e);break;case"textarea":n0(e,n),a=ou(e,n),dt("invalid",e);break;default:a=n}du(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?ig(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ng(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ml(e,c):typeof c=="number"&&ml(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ul.hasOwnProperty(i)?c!=null&&i==="onScroll"&&dt("scroll",e):c!=null&&Pm(e,i,c,l))}switch(r){case"input":no(e),r0(e,n,!1);break;case"textarea":no(e),a0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Tn(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Da(e,!!n.multiple,i,!1):n.defaultValue!=null&&Da(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=sc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Jt(t),null;case 6:if(e&&t.stateNode!=null)Mp(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(te(166));if(r=Kn(Nl.current),Kn(yr.current),xo(t)){if(n=t.stateNode,r=t.memoizedProps,n[fr]=t,(i=n.nodeValue!==r)&&(e=Es,e!==null))switch(e.tag){case 3:ho(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ho(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[fr]=t,t.stateNode=n}return Jt(t),null;case 13:if(ut(ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ht&&_s!==null&&t.mode&1&&!(t.flags&128))Qg(),ii(),t.flags|=98560,i=!1;else if(i=xo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(te(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(te(317));i[fr]=t}else ii(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Jt(t),i=!1}else Gs!==null&&(Wu(Gs),Gs=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ft.current&1?Rt===0&&(Rt=3):fh())),t.updateQueue!==null&&(t.flags|=4),Jt(t),null);case 4:return oi(),Iu(e,t),e===null&&bl(t.stateNode.containerInfo),Jt(t),null;case 10:return Xm(t.type._context),Jt(t),null;case 17:return vs(t.type)&&rc(),Jt(t),null;case 19:if(ut(ft),i=t.memoizedState,i===null)return Jt(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)Li(i,!1);else{if(Rt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=dc(e),l!==null){for(t.flags|=128,Li(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ot(ft,ft.current&1|2),t.child}e=e.sibling}i.tail!==null&&jt()>di&&(t.flags|=128,n=!0,Li(i,!1),t.lanes=4194304)}else{if(!n)if(e=dc(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Li(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!ht)return Jt(t),null}else 2*jt()-i.renderingStartTime>di&&r!==1073741824&&(t.flags|=128,n=!0,Li(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=jt(),t.sibling=null,r=ft.current,ot(ft,n?r&1|2:r&1),t):(Jt(t),null);case 22:case 23:return xh(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Cs&1073741824&&(Jt(t),t.subtreeFlags&6&&(t.flags|=8192)):Jt(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function X2(e,t){switch(Vm(t),t.tag){case 1:return vs(t.type)&&rc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return oi(),ut(bs),ut(es),rh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return sh(t),null;case 13:if(ut(ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));ii()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(ft),null;case 4:return oi(),null;case 10:return Xm(t.type._context),null;case 22:case 23:return xh(),null;case 24:return null;default:return null}}var po=!1,Xt=!1,Z2=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Ia(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){vt(e,t,n)}else r.current=null}function Ou(e,t,r){try{r()}catch(n){vt(e,t,n)}}var V0=!1;function ej(e,t){if(ju=Zo,e=$g(),Km(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,d=0,m=0,h=e,f=null;t:for(;;){for(var j;h!==r||a!==0&&h.nodeType!==3||(o=l+a),h!==i||n!==0&&h.nodeType!==3||(c=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(j=h.firstChild)!==null;)f=h,h=j;for(;;){if(h===e)break t;if(f===r&&++d===a&&(o=l),f===i&&++m===n&&(c=l),(j=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=j}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(wu={focusedElem:e,selectionRange:r},Zo=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,y=x.memoizedState,b=t.stateNode,p=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:qs(t.type,g),y);b.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(w){vt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return x=V0,V0=!1,x}function al(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Ou(t,r,i)}a=a.next}while(a!==n)}}function Ic(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Du(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Tp(e){var t=e.alternate;t!==null&&(e.alternate=null,Tp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[fr],delete t[jl],delete t[Su],delete t[F2],delete t[I2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ap(e){return e.tag===5||e.tag===3||e.tag===4}function G0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ap(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function zu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=sc));else if(n!==4&&(e=e.child,e!==null))for(zu(e,t,r),e=e.sibling;e!==null;)zu(e,t,r),e=e.sibling}function Uu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Uu(e,t,r),e=e.sibling;e!==null;)Uu(e,t,r),e=e.sibling}var Bt=null,Vs=!1;function Qr(e,t,r){for(r=r.child;r!==null;)Rp(e,t,r),r=r.sibling}function Rp(e,t,r){if(pr&&typeof pr.onCommitFiberUnmount=="function")try{pr.onCommitFiberUnmount(Mc,r)}catch{}switch(r.tag){case 5:Xt||Ia(r,t);case 6:var n=Bt,a=Vs;Bt=null,Qr(e,t,r),Bt=n,Vs=a,Bt!==null&&(Vs?(e=Bt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Bt.removeChild(r.stateNode));break;case 18:Bt!==null&&(Vs?(e=Bt,r=r.stateNode,e.nodeType===8?Nd(e.parentNode,r):e.nodeType===1&&Nd(e,r),gl(e)):Nd(Bt,r.stateNode));break;case 4:n=Bt,a=Vs,Bt=r.stateNode.containerInfo,Vs=!0,Qr(e,t,r),Bt=n,Vs=a;break;case 0:case 11:case 14:case 15:if(!Xt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Ou(r,t,l),a=a.next}while(a!==n)}Qr(e,t,r);break;case 1:if(!Xt&&(Ia(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){vt(r,t,o)}Qr(e,t,r);break;case 21:Qr(e,t,r);break;case 22:r.mode&1?(Xt=(n=Xt)||r.memoizedState!==null,Qr(e,t,r),Xt=n):Qr(e,t,r);break;default:Qr(e,t,r)}}function Y0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Z2),t.forEach(function(n){var a=cj.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Bs(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Bt=o.stateNode,Vs=!1;break e;case 3:Bt=o.stateNode.containerInfo,Vs=!0;break e;case 4:Bt=o.stateNode.containerInfo,Vs=!0;break e}o=o.return}if(Bt===null)throw Error(te(160));Rp(i,l,a),Bt=null,Vs=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){vt(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Pp(t,e),t=t.sibling}function Pp(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bs(t,e),lr(e),n&4){try{al(3,e,e.return),Ic(3,e)}catch(g){vt(e,e.return,g)}try{al(5,e,e.return)}catch(g){vt(e,e.return,g)}}break;case 1:Bs(t,e),lr(e),n&512&&r!==null&&Ia(r,r.return);break;case 5:if(Bs(t,e),lr(e),n&512&&r!==null&&Ia(r,r.return),e.flags&32){var a=e.stateNode;try{ml(a,"")}catch(g){vt(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&tg(a,i),uu(o,l);var d=uu(o,i);for(l=0;l<c.length;l+=2){var m=c[l],h=c[l+1];m==="style"?ig(a,h):m==="dangerouslySetInnerHTML"?ng(a,h):m==="children"?ml(a,h):Pm(a,m,h,d)}switch(o){case"input":iu(a,i);break;case"textarea":sg(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var j=i.value;j!=null?Da(a,!!i.multiple,j,!1):f!==!!i.multiple&&(i.defaultValue!=null?Da(a,!!i.multiple,i.defaultValue,!0):Da(a,!!i.multiple,i.multiple?[]:"",!1))}a[jl]=i}catch(g){vt(e,e.return,g)}}break;case 6:if(Bs(t,e),lr(e),n&4){if(e.stateNode===null)throw Error(te(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){vt(e,e.return,g)}}break;case 3:if(Bs(t,e),lr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{gl(t.containerInfo)}catch(g){vt(e,e.return,g)}break;case 4:Bs(t,e),lr(e);break;case 13:Bs(t,e),lr(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(mh=jt())),n&4&&Y0(e);break;case 22:if(m=r!==null&&r.memoizedState!==null,e.mode&1?(Xt=(d=Xt)||m,Bs(t,e),Xt=d):Bs(t,e),lr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!m&&e.mode&1)for(xe=e,m=e.child;m!==null;){for(h=xe=m;xe!==null;){switch(f=xe,j=f.child,f.tag){case 0:case 11:case 14:case 15:al(4,f,f.return);break;case 1:Ia(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){vt(n,r,g)}}break;case 5:Ia(f,f.return);break;case 22:if(f.memoizedState!==null){X0(h);continue}}j!==null?(j.return=f,xe=j):X0(h)}m=m.sibling}e:for(m=null,h=e;;){if(h.tag===5){if(m===null){m=h;try{a=h.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,c=h.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=ag("display",l))}catch(g){vt(e,e.return,g)}}}else if(h.tag===6){if(m===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){vt(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;m===h&&(m=null),h=h.return}m===h&&(m=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Bs(t,e),lr(e),n&4&&Y0(e);break;case 21:break;default:Bs(t,e),lr(e)}}function lr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ap(r)){var n=r;break e}r=r.return}throw Error(te(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ml(a,""),n.flags&=-33);var i=G0(e);Uu(e,i,a);break;case 3:case 4:var l=n.stateNode.containerInfo,o=G0(e);zu(e,o,l);break;default:throw Error(te(161))}}catch(c){vt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tj(e,t,r){xe=e,$p(e)}function $p(e,t,r){for(var n=(e.mode&1)!==0;xe!==null;){var a=xe,i=a.child;if(a.tag===22&&n){var l=a.memoizedState!==null||po;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Xt;o=po;var d=Xt;if(po=l,(Xt=c)&&!d)for(xe=a;xe!==null;)l=xe,c=l.child,l.tag===22&&l.memoizedState!==null?Z0(a):c!==null?(c.return=l,xe=c):Z0(a);for(;i!==null;)xe=i,$p(i),i=i.sibling;xe=a,po=o,Xt=d}J0(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,xe=i):J0(e)}}function J0(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xt||Ic(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Xt)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:qs(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&L0(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}L0(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var h=m.dehydrated;h!==null&&gl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Xt||t.flags&512&&Du(t)}catch(f){vt(t,t.return,f)}}if(t===e){xe=null;break}if(r=t.sibling,r!==null){r.return=t.return,xe=r;break}xe=t.return}}function X0(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,xe=r;break}xe=t.return}}function Z0(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ic(4,t)}catch(c){vt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){vt(t,a,c)}}var i=t.return;try{Du(t)}catch(c){vt(t,i,c)}break;case 5:var l=t.return;try{Du(t)}catch(c){vt(t,l,c)}}}catch(c){vt(t,t.return,c)}if(t===e){xe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,xe=o;break}xe=t.return}}var sj=Math.ceil,hc=qr.ReactCurrentDispatcher,dh=qr.ReactCurrentOwner,Ds=qr.ReactCurrentBatchConfig,Je=0,zt=null,Ct=null,Kt=0,Cs=0,Oa=Pn(0),Rt=0,_l=null,ma=0,Oc=0,uh=0,il=null,gs=null,mh=0,di=1/0,Sr=null,xc=!1,Hu=null,kn=null,yo=!1,fn=null,fc=0,ll=0,Bu=null,Oo=-1,Do=0;function os(){return Je&6?jt():Oo!==-1?Oo:Oo=jt()}function Sn(e){return e.mode&1?Je&2&&Kt!==0?Kt&-Kt:D2.transition!==null?(Do===0&&(Do=yg()),Do):(e=nt,e!==0||(e=window.event,e=e===void 0?16:Sg(e.type)),e):1}function Zs(e,t,r,n){if(50<ll)throw ll=0,Bu=null,Error(te(185));Dl(e,r,n),(!(Je&2)||e!==zt)&&(e===zt&&(!(Je&2)&&(Oc|=r),Rt===4&&sn(e,Kt)),js(e,n),r===1&&Je===0&&!(t.mode&1)&&(di=jt()+500,$c&&$n()))}function js(e,t){var r=e.callbackNode;Dv(e,t);var n=Xo(e,e===zt?Kt:0);if(n===0)r!==null&&o0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&o0(r),t===1)e.tag===0?O2(ex.bind(null,e)):qg(ex.bind(null,e)),$2(function(){!(Je&6)&&$n()}),r=null;else{switch(bg(n)){case 1:r=Om;break;case 4:r=gg;break;case 16:r=Jo;break;case 536870912:r=pg;break;default:r=Jo}r=Hp(r,Lp.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Lp(e,t){if(Oo=-1,Do=0,Je&6)throw Error(te(327));var r=e.callbackNode;if(qa()&&e.callbackNode!==r)return null;var n=Xo(e,e===zt?Kt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=gc(e,n);else{t=n;var a=Je;Je|=2;var i=Ip();(zt!==e||Kt!==t)&&(Sr=null,di=jt()+500,aa(e,t));do try{aj();break}catch(o){Fp(e,o)}while(!0);Jm(),hc.current=i,Je=a,Ct!==null?t=0:(zt=null,Kt=0,t=Rt)}if(t!==0){if(t===2&&(a=gu(e),a!==0&&(n=a,t=qu(e,a))),t===1)throw r=_l,aa(e,0),sn(e,n),js(e,jt()),r;if(t===6)sn(e,n);else{if(a=e.current.alternate,!(n&30)&&!rj(a)&&(t=gc(e,n),t===2&&(i=gu(e),i!==0&&(n=i,t=qu(e,i))),t===1))throw r=_l,aa(e,0),sn(e,n),js(e,jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(te(345));case 2:Bn(e,gs,Sr);break;case 3:if(sn(e,n),(n&130023424)===n&&(t=mh+500-jt(),10<t)){if(Xo(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){os(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ku(Bn.bind(null,e,gs,Sr),t);break}Bn(e,gs,Sr);break;case 4:if(sn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var l=31-Xs(n);i=1<<l,l=t[l],l>a&&(a=l),n&=~i}if(n=a,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*sj(n/1960))-n,10<n){e.timeoutHandle=ku(Bn.bind(null,e,gs,Sr),n);break}Bn(e,gs,Sr);break;case 5:Bn(e,gs,Sr);break;default:throw Error(te(329))}}}return js(e,jt()),e.callbackNode===r?Lp.bind(null,e):null}function qu(e,t){var r=il;return e.current.memoizedState.isDehydrated&&(aa(e,t).flags|=256),e=gc(e,t),e!==2&&(t=gs,gs=r,t!==null&&Wu(t)),e}function Wu(e){gs===null?gs=e:gs.push.apply(gs,e)}function rj(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!tr(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sn(e,t){for(t&=~uh,t&=~Oc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xs(t),n=1<<r;e[r]=-1,t&=~n}}function ex(e){if(Je&6)throw Error(te(327));qa();var t=Xo(e,0);if(!(t&1))return js(e,jt()),null;var r=gc(e,t);if(e.tag!==0&&r===2){var n=gu(e);n!==0&&(t=n,r=qu(e,n))}if(r===1)throw r=_l,aa(e,0),sn(e,t),js(e,jt()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Bn(e,gs,Sr),js(e,jt()),null}function hh(e,t){var r=Je;Je|=1;try{return e(t)}finally{Je=r,Je===0&&(di=jt()+500,$c&&$n())}}function ha(e){fn!==null&&fn.tag===0&&!(Je&6)&&qa();var t=Je;Je|=1;var r=Ds.transition,n=nt;try{if(Ds.transition=null,nt=1,e)return e()}finally{nt=n,Ds.transition=r,Je=t,!(Je&6)&&$n()}}function xh(){Cs=Oa.current,ut(Oa)}function aa(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,P2(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(Vm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&rc();break;case 3:oi(),ut(bs),ut(es),rh();break;case 5:sh(n);break;case 4:oi();break;case 13:ut(ft);break;case 19:ut(ft);break;case 10:Xm(n.type._context);break;case 22:case 23:xh()}r=r.return}if(zt=e,Ct=e=Cn(e.current,null),Kt=Cs=t,Rt=0,_l=null,uh=Oc=ma=0,gs=il=null,Wn!==null){for(t=0;t<Wn.length;t++)if(r=Wn[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=a,n.next=l}r.pending=n}Wn=null}return e}function Fp(e,t){do{var r=Ct;try{if(Jm(),Lo.current=mc,uc){for(var n=gt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}uc=!1}if(ua=0,It=Tt=gt=null,nl=!1,kl=0,dh.current=null,r===null||r.return===null){Rt=1,_l=t,Ct=null;break}e:{var i=e,l=r.return,o=r,c=t;if(t=Kt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,m=o,h=m.tag;if(!(m.mode&1)&&(h===0||h===11||h===15)){var f=m.alternate;f?(m.updateQueue=f.updateQueue,m.memoizedState=f.memoizedState,m.lanes=f.lanes):(m.updateQueue=null,m.memoizedState=null)}var j=U0(l);if(j!==null){j.flags&=-257,H0(j,l,o,i,t),j.mode&1&&z0(i,d,t),t=j,c=d;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){z0(i,d,t),fh();break e}c=Error(te(426))}}else if(ht&&o.mode&1){var y=U0(l);if(y!==null){!(y.flags&65536)&&(y.flags|=256),H0(y,l,o,i,t),Gm(ci(c,o));break e}}i=c=ci(c,o),Rt!==4&&(Rt=2),il===null?il=[i]:il.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var b=bp(i,c,t);$0(i,b);break e;case 1:o=c;var p=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(kn===null||!kn.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=vp(i,o,t);$0(i,w);break e}}i=i.return}while(i!==null)}Dp(r)}catch(N){t=N,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function Ip(){var e=hc.current;return hc.current=mc,e===null?mc:e}function fh(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),zt===null||!(ma&268435455)&&!(Oc&268435455)||sn(zt,Kt)}function gc(e,t){var r=Je;Je|=2;var n=Ip();(zt!==e||Kt!==t)&&(Sr=null,aa(e,t));do try{nj();break}catch(a){Fp(e,a)}while(!0);if(Jm(),Je=r,hc.current=n,Ct!==null)throw Error(te(261));return zt=null,Kt=0,Rt}function nj(){for(;Ct!==null;)Op(Ct)}function aj(){for(;Ct!==null&&!Tv();)Op(Ct)}function Op(e){var t=Up(e.alternate,e,Cs);e.memoizedProps=e.pendingProps,t===null?Dp(e):Ct=t,dh.current=null}function Dp(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=X2(r,t),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rt=6,Ct=null;return}}else if(r=J2(r,t,Cs),r!==null){Ct=r;return}if(t=t.sibling,t!==null){Ct=t;return}Ct=t=e}while(t!==null);Rt===0&&(Rt=5)}function Bn(e,t,r){var n=nt,a=Ds.transition;try{Ds.transition=null,nt=1,ij(e,t,r,n)}finally{Ds.transition=a,nt=n}return null}function ij(e,t,r,n){do qa();while(fn!==null);if(Je&6)throw Error(te(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(zv(e,i),e===zt&&(Ct=zt=null,Kt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yo||(yo=!0,Hp(Jo,function(){return qa(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Ds.transition,Ds.transition=null;var l=nt;nt=1;var o=Je;Je|=4,dh.current=null,ej(e,r),Pp(r,e),C2(wu),Zo=!!ju,wu=ju=null,e.current=r,tj(r),Av(),Je=o,nt=l,Ds.transition=i}else e.current=r;if(yo&&(yo=!1,fn=e,fc=a),i=e.pendingLanes,i===0&&(kn=null),$v(r.stateNode),js(e,jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(xc)throw xc=!1,e=Hu,Hu=null,e;return fc&1&&e.tag!==0&&qa(),i=e.pendingLanes,i&1?e===Bu?ll++:(ll=0,Bu=e):ll=0,$n(),null}function qa(){if(fn!==null){var e=bg(fc),t=Ds.transition,r=nt;try{if(Ds.transition=null,nt=16>e?16:e,fn===null)var n=!1;else{if(e=fn,fn=null,fc=0,Je&6)throw Error(te(331));var a=Je;for(Je|=4,xe=e.current;xe!==null;){var i=xe,l=i.child;if(xe.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(xe=d;xe!==null;){var m=xe;switch(m.tag){case 0:case 11:case 15:al(8,m,i)}var h=m.child;if(h!==null)h.return=m,xe=h;else for(;xe!==null;){m=xe;var f=m.sibling,j=m.return;if(Tp(m),m===d){xe=null;break}if(f!==null){f.return=j,xe=f;break}xe=j}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}xe=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,xe=l;else e:for(;xe!==null;){if(i=xe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:al(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,xe=b;break e}xe=i.return}}var p=e.current;for(xe=p;xe!==null;){l=xe;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,xe=v;else e:for(l=p;xe!==null;){if(o=xe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ic(9,o)}}catch(N){vt(o,o.return,N)}if(o===l){xe=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,xe=w;break e}xe=o.return}}if(Je=a,$n(),pr&&typeof pr.onPostCommitFiberRoot=="function")try{pr.onPostCommitFiberRoot(Mc,e)}catch{}n=!0}return n}finally{nt=r,Ds.transition=t}}return!1}function tx(e,t,r){t=ci(r,t),t=bp(e,t,1),e=Nn(e,t,1),t=os(),e!==null&&(Dl(e,1,t),js(e,t))}function vt(e,t,r){if(e.tag===3)tx(e,e,r);else for(;t!==null;){if(t.tag===3){tx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(kn===null||!kn.has(n))){e=ci(r,e),e=vp(t,e,1),t=Nn(t,e,1),e=os(),t!==null&&(Dl(t,1,e),js(t,e));break}}t=t.return}}function lj(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=os(),e.pingedLanes|=e.suspendedLanes&r,zt===e&&(Kt&r)===r&&(Rt===4||Rt===3&&(Kt&130023424)===Kt&&500>jt()-mh?aa(e,0):uh|=r),js(e,t)}function zp(e,t){t===0&&(e.mode&1?(t=lo,lo<<=1,!(lo&130023424)&&(lo=4194304)):t=1);var r=os();e=Ur(e,t),e!==null&&(Dl(e,t,r),js(e,r))}function oj(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),zp(e,r)}function cj(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(te(314))}n!==null&&n.delete(t),zp(e,r)}var Up;Up=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||bs.current)ps=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ps=!1,Y2(e,t,r);ps=!!(e.flags&131072)}else ps=!1,ht&&t.flags&1048576&&Wg(t,ic,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Io(e,t),e=t.pendingProps;var a=ai(t,es.current);Ba(t,r),a=ah(null,t,n,e,a,r);var i=ih();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,vs(n)?(i=!0,nc(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,eh(t),a.updater=Fc,t.stateNode=a,a._reactInternals=t,Au(t,n,e,r),t=$u(null,t,n,!0,i,r)):(t.tag=0,ht&&i&&Qm(t),is(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Io(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=uj(n),e=qs(n,e),a){case 0:t=Pu(null,t,n,e,r);break e;case 1:t=W0(null,t,n,e,r);break e;case 11:t=B0(null,t,n,e,r);break e;case 14:t=q0(null,t,n,qs(n.type,e),r);break e}throw Error(te(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:qs(n,a),Pu(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:qs(n,a),W0(e,t,n,a,r);case 3:e:{if(kp(t),e===null)throw Error(te(387));n=t.pendingProps,i=t.memoizedState,a=i.element,Jg(e,t),cc(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=ci(Error(te(423)),t),t=K0(e,t,n,r,a);break e}else if(n!==a){a=ci(Error(te(424)),t),t=K0(e,t,n,r,a);break e}else for(_s=wn(t.stateNode.containerInfo.firstChild),Es=t,ht=!0,Gs=null,r=Gg(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ii(),n===a){t=Hr(e,t,r);break e}is(e,t,n,r)}t=t.child}return t;case 5:return Xg(t),e===null&&Eu(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Nu(n,a)?l=null:i!==null&&Nu(n,i)&&(t.flags|=32),Np(e,t),is(e,t,l,r),t.child;case 6:return e===null&&Eu(t),null;case 13:return Sp(e,t,r);case 4:return th(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=li(t,null,n,r):is(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:qs(n,a),B0(e,t,n,a,r);case 7:return is(e,t,t.pendingProps,r),t.child;case 8:return is(e,t,t.pendingProps.children,r),t.child;case 12:return is(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,ot(lc,n._currentValue),n._currentValue=l,i!==null)if(tr(i.value,l)){if(i.children===a.children&&!bs.current){t=Hr(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Lr(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?c.next=c:(c.next=m.next,m.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Mu(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(te(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Mu(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}is(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ba(t,r),a=zs(a),n=n(a),t.flags|=1,is(e,t,n,r),t.child;case 14:return n=t.type,a=qs(n,t.pendingProps),a=qs(n.type,a),q0(e,t,n,a,r);case 15:return jp(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:qs(n,a),Io(e,t),t.tag=1,vs(n)?(e=!0,nc(t)):e=!1,Ba(t,r),yp(t,n,a),Au(t,n,a,r),$u(null,t,n,!0,e,r);case 19:return Cp(e,t,r);case 22:return wp(e,t,r)}throw Error(te(156,t.tag))};function Hp(e,t){return fg(e,t)}function dj(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Os(e,t,r,n){return new dj(e,t,r,n)}function gh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function uj(e){if(typeof e=="function")return gh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Lm)return 11;if(e===Fm)return 14}return 2}function Cn(e,t){var r=e.alternate;return r===null?(r=Os(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function zo(e,t,r,n,a,i){var l=2;if(n=e,typeof e=="function")gh(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Ea:return ia(r.children,a,i,t);case $m:l=8,a|=8;break;case tu:return e=Os(12,r,t,a|2),e.elementType=tu,e.lanes=i,e;case su:return e=Os(13,r,t,a),e.elementType=su,e.lanes=i,e;case ru:return e=Os(19,r,t,a),e.elementType=ru,e.lanes=i,e;case Xf:return Dc(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Yf:l=10;break e;case Jf:l=9;break e;case Lm:l=11;break e;case Fm:l=14;break e;case Zr:l=16,n=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=Os(l,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function ia(e,t,r,n){return e=Os(7,e,n,t),e.lanes=r,e}function Dc(e,t,r,n){return e=Os(22,e,n,t),e.elementType=Xf,e.lanes=r,e.stateNode={isHidden:!1},e}function Ad(e,t,r){return e=Os(6,e,null,t),e.lanes=r,e}function Rd(e,t,r){return t=Os(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mj(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=md(0),this.expirationTimes=md(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=md(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function ph(e,t,r,n,a,i,l,o,c){return e=new mj(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Os(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},eh(i),e}function hj(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_a,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Bp(e){if(!e)return An;e=e._reactInternals;e:{if(ya(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(vs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(vs(r))return Bg(e,r,t)}return t}function qp(e,t,r,n,a,i,l,o,c){return e=ph(r,n,!0,e,a,i,l,o,c),e.context=Bp(null),r=e.current,n=os(),a=Sn(r),i=Lr(n,a),i.callback=t??null,Nn(r,i,a),e.current.lanes=a,Dl(e,a,n),js(e,n),e}function zc(e,t,r,n){var a=t.current,i=os(),l=Sn(a);return r=Bp(r),t.context===null?t.context=r:t.pendingContext=r,t=Lr(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Nn(a,t,l),e!==null&&(Zs(e,a,l,i),$o(e,a,l)),l}function pc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function yh(e,t){sx(e,t),(e=e.alternate)&&sx(e,t)}function xj(){return null}var Wp=typeof reportError=="function"?reportError:function(e){console.error(e)};function bh(e){this._internalRoot=e}Uc.prototype.render=bh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));zc(e,t,null,null)};Uc.prototype.unmount=bh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ha(function(){zc(null,e,null,null)}),t[zr]=null}};function Uc(e){this._internalRoot=e}Uc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wg();e={blockedOn:null,target:e,priority:t};for(var r=0;r<tn.length&&t!==0&&t<tn[r].priority;r++);tn.splice(r,0,e),r===0&&kg(e)}};function vh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Hc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rx(){}function fj(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=pc(l);i.call(d)}}var l=qp(t,n,e,0,null,!1,!1,"",rx);return e._reactRootContainer=l,e[zr]=l.current,bl(e.nodeType===8?e.parentNode:e),ha(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var d=pc(c);o.call(d)}}var c=ph(e,0,!1,null,null,!1,!1,"",rx);return e._reactRootContainer=c,e[zr]=c.current,bl(e.nodeType===8?e.parentNode:e),ha(function(){zc(t,c,r,n)}),c}function Bc(e,t,r,n,a){var i=r._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var c=pc(l);o.call(c)}}zc(t,l,e,a)}else l=fj(r,t,e,a,n);return pc(l)}vg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ki(t.pendingLanes);r!==0&&(Dm(t,r|1),js(t,jt()),!(Je&6)&&(di=jt()+500,$n()))}break;case 13:ha(function(){var n=Ur(e,1);if(n!==null){var a=os();Zs(n,e,1,a)}}),yh(e,1)}};zm=function(e){if(e.tag===13){var t=Ur(e,134217728);if(t!==null){var r=os();Zs(t,e,134217728,r)}yh(e,134217728)}};jg=function(e){if(e.tag===13){var t=Sn(e),r=Ur(e,t);if(r!==null){var n=os();Zs(r,e,t,n)}yh(e,t)}};wg=function(){return nt};Ng=function(e,t){var r=nt;try{return nt=e,t()}finally{nt=r}};hu=function(e,t,r){switch(t){case"input":if(iu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Pc(n);if(!a)throw Error(te(90));eg(n),iu(n,a)}}}break;case"textarea":sg(e,r);break;case"select":t=r.value,t!=null&&Da(e,!!r.multiple,t,!1)}};cg=hh;dg=ha;var gj={usingClientEntryPoint:!1,Events:[Ul,Ra,Pc,lg,og,hh]},Fi={findFiberByHostInstance:qn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pj={bundleType:Fi.bundleType,version:Fi.version,rendererPackageName:Fi.rendererPackageName,rendererConfig:Fi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hg(e),e===null?null:e.stateNode},findFiberByHostInstance:Fi.findFiberByHostInstance||xj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{Mc=bo.inject(pj),pr=bo}catch{}}Ts.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gj;Ts.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vh(t))throw Error(te(200));return hj(e,t,null,r)};Ts.createRoot=function(e,t){if(!vh(e))throw Error(te(299));var r=!1,n="",a=Wp;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=ph(e,1,!1,null,null,r,!1,n,a),e[zr]=t.current,bl(e.nodeType===8?e.parentNode:e),new bh(t)};Ts.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=hg(t),e=e===null?null:e.stateNode,e};Ts.flushSync=function(e){return ha(e)};Ts.hydrate=function(e,t,r){if(!Hc(t))throw Error(te(200));return Bc(null,e,t,!0,r)};Ts.hydrateRoot=function(e,t,r){if(!vh(e))throw Error(te(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",l=Wp;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=qp(t,null,e,1,r??null,a,!1,i,l),e[zr]=t.current,bl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Uc(t)};Ts.render=function(e,t,r){if(!Hc(t))throw Error(te(200));return Bc(null,e,t,!1,r)};Ts.unmountComponentAtNode=function(e){if(!Hc(e))throw Error(te(40));return e._reactRootContainer?(ha(function(){Bc(null,null,e,!1,function(){e._reactRootContainer=null,e[zr]=null})}),!0):!1};Ts.unstable_batchedUpdates=hh;Ts.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Hc(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return Bc(e,t,r,!1,n)};Ts.version="18.3.1-next-f1338f8080-20240426";function Kp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kp)}catch(e){console.error(e)}}Kp(),Kf.exports=Ts;var Qp=Kf.exports,nx=Qp;Zd.createRoot=nx.createRoot,Zd.hydrateRoot=nx.hydrateRoot;var ji=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},yj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},nn,Cm,Nf,bj=(Nf=class{constructor(){Se(this,nn,yj);Se(this,Cm,!1)}setTimeoutProvider(e){ce(this,nn,e)}setTimeout(e,t){return C(this,nn).setTimeout(e,t)}clearTimeout(e){C(this,nn).clearTimeout(e)}setInterval(e,t){return C(this,nn).setInterval(e,t)}clearInterval(e){C(this,nn).clearInterval(e)}},nn=new WeakMap,Cm=new WeakMap,Nf),Qn=new bj;function vj(e){setTimeout(e,0)}var xa=typeof window>"u"||"Deno"in globalThis;function ls(){}function jj(e,t){return typeof e=="function"?e(t):e}function Ku(e){return typeof e=="number"&&e>=0&&e!==1/0}function Vp(e,t){return Math.max(e+(t||0)-Date.now(),0)}function _n(e,t){return typeof e=="function"?e(t):e}function Ls(e,t){return typeof e=="function"?e(t):e}function ax(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==jh(l,t.options))return!1}else if(!El(t.queryKey,l))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||i&&!i(t))}function ix(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(fa(t.options.mutationKey)!==fa(i))return!1}else if(!El(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function jh(e,t){return((t==null?void 0:t.queryKeyHashFn)||fa)(e)}function fa(e){return JSON.stringify(e,(t,r)=>Qu(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function El(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>El(e[r],t[r])):!1}var wj=Object.prototype.hasOwnProperty;function Gp(e,t){if(e===t)return e;const r=lx(e)&&lx(t);if(!r&&!(Qu(e)&&Qu(t)))return t;const a=(r?e:Object.keys(e)).length,i=r?t:Object.keys(t),l=i.length,o=r?new Array(l):{};let c=0;for(let d=0;d<l;d++){const m=r?d:i[d],h=e[m],f=t[m];if(h===f){o[m]=h,(r?d<a:wj.call(e,m))&&c++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){o[m]=f;continue}const j=Gp(h,f);o[m]=j,j===h&&c++}return a===l&&c===a?e:o}function yc(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function lx(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Qu(e){if(!ox(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!ox(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ox(e){return Object.prototype.toString.call(e)==="[object Object]"}function Nj(e){return new Promise(t=>{Qn.setTimeout(t,e)})}function Vu(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Gp(e,t):t}function kj(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function Sj(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var wh=Symbol();function Yp(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===wh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Jp(e,t){return typeof e=="function"?e(...t):!!e}var Yn,an,Wa,kf,Cj=(kf=class extends ji{constructor(){super();Se(this,Yn);Se(this,an);Se(this,Wa);ce(this,Wa,t=>{if(!xa&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){C(this,an)||this.setEventListener(C(this,Wa))}onUnsubscribe(){var t;this.hasListeners()||((t=C(this,an))==null||t.call(this),ce(this,an,void 0))}setEventListener(t){var r;ce(this,Wa,t),(r=C(this,an))==null||r.call(this),ce(this,an,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){C(this,Yn)!==t&&(ce(this,Yn,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof C(this,Yn)=="boolean"?C(this,Yn):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Yn=new WeakMap,an=new WeakMap,Wa=new WeakMap,kf),Nh=new Cj;function Gu(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}var _j=vj;function Ej(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=_j;const i=o=>{t?e.push(o):a(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var At=Ej(),Ka,ln,Qa,Sf,Mj=(Sf=class extends ji{constructor(){super();Se(this,Ka,!0);Se(this,ln);Se(this,Qa);ce(this,Qa,t=>{if(!xa&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){C(this,ln)||this.setEventListener(C(this,Qa))}onUnsubscribe(){var t;this.hasListeners()||((t=C(this,ln))==null||t.call(this),ce(this,ln,void 0))}setEventListener(t){var r;ce(this,Qa,t),(r=C(this,ln))==null||r.call(this),ce(this,ln,t(this.setOnline.bind(this)))}setOnline(t){C(this,Ka)!==t&&(ce(this,Ka,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return C(this,Ka)}},Ka=new WeakMap,ln=new WeakMap,Qa=new WeakMap,Sf),bc=new Mj;function Tj(e){return Math.min(1e3*2**e,3e4)}function Xp(e){return(e??"online")==="online"?bc.isOnline():!0}var Yu=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Zp(e){let t=!1,r=0,n;const a=Gu(),i=()=>a.status!=="pending",l=g=>{var y;if(!i()){const b=new Yu(g);f(b),(y=e.onCancel)==null||y.call(e,b)}},o=()=>{t=!0},c=()=>{t=!1},d=()=>Nh.isFocused()&&(e.networkMode==="always"||bc.isOnline())&&e.canRun(),m=()=>Xp(e.networkMode)&&e.canRun(),h=g=>{i()||(n==null||n(),a.resolve(g))},f=g=>{i()||(n==null||n(),a.reject(g))},j=()=>new Promise(g=>{var y;n=b=>{(i()||d())&&g(b)},(y=e.onPause)==null||y.call(e)}).then(()=>{var g;n=void 0,i()||(g=e.onContinue)==null||g.call(e)}),x=()=>{if(i())return;let g;const y=r===0?e.initialPromise:void 0;try{g=y??e.fn()}catch(b){g=Promise.reject(b)}Promise.resolve(g).then(h).catch(b=>{var A;if(i())return;const p=e.retry??(xa?0:3),v=e.retryDelay??Tj,w=typeof v=="function"?v(r,b):v,N=p===!0||typeof p=="number"&&r<p||typeof p=="function"&&p(r,b);if(t||!N){f(b);return}r++,(A=e.onFail)==null||A.call(e,r,b),Nj(w).then(()=>d()?void 0:j()).then(()=>{t?f(b):x()})})};return{promise:a,status:()=>a.status,cancel:l,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:c,canStart:m,start:()=>(m()?x():j().then(x),a)}}var Jn,Cf,ey=(Cf=class{constructor(){Se(this,Jn)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ku(this.gcTime)&&ce(this,Jn,Qn.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(xa?1/0:5*60*1e3))}clearGcTimeout(){C(this,Jn)&&(Qn.clearTimeout(C(this,Jn)),ce(this,Jn,void 0))}},Jn=new WeakMap,Cf),Xn,Va,$s,Zn,Lt,Pl,ea,Ks,kr,_f,Aj=(_f=class extends ey{constructor(t){super();Se(this,Ks);Se(this,Xn);Se(this,Va);Se(this,$s);Se(this,Zn);Se(this,Lt);Se(this,Pl);Se(this,ea);ce(this,ea,!1),ce(this,Pl,t.defaultOptions),this.setOptions(t.options),this.observers=[],ce(this,Zn,t.client),ce(this,$s,C(this,Zn).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ce(this,Xn,dx(this.options)),this.state=t.state??C(this,Xn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=C(this,Lt))==null?void 0:t.promise}setOptions(t){if(this.options={...C(this,Pl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=dx(this.options);r.data!==void 0&&(this.setState(cx(r.data,r.dataUpdatedAt)),ce(this,Xn,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&C(this,$s).remove(this)}setData(t,r){const n=Vu(this.state.data,t,this.options);return Ue(this,Ks,kr).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Ue(this,Ks,kr).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=C(this,Lt))==null?void 0:n.promise;return(a=C(this,Lt))==null||a.cancel(t),r?r.then(ls).catch(ls):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(C(this,Xn))}isActive(){return this.observers.some(t=>Ls(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===wh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>_n(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Vp(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=C(this,Lt))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=C(this,Lt))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),C(this,$s).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(C(this,Lt)&&(C(this,ea)?C(this,Lt).cancel({revert:!0}):C(this,Lt).cancelRetry()),this.scheduleGc()),C(this,$s).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ue(this,Ks,kr).call(this,{type:"invalidate"})}async fetch(t,r){var c,d,m,h,f,j,x,g,y,b,p,v;if(this.state.fetchStatus!=="idle"&&((c=C(this,Lt))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(C(this,Lt))return C(this,Lt).continueRetry(),C(this,Lt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(N=>N.options.queryFn);w&&this.setOptions(w.options)}const n=new AbortController,a=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(ce(this,ea,!0),n.signal)})},i=()=>{const w=Yp(this.options,r),A=(()=>{const z={client:C(this,Zn),queryKey:this.queryKey,meta:this.meta};return a(z),z})();return ce(this,ea,!1),this.options.persister?this.options.persister(w,A,this):w(A)},o=(()=>{const w={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:C(this,Zn),state:this.state,fetchFn:i};return a(w),w})();(d=this.options.behavior)==null||d.onFetch(o,this),ce(this,Va,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=o.fetchOptions)==null?void 0:m.meta))&&Ue(this,Ks,kr).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),ce(this,Lt,Zp({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:w=>{w instanceof Yu&&w.revert&&this.setState({...C(this,Va),fetchStatus:"idle"}),n.abort()},onFail:(w,N)=>{Ue(this,Ks,kr).call(this,{type:"failed",failureCount:w,error:N})},onPause:()=>{Ue(this,Ks,kr).call(this,{type:"pause"})},onContinue:()=>{Ue(this,Ks,kr).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const w=await C(this,Lt).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(j=(f=C(this,$s).config).onSuccess)==null||j.call(f,w,this),(g=(x=C(this,$s).config).onSettled)==null||g.call(x,w,this.state.error,this),w}catch(w){if(w instanceof Yu){if(w.silent)return C(this,Lt).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw Ue(this,Ks,kr).call(this,{type:"error",error:w}),(b=(y=C(this,$s).config).onError)==null||b.call(y,w,this),(v=(p=C(this,$s).config).onSettled)==null||v.call(p,this.state.data,w,this),w}finally{this.scheduleGc()}}},Xn=new WeakMap,Va=new WeakMap,$s=new WeakMap,Zn=new WeakMap,Lt=new WeakMap,Pl=new WeakMap,ea=new WeakMap,Ks=new WeakSet,kr=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...ty(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,...cx(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ce(this,Va,t.manual?a:void 0),a;case"error":const i=t.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),At.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),C(this,$s).notify({query:this,type:"updated",action:t})})},_f);function ty(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Xp(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function cx(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function dx(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var xs,Ve,$l,ns,ta,Ga,_r,on,Ll,Ya,Ja,sa,ra,cn,Xa,tt,Vi,Ju,Xu,Zu,em,tm,sm,rm,sy,Ef,Rj=(Ef=class extends ji{constructor(t,r){super();Se(this,tt);Se(this,xs);Se(this,Ve);Se(this,$l);Se(this,ns);Se(this,ta);Se(this,Ga);Se(this,_r);Se(this,on);Se(this,Ll);Se(this,Ya);Se(this,Ja);Se(this,sa);Se(this,ra);Se(this,cn);Se(this,Xa,new Set);this.options=r,ce(this,xs,t),ce(this,on,null),ce(this,_r,Gu()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(C(this,Ve).addObserver(this),ux(C(this,Ve),this.options)?Ue(this,tt,Vi).call(this):this.updateResult(),Ue(this,tt,em).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return nm(C(this,Ve),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return nm(C(this,Ve),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ue(this,tt,tm).call(this),Ue(this,tt,sm).call(this),C(this,Ve).removeObserver(this)}setOptions(t){const r=this.options,n=C(this,Ve);if(this.options=C(this,xs).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ls(this.options.enabled,C(this,Ve))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ue(this,tt,rm).call(this),C(this,Ve).setOptions(this.options),r._defaulted&&!yc(this.options,r)&&C(this,xs).getQueryCache().notify({type:"observerOptionsUpdated",query:C(this,Ve),observer:this});const a=this.hasListeners();a&&mx(C(this,Ve),n,this.options,r)&&Ue(this,tt,Vi).call(this),this.updateResult(),a&&(C(this,Ve)!==n||Ls(this.options.enabled,C(this,Ve))!==Ls(r.enabled,C(this,Ve))||_n(this.options.staleTime,C(this,Ve))!==_n(r.staleTime,C(this,Ve)))&&Ue(this,tt,Ju).call(this);const i=Ue(this,tt,Xu).call(this);a&&(C(this,Ve)!==n||Ls(this.options.enabled,C(this,Ve))!==Ls(r.enabled,C(this,Ve))||i!==C(this,cn))&&Ue(this,tt,Zu).call(this,i)}getOptimisticResult(t){const r=C(this,xs).getQueryCache().build(C(this,xs),t),n=this.createResult(r,t);return $j(this,n)&&(ce(this,ns,n),ce(this,Ga,this.options),ce(this,ta,C(this,Ve).state)),n}getCurrentResult(){return C(this,ns)}trackResult(t,r){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&C(this,_r).status==="pending"&&C(this,_r).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(t){C(this,Xa).add(t)}getCurrentQuery(){return C(this,Ve)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=C(this,xs).defaultQueryOptions(t),n=C(this,xs).getQueryCache().build(C(this,xs),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Ue(this,tt,Vi).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),C(this,ns)))}createResult(t,r){var Z;const n=C(this,Ve),a=this.options,i=C(this,ns),l=C(this,ta),o=C(this,Ga),d=t!==n?t.state:C(this,$l),{state:m}=t;let h={...m},f=!1,j;if(r._optimisticResults){const q=this.hasListeners(),O=!q&&ux(t,r),V=q&&mx(t,n,r,a);(O||V)&&(h={...h,...ty(m.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:x,errorUpdatedAt:g,status:y}=h;j=h.data;let b=!1;if(r.placeholderData!==void 0&&j===void 0&&y==="pending"){let q;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(q=i.data,b=!0):q=typeof r.placeholderData=="function"?r.placeholderData((Z=C(this,Ja))==null?void 0:Z.state.data,C(this,Ja)):r.placeholderData,q!==void 0&&(y="success",j=Vu(i==null?void 0:i.data,q,r),f=!0)}if(r.select&&j!==void 0&&!b)if(i&&j===(l==null?void 0:l.data)&&r.select===C(this,Ll))j=C(this,Ya);else try{ce(this,Ll,r.select),j=r.select(j),j=Vu(i==null?void 0:i.data,j,r),ce(this,Ya,j),ce(this,on,null)}catch(q){ce(this,on,q)}C(this,on)&&(x=C(this,on),j=C(this,Ya),g=Date.now(),y="error");const p=h.fetchStatus==="fetching",v=y==="pending",w=y==="error",N=v&&p,A=j!==void 0,F={status:y,fetchStatus:h.fetchStatus,isPending:v,isSuccess:y==="success",isError:w,isInitialLoading:N,isLoading:N,data:j,dataUpdatedAt:h.dataUpdatedAt,error:x,errorUpdatedAt:g,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:p,isRefetching:p&&!v,isLoadingError:w&&!A,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:w&&A,isStale:kh(t,r),refetch:this.refetch,promise:C(this,_r),isEnabled:Ls(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const q=J=>{F.status==="error"?J.reject(F.error):F.data!==void 0&&J.resolve(F.data)},O=()=>{const J=ce(this,_r,F.promise=Gu());q(J)},V=C(this,_r);switch(V.status){case"pending":t.queryHash===n.queryHash&&q(V);break;case"fulfilled":(F.status==="error"||F.data!==V.value)&&O();break;case"rejected":(F.status!=="error"||F.error!==V.reason)&&O();break}}return F}updateResult(){const t=C(this,ns),r=this.createResult(C(this,Ve),this.options);if(ce(this,ta,C(this,Ve).state),ce(this,Ga,this.options),C(this,ta).data!==void 0&&ce(this,Ja,C(this,Ve)),yc(r,t))return;ce(this,ns,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!C(this,Xa).size)return!0;const l=new Set(i??C(this,Xa));return this.options.throwOnError&&l.add("error"),Object.keys(C(this,ns)).some(o=>{const c=o;return C(this,ns)[c]!==t[c]&&l.has(c)})};Ue(this,tt,sy).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ue(this,tt,em).call(this)}},xs=new WeakMap,Ve=new WeakMap,$l=new WeakMap,ns=new WeakMap,ta=new WeakMap,Ga=new WeakMap,_r=new WeakMap,on=new WeakMap,Ll=new WeakMap,Ya=new WeakMap,Ja=new WeakMap,sa=new WeakMap,ra=new WeakMap,cn=new WeakMap,Xa=new WeakMap,tt=new WeakSet,Vi=function(t){Ue(this,tt,rm).call(this);let r=C(this,Ve).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(ls)),r},Ju=function(){Ue(this,tt,tm).call(this);const t=_n(this.options.staleTime,C(this,Ve));if(xa||C(this,ns).isStale||!Ku(t))return;const n=Vp(C(this,ns).dataUpdatedAt,t)+1;ce(this,sa,Qn.setTimeout(()=>{C(this,ns).isStale||this.updateResult()},n))},Xu=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(C(this,Ve)):this.options.refetchInterval)??!1},Zu=function(t){Ue(this,tt,sm).call(this),ce(this,cn,t),!(xa||Ls(this.options.enabled,C(this,Ve))===!1||!Ku(C(this,cn))||C(this,cn)===0)&&ce(this,ra,Qn.setInterval(()=>{(this.options.refetchIntervalInBackground||Nh.isFocused())&&Ue(this,tt,Vi).call(this)},C(this,cn)))},em=function(){Ue(this,tt,Ju).call(this),Ue(this,tt,Zu).call(this,Ue(this,tt,Xu).call(this))},tm=function(){C(this,sa)&&(Qn.clearTimeout(C(this,sa)),ce(this,sa,void 0))},sm=function(){C(this,ra)&&(Qn.clearInterval(C(this,ra)),ce(this,ra,void 0))},rm=function(){const t=C(this,xs).getQueryCache().build(C(this,xs),this.options);if(t===C(this,Ve))return;const r=C(this,Ve);ce(this,Ve,t),ce(this,$l,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},sy=function(t){At.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(C(this,ns))}),C(this,xs).getQueryCache().notify({query:C(this,Ve),type:"observerResultsUpdated"})})},Ef);function Pj(e,t){return Ls(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function ux(e,t){return Pj(e,t)||e.state.data!==void 0&&nm(e,t,t.refetchOnMount)}function nm(e,t,r){if(Ls(t.enabled,e)!==!1&&_n(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&kh(e,t)}return!1}function mx(e,t,r,n){return(e!==t||Ls(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&kh(e,r)}function kh(e,t){return Ls(t.enabled,e)!==!1&&e.isStaleByTime(_n(t.staleTime,e))}function $j(e,t){return!yc(e.getCurrentResult(),t)}function hx(e){return{onFetch:(t,r)=>{var m,h,f,j,x;const n=t.options,a=(f=(h=(m=t.fetchOptions)==null?void 0:m.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((j=t.state.data)==null?void 0:j.pages)||[],l=((x=t.state.data)==null?void 0:x.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const d=async()=>{let g=!1;const y=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},b=Yp(t.options,t.fetchOptions),p=async(v,w,N)=>{if(g)return Promise.reject();if(w==null&&v.pages.length)return Promise.resolve(v);const z=(()=>{const O={client:t.client,queryKey:t.queryKey,pageParam:w,direction:N?"backward":"forward",meta:t.options.meta};return y(O),O})(),F=await b(z),{maxPages:Z}=t.options,q=N?Sj:kj;return{pages:q(v.pages,F,Z),pageParams:q(v.pageParams,w,Z)}};if(a&&i.length){const v=a==="backward",w=v?Lj:xx,N={pages:i,pageParams:l},A=w(n,N);o=await p(N,A,v)}else{const v=e??i.length;do{const w=c===0?l[0]??n.initialPageParam:xx(n,o);if(c>0&&w==null)break;o=await p(o,w),c++}while(c<v)}return o};t.options.persister?t.fetchFn=()=>{var g,y;return(y=(g=t.options).persister)==null?void 0:y.call(g,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function xx(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Lj(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Fl,mr,as,na,hr,Xr,Mf,Fj=(Mf=class extends ey{constructor(t){super();Se(this,hr);Se(this,Fl);Se(this,mr);Se(this,as);Se(this,na);ce(this,Fl,t.client),this.mutationId=t.mutationId,ce(this,as,t.mutationCache),ce(this,mr,[]),this.state=t.state||ry(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){C(this,mr).includes(t)||(C(this,mr).push(t),this.clearGcTimeout(),C(this,as).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ce(this,mr,C(this,mr).filter(r=>r!==t)),this.scheduleGc(),C(this,as).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){C(this,mr).length||(this.state.status==="pending"?this.scheduleGc():C(this,as).remove(this))}continue(){var t;return((t=C(this,na))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,c,d,m,h,f,j,x,g,y,b,p,v,w,N,A,z,F,Z;const r=()=>{Ue(this,hr,Xr).call(this,{type:"continue"})},n={client:C(this,Fl),meta:this.options.meta,mutationKey:this.options.mutationKey};ce(this,na,Zp({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(q,O)=>{Ue(this,hr,Xr).call(this,{type:"failed",failureCount:q,error:O})},onPause:()=>{Ue(this,hr,Xr).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>C(this,as).canRun(this)}));const a=this.state.status==="pending",i=!C(this,na).canStart();try{if(a)r();else{Ue(this,hr,Xr).call(this,{type:"pending",variables:t,isPaused:i}),await((o=(l=C(this,as).config).onMutate)==null?void 0:o.call(l,t,this,n));const O=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,n));O!==this.state.context&&Ue(this,hr,Xr).call(this,{type:"pending",context:O,variables:t,isPaused:i})}const q=await C(this,na).start();return await((h=(m=C(this,as).config).onSuccess)==null?void 0:h.call(m,q,t,this.state.context,this,n)),await((j=(f=this.options).onSuccess)==null?void 0:j.call(f,q,t,this.state.context,n)),await((g=(x=C(this,as).config).onSettled)==null?void 0:g.call(x,q,null,this.state.variables,this.state.context,this,n)),await((b=(y=this.options).onSettled)==null?void 0:b.call(y,q,null,t,this.state.context,n)),Ue(this,hr,Xr).call(this,{type:"success",data:q}),q}catch(q){try{throw await((v=(p=C(this,as).config).onError)==null?void 0:v.call(p,q,t,this.state.context,this,n)),await((N=(w=this.options).onError)==null?void 0:N.call(w,q,t,this.state.context,n)),await((z=(A=C(this,as).config).onSettled)==null?void 0:z.call(A,void 0,q,this.state.variables,this.state.context,this,n)),await((Z=(F=this.options).onSettled)==null?void 0:Z.call(F,void 0,q,t,this.state.context,n)),q}finally{Ue(this,hr,Xr).call(this,{type:"error",error:q})}}finally{C(this,as).runNext(this)}}},Fl=new WeakMap,mr=new WeakMap,as=new WeakMap,na=new WeakMap,hr=new WeakSet,Xr=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),At.batch(()=>{C(this,mr).forEach(n=>{n.onMutationUpdate(t)}),C(this,as).notify({mutation:this,type:"updated",action:t})})},Mf);function ry(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Er,Qs,Il,Tf,Ij=(Tf=class extends ji{constructor(t={}){super();Se(this,Er);Se(this,Qs);Se(this,Il);this.config=t,ce(this,Er,new Set),ce(this,Qs,new Map),ce(this,Il,0)}build(t,r,n){const a=new Fj({client:t,mutationCache:this,mutationId:++to(this,Il)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){C(this,Er).add(t);const r=vo(t);if(typeof r=="string"){const n=C(this,Qs).get(r);n?n.push(t):C(this,Qs).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(C(this,Er).delete(t)){const r=vo(t);if(typeof r=="string"){const n=C(this,Qs).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&C(this,Qs).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=vo(t);if(typeof r=="string"){const n=C(this,Qs).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=vo(t);if(typeof r=="string"){const a=(n=C(this,Qs).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){At.batch(()=>{C(this,Er).forEach(t=>{this.notify({type:"removed",mutation:t})}),C(this,Er).clear(),C(this,Qs).clear()})}getAll(){return Array.from(C(this,Er))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>ix(r,n))}findAll(t={}){return this.getAll().filter(r=>ix(t,r))}notify(t){At.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return At.batch(()=>Promise.all(t.map(r=>r.continue().catch(ls))))}},Er=new WeakMap,Qs=new WeakMap,Il=new WeakMap,Tf);function vo(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Mr,dn,fs,Tr,Or,Uo,am,Af,Oj=(Af=class extends ji{constructor(r,n){super();Se(this,Or);Se(this,Mr);Se(this,dn);Se(this,fs);Se(this,Tr);ce(this,Mr,r),this.setOptions(n),this.bindMethods(),Ue(this,Or,Uo).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=C(this,Mr).defaultMutationOptions(r),yc(this.options,n)||C(this,Mr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:C(this,fs),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&fa(n.mutationKey)!==fa(this.options.mutationKey)?this.reset():((a=C(this,fs))==null?void 0:a.state.status)==="pending"&&C(this,fs).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=C(this,fs))==null||r.removeObserver(this)}onMutationUpdate(r){Ue(this,Or,Uo).call(this),Ue(this,Or,am).call(this,r)}getCurrentResult(){return C(this,dn)}reset(){var r;(r=C(this,fs))==null||r.removeObserver(this),ce(this,fs,void 0),Ue(this,Or,Uo).call(this),Ue(this,Or,am).call(this)}mutate(r,n){var a;return ce(this,Tr,n),(a=C(this,fs))==null||a.removeObserver(this),ce(this,fs,C(this,Mr).getMutationCache().build(C(this,Mr),this.options)),C(this,fs).addObserver(this),C(this,fs).execute(r)}},Mr=new WeakMap,dn=new WeakMap,fs=new WeakMap,Tr=new WeakMap,Or=new WeakSet,Uo=function(){var n;const r=((n=C(this,fs))==null?void 0:n.state)??ry();ce(this,dn,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},am=function(r){At.batch(()=>{var n,a,i,l,o,c,d,m;if(C(this,Tr)&&this.hasListeners()){const h=C(this,dn).variables,f=C(this,dn).context,j={client:C(this,Mr),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((a=(n=C(this,Tr)).onSuccess)==null||a.call(n,r.data,h,f,j),(l=(i=C(this,Tr)).onSettled)==null||l.call(i,r.data,null,h,f,j)):(r==null?void 0:r.type)==="error"&&((c=(o=C(this,Tr)).onError)==null||c.call(o,r.error,h,f,j),(m=(d=C(this,Tr)).onSettled)==null||m.call(d,void 0,r.error,h,f,j))}this.listeners.forEach(h=>{h(C(this,dn))})})},Af),xr,Rf,Dj=(Rf=class extends ji{constructor(t={}){super();Se(this,xr);this.config=t,ce(this,xr,new Map)}build(t,r,n){const a=r.queryKey,i=r.queryHash??jh(a,r);let l=this.get(i);return l||(l=new Aj({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(l)),l}add(t){C(this,xr).has(t.queryHash)||(C(this,xr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=C(this,xr).get(t.queryHash);r&&(t.destroy(),r===t&&C(this,xr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){At.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return C(this,xr).get(t)}getAll(){return[...C(this,xr).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>ax(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>ax(t,n)):r}notify(t){At.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){At.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){At.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},xr=new WeakMap,Rf),bt,un,mn,Za,ei,hn,ti,si,Pf,zj=(Pf=class{constructor(e={}){Se(this,bt);Se(this,un);Se(this,mn);Se(this,Za);Se(this,ei);Se(this,hn);Se(this,ti);Se(this,si);ce(this,bt,e.queryCache||new Dj),ce(this,un,e.mutationCache||new Ij),ce(this,mn,e.defaultOptions||{}),ce(this,Za,new Map),ce(this,ei,new Map),ce(this,hn,0)}mount(){to(this,hn)._++,C(this,hn)===1&&(ce(this,ti,Nh.subscribe(async e=>{e&&(await this.resumePausedMutations(),C(this,bt).onFocus())})),ce(this,si,bc.subscribe(async e=>{e&&(await this.resumePausedMutations(),C(this,bt).onOnline())})))}unmount(){var e,t;to(this,hn)._--,C(this,hn)===0&&((e=C(this,ti))==null||e.call(this),ce(this,ti,void 0),(t=C(this,si))==null||t.call(this),ce(this,si,void 0))}isFetching(e){return C(this,bt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return C(this,un).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=C(this,bt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=C(this,bt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(_n(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return C(this,bt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=C(this,bt).get(n.queryHash),i=a==null?void 0:a.state.data,l=jj(t,i);if(l!==void 0)return C(this,bt).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return At.batch(()=>C(this,bt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=C(this,bt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=C(this,bt);At.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=C(this,bt);return At.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=At.batch(()=>C(this,bt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(ls).catch(ls)}invalidateQueries(e,t={}){return At.batch(()=>(C(this,bt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=At.batch(()=>C(this,bt).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(ls)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(ls)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=C(this,bt).build(this,t);return r.isStaleByTime(_n(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ls).catch(ls)}fetchInfiniteQuery(e){return e.behavior=hx(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ls).catch(ls)}ensureInfiniteQueryData(e){return e.behavior=hx(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return bc.isOnline()?C(this,un).resumePausedMutations():Promise.resolve()}getQueryCache(){return C(this,bt)}getMutationCache(){return C(this,un)}getDefaultOptions(){return C(this,mn)}setDefaultOptions(e){ce(this,mn,e)}setQueryDefaults(e,t){C(this,Za).set(fa(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...C(this,Za).values()],r={};return t.forEach(n=>{El(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){C(this,ei).set(fa(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...C(this,ei).values()],r={};return t.forEach(n=>{El(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...C(this,mn).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=jh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===wh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...C(this,mn).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){C(this,bt).clear(),C(this,un).clear()}},bt=new WeakMap,un=new WeakMap,mn=new WeakMap,Za=new WeakMap,ei=new WeakMap,hn=new WeakMap,ti=new WeakMap,si=new WeakMap,Pf),ny=u.createContext(void 0),mt=e=>{const t=u.useContext(ny);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Uj=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(ny.Provider,{value:e,children:t})),ay=u.createContext(!1),Hj=()=>u.useContext(ay);ay.Provider;function Bj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var qj=u.createContext(Bj()),Wj=()=>u.useContext(qj),Kj=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Qj=e=>{u.useEffect(()=>{e.clearReset()},[e])},Vj=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||Jp(r,[e.error,n])),Gj=e=>{if(e.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Yj=(e,t)=>e.isLoading&&e.isFetching&&!t,Jj=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,fx=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Xj(e,t,r){var h,f,j,x,g;const n=Hj(),a=Wj(),i=mt(),l=i.defaultQueryOptions(e);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,l),l._optimisticResults=n?"isRestoring":"optimistic",Gj(l),Kj(l,a),Qj(a);const o=!i.getQueryCache().get(l.queryHash),[c]=u.useState(()=>new t(i,l)),d=c.getOptimisticResult(l),m=!n&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(y=>{const b=m?c.subscribe(At.batchCalls(y)):ls;return c.updateResult(),b},[c,m]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(l)},[l,c]),Jj(l,d))throw fx(l,c,a);if(Vj({result:d,errorResetBoundary:a,throwOnError:l.throwOnError,query:i.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw d.error;if((x=(j=i.getDefaultOptions().queries)==null?void 0:j._experimental_afterQuery)==null||x.call(j,l,d),l.experimental_prefetchInRender&&!xa&&Yj(d,n)){const y=o?fx(l,c,a):(g=i.getQueryCache().get(l.queryHash))==null?void 0:g.promise;y==null||y.catch(ls).finally(()=>{c.updateResult()})}return l.notifyOnChangeProps?d:c.trackResult(d)}function me(e,t){return Xj(e,Rj)}function Ce(e,t){const r=mt(),[n]=u.useState(()=>new Oj(r,e));u.useEffect(()=>{n.setOptions(e)},[n,e]);const a=u.useSyncExternalStore(u.useCallback(l=>n.subscribe(At.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=u.useCallback((l,o)=>{n.mutate(l,o).catch(ls)},[n]);if(a.error&&Jp(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ml(){return Ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ml.apply(this,arguments)}var gn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(gn||(gn={}));const gx="popstate";function Zj(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:l,hash:o}=n.location;return im("",{pathname:i,search:l,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:vc(a)}return t1(t,r,null,e)}function wt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Sh(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function e1(){return Math.random().toString(36).substr(2,8)}function px(e,t){return{usr:e.state,key:e.key,idx:t}}function im(e,t,r,n){return r===void 0&&(r=null),Ml({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?wi(t):t,{state:r,key:t&&t.key||n||e1()})}function vc(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function wi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function t1(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,l=a.history,o=gn.Pop,c=null,d=m();d==null&&(d=0,l.replaceState(Ml({},l.state,{idx:d}),""));function m(){return(l.state||{idx:null}).idx}function h(){o=gn.Pop;let y=m(),b=y==null?null:y-d;d=y,c&&c({action:o,location:g.location,delta:b})}function f(y,b){o=gn.Push;let p=im(g.location,y,b);d=m()+1;let v=px(p,d),w=g.createHref(p);try{l.pushState(v,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;a.location.assign(w)}i&&c&&c({action:o,location:g.location,delta:1})}function j(y,b){o=gn.Replace;let p=im(g.location,y,b);d=m();let v=px(p,d),w=g.createHref(p);l.replaceState(v,"",w),i&&c&&c({action:o,location:g.location,delta:0})}function x(y){let b=a.location.origin!=="null"?a.location.origin:a.location.href,p=typeof y=="string"?y:vc(y);return p=p.replace(/ $/,"%20"),wt(b,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,b)}let g={get action(){return o},get location(){return e(a,l)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(gx,h),c=y,()=>{a.removeEventListener(gx,h),c=null}},createHref(y){return t(a,y)},createURL:x,encodeLocation(y){let b=x(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:j,go(y){return l.go(y)}};return g}var yx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(yx||(yx={}));function s1(e,t,r){return r===void 0&&(r="/"),r1(e,t,r)}function r1(e,t,r,n){let a=typeof t=="string"?wi(t):t,i=Ch(a.pathname||"/",r);if(i==null)return null;let l=iy(e);n1(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=g1(i);o=h1(l[c],d)}return o}function iy(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(wt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=En([n,c.relativePath]),m=r.concat(c);i.children&&i.children.length>0&&(wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),iy(i.children,t,m,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:u1(d,i.index),routesMeta:m})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,l);else for(let c of ly(i.path))a(i,l,c)}),t}function ly(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let l=ly(n.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function n1(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:m1(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const a1=/^:[\w-]+$/,i1=3,l1=2,o1=1,c1=10,d1=-2,bx=e=>e==="*";function u1(e,t){let r=e.split("/"),n=r.length;return r.some(bx)&&(n+=d1),t&&(n+=l1),r.filter(a=>!bx(a)).reduce((a,i)=>a+(a1.test(i)?i1:i===""?o1:c1),n)}function m1(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function h1(e,t,r){let{routesMeta:n}=e,a={},i="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,m=i==="/"?t:t.slice(i.length)||"/",h=x1({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},m),f=c.route;if(!h)return null;Object.assign(a,h.params),l.push({params:a,pathname:En([i,h.pathname]),pathnameBase:j1(En([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=En([i,h.pathnameBase]))}return l}function x1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=f1(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((d,m,h)=>{let{paramName:f,isOptional:j}=m;if(f==="*"){let g=o[h]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[h];return j&&!x?d[f]=void 0:d[f]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function f1(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Sh(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function g1(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Sh(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Ch(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const p1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,y1=e=>p1.test(e);function b1(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?wi(e):e,i;if(r)if(y1(r))i=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),Sh(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?i=vx(r.substring(1),"/"):i=vx(r,t)}else i=t;return{pathname:i,search:w1(n),hash:N1(a)}}function vx(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Pd(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function v1(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function _h(e,t){let r=v1(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Eh(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=wi(e):(a=Ml({},e),wt(!a.pathname||!a.pathname.includes("?"),Pd("?","pathname","search",a)),wt(!a.pathname||!a.pathname.includes("#"),Pd("#","pathname","hash",a)),wt(!a.search||!a.search.includes("#"),Pd("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;a.pathname=f.join("/")}o=h>=0?t[h]:"/"}let c=b1(a,o),d=l&&l!=="/"&&l.endsWith("/"),m=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||m)&&(c.pathname+="/"),c}const En=e=>e.join("/").replace(/\/\/+/g,"/"),j1=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),w1=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,N1=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function k1(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const oy=["post","put","patch","delete"];new Set(oy);const S1=["get",...oy];new Set(S1);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tl(){return Tl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tl.apply(this,arguments)}const Mh=u.createContext(null),C1=u.createContext(null),Ln=u.createContext(null),qc=u.createContext(null),vr=u.createContext({outlet:null,matches:[],isDataRoute:!1}),cy=u.createContext(null);function _1(e,t){let{relative:r}=t===void 0?{}:t;Ni()||wt(!1);let{basename:n,navigator:a}=u.useContext(Ln),{hash:i,pathname:l,search:o}=my(e,{relative:r}),c=l;return n!=="/"&&(c=l==="/"?n:En([n,l])),a.createHref({pathname:c,search:o,hash:i})}function Ni(){return u.useContext(qc)!=null}function Fn(){return Ni()||wt(!1),u.useContext(qc).location}function dy(e){u.useContext(Ln).static||u.useLayoutEffect(e)}function jr(){let{isDataRoute:e}=u.useContext(vr);return e?H1():E1()}function E1(){Ni()||wt(!1);let e=u.useContext(Mh),{basename:t,future:r,navigator:n}=u.useContext(Ln),{matches:a}=u.useContext(vr),{pathname:i}=Fn(),l=JSON.stringify(_h(a,r.v7_relativeSplatPath)),o=u.useRef(!1);return dy(()=>{o.current=!0}),u.useCallback(function(d,m){if(m===void 0&&(m={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let h=Eh(d,JSON.parse(l),i,m.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:En([t,h.pathname])),(m.replace?n.replace:n.push)(h,m.state,m)},[t,n,l,i,e])}const M1=u.createContext(null);function T1(e){let t=u.useContext(vr).outlet;return t&&u.createElement(M1.Provider,{value:e},t)}function uy(){let{matches:e}=u.useContext(vr),t=e[e.length-1];return t?t.params:{}}function my(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=u.useContext(Ln),{matches:a}=u.useContext(vr),{pathname:i}=Fn(),l=JSON.stringify(_h(a,n.v7_relativeSplatPath));return u.useMemo(()=>Eh(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function A1(e,t){return R1(e,t)}function R1(e,t,r,n){Ni()||wt(!1);let{navigator:a}=u.useContext(Ln),{matches:i}=u.useContext(vr),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=Fn(),m;if(t){var h;let y=typeof t=="string"?wi(t):t;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||wt(!1),m=y}else m=d;let f=m.pathname||"/",j=f;if(c!=="/"){let y=c.replace(/^\//,"").split("/");j="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let x=s1(e,{pathname:j}),g=I1(x&&x.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:En([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:En([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return t&&g?u.createElement(qc.Provider,{value:{location:Tl({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:gn.Pop}},g):g}function P1(){let e=U1(),t=k1(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},t),r?u.createElement("pre",{style:a},r):null,null)}const $1=u.createElement(P1,null);class L1 extends u.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?u.createElement(vr.Provider,{value:this.props.routeContext},u.createElement(cy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function F1(e){let{routeContext:t,match:r,children:n}=e,a=u.useContext(Mh);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),u.createElement(vr.Provider,{value:t},n)}function I1(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let m=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);m>=0||wt(!1),l=l.slice(0,Math.min(l.length,m+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let m=0;m<l.length;m++){let h=l[m];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=m),h.route.id){let{loaderData:f,errors:j}=r,x=h.route.loader&&f[h.route.id]===void 0&&(!j||j[h.route.id]===void 0);if(h.route.lazy||x){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((m,h,f)=>{let j,x=!1,g=null,y=null;r&&(j=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||$1,c&&(d<0&&f===0?(B1("route-fallback"),x=!0,y=null):d===f&&(x=!0,y=h.route.hydrateFallbackElement||null)));let b=t.concat(l.slice(0,f+1)),p=()=>{let v;return j?v=g:x?v=y:h.route.Component?v=u.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=m,u.createElement(F1,{match:h,routeContext:{outlet:m,matches:b,isDataRoute:r!=null},children:v})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?u.createElement(L1,{location:r.location,revalidation:r.revalidation,component:g,error:j,children:p(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):p()},null)}var hy=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(hy||{}),xy=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(xy||{});function O1(e){let t=u.useContext(Mh);return t||wt(!1),t}function D1(e){let t=u.useContext(C1);return t||wt(!1),t}function z1(e){let t=u.useContext(vr);return t||wt(!1),t}function fy(e){let t=z1(),r=t.matches[t.matches.length-1];return r.route.id||wt(!1),r.route.id}function U1(){var e;let t=u.useContext(cy),r=D1(),n=fy();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function H1(){let{router:e}=O1(hy.UseNavigateStable),t=fy(xy.UseNavigateStable),r=u.useRef(!1);return dy(()=>{r.current=!0}),u.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Tl({fromRouteId:t},i)))},[e,t])}const jx={};function B1(e,t,r){jx[e]||(jx[e]=!0)}function q1(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function gy(e){let{to:t,replace:r,state:n,relative:a}=e;Ni()||wt(!1);let{future:i,static:l}=u.useContext(Ln),{matches:o}=u.useContext(vr),{pathname:c}=Fn(),d=jr(),m=Eh(t,_h(o,i.v7_relativeSplatPath),c,a==="path"),h=JSON.stringify(m);return u.useEffect(()=>d(JSON.parse(h),{replace:r,state:n,relative:a}),[d,h,a,r,n]),null}function W1(e){return T1(e.context)}function Ze(e){wt(!1)}function K1(e){let{basename:t="/",children:r=null,location:n,navigationType:a=gn.Pop,navigator:i,static:l=!1,future:o}=e;Ni()&&wt(!1);let c=t.replace(/^\/*/,"/"),d=u.useMemo(()=>({basename:c,navigator:i,static:l,future:Tl({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof n=="string"&&(n=wi(n));let{pathname:m="/",search:h="",hash:f="",state:j=null,key:x="default"}=n,g=u.useMemo(()=>{let y=Ch(m,c);return y==null?null:{location:{pathname:y,search:h,hash:f,state:j,key:x},navigationType:a}},[c,m,h,f,j,x,a]);return g==null?null:u.createElement(Ln.Provider,{value:d},u.createElement(qc.Provider,{children:r,value:g}))}function Q1(e){let{children:t,location:r}=e;return A1(lm(t),r)}new Promise(()=>{});function lm(e,t){t===void 0&&(t=[]);let r=[];return u.Children.forEach(e,(n,a)=>{if(!u.isValidElement(n))return;let i=[...t,a];if(n.type===u.Fragment){r.push.apply(r,lm(n.props.children,i));return}n.type!==Ze&&wt(!1),!n.props.index||!n.props.children||wt(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=lm(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function om(){return om=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},om.apply(this,arguments)}function V1(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function G1(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Y1(e,t){return e.button===0&&(!t||t==="_self")&&!G1(e)}function cm(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function J1(e,t){let r=cm(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const X1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Z1="6";try{window.__reactRouterVersion=Z1}catch{}const ew="startTransition",wx=ri[ew];function tw(e){let{basename:t,children:r,future:n,window:a}=e,i=u.useRef();i.current==null&&(i.current=Zj({window:a,v5Compat:!0}));let l=i.current,[o,c]=u.useState({action:l.action,location:l.location}),{v7_startTransition:d}=n||{},m=u.useCallback(h=>{d&&wx?wx(()=>c(h)):c(h)},[c,d]);return u.useLayoutEffect(()=>l.listen(m),[l,m]),u.useEffect(()=>q1(n),[n]),u.createElement(K1,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const sw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ye=u.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:m,viewTransition:h}=t,f=V1(t,X1),{basename:j}=u.useContext(Ln),x,g=!1;if(typeof d=="string"&&rw.test(d)&&(x=d,sw))try{let v=new URL(window.location.href),w=d.startsWith("//")?new URL(v.protocol+d):new URL(d),N=Ch(w.pathname,j);w.origin===v.origin&&N!=null?d=N+w.search+w.hash:g=!0}catch{}let y=_1(d,{relative:a}),b=nw(d,{replace:l,state:o,target:c,preventScrollReset:m,relative:a,viewTransition:h});function p(v){n&&n(v),v.defaultPrevented||b(v)}return u.createElement("a",om({},f,{href:x||y,onClick:g||i?n:p,ref:r,target:c}))});var Nx;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Nx||(Nx={}));var kx;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(kx||(kx={}));function nw(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,c=jr(),d=Fn(),m=my(e,{relative:l});return u.useCallback(h=>{if(Y1(h,r)){h.preventDefault();let f=n!==void 0?n:vc(d)===vc(m);c(e,{replace:f,state:a,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,m,n,a,r,e,i,l,o])}function Bl(e){let t=u.useRef(cm(e)),r=u.useRef(!1),n=Fn(),a=u.useMemo(()=>J1(n.search,r.current?null:t.current),[n.search]),i=jr(),l=u.useCallback((o,c)=>{const d=cm(typeof o=="function"?o(a):o);r.current=!0,i("?"+d,c)},[i,a]);return[a,l]}const aw={},Sx=e=>{let t;const r=new Set,n=(m,h)=>{const f=typeof m=="function"?m(t):m;if(!Object.is(f,t)){const j=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),r.forEach(x=>x(t,j))}},a=()=>t,c={setState:n,getState:a,getInitialState:()=>d,subscribe:m=>(r.add(m),()=>r.delete(m)),destroy:()=>{(aw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,a,c);return c},iw=e=>e?Sx(e):Sx;var py={exports:{}},yy={},by={exports:{}},vy={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ui=u;function lw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ow=typeof Object.is=="function"?Object.is:lw,cw=ui.useState,dw=ui.useEffect,uw=ui.useLayoutEffect,mw=ui.useDebugValue;function hw(e,t){var r=t(),n=cw({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return uw(function(){a.value=r,a.getSnapshot=t,$d(a)&&i({inst:a})},[e,r,t]),dw(function(){return $d(a)&&i({inst:a}),e(function(){$d(a)&&i({inst:a})})},[e]),mw(r),r}function $d(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ow(e,r)}catch{return!0}}function xw(e,t){return t()}var fw=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xw:hw;vy.useSyncExternalStore=ui.useSyncExternalStore!==void 0?ui.useSyncExternalStore:fw;by.exports=vy;var gw=by.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wc=u,pw=gw;function yw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var bw=typeof Object.is=="function"?Object.is:yw,vw=pw.useSyncExternalStore,jw=Wc.useRef,ww=Wc.useEffect,Nw=Wc.useMemo,kw=Wc.useDebugValue;yy.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=jw(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=Nw(function(){function c(j){if(!d){if(d=!0,m=j,j=n(j),a!==void 0&&l.hasValue){var x=l.value;if(a(x,j))return h=x}return h=j}if(x=h,bw(m,j))return x;var g=n(j);return a!==void 0&&a(x,g)?(m=j,x):(m=j,h=g)}var d=!1,m,h,f=r===void 0?null:r;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,r,n,a]);var o=vw(e,i[0],i[1]);return ww(function(){l.hasValue=!0,l.value=o},[o]),kw(o),o};py.exports=yy;var Sw=py.exports;const Cw=$f(Sw),jy={},{useDebugValue:_w}=Le,{useSyncExternalStoreWithSelector:Ew}=Cw;let Cx=!1;const Mw=e=>e;function Tw(e,t=Mw,r){(jy?"production":void 0)!=="production"&&r&&!Cx&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Cx=!0);const n=Ew(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return _w(n),n}const Aw=e=>{(jy?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?iw(e):e,r=(n,a)=>Tw(t,n,a);return Object.assign(r,t),r},Rw=e=>Aw,Pw={};function $w(e,t){let r;try{r=e()}catch{return}return{getItem:a=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=r.getItem(a))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(a,i)=>r.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>r.removeItem(a)}}const Al=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return Al(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Al(n)(r)}}}},Lw=(e,t)=>(r,n,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,b)=>({...b,...y}),...t},l=!1;const o=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...y)},n,a);const m=Al(i.serialize),h=()=>{const y=i.partialize({...n()});let b;const p=m({state:y,version:i.version}).then(v=>d.setItem(i.name,v)).catch(v=>{b=v});if(b)throw b;return p},f=a.setState;a.setState=(y,b)=>{f(y,b),h()};const j=e((...y)=>{r(...y),h()},n,a);let x;const g=()=>{var y;if(!d)return;l=!1,o.forEach(p=>p(n()));const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,n()))||void 0;return Al(d.getItem.bind(d))(i.name).then(p=>{if(p)return i.deserialize(p)}).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==i.version){if(i.migrate)return i.migrate(p.state,p.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return p.state}).then(p=>{var v;return x=i.merge(p,(v=n())!=null?v:j),r(x,!0),h()}).then(()=>{b==null||b(x,void 0),l=!0,c.forEach(p=>p(x))}).catch(p=>{b==null||b(void 0,p)})};return a.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(d=y.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>l,onHydrate:y=>(o.add(y),()=>{o.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},g(),x||j},Fw=(e,t)=>(r,n,a)=>{let i={storage:$w(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...t},l=!1;const o=new Set,c=new Set;let d=i.storage;if(!d)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...g)},n,a);const m=()=>{const g=i.partialize({...n()});return d.setItem(i.name,{state:g,version:i.version})},h=a.setState;a.setState=(g,y)=>{h(g,y),m()};const f=e((...g)=>{r(...g),m()},n,a);a.getInitialState=()=>f;let j;const x=()=>{var g,y;if(!d)return;l=!1,o.forEach(p=>{var v;return p((v=n())!=null?v:f)});const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(g=n())!=null?g:f))||void 0;return Al(d.getItem.bind(d))(i.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==i.version){if(i.migrate)return[!0,i.migrate(p.state,p.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var v;const[w,N]=p;if(j=i.merge(N,(v=n())!=null?v:f),r(j,!0),w)return m()}).then(()=>{b==null||b(j,void 0),j=n(),l=!0,c.forEach(p=>p(j))}).catch(p=>{b==null||b(void 0,p)})};return a.persist={setOptions:g=>{i={...i,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>l,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||x(),j||f},Iw=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Pw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Lw(e,t)):Fw(e,t),Ow=Iw,Dw={"tickets:view":["admin","manager","customer_service"],"tickets:create":["admin","manager","customer_service"],"tickets:edit":["admin","manager","customer_service"],"tickets:delete":["admin"],"tickets:assign":["admin","manager"],"tickets:bulk_assign":["admin","manager"],"chat:view":["admin","manager","customer_service"],"chat:respond":["admin","manager","customer_service"],"chat:takeover":["admin","manager","customer_service"],"group_chat:view":["admin","manager","customer_service","general"],"group_chat:send":["admin","manager","customer_service","general"],"customers:view":["admin","manager","customer_service","general"],"customers:edit":["admin","manager","customer_service"],"staff:view":["admin","manager"],"staff:create":["admin"],"staff:edit":["admin"],"staff:delete":["admin"],"analytics:view":["admin","manager"],"settings:view":["admin"],"settings:edit":["admin"],"ai_agent:view":["admin","manager"],"ai_agent:edit":["admin"]};function zw(e,t){return e?Dw[t].includes(e):!1}const us=Rw()(Ow((e,t)=>({token:null,user:null,setAuth:(r,n)=>{const a={...n,role:n.role==="agent"?"customer_service":n.role};e({token:r,user:a})},logout:()=>e({token:null,user:null}),hasPermission:r=>{const n=t().user;return zw(n==null?void 0:n.role,r)}}),{name:"auth-storage"}));function wy(e,t){return function(){return e.apply(t,arguments)}}const{toString:Uw}=Object.prototype,{getPrototypeOf:Th}=Object,{iterator:Kc,toStringTag:Ny}=Symbol,Qc=(e=>t=>{const r=Uw.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),nr=e=>(e=e.toLowerCase(),t=>Qc(t)===e),Vc=e=>t=>typeof t===e,{isArray:ki}=Array,mi=Vc("undefined");function ql(e){return e!==null&&!mi(e)&&e.constructor!==null&&!mi(e.constructor)&&ws(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ky=nr("ArrayBuffer");function Hw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&ky(e.buffer),t}const Bw=Vc("string"),ws=Vc("function"),Sy=Vc("number"),Wl=e=>e!==null&&typeof e=="object",qw=e=>e===!0||e===!1,Ho=e=>{if(Qc(e)!=="object")return!1;const t=Th(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ny in e)&&!(Kc in e)},Ww=e=>{if(!Wl(e)||ql(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Kw=nr("Date"),Qw=nr("File"),Vw=nr("Blob"),Gw=nr("FileList"),Yw=e=>Wl(e)&&ws(e.pipe),Jw=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ws(e.append)&&((t=Qc(e))==="formdata"||t==="object"&&ws(e.toString)&&e.toString()==="[object FormData]"))},Xw=nr("URLSearchParams"),[Zw,eN,tN,sN]=["ReadableStream","Request","Response","Headers"].map(nr),rN=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Kl(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),ki(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(ql(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(n=0;n<l;n++)o=i[n],t.call(null,e[o],o,e)}}function Cy(e,t){if(ql(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Vn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_y=e=>!mi(e)&&e!==Vn;function dm(){const{caseless:e,skipUndefined:t}=_y(this)&&this||{},r={},n=(a,i)=>{const l=e&&Cy(r,i)||i;Ho(r[l])&&Ho(a)?r[l]=dm(r[l],a):Ho(a)?r[l]=dm({},a):ki(a)?r[l]=a.slice():(!t||!mi(a))&&(r[l]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&Kl(arguments[a],n);return r}const nN=(e,t,r,{allOwnKeys:n}={})=>(Kl(t,(a,i)=>{r&&ws(a)?e[i]=wy(a,r):e[i]=a},{allOwnKeys:n}),e),aN=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),iN=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},lN=(e,t,r,n)=>{let a,i,l;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)l=a[i],(!n||n(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=r!==!1&&Th(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},oN=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},cN=e=>{if(!e)return null;if(ki(e))return e;let t=e.length;if(!Sy(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},dN=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Th(Uint8Array)),uN=(e,t)=>{const n=(e&&e[Kc]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},mN=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},hN=nr("HTMLFormElement"),xN=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),_x=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),fN=nr("RegExp"),Ey=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Kl(r,(a,i)=>{let l;(l=t(a,i,e))!==!1&&(n[i]=l||a)}),Object.defineProperties(e,n)},gN=e=>{Ey(e,(t,r)=>{if(ws(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ws(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},pN=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return ki(e)?n(e):n(String(e).split(t)),r},yN=()=>{},bN=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function vN(e){return!!(e&&ws(e.append)&&e[Ny]==="FormData"&&e[Kc])}const jN=e=>{const t=new Array(10),r=(n,a)=>{if(Wl(n)){if(t.indexOf(n)>=0)return;if(ql(n))return n;if(!("toJSON"in n)){t[a]=n;const i=ki(n)?[]:{};return Kl(n,(l,o)=>{const c=r(l,a+1);!mi(c)&&(i[o]=c)}),t[a]=void 0,i}}return n};return r(e,0)},wN=nr("AsyncFunction"),NN=e=>e&&(Wl(e)||ws(e))&&ws(e.then)&&ws(e.catch),My=((e,t)=>e?setImmediate:t?((r,n)=>(Vn.addEventListener("message",({source:a,data:i})=>{a===Vn&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Vn.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ws(Vn.postMessage)),kN=typeof queueMicrotask<"u"?queueMicrotask.bind(Vn):typeof process<"u"&&process.nextTick||My,SN=e=>e!=null&&ws(e[Kc]),U={isArray:ki,isArrayBuffer:ky,isBuffer:ql,isFormData:Jw,isArrayBufferView:Hw,isString:Bw,isNumber:Sy,isBoolean:qw,isObject:Wl,isPlainObject:Ho,isEmptyObject:Ww,isReadableStream:Zw,isRequest:eN,isResponse:tN,isHeaders:sN,isUndefined:mi,isDate:Kw,isFile:Qw,isBlob:Vw,isRegExp:fN,isFunction:ws,isStream:Yw,isURLSearchParams:Xw,isTypedArray:dN,isFileList:Gw,forEach:Kl,merge:dm,extend:nN,trim:rN,stripBOM:aN,inherits:iN,toFlatObject:lN,kindOf:Qc,kindOfTest:nr,endsWith:oN,toArray:cN,forEachEntry:uN,matchAll:mN,isHTMLForm:hN,hasOwnProperty:_x,hasOwnProp:_x,reduceDescriptors:Ey,freezeMethods:gN,toObjectSet:pN,toCamelCase:xN,noop:yN,toFiniteNumber:bN,findKey:Cy,global:Vn,isContextDefined:_y,isSpecCompliantForm:vN,toJSONObject:jN,isAsyncFn:wN,isThenable:NN,setImmediate:My,asap:kN,isIterable:SN};function Oe(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}U.inherits(Oe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:U.toJSONObject(this.config),code:this.code,status:this.status}}});const Ty=Oe.prototype,Ay={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ay[e]={value:e}});Object.defineProperties(Oe,Ay);Object.defineProperty(Ty,"isAxiosError",{value:!0});Oe.from=(e,t,r,n,a,i)=>{const l=Object.create(Ty);U.toFlatObject(e,l,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Oe.call(l,o,c,r,n,a),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const CN=null;function um(e){return U.isPlainObject(e)||U.isArray(e)}function Ry(e){return U.endsWith(e,"[]")?e.slice(0,-2):e}function Ex(e,t,r){return e?e.concat(t).map(function(a,i){return a=Ry(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function _N(e){return U.isArray(e)&&!e.some(um)}const EN=U.toFlatObject(U,{},null,function(t){return/^is[A-Z]/.test(t)});function Gc(e,t,r){if(!U.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=U.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!U.isUndefined(y[g])});const n=r.metaTokens,a=r.visitor||m,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&U.isSpecCompliantForm(t);if(!U.isFunction(a))throw new TypeError("visitor must be a function");function d(x){if(x===null)return"";if(U.isDate(x))return x.toISOString();if(U.isBoolean(x))return x.toString();if(!c&&U.isBlob(x))throw new Oe("Blob is not supported. Use a Buffer instead.");return U.isArrayBuffer(x)||U.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function m(x,g,y){let b=x;if(x&&!y&&typeof x=="object"){if(U.endsWith(g,"{}"))g=n?g:g.slice(0,-2),x=JSON.stringify(x);else if(U.isArray(x)&&_N(x)||(U.isFileList(x)||U.endsWith(g,"[]"))&&(b=U.toArray(x)))return g=Ry(g),b.forEach(function(v,w){!(U.isUndefined(v)||v===null)&&t.append(l===!0?Ex([g],w,i):l===null?g:g+"[]",d(v))}),!1}return um(x)?!0:(t.append(Ex(y,g,i),d(x)),!1)}const h=[],f=Object.assign(EN,{defaultVisitor:m,convertValue:d,isVisitable:um});function j(x,g){if(!U.isUndefined(x)){if(h.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(x),U.forEach(x,function(b,p){(!(U.isUndefined(b)||b===null)&&a.call(t,b,U.isString(p)?p.trim():p,g,f))===!0&&j(b,g?g.concat(p):[p])}),h.pop()}}if(!U.isObject(e))throw new TypeError("data must be an object");return j(e),t}function Mx(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Ah(e,t){this._pairs=[],e&&Gc(e,this,t)}const Py=Ah.prototype;Py.append=function(t,r){this._pairs.push([t,r])};Py.toString=function(t){const r=t?function(n){return t.call(this,n,Mx)}:Mx;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function MN(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function $y(e,t,r){if(!t)return e;const n=r&&r.encode||MN;U.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=U.isURLSearchParams(t)?t.toString():new Ah(t,r).toString(n),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Tx{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){U.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Ly={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},TN=typeof URLSearchParams<"u"?URLSearchParams:Ah,AN=typeof FormData<"u"?FormData:null,RN=typeof Blob<"u"?Blob:null,PN={isBrowser:!0,classes:{URLSearchParams:TN,FormData:AN,Blob:RN},protocols:["http","https","file","blob","url","data"]},Rh=typeof window<"u"&&typeof document<"u",mm=typeof navigator=="object"&&navigator||void 0,$N=Rh&&(!mm||["ReactNative","NativeScript","NS"].indexOf(mm.product)<0),LN=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",FN=Rh&&window.location.href||"http://localhost",IN=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rh,hasStandardBrowserEnv:$N,hasStandardBrowserWebWorkerEnv:LN,navigator:mm,origin:FN},Symbol.toStringTag,{value:"Module"})),Zt={...IN,...PN};function ON(e,t){return Gc(e,new Zt.classes.URLSearchParams,{visitor:function(r,n,a,i){return Zt.isNode&&U.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function DN(e){return U.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function zN(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function Fy(e){function t(r,n,a,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&U.isArray(a)?a.length:l,c?(U.hasOwnProp(a,l)?a[l]=[a[l],n]:a[l]=n,!o):((!a[l]||!U.isObject(a[l]))&&(a[l]=[]),t(r,n,a[l],i)&&U.isArray(a[l])&&(a[l]=zN(a[l])),!o)}if(U.isFormData(e)&&U.isFunction(e.entries)){const r={};return U.forEachEntry(e,(n,a)=>{t(DN(n),a,r,0)}),r}return null}function UN(e,t,r){if(U.isString(e))try{return(t||JSON.parse)(e),U.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Ql={transitional:Ly,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=U.isObject(t);if(i&&U.isHTMLForm(t)&&(t=new FormData(t)),U.isFormData(t))return a?JSON.stringify(Fy(t)):t;if(U.isArrayBuffer(t)||U.isBuffer(t)||U.isStream(t)||U.isFile(t)||U.isBlob(t)||U.isReadableStream(t))return t;if(U.isArrayBufferView(t))return t.buffer;if(U.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return ON(t,this.formSerializer).toString();if((o=U.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Gc(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),UN(t)):t}],transformResponse:[function(t){const r=this.transitional||Ql.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(U.isResponse(t)||U.isReadableStream(t))return t;if(t&&U.isString(t)&&(n&&!this.responseType||a)){const l=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?Oe.from(o,Oe.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zt.classes.FormData,Blob:Zt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};U.forEach(["delete","get","head","post","put","patch"],e=>{Ql.headers[e]={}});const HN=U.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),BN=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),r=l.substring(0,a).trim().toLowerCase(),n=l.substring(a+1).trim(),!(!r||t[r]&&HN[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Ax=Symbol("internals");function Ii(e){return e&&String(e).trim().toLowerCase()}function Bo(e){return e===!1||e==null?e:U.isArray(e)?e.map(Bo):String(e)}function qN(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const WN=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ld(e,t,r,n,a){if(U.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!U.isString(t)){if(U.isString(n))return t.indexOf(n)!==-1;if(U.isRegExp(n))return n.test(t)}}function KN(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function QN(e,t){const r=U.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,l){return this[n].call(this,t,a,i,l)},configurable:!0})})}let Ns=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(o,c,d){const m=Ii(c);if(!m)throw new Error("header name must be a non-empty string");const h=U.findKey(a,m);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||c]=Bo(o))}const l=(o,c)=>U.forEach(o,(d,m)=>i(d,m,c));if(U.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(U.isString(t)&&(t=t.trim())&&!WN(t))l(BN(t),r);else if(U.isObject(t)&&U.isIterable(t)){let o={},c,d;for(const m of t){if(!U.isArray(m))throw TypeError("Object iterator must return a key-value pair");o[d=m[0]]=(c=o[d])?U.isArray(c)?[...c,m[1]]:[c,m[1]]:m[1]}l(o,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=Ii(t),t){const n=U.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return qN(a);if(U.isFunction(r))return r.call(this,a,n);if(U.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ii(t),t){const n=U.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Ld(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(l){if(l=Ii(l),l){const o=U.findKey(n,l);o&&(!r||Ld(n,n[o],o,r))&&(delete n[o],a=!0)}}return U.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||Ld(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return U.forEach(this,(a,i)=>{const l=U.findKey(n,i);if(l){r[l]=Bo(a),delete r[i];return}const o=t?KN(i):String(i).trim();o!==i&&delete r[i],r[o]=Bo(a),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return U.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&U.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[Ax]=this[Ax]={accessors:{}}).accessors,a=this.prototype;function i(l){const o=Ii(l);n[o]||(QN(a,l),n[o]=!0)}return U.isArray(t)?t.forEach(i):i(t),this}};Ns.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);U.reduceDescriptors(Ns.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});U.freezeMethods(Ns);function Fd(e,t){const r=this||Ql,n=t||r,a=Ns.from(n.headers);let i=n.data;return U.forEach(e,function(o){i=o.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function Iy(e){return!!(e&&e.__CANCEL__)}function Si(e,t,r){Oe.call(this,e??"canceled",Oe.ERR_CANCELED,t,r),this.name="CanceledError"}U.inherits(Si,Oe,{__CANCEL__:!0});function Oy(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Oe("Request failed with status code "+r.status,[Oe.ERR_BAD_REQUEST,Oe.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function VN(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function GN(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),m=n[i];l||(l=d),r[a]=c,n[a]=d;let h=i,f=0;for(;h!==a;)f+=r[h++],h=h%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),d-l<t)return;const j=m&&d-m;return j?Math.round(f*1e3/j):void 0}}function YN(e,t){let r=0,n=1e3/t,a,i;const l=(d,m=Date.now())=>{r=m,a=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const m=Date.now(),h=m-r;h>=n?l(d,m):(a=d,i||(i=setTimeout(()=>{i=null,l(a)},n-h)))},()=>a&&l(a)]}const jc=(e,t,r=3)=>{let n=0;const a=GN(50,250);return YN(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-n,d=a(c),m=l<=o;n=l;const h={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&m?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},r)},Rx=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Px=e=>(...t)=>U.asap(()=>e(...t)),JN=Zt.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Zt.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Zt.origin),Zt.navigator&&/(msie|trident)/i.test(Zt.navigator.userAgent)):()=>!0,XN=Zt.hasStandardBrowserEnv?{write(e,t,r,n,a,i,l){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];U.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),U.isString(n)&&o.push(`path=${n}`),U.isString(a)&&o.push(`domain=${a}`),i===!0&&o.push("secure"),U.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function ZN(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ek(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Dy(e,t,r){let n=!ZN(t);return e&&(n||r==!1)?ek(e,t):t}const $x=e=>e instanceof Ns?{...e}:e;function ga(e,t){t=t||{};const r={};function n(d,m,h,f){return U.isPlainObject(d)&&U.isPlainObject(m)?U.merge.call({caseless:f},d,m):U.isPlainObject(m)?U.merge({},m):U.isArray(m)?m.slice():m}function a(d,m,h,f){if(U.isUndefined(m)){if(!U.isUndefined(d))return n(void 0,d,h,f)}else return n(d,m,h,f)}function i(d,m){if(!U.isUndefined(m))return n(void 0,m)}function l(d,m){if(U.isUndefined(m)){if(!U.isUndefined(d))return n(void 0,d)}else return n(void 0,m)}function o(d,m,h){if(h in t)return n(d,m);if(h in e)return n(void 0,d)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,m,h)=>a($x(d),$x(m),h,!0)};return U.forEach(Object.keys({...e,...t}),function(m){const h=c[m]||a,f=h(e[m],t[m],m);U.isUndefined(f)&&h!==o||(r[m]=f)}),r}const zy=e=>{const t=ga({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=Ns.from(l),t.url=$y(Dy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),U.isFormData(r)){if(Zt.hasStandardBrowserEnv||Zt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(U.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([m,h])=>{d.includes(m.toLowerCase())&&l.set(m,h)})}}if(Zt.hasStandardBrowserEnv&&(n&&U.isFunction(n)&&(n=n(t)),n||n!==!1&&JN(t.url))){const c=a&&i&&XN.read(i);c&&l.set(a,c)}return t},tk=typeof XMLHttpRequest<"u",sk=tk&&function(e){return new Promise(function(r,n){const a=zy(e);let i=a.data;const l=Ns.from(a.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=a,m,h,f,j,x;function g(){j&&j(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(m),a.signal&&a.signal.removeEventListener("abort",m)}let y=new XMLHttpRequest;y.open(a.method.toUpperCase(),a.url,!0),y.timeout=a.timeout;function b(){if(!y)return;const v=Ns.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),N={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:v,config:e,request:y};Oy(function(z){r(z),g()},function(z){n(z),g()},N),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new Oe("Request aborted",Oe.ECONNABORTED,e,y)),y=null)},y.onerror=function(w){const N=w&&w.message?w.message:"Network Error",A=new Oe(N,Oe.ERR_NETWORK,e,y);A.event=w||null,n(A),y=null},y.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const N=a.transitional||Ly;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),n(new Oe(w,N.clarifyTimeoutError?Oe.ETIMEDOUT:Oe.ECONNABORTED,e,y)),y=null},i===void 0&&l.setContentType(null),"setRequestHeader"in y&&U.forEach(l.toJSON(),function(w,N){y.setRequestHeader(N,w)}),U.isUndefined(a.withCredentials)||(y.withCredentials=!!a.withCredentials),o&&o!=="json"&&(y.responseType=a.responseType),d&&([f,x]=jc(d,!0),y.addEventListener("progress",f)),c&&y.upload&&([h,j]=jc(c),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",j)),(a.cancelToken||a.signal)&&(m=v=>{y&&(n(!v||v.type?new Si(null,e,y):v),y.abort(),y=null)},a.cancelToken&&a.cancelToken.subscribe(m),a.signal&&(a.signal.aborted?m():a.signal.addEventListener("abort",m)));const p=VN(a.url);if(p&&Zt.protocols.indexOf(p)===-1){n(new Oe("Unsupported protocol "+p+":",Oe.ERR_BAD_REQUEST,e));return}y.send(i||null)})},rk=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,o();const m=d instanceof Error?d:this.reason;n.abort(m instanceof Oe?m:new Si(m instanceof Error?m.message:m))}};let l=t&&setTimeout(()=>{l=null,i(new Oe(`timeout ${t} of ms exceeded`,Oe.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>U.asap(o),c}},nk=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},ak=async function*(e,t){for await(const r of ik(e))yield*nk(r,t)},ik=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Lx=(e,t,r,n)=>{const a=ak(e,t);let i=0,l,o=c=>{l||(l=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:m}=await a.next();if(d){o(),c.close();return}let h=m.byteLength;if(r){let f=i+=h;r(f)}c.enqueue(new Uint8Array(m))}catch(d){throw o(d),d}},cancel(c){return o(c),a.return()}},{highWaterMark:2})},Fx=64*1024,{isFunction:jo}=U,lk=(({Request:e,Response:t})=>({Request:e,Response:t}))(U.global),{ReadableStream:Ix,TextEncoder:Ox}=U.global,Dx=(e,...t)=>{try{return!!e(...t)}catch{return!1}},ok=e=>{e=U.merge.call({skipUndefined:!0},lk,e);const{fetch:t,Request:r,Response:n}=e,a=t?jo(t):typeof fetch=="function",i=jo(r),l=jo(n);if(!a)return!1;const o=a&&jo(Ix),c=a&&(typeof Ox=="function"?(x=>g=>x.encode(g))(new Ox):async x=>new Uint8Array(await new r(x).arrayBuffer())),d=i&&o&&Dx(()=>{let x=!1;const g=new r(Zt.origin,{body:new Ix,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!g}),m=l&&o&&Dx(()=>U.isReadableStream(new n("").body)),h={stream:m&&(x=>x.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!h[x]&&(h[x]=(g,y)=>{let b=g&&g[x];if(b)return b.call(g);throw new Oe(`Response type '${x}' is not supported`,Oe.ERR_NOT_SUPPORT,y)})});const f=async x=>{if(x==null)return 0;if(U.isBlob(x))return x.size;if(U.isSpecCompliantForm(x))return(await new r(Zt.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(U.isArrayBufferView(x)||U.isArrayBuffer(x))return x.byteLength;if(U.isURLSearchParams(x)&&(x=x+""),U.isString(x))return(await c(x)).byteLength},j=async(x,g)=>{const y=U.toFiniteNumber(x.getContentLength());return y??f(g)};return async x=>{let{url:g,method:y,data:b,signal:p,cancelToken:v,timeout:w,onDownloadProgress:N,onUploadProgress:A,responseType:z,headers:F,withCredentials:Z="same-origin",fetchOptions:q}=zy(x),O=t||fetch;z=z?(z+"").toLowerCase():"text";let V=rk([p,v&&v.toAbortSignal()],w),J=null;const pe=V&&V.unsubscribe&&(()=>{V.unsubscribe()});let ke;try{if(A&&d&&y!=="get"&&y!=="head"&&(ke=await j(F,b))!==0){let ee=new r(g,{method:"POST",body:b,duplex:"half"}),ie;if(U.isFormData(b)&&(ie=ee.headers.get("content-type"))&&F.setContentType(ie),ee.body){const[ne,ge]=Rx(ke,jc(Px(A)));b=Lx(ee.body,Fx,ne,ge)}}U.isString(Z)||(Z=Z?"include":"omit");const we=i&&"credentials"in r.prototype,B={...q,signal:V,method:y.toUpperCase(),headers:F.normalize().toJSON(),body:b,duplex:"half",credentials:we?Z:void 0};J=i&&new r(g,B);let M=await(i?O(J,q):O(g,B));const X=m&&(z==="stream"||z==="response");if(m&&(N||X&&pe)){const ee={};["status","statusText","headers"].forEach($e=>{ee[$e]=M[$e]});const ie=U.toFiniteNumber(M.headers.get("content-length")),[ne,ge]=N&&Rx(ie,jc(Px(N),!0))||[];M=new n(Lx(M.body,Fx,ne,()=>{ge&&ge(),pe&&pe()}),ee)}z=z||"text";let Y=await h[U.findKey(h,z)||"text"](M,x);return!X&&pe&&pe(),await new Promise((ee,ie)=>{Oy(ee,ie,{data:Y,headers:Ns.from(M.headers),status:M.status,statusText:M.statusText,config:x,request:J})})}catch(we){throw pe&&pe(),we&&we.name==="TypeError"&&/Load failed|fetch/i.test(we.message)?Object.assign(new Oe("Network Error",Oe.ERR_NETWORK,x,J),{cause:we.cause||we}):Oe.from(we,we&&we.code,x,J)}}},ck=new Map,Uy=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:a}=t,i=[n,a,r];let l=i.length,o=l,c,d,m=ck;for(;o--;)c=i[o],d=m.get(c),d===void 0&&m.set(c,d=o?new Map:ok(t)),m=d;return d};Uy();const Ph={http:CN,xhr:sk,fetch:{get:Uy}};U.forEach(Ph,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const zx=e=>`- ${e}`,dk=e=>U.isFunction(e)||e===null||e===!1;function uk(e,t){e=U.isArray(e)?e:[e];const{length:r}=e;let n,a;const i={};for(let l=0;l<r;l++){n=e[l];let o;if(a=n,!dk(n)&&(a=Ph[(o=String(n)).toLowerCase()],a===void 0))throw new Oe(`Unknown adapter '${o}'`);if(a&&(U.isFunction(a)||(a=a.get(t))))break;i[o||"#"+l]=a}if(!a){const l=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(zx).join(`
`):" "+zx(l[0]):"as no adapter specified";throw new Oe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a}const Hy={getAdapter:uk,adapters:Ph};function Id(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Si(null,e)}function Ux(e){return Id(e),e.headers=Ns.from(e.headers),e.data=Fd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Hy.getAdapter(e.adapter||Ql.adapter,e)(e).then(function(n){return Id(e),n.data=Fd.call(e,e.transformResponse,n),n.headers=Ns.from(n.headers),n},function(n){return Iy(n)||(Id(e),n&&n.response&&(n.response.data=Fd.call(e,e.transformResponse,n.response),n.response.headers=Ns.from(n.response.headers))),Promise.reject(n)})}const By="1.13.2",Yc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Yc[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Hx={};Yc.transitional=function(t,r,n){function a(i,l){return"[Axios v"+By+"] Transitional option '"+i+"'"+l+(n?". "+n:"")}return(i,l,o)=>{if(t===!1)throw new Oe(a(l," has been removed"+(r?" in "+r:"")),Oe.ERR_DEPRECATED);return r&&!Hx[l]&&(Hx[l]=!0,console.warn(a(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};Yc.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function mk(e,t,r){if(typeof e!="object")throw new Oe("options must be an object",Oe.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],l=t[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new Oe("option "+i+" must be "+c,Oe.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Oe("Unknown option "+i,Oe.ERR_BAD_OPTION)}}const qo={assertOptions:mk,validators:Yc},or=qo.validators;let la=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Tx,response:new Tx}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ga(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&qo.assertOptions(n,{silentJSONParsing:or.transitional(or.boolean),forcedJSONParsing:or.transitional(or.boolean),clarifyTimeoutError:or.transitional(or.boolean)},!1),a!=null&&(U.isFunction(a)?r.paramsSerializer={serialize:a}:qo.assertOptions(a,{encode:or.function,serialize:or.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),qo.assertOptions(r,{baseUrl:or.spelling("baseURL"),withXsrfToken:or.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&U.merge(i.common,i[r.method]);i&&U.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=Ns.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let m,h=0,f;if(!c){const x=[Ux.bind(this),void 0];for(x.unshift(...o),x.push(...d),f=x.length,m=Promise.resolve(r);h<f;)m=m.then(x[h++],x[h++]);return m}f=o.length;let j=r;for(;h<f;){const x=o[h++],g=o[h++];try{j=x(j)}catch(y){g.call(this,y);break}}try{m=Ux.call(this,j)}catch(x){return Promise.reject(x)}for(h=0,f=d.length;h<f;)m=m.then(d[h++],d[h++]);return m}getUri(t){t=ga(this.defaults,t);const r=Dy(t.baseURL,t.url,t.allowAbsoluteUrls);return $y(r,t.params,t.paramsSerializer)}};U.forEach(["delete","get","head","options"],function(t){la.prototype[t]=function(r,n){return this.request(ga(n||{},{method:t,url:r,data:(n||{}).data}))}});U.forEach(["post","put","patch"],function(t){function r(n){return function(i,l,o){return this.request(ga(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}la.prototype[t]=r(),la.prototype[t+"Form"]=r(!0)});let hk=class qy{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const l=new Promise(o=>{n.subscribe(o),i=o}).then(a);return l.cancel=function(){n.unsubscribe(i)},l},t(function(i,l,o){n.reason||(n.reason=new Si(i,l,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new qy(function(a){t=a}),cancel:t}}};function xk(e){return function(r){return e.apply(null,r)}}function fk(e){return U.isObject(e)&&e.isAxiosError===!0}const hm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(hm).forEach(([e,t])=>{hm[t]=e});function Wy(e){const t=new la(e),r=wy(la.prototype.request,t);return U.extend(r,la.prototype,t,{allOwnKeys:!0}),U.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return Wy(ga(e,a))},r}const Nt=Wy(Ql);Nt.Axios=la;Nt.CanceledError=Si;Nt.CancelToken=hk;Nt.isCancel=Iy;Nt.VERSION=By;Nt.toFormData=Gc;Nt.AxiosError=Oe;Nt.Cancel=Nt.CanceledError;Nt.all=function(t){return Promise.all(t)};Nt.spread=xk;Nt.isAxiosError=fk;Nt.mergeConfig=ga;Nt.AxiosHeaders=Ns;Nt.formToJSON=e=>Fy(U.isHTMLForm(e)?new FormData(e):e);Nt.getAdapter=Hy.getAdapter;Nt.HttpStatusCode=hm;Nt.default=Nt;const{Axios:VC,AxiosError:GC,CanceledError:YC,isCancel:JC,CancelToken:XC,VERSION:ZC,all:e_,Cancel:t_,isAxiosError:s_,spread:r_,toFormData:n_,AxiosHeaders:a_,HttpStatusCode:i_,formToJSON:l_,getAdapter:o_,mergeConfig:c_}=Nt,gk="https://dartmouth-os-worker.dartmouth.workers.dev",I=Nt.create({baseURL:gk,headers:{"Content-Type":"application/json"}});I.interceptors.request.use(e=>{const t=localStorage.getItem("auth-storage");if(t)try{const{state:r}=JSON.parse(t);r!=null&&r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}catch(r){console.error("Error parsing auth token:",r)}return e});I.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("auth-storage"),window.location.href="/login"),Promise.reject(e)});const pk={login:(e,t)=>I.post("/api/auth/login",{email:e,password:t}),me:()=>I.get("/api/auth/me"),logout:()=>I.post("/api/auth/logout")},Ie={list:e=>I.get("/api/tickets",{params:e}),get:e=>I.get(`/api/tickets/${e}`),getById:e=>I.get(`/api/tickets/${e}`),getMessages:e=>I.get(`/api/tickets/${e}/messages`),assign:(e,t)=>I.put(`/api/tickets/${e}/assign`,{assignedTo:t}),updateStatus:(e,t)=>I.put(`/api/tickets/${e}/status`,{status:t}),reply:(e,t,r)=>I.post(`/api/tickets/${e}/reply`,{content:t,attachments:r}),addNote:(e,t,r,n)=>I.post(`/api/tickets/${e}/notes`,{content:t,noteType:r,attachments:n}),editNote:(e,t,r)=>I.put(`/api/tickets/${e}/notes/${t}`,{content:r}),deleteNote:(e,t)=>I.delete(`/api/tickets/${e}/notes/${t}`),snooze:(e,t,r)=>I.post(`/api/tickets/${e}/snooze`,{snoozedUntil:t,reason:r}),unsnooze:e=>I.post(`/api/tickets/${e}/unsnooze`),escalate:(e,t,r)=>I.post(`/api/tickets/${e}/escalate`,{staffIds:t,reason:r}),resolveEscalation:(e,t)=>I.post(`/api/tickets/${e}/resolve-escalation`,{escalationId:t}),scheduleReply:(e,t,r)=>I.post(`/api/tickets/${e}/schedule-reply`,{content:t,scheduledFor:r}),getScheduledMessages:e=>I.get(`/api/tickets/${e}/scheduled-messages`),updateScheduledMessage:(e,t,r)=>I.put(`/api/scheduled-messages/${e}`,{content:t,scheduledFor:r}),deleteScheduledMessage:e=>I.delete(`/api/scheduled-messages/${e}`),getAIDraft:e=>I.get(`/api/tickets/${e}/ai-draft`),approveAIDraft:e=>I.post(`/api/tickets/${e}/ai-draft/approve`),editAIDraft:(e,t)=>I.post(`/api/tickets/${e}/ai-draft/edit`,{editedContent:t}),rejectAIDraft:(e,t)=>I.post(`/api/tickets/${e}/ai-draft/reject`,{reason:t}),submitAIDraftFeedback:(e,t)=>I.post(`/api/tickets/${e}/ai-draft/feedback`,t),delete:e=>I.delete(`/api/tickets/${e}`),merge:(e,t)=>I.post(`/api/tickets/${e}/merge`,{secondaryTicketIds:t}),bulkAssign:(e,t)=>I.post("/api/tickets/bulk-assign",{ticketIds:e,assignedTo:t}),createManual:e=>I.post("/api/tickets/create-manual",e)},rt={list:()=>I.get("/api/staff"),get:e=>I.get(`/api/staff/${e}`),me:()=>I.get("/api/staff/me"),onlineCount:()=>I.get("/api/staff/online-count"),create:e=>I.post("/api/staff",e),update:(e,t)=>I.put(`/api/staff/${e}`,t),updatePresence:(e,t)=>I.put(`/api/staff/${e}/presence`,{isAvailable:t}),updateAvailability:(e,t)=>I.put(`/api/staff/${e}/availability`,{status:t}),uploadAvatar:(e,t)=>{const r=new FormData;return r.append("avatar",t),I.post(`/api/staff/${e}/avatar`,r,{headers:{"Content-Type":"multipart/form-data"}})},deleteAvatar:e=>I.delete(`/api/staff/${e}/avatar`),getAvatarUrl:e=>e?e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev${e}`:null},$r={getSettings:()=>I.get("/api/chat/settings"),updateSettings:e=>I.put("/api/chat/settings",e),getBusinessHours:()=>I.get("/api/chat/business-hours"),updateBusinessHours:e=>I.put("/api/chat/business-hours",{hours:e}),getStatus:()=>I.get("/api/chat/status"),getEmbedCode:()=>I.get("/api/chat/embed-code")},wo={listDocuments:()=>I.get("/api/ai-agent/knowledge"),uploadDocument:(e,t)=>{const r=new FormData;return r.append("file",e),r.append("category",t),I.post("/api/ai-agent/knowledge/upload",r,{headers:{"Content-Type":"multipart/form-data"}})},deleteDocument:e=>I.delete(`/api/ai-agent/knowledge/${e}`),reprocessDocuments:()=>I.post("/api/ai-agent/knowledge/reprocess")},Od={getConfig:()=>I.get("/api/ai-agent/system-message"),updateConfig:e=>I.put("/api/ai-agent/system-message",e),resetToDefault:()=>I.post("/api/ai-agent/system-message/reset")},Bx={getAIAgentStats:(e="7d")=>I.get("/api/analytics/ai-agent",{params:{timeRange:e}}),getLearningExamples:(e=10)=>I.get("/api/analytics/ai-agent/learning-examples",{params:{limit:e}})},No={getConfig:()=>I.get("/api/auto-assignment/config"),updateConfig:e=>I.put("/api/auto-assignment/config",e),runNow:()=>I.post("/api/auto-assignment/run"),getHistory:e=>I.get("/api/auto-assignment/history",{params:{limit:e}}),getStaffSettings:e=>I.get(`/api/auto-assignment/staff/${e}`),updateStaffSettings:(e,t)=>I.put(`/api/auto-assignment/staff/${e}`,t)},yk={getTicketData:e=>I.get("/api/shopify/ticket-data",{params:{email:e}}),getCustomer:e=>I.get("/api/shopify/customer",{params:{email:e}}),getCustomerOrders:(e,t)=>I.get(`/api/shopify/customer/${e}/orders`,{params:{limit:t}}),getOrdersByEmail:(e,t)=>I.get("/api/shopify/orders",{params:{email:e,limit:t}}),searchOrder:e=>I.get("/api/shopify/order",{params:{number:e}}),getOrder:e=>I.get(`/api/shopify/order/${e}`)},xt={listChannels:()=>I.get("/api/group-chat/channels"),createChannel:e=>I.post("/api/group-chat/channels",e),getChannel:e=>I.get(`/api/group-chat/channels/${e}`),updateChannel:(e,t)=>I.patch(`/api/group-chat/channels/${e}`,t),archiveChannel:e=>I.delete(`/api/group-chat/channels/${e}`),getMessages:(e,t)=>I.get(`/api/group-chat/channels/${e}/messages`,{params:t}),sendMessage:(e,t)=>I.post(`/api/group-chat/channels/${e}/messages`,t),pollMessages:(e,t)=>I.get(`/api/group-chat/channels/${e}/poll`,{params:{after:t}}),editMessage:(e,t,r)=>I.patch(`/api/group-chat/messages/${e}`,{content:t,deleteAttachment:r}),deleteMessage:e=>I.delete(`/api/group-chat/messages/${e}`),addReaction:(e,t)=>I.post(`/api/group-chat/messages/${e}/react`,{emoji:t}),getMembers:e=>I.get(`/api/group-chat/channels/${e}/members`),addMember:(e,t)=>I.post(`/api/group-chat/channels/${e}/members`,{staffId:t}),removeMember:(e,t)=>I.delete(`/api/group-chat/channels/${e}/members/${t}`),markAsRead:(e,t)=>I.post(`/api/group-chat/channels/${e}/read`,{messageId:t}),getUnreadCounts:()=>I.get("/api/group-chat/unread"),getTimeLimit:()=>I.get("/api/group-chat/settings/time-limit"),setTimeLimit:e=>I.put("/api/group-chat/settings/time-limit",{timeLimit:e}),getAutoArchiveHours:()=>I.get("/api/group-chat/settings/auto-archive"),setAutoArchiveHours:e=>I.put("/api/group-chat/settings/auto-archive",{hours:e})},Gi={getMemos:e=>I.get("/api/memos",{params:e}),createMemo:e=>I.post("/api/memos",e),editMemo:(e,t)=>I.patch(`/api/memos/${e}`,t),deleteMemo:e=>I.delete(`/api/memos/${e}`)},qx={getAllTags:e=>I.get("/api/tags",{params:e?{search:e}:{}}),searchTags:e=>I.get("/api/tags/search",{params:{search:e}})},ko={getGlobal:()=>I.get("/api/signatures/global"),setGlobal:e=>I.put("/api/signatures/global",{signatureHtml:e}),getPreview:()=>I.get("/api/signatures/preview"),getPlainText:()=>I.get("/api/signatures/plain-text"),uploadLogo:e=>I.post("/api/signatures/upload-logo",{attachment:e}),getSettings:()=>I.get("/api/signatures/settings"),saveSettings:e=>I.put("/api/signatures/settings",e),getPreviewFromSettings:e=>I.post("/api/signatures/preview-from-settings",e)},Un={getMentions:e=>I.get("/api/mentions",{params:e}),getMention:e=>I.get(`/api/mentions/${e}`),markAsRead:e=>I.patch(`/api/mentions/${e}/read`),markAsUnread:e=>I.patch(`/api/mentions/${e}/unread`),archiveMention:e=>I.patch(`/api/mentions/${e}/archive`),getUnreadCount:()=>I.get("/api/mentions/unread-count"),updateMention:(e,t)=>I.patch(`/api/mentions/${e}`,t),deleteMention:e=>I.delete(`/api/mentions/${e}`)};function bk(){const[e,t]=u.useState("john@dtf.com.au"),[r,n]=u.useState("changeme123"),[a,i]=u.useState(""),[l,o]=u.useState(!1),c=jr(),d=us(h=>h.setAuth),m=async h=>{var f,j;h.preventDefault(),i(""),o(!0);try{const x=await pk.login(e,r);d(x.data.token,x.data.user),c("/tickets")}catch(x){i(((j=(f=x.response)==null?void 0:f.data)==null?void 0:j.error)||"Login failed")}finally{o(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Customer Service Dashboard"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your account"})]}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:m,children:[a&&s.jsx("div",{className:"rounded-md bg-red-50 p-4",children:s.jsx("div",{className:"text-sm text-red-800",children:a})}),s.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:h=>t(h.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",value:r,onChange:h=>n(h.target.value)})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:l?"Signing in...":"Sign in"})}),s.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[s.jsx("p",{children:"Test credentials:"}),s.jsx("p",{children:"Admin: john@dtf.com.au / changeme123"}),s.jsx("p",{children:"Agent: john+ted@dtf.com.au / changeme123"})]})]})]})})}var vk=Object.defineProperty,jk=(e,t,r)=>t in e?vk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Dd=(e,t,r)=>(jk(e,typeof t!="symbol"?t+"":t,r),r);let wk=class{constructor(){Dd(this,"current",this.detect()),Dd(this,"handoffState","pending"),Dd(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Fr=new wk,Ut=(e,t)=>{Fr.isServer?u.useEffect(e,t):u.useLayoutEffect(e,t)};function Ir(e){let t=u.useRef(e);return Ut(()=>{t.current=e},[e]),t}let Be=function(e){let t=Ir(e);return Le.useCallback((...r)=>t.current(...r),[t])};function Jc(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function sr(){let e=[],t={addEventListener(r,n,a,i){return r.addEventListener(n,a,i),t.add(()=>r.removeEventListener(n,a,i))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return t.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return t.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return Jc(()=>{n.current&&r[0]()}),t.add(()=>{n.current=!1})},style(r,n,a){let i=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:a}),this.add(()=>{Object.assign(r.style,{[n]:i})})},group(r){let n=sr();return r(n),this.add(()=>n.dispose())},add(r){return e.push(r),()=>{let n=e.indexOf(r);if(n>=0)for(let a of e.splice(n,1))a()}},dispose(){for(let r of e.splice(0))r()}};return t}function Vl(){let[e]=u.useState(sr);return u.useEffect(()=>()=>e.dispose(),[e]),e}function Nk(){let e=typeof document>"u";return"useSyncExternalStore"in ri?(t=>t.useSyncExternalStore)(ri)(()=>()=>{},()=>!1,()=>!e):!1}function Ci(){let e=Nk(),[t,r]=u.useState(Fr.isHandoffComplete);return t&&Fr.isHandoffComplete===!1&&r(!1),u.useEffect(()=>{t!==!0&&r(!0)},[t]),u.useEffect(()=>Fr.handoff(),[]),e?!1:t}var Wx;let Wr=(Wx=Le.useId)!=null?Wx:function(){let e=Ci(),[t,r]=Le.useState(e?()=>Fr.nextId():null);return Ut(()=>{t===null&&r(Fr.nextId())},[t]),t!=null?""+t:void 0};function Dt(e,t,...r){if(e in t){let a=t[e];return typeof a=="function"?a(...r):a}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Dt),n}function Xc(e){return Fr.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let xm=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var Ar=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(Ar||{}),Ky=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Ky||{}),kk=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(kk||{});function Qy(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(xm)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var $h=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))($h||{});function Lh(e,t=0){var r;return e===((r=Xc(e))==null?void 0:r.body)?!1:Dt(t,{0(){return e.matches(xm)},1(){let n=e;for(;n!==null;){if(n.matches(xm))return!0;n=n.parentElement}return!1}})}function Vy(e){let t=Xc(e);sr().nextFrame(()=>{t&&!Lh(t.activeElement,0)&&Mn(e)})}var Sk=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Sk||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Mn(e){e==null||e.focus({preventScroll:!0})}let Ck=["textarea","input"].join(",");function _k(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Ck))!=null?r:!1}function Gy(e,t=r=>r){return e.slice().sort((r,n)=>{let a=t(r),i=t(n);if(a===null||i===null)return 0;let l=a.compareDocumentPosition(i);return l&Node.DOCUMENT_POSITION_FOLLOWING?-1:l&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Ek(e,t){return ol(Qy(),t,{relativeTo:e})}function ol(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:a=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,l=Array.isArray(e)?r?Gy(e):e:Qy(e);a.length>0&&l.length>1&&(l=l.filter(j=>!a.includes(j))),n=n??i.activeElement;let o=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,l.indexOf(n))-1;if(t&4)return Math.max(0,l.indexOf(n))+1;if(t&8)return l.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=t&32?{preventScroll:!0}:{},m=0,h=l.length,f;do{if(m>=h||m+h<=0)return 0;let j=c+m;if(t&16)j=(j+h)%h;else{if(j<0)return 3;if(j>=h)return 1}f=l[j],f==null||f.focus(d),m+=o}while(f!==i.activeElement);return t&6&&_k(f)&&f.select(),2}function Yy(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Mk(){return/Android/gi.test(window.navigator.userAgent)}function Tk(){return Yy()||Mk()}function So(e,t,r){let n=Ir(t);u.useEffect(()=>{function a(i){n.current(i)}return document.addEventListener(e,a,r),()=>document.removeEventListener(e,a,r)},[e,r])}function Jy(e,t,r){let n=Ir(t);u.useEffect(()=>{function a(i){n.current(i)}return window.addEventListener(e,a,r),()=>window.removeEventListener(e,a,r)},[e,r])}function Xy(e,t,r=!0){let n=u.useRef(!1);u.useEffect(()=>{requestAnimationFrame(()=>{n.current=r})},[r]);function a(l,o){if(!n.current||l.defaultPrevented)return;let c=o(l);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let d=function m(h){return typeof h=="function"?m(h()):Array.isArray(h)||h instanceof Set?h:[h]}(e);for(let m of d){if(m===null)continue;let h=m instanceof HTMLElement?m:m.current;if(h!=null&&h.contains(c)||l.composed&&l.composedPath().includes(h))return}return!Lh(c,$h.Loose)&&c.tabIndex!==-1&&l.preventDefault(),t(l,c)}let i=u.useRef(null);So("pointerdown",l=>{var o,c;n.current&&(i.current=((c=(o=l.composedPath)==null?void 0:o.call(l))==null?void 0:c[0])||l.target)},!0),So("mousedown",l=>{var o,c;n.current&&(i.current=((c=(o=l.composedPath)==null?void 0:o.call(l))==null?void 0:c[0])||l.target)},!0),So("click",l=>{Tk()||i.current&&(a(l,()=>i.current),i.current=null)},!0),So("touchend",l=>a(l,()=>l.target instanceof HTMLElement?l.target:null),!0),Jy("blur",l=>a(l,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function _i(...e){return u.useMemo(()=>Xc(...e),[...e])}function Kx(e){var t;if(e.type)return e.type;let r=(t=e.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function Ak(e,t){let[r,n]=u.useState(()=>Kx(e));return Ut(()=>{n(Kx(e))},[e.type,e.as]),Ut(()=>{r||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&n("button")},[r,t]),r}let Zy=Symbol();function Rk(e,t=!0){return Object.assign(e,{[Zy]:t})}function ms(...e){let t=u.useRef(e);u.useEffect(()=>{t.current=e},[e]);let r=Be(n=>{for(let a of t.current)a!=null&&(typeof a=="function"?a(n):a.current=n)});return e.every(n=>n==null||(n==null?void 0:n[Zy]))?void 0:r}function Qx(e){return[e.screenX,e.screenY]}function Pk(){let e=u.useRef([-1,-1]);return{wasMoved(t){let r=Qx(t);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(t){e.current=Qx(t)}}}function $k({container:e,accept:t,walk:r,enabled:n=!0}){let a=u.useRef(t),i=u.useRef(r);u.useEffect(()=>{a.current=t,i.current=r},[t,r]),Ut(()=>{if(!e||!n)return;let l=Xc(e);if(!l)return;let o=a.current,c=i.current,d=Object.assign(h=>o(h),{acceptNode:o}),m=l.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,d,!1);for(;m.nextNode();)c(m.currentNode)},[e,n,a,i])}function Fh(e,t){let r=u.useRef([]),n=Be(e);u.useEffect(()=>{let a=[...r.current];for(let[i,l]of t.entries())if(r.current[i]!==l){let o=n(t,a);return r.current=t,o}},[n,...t])}function wc(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}var hi=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(hi||{}),pn=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(pn||{});function ts({ourProps:e,theirProps:t,slot:r,defaultTag:n,features:a,visible:i=!0,name:l,mergeRefs:o}){o=o??Lk;let c=eb(t,e);if(i)return Co(c,r,n,l,o);let d=a??0;if(d&2){let{static:m=!1,...h}=c;if(m)return Co(h,r,n,l,o)}if(d&1){let{unmount:m=!0,...h}=c;return Dt(m?0:1,{0(){return null},1(){return Co({...h,hidden:!0,style:{display:"none"}},r,n,l,o)}})}return Co(c,r,n,l,o)}function Co(e,t={},r,n,a){let{as:i=r,children:l,refName:o="ref",...c}=zd(e,["unmount","static"]),d=e.ref!==void 0?{[o]:e.ref}:{},m=typeof l=="function"?l(t):l;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(t));let h={};if(t){let f=!1,j=[];for(let[x,g]of Object.entries(t))typeof g=="boolean"&&(f=!0),g===!0&&j.push(x);f&&(h["data-headlessui-state"]=j.join(" "))}if(i===u.Fragment&&Object.keys(Vx(c)).length>0){if(!u.isValidElement(m)||Array.isArray(m)&&m.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(c).map(g=>`  - ${g}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(g=>`  - ${g}`).join(`
`)].join(`
`));let f=m.props,j=typeof(f==null?void 0:f.className)=="function"?(...g)=>wc(f==null?void 0:f.className(...g),c.className):wc(f==null?void 0:f.className,c.className),x=j?{className:j}:{};return u.cloneElement(m,Object.assign({},eb(m.props,Vx(zd(c,["ref"]))),h,d,{ref:a(m.ref,d.ref)},x))}return u.createElement(i,Object.assign({},zd(c,["ref"]),i!==u.Fragment&&d,i!==u.Fragment&&h),m)}function Lk(...e){return e.every(t=>t==null)?void 0:t=>{for(let r of e)r!=null&&(typeof r=="function"?r(t):r.current=t)}}function eb(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},r={};for(let n of e)for(let a in n)a.startsWith("on")&&typeof n[a]=="function"?(r[a]!=null||(r[a]=[]),r[a].push(n[a])):t[a]=n[a];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(r).map(n=>[n,void 0])));for(let n in r)Object.assign(t,{[n](a,...i){let l=r[n];for(let o of l){if((a instanceof Event||(a==null?void 0:a.nativeEvent)instanceof Event)&&a.defaultPrevented)return;o(a,...i)}}});return t}function Vt(e){var t;return Object.assign(u.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function Vx(e){let t=Object.assign({},e);for(let r in t)t[r]===void 0&&delete t[r];return t}function zd(e,t=[]){let r=Object.assign({},e);for(let n of t)n in r&&delete r[n];return r}let Fk="div";var Nc=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Nc||{});function Ik(e,t){var r;let{features:n=1,...a}=e,i={ref:t,"aria-hidden":(n&2)===2?!0:(r=a["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return ts({ourProps:i,theirProps:a,slot:{},defaultTag:Fk,name:"Hidden"})}let fm=Vt(Ik),Ih=u.createContext(null);Ih.displayName="OpenClosedContext";var qt=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(qt||{});function Zc(){return u.useContext(Ih)}function tb({value:e,children:t}){return Le.createElement(Ih.Provider,{value:e},t)}function Ok(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let rn=[];Ok(()=>{function e(t){t.target instanceof HTMLElement&&t.target!==document.body&&rn[0]!==t.target&&(rn.unshift(t.target),rn=rn.filter(r=>r!=null&&r.isConnected),rn.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function sb(e){let t=e.parentElement,r=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(r=t),t=t.parentElement;let n=(t==null?void 0:t.getAttribute("disabled"))==="";return n&&Dk(r)?!1:n}function Dk(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}function zk(e){throw new Error("Unexpected object: "+e)}var Js=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Js||{});function Uk(e,t){let r=t.resolveItems();if(r.length<=0)return null;let n=t.resolveActiveIndex(),a=n??-1;switch(e.focus){case 0:{for(let i=0;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 1:{for(let i=a-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 2:{for(let i=a+1;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 3:{for(let i=r.length-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 4:{for(let i=0;i<r.length;++i)if(t.resolveId(r[i],i,r)===e.id)return i;return n}case 5:return null;default:zk(e)}}var Ft=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Ft||{});function rb(e,t,r,n){let a=Ir(r);u.useEffect(()=>{e=e??window;function i(l){a.current(l)}return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i,n)},[e,t,n])}function Gl(){let e=u.useRef(!1);return Ut(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function nb(e){let t=Be(e),r=u.useRef(!1);u.useEffect(()=>(r.current=!1,()=>{r.current=!0,Jc(()=>{r.current&&t()})}),[t])}var Yi=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Yi||{});function Hk(){let e=u.useRef(0);return Jy("keydown",t=>{t.key==="Tab"&&(e.current=t.shiftKey?1:0)},!0),e}function ab(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let r of e.current)r.current instanceof HTMLElement&&t.add(r.current);return t}let Bk="div";var ib=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(ib||{});function qk(e,t){let r=u.useRef(null),n=ms(r,t),{initialFocus:a,containers:i,features:l=30,...o}=e;Ci()||(l=1);let c=_i(r);Qk({ownerDocument:c},!!(l&16));let d=Vk({ownerDocument:c,container:r,initialFocus:a},!!(l&2));Gk({ownerDocument:c,container:r,containers:i,previousActiveElement:d},!!(l&8));let m=Hk(),h=Be(g=>{let y=r.current;y&&(b=>b())(()=>{Dt(m.current,{[Yi.Forwards]:()=>{ol(y,Ar.First,{skipElements:[g.relatedTarget]})},[Yi.Backwards]:()=>{ol(y,Ar.Last,{skipElements:[g.relatedTarget]})}})})}),f=Vl(),j=u.useRef(!1),x={ref:n,onKeyDown(g){g.key=="Tab"&&(j.current=!0,f.requestAnimationFrame(()=>{j.current=!1}))},onBlur(g){let y=ab(i);r.current instanceof HTMLElement&&y.add(r.current);let b=g.relatedTarget;b instanceof HTMLElement&&b.dataset.headlessuiFocusGuard!=="true"&&(lb(y,b)||(j.current?ol(r.current,Dt(m.current,{[Yi.Forwards]:()=>Ar.Next,[Yi.Backwards]:()=>Ar.Previous})|Ar.WrapAround,{relativeTo:g.target}):g.target instanceof HTMLElement&&Mn(g.target)))}};return Le.createElement(Le.Fragment,null,!!(l&4)&&Le.createElement(fm,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:Nc.Focusable}),ts({ourProps:x,theirProps:o,defaultTag:Bk,name:"FocusTrap"}),!!(l&4)&&Le.createElement(fm,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:Nc.Focusable}))}let Wk=Vt(qk),Oi=Object.assign(Wk,{features:ib});function Kk(e=!0){let t=u.useRef(rn.slice());return Fh(([r],[n])=>{n===!0&&r===!1&&Jc(()=>{t.current.splice(0)}),n===!1&&r===!0&&(t.current=rn.slice())},[e,rn,t]),Be(()=>{var r;return(r=t.current.find(n=>n!=null&&n.isConnected))!=null?r:null})}function Qk({ownerDocument:e},t){let r=Kk(t);Fh(()=>{t||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&Mn(r())},[t]),nb(()=>{t&&Mn(r())})}function Vk({ownerDocument:e,container:t,initialFocus:r},n){let a=u.useRef(null),i=Gl();return Fh(()=>{if(!n)return;let l=t.current;l&&Jc(()=>{if(!i.current)return;let o=e==null?void 0:e.activeElement;if(r!=null&&r.current){if((r==null?void 0:r.current)===o){a.current=o;return}}else if(l.contains(o)){a.current=o;return}r!=null&&r.current?Mn(r.current):ol(l,Ar.First)===Ky.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),a.current=e==null?void 0:e.activeElement})},[n]),a}function Gk({ownerDocument:e,container:t,containers:r,previousActiveElement:n},a){let i=Gl();rb(e==null?void 0:e.defaultView,"focus",l=>{if(!a||!i.current)return;let o=ab(r);t.current instanceof HTMLElement&&o.add(t.current);let c=n.current;if(!c)return;let d=l.target;d&&d instanceof HTMLElement?lb(o,d)?(n.current=d,Mn(d)):(l.preventDefault(),l.stopPropagation(),Mn(c)):Mn(n.current)},!0)}function lb(e,t){for(let r of e)if(r.contains(t))return!0;return!1}let ob=u.createContext(!1);function Yk(){return u.useContext(ob)}function gm(e){return Le.createElement(ob.Provider,{value:e.force},e.children)}function Jk(e){let t=Yk(),r=u.useContext(cb),n=_i(e),[a,i]=u.useState(()=>{if(!t&&r!==null||Fr.isServer)return null;let l=n==null?void 0:n.getElementById("headlessui-portal-root");if(l)return l;if(n===null)return null;let o=n.createElement("div");return o.setAttribute("id","headlessui-portal-root"),n.body.appendChild(o)});return u.useEffect(()=>{a!==null&&(n!=null&&n.body.contains(a)||n==null||n.body.appendChild(a))},[a,n]),u.useEffect(()=>{t||r!==null&&i(r.current)},[r,i,t]),a}let Xk=u.Fragment;function Zk(e,t){let r=e,n=u.useRef(null),a=ms(Rk(m=>{n.current=m}),t),i=_i(n),l=Jk(n),[o]=u.useState(()=>{var m;return Fr.isServer?null:(m=i==null?void 0:i.createElement("div"))!=null?m:null}),c=u.useContext(pm),d=Ci();return Ut(()=>{!l||!o||l.contains(o)||(o.setAttribute("data-headlessui-portal",""),l.appendChild(o))},[l,o]),Ut(()=>{if(o&&c)return c.register(o)},[c,o]),nb(()=>{var m;!l||!o||(o instanceof Node&&l.contains(o)&&l.removeChild(o),l.childNodes.length<=0&&((m=l.parentElement)==null||m.removeChild(l)))}),d?!l||!o?null:Qp.createPortal(ts({ourProps:{ref:a},theirProps:r,defaultTag:Xk,name:"Portal"}),o):null}let e5=u.Fragment,cb=u.createContext(null);function t5(e,t){let{target:r,...n}=e,a={ref:ms(t)};return Le.createElement(cb.Provider,{value:r},ts({ourProps:a,theirProps:n,defaultTag:e5,name:"Popover.Group"}))}let pm=u.createContext(null);function s5(){let e=u.useContext(pm),t=u.useRef([]),r=Be(i=>(t.current.push(i),e&&e.register(i),()=>n(i))),n=Be(i=>{let l=t.current.indexOf(i);l!==-1&&t.current.splice(l,1),e&&e.unregister(i)}),a=u.useMemo(()=>({register:r,unregister:n,portals:t}),[r,n,t]);return[t,u.useMemo(()=>function({children:i}){return Le.createElement(pm.Provider,{value:a},i)},[a])]}let r5=Vt(Zk),n5=Vt(t5),ym=Object.assign(r5,{Group:n5});function a5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const i5=typeof Object.is=="function"?Object.is:a5,{useState:l5,useEffect:o5,useLayoutEffect:c5,useDebugValue:d5}=ri;function u5(e,t,r){const n=t(),[{inst:a},i]=l5({inst:{value:n,getSnapshot:t}});return c5(()=>{a.value=n,a.getSnapshot=t,Ud(a)&&i({inst:a})},[e,n,t]),o5(()=>(Ud(a)&&i({inst:a}),e(()=>{Ud(a)&&i({inst:a})})),[e]),d5(n),n}function Ud(e){const t=e.getSnapshot,r=e.value;try{const n=t();return!i5(r,n)}catch{return!0}}function m5(e,t,r){return t()}const h5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",x5=!h5,f5=x5?m5:u5,g5="useSyncExternalStore"in ri?(e=>e.useSyncExternalStore)(ri):f5;function p5(e){return g5(e.subscribe,e.getSnapshot,e.getSnapshot)}function y5(e,t){let r=e(),n=new Set;return{getSnapshot(){return r},subscribe(a){return n.add(a),()=>n.delete(a)},dispatch(a,...i){let l=t[a].call(r,...i);l&&(r=l,n.forEach(o=>o()))}}}function b5(){let e;return{before({doc:t}){var r;let n=t.documentElement;e=((r=t.defaultView)!=null?r:window).innerWidth-n.clientWidth},after({doc:t,d:r}){let n=t.documentElement,a=n.clientWidth-n.offsetWidth,i=e-a;r.style(n,"paddingRight",`${i}px`)}}}function v5(){return Yy()?{before({doc:e,d:t,meta:r}){function n(a){return r.containers.flatMap(i=>i()).some(i=>i.contains(a))}t.microTask(()=>{var a;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let o=sr();o.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>o.dispose()))}let i=(a=window.scrollY)!=null?a:window.pageYOffset,l=null;t.addEventListener(e,"click",o=>{if(o.target instanceof HTMLElement)try{let c=o.target.closest("a");if(!c)return;let{hash:d}=new URL(c.href),m=e.querySelector(d);m&&!n(m)&&(l=m)}catch{}},!0),t.addEventListener(e,"touchstart",o=>{if(o.target instanceof HTMLElement)if(n(o.target)){let c=o.target;for(;c.parentElement&&n(c.parentElement);)c=c.parentElement;t.style(c,"overscrollBehavior","contain")}else t.style(o.target,"touchAction","none")}),t.addEventListener(e,"touchmove",o=>{if(o.target instanceof HTMLElement)if(n(o.target)){let c=o.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&o.preventDefault()}else o.preventDefault()},{passive:!1}),t.add(()=>{var o;let c=(o=window.scrollY)!=null?o:window.pageYOffset;i!==c&&window.scrollTo(0,i),l&&l.isConnected&&(l.scrollIntoView({block:"nearest"}),l=null)})})}}:{}}function j5(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function w5(e){let t={};for(let r of e)Object.assign(t,r(t));return t}let Gn=y5(()=>new Map,{PUSH(e,t){var r;let n=(r=this.get(e))!=null?r:{doc:e,count:0,d:sr(),meta:new Set};return n.count++,n.meta.add(t),this.set(e,n),this},POP(e,t){let r=this.get(e);return r&&(r.count--,r.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:r}){let n={doc:e,d:t,meta:w5(r)},a=[v5(),b5(),j5()];a.forEach(({before:i})=>i==null?void 0:i(n)),a.forEach(({after:i})=>i==null?void 0:i(n))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});Gn.subscribe(()=>{let e=Gn.getSnapshot(),t=new Map;for(let[r]of e)t.set(r,r.documentElement.style.overflow);for(let r of e.values()){let n=t.get(r.doc)==="hidden",a=r.count!==0;(a&&!n||!a&&n)&&Gn.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&Gn.dispatch("TEARDOWN",r)}});function N5(e,t,r){let n=p5(Gn),a=e?n.get(e):void 0,i=a?a.count>0:!1;return Ut(()=>{if(!(!e||!t))return Gn.dispatch("PUSH",e,r),()=>Gn.dispatch("POP",e,r)},[t,e]),i}let Hd=new Map,Di=new Map;function Gx(e,t=!0){Ut(()=>{var r;if(!t)return;let n=typeof e=="function"?e():e.current;if(!n)return;function a(){var l;if(!n)return;let o=(l=Di.get(n))!=null?l:1;if(o===1?Di.delete(n):Di.set(n,o-1),o!==1)return;let c=Hd.get(n);c&&(c["aria-hidden"]===null?n.removeAttribute("aria-hidden"):n.setAttribute("aria-hidden",c["aria-hidden"]),n.inert=c.inert,Hd.delete(n))}let i=(r=Di.get(n))!=null?r:0;return Di.set(n,i+1),i!==0||(Hd.set(n,{"aria-hidden":n.getAttribute("aria-hidden"),inert:n.inert}),n.setAttribute("aria-hidden","true"),n.inert=!0),a},[e,t])}function k5({defaultContainers:e=[],portals:t,mainTreeNodeRef:r}={}){var n;let a=u.useRef((n=r==null?void 0:r.current)!=null?n:null),i=_i(a),l=Be(()=>{var o,c,d;let m=[];for(let h of e)h!==null&&(h instanceof HTMLElement?m.push(h):"current"in h&&h.current instanceof HTMLElement&&m.push(h.current));if(t!=null&&t.current)for(let h of t.current)m.push(h);for(let h of(o=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?o:[])h!==document.body&&h!==document.head&&h instanceof HTMLElement&&h.id!=="headlessui-portal-root"&&(h.contains(a.current)||h.contains((d=(c=a.current)==null?void 0:c.getRootNode())==null?void 0:d.host)||m.some(f=>h.contains(f))||m.push(h));return m});return{resolveContainers:l,contains:Be(o=>l().some(c=>c.contains(o))),mainTreeNodeRef:a,MainTreeNode:u.useMemo(()=>function(){return r!=null?null:Le.createElement(fm,{features:Nc.Hidden,ref:a})},[a,r])}}let Oh=u.createContext(()=>{});Oh.displayName="StackContext";var bm=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(bm||{});function S5(){return u.useContext(Oh)}function C5({children:e,onUpdate:t,type:r,element:n,enabled:a}){let i=S5(),l=Be((...o)=>{t==null||t(...o),i(...o)});return Ut(()=>{let o=a===void 0||a===!0;return o&&l(0,r,n),()=>{o&&l(1,r,n)}},[l,r,n,a]),Le.createElement(Oh.Provider,{value:l},e)}let db=u.createContext(null);function ub(){let e=u.useContext(db);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,ub),t}return e}function _5(){let[e,t]=u.useState([]);return[e.length>0?e.join(" "):void 0,u.useMemo(()=>function(r){let n=Be(i=>(t(l=>[...l,i]),()=>t(l=>{let o=l.slice(),c=o.indexOf(i);return c!==-1&&o.splice(c,1),o}))),a=u.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props}),[n,r.slot,r.name,r.props]);return Le.createElement(db.Provider,{value:a},r.children)},[t])]}let E5="p";function M5(e,t){let r=Wr(),{id:n=`headlessui-description-${r}`,...a}=e,i=ub(),l=ms(t);Ut(()=>i.register(n),[n,i.register]);let o={ref:l,...i.props,id:n};return ts({ourProps:o,theirProps:a,slot:i.slot||{},defaultTag:E5,name:i.name||"Description"})}let T5=Vt(M5),A5=Object.assign(T5,{});var R5=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(R5||{}),P5=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(P5||{});let $5={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},kc=u.createContext(null);kc.displayName="DialogContext";function Yl(e){let t=u.useContext(kc);if(t===null){let r=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Yl),r}return t}function L5(e,t,r=()=>[document.body]){N5(e,t,n=>{var a;return{containers:[...(a=n.containers)!=null?a:[],r]}})}function F5(e,t){return Dt(t.type,$5,e,t)}let I5="div",O5=hi.RenderStrategy|hi.Static;function D5(e,t){let r=Wr(),{id:n=`headlessui-dialog-${r}`,open:a,onClose:i,initialFocus:l,role:o="dialog",__demoMode:c=!1,...d}=e,[m,h]=u.useState(0),f=u.useRef(!1);o=function(){return o==="dialog"||o==="alertdialog"?o:(f.current||(f.current=!0,console.warn(`Invalid role [${o}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let j=Zc();a===void 0&&j!==null&&(a=(j&qt.Open)===qt.Open);let x=u.useRef(null),g=ms(x,t),y=_i(x),b=e.hasOwnProperty("open")||j!==null,p=e.hasOwnProperty("onClose");if(!b&&!p)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!b)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!p)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof a!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${a}`);if(typeof i!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${i}`);let v=a?0:1,[w,N]=u.useReducer(F5,{titleId:null,descriptionId:null,panelRef:u.createRef()}),A=Be(()=>i(!1)),z=Be(W=>N({type:0,id:W})),F=Ci()?c?!1:v===0:!1,Z=m>1,q=u.useContext(kc)!==null,[O,V]=s5(),J={get current(){var W;return(W=w.panelRef.current)!=null?W:x.current}},{resolveContainers:pe,mainTreeNodeRef:ke,MainTreeNode:we}=k5({portals:O,defaultContainers:[J]}),B=Z?"parent":"leaf",M=j!==null?(j&qt.Closing)===qt.Closing:!1,X=q||M?!1:F,Y=u.useCallback(()=>{var W,Q;return(Q=Array.from((W=y==null?void 0:y.querySelectorAll("body > *"))!=null?W:[]).find(H=>H.id==="headlessui-portal-root"?!1:H.contains(ke.current)&&H instanceof HTMLElement))!=null?Q:null},[ke]);Gx(Y,X);let ee=Z?!0:F,ie=u.useCallback(()=>{var W,Q;return(Q=Array.from((W=y==null?void 0:y.querySelectorAll("[data-headlessui-portal]"))!=null?W:[]).find(H=>H.contains(ke.current)&&H instanceof HTMLElement))!=null?Q:null},[ke]);Gx(ie,ee),Xy(pe,W=>{W.preventDefault(),A()},!(!F||Z));let ge=!(Z||v!==0);rb(y==null?void 0:y.defaultView,"keydown",W=>{ge&&(W.defaultPrevented||W.key===Ft.Escape&&(W.preventDefault(),W.stopPropagation(),A()))}),L5(y,!(M||v!==0||q),pe),u.useEffect(()=>{if(v!==0||!x.current)return;let W=new ResizeObserver(Q=>{for(let H of Q){let he=H.target.getBoundingClientRect();he.x===0&&he.y===0&&he.width===0&&he.height===0&&A()}});return W.observe(x.current),()=>W.disconnect()},[v,x,A]);let[R,ae]=_5(),je=u.useMemo(()=>[{dialogState:v,close:A,setTitleId:z},w],[v,w,A,z]),_=u.useMemo(()=>({open:v===0}),[v]),G={ref:g,id:n,role:o,"aria-modal":v===0?!0:void 0,"aria-labelledby":w.titleId,"aria-describedby":R};return Le.createElement(C5,{type:"Dialog",enabled:v===0,element:x,onUpdate:Be((W,Q)=>{Q==="Dialog"&&Dt(W,{[bm.Add]:()=>h(H=>H+1),[bm.Remove]:()=>h(H=>H-1)})})},Le.createElement(gm,{force:!0},Le.createElement(ym,null,Le.createElement(kc.Provider,{value:je},Le.createElement(ym.Group,{target:x},Le.createElement(gm,{force:!1},Le.createElement(ae,{slot:_,name:"Dialog.Description"},Le.createElement(Oi,{initialFocus:l,containers:pe,features:F?Dt(B,{parent:Oi.features.RestoreFocus,leaf:Oi.features.All&~Oi.features.FocusLock}):Oi.features.None},Le.createElement(V,null,ts({ourProps:G,theirProps:d,slot:_,defaultTag:I5,features:O5,visible:v===0,name:"Dialog"}))))))))),Le.createElement(we,null))}let z5="div";function U5(e,t){let r=Wr(),{id:n=`headlessui-dialog-overlay-${r}`,...a}=e,[{dialogState:i,close:l}]=Yl("Dialog.Overlay"),o=ms(t),c=Be(m=>{if(m.target===m.currentTarget){if(sb(m.currentTarget))return m.preventDefault();m.preventDefault(),m.stopPropagation(),l()}}),d=u.useMemo(()=>({open:i===0}),[i]);return ts({ourProps:{ref:o,id:n,"aria-hidden":!0,onClick:c},theirProps:a,slot:d,defaultTag:z5,name:"Dialog.Overlay"})}let H5="div";function B5(e,t){let r=Wr(),{id:n=`headlessui-dialog-backdrop-${r}`,...a}=e,[{dialogState:i},l]=Yl("Dialog.Backdrop"),o=ms(t);u.useEffect(()=>{if(l.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[l.panelRef]);let c=u.useMemo(()=>({open:i===0}),[i]);return Le.createElement(gm,{force:!0},Le.createElement(ym,null,ts({ourProps:{ref:o,id:n,"aria-hidden":!0},theirProps:a,slot:c,defaultTag:H5,name:"Dialog.Backdrop"})))}let q5="div";function W5(e,t){let r=Wr(),{id:n=`headlessui-dialog-panel-${r}`,...a}=e,[{dialogState:i},l]=Yl("Dialog.Panel"),o=ms(t,l.panelRef),c=u.useMemo(()=>({open:i===0}),[i]),d=Be(m=>{m.stopPropagation()});return ts({ourProps:{ref:o,id:n,onClick:d},theirProps:a,slot:c,defaultTag:q5,name:"Dialog.Panel"})}let K5="h2";function Q5(e,t){let r=Wr(),{id:n=`headlessui-dialog-title-${r}`,...a}=e,[{dialogState:i,setTitleId:l}]=Yl("Dialog.Title"),o=ms(t);u.useEffect(()=>(l(n),()=>l(null)),[n,l]);let c=u.useMemo(()=>({open:i===0}),[i]);return ts({ourProps:{ref:o,id:n},theirProps:a,slot:c,defaultTag:K5,name:"Dialog.Title"})}let V5=Vt(D5),G5=Vt(B5),Y5=Vt(W5),J5=Vt(U5),X5=Vt(Q5),Yx=Object.assign(V5,{Backdrop:G5,Panel:Y5,Overlay:J5,Title:X5,Description:A5}),Jx=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Xx(e){var t,r;let n=(t=e.innerText)!=null?t:"",a=e.cloneNode(!0);if(!(a instanceof HTMLElement))return n;let i=!1;for(let o of a.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),i=!0;let l=i?(r=a.innerText)!=null?r:"":n;return Jx.test(l)&&(l=l.replace(Jx,"")),l}function Z5(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let r=e.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(a=>{let i=document.getElementById(a);if(i){let l=i.getAttribute("aria-label");return typeof l=="string"?l.trim():Xx(i).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return Xx(e).trim()}function e4(e){let t=u.useRef(""),r=u.useRef("");return Be(()=>{let n=e.current;if(!n)return"";let a=n.innerText;if(t.current===a)return r.current;let i=Z5(n).trim().toLowerCase();return t.current=a,r.current=i,i})}var t4=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(t4||{}),s4=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(s4||{}),r4=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(r4||{});function Bd(e,t=r=>r){let r=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=Gy(t(e.items.slice()),i=>i.dataRef.current.domRef.current),a=r?n.indexOf(r):null;return a===-1&&(a=null),{items:n,activeItemIndex:a}}let n4={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var r;let n=Bd(e),a=Uk(t,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeItemIndex:a,activationTrigger:(r=t.trigger)!=null?r:1}},3:(e,t)=>{let r=e.searchQuery!==""?0:1,n=e.searchQuery+t.value.toLowerCase(),a=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(l=>{var o;return((o=l.dataRef.current.textValue)==null?void 0:o.startsWith(n))&&!l.dataRef.current.disabled}),i=a?e.items.indexOf(a):-1;return i===-1||i===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:i,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let r=Bd(e,n=>[...n,{id:t.id,dataRef:t.dataRef}]);return{...e,...r}},6:(e,t)=>{let r=Bd(e,n=>{let a=n.findIndex(i=>i.id===t.id);return a!==-1&&n.splice(a,1),n});return{...e,...r,activationTrigger:1}}},Dh=u.createContext(null);Dh.displayName="MenuContext";function ed(e){let t=u.useContext(Dh);if(t===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ed),r}return t}function a4(e,t){return Dt(t.type,n4,e,t)}let i4=u.Fragment;function l4(e,t){let{__demoMode:r=!1,...n}=e,a=u.useReducer(a4,{__demoMode:r,menuState:r?0:1,buttonRef:u.createRef(),itemsRef:u.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:i,itemsRef:l,buttonRef:o},c]=a,d=ms(t);Xy([o,l],(j,x)=>{var g;c({type:1}),Lh(x,$h.Loose)||(j.preventDefault(),(g=o.current)==null||g.focus())},i===0);let m=Be(()=>{c({type:1})}),h=u.useMemo(()=>({open:i===0,close:m}),[i,m]),f={ref:d};return Le.createElement(Dh.Provider,{value:a},Le.createElement(tb,{value:Dt(i,{0:qt.Open,1:qt.Closed})},ts({ourProps:f,theirProps:n,slot:h,defaultTag:i4,name:"Menu"})))}let o4="button";function c4(e,t){var r;let n=Wr(),{id:a=`headlessui-menu-button-${n}`,...i}=e,[l,o]=ed("Menu.Button"),c=ms(l.buttonRef,t),d=Vl(),m=Be(g=>{switch(g.key){case Ft.Space:case Ft.Enter:case Ft.ArrowDown:g.preventDefault(),g.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Js.First}));break;case Ft.ArrowUp:g.preventDefault(),g.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Js.Last}));break}}),h=Be(g=>{switch(g.key){case Ft.Space:g.preventDefault();break}}),f=Be(g=>{if(sb(g.currentTarget))return g.preventDefault();e.disabled||(l.menuState===0?(o({type:1}),d.nextFrame(()=>{var y;return(y=l.buttonRef.current)==null?void 0:y.focus({preventScroll:!0})})):(g.preventDefault(),o({type:0})))}),j=u.useMemo(()=>({open:l.menuState===0}),[l]),x={ref:c,id:a,type:Ak(e,l.buttonRef),"aria-haspopup":"menu","aria-controls":(r=l.itemsRef.current)==null?void 0:r.id,"aria-expanded":l.menuState===0,onKeyDown:m,onKeyUp:h,onClick:f};return ts({ourProps:x,theirProps:i,slot:j,defaultTag:o4,name:"Menu.Button"})}let d4="div",u4=hi.RenderStrategy|hi.Static;function m4(e,t){var r,n;let a=Wr(),{id:i=`headlessui-menu-items-${a}`,...l}=e,[o,c]=ed("Menu.Items"),d=ms(o.itemsRef,t),m=_i(o.itemsRef),h=Vl(),f=Zc(),j=f!==null?(f&qt.Open)===qt.Open:o.menuState===0;u.useEffect(()=>{let p=o.itemsRef.current;p&&o.menuState===0&&p!==(m==null?void 0:m.activeElement)&&p.focus({preventScroll:!0})},[o.menuState,o.itemsRef,m]),$k({container:o.itemsRef.current,enabled:o.menuState===0,accept(p){return p.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:p.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(p){p.setAttribute("role","none")}});let x=Be(p=>{var v,w;switch(h.dispose(),p.key){case Ft.Space:if(o.searchQuery!=="")return p.preventDefault(),p.stopPropagation(),c({type:3,value:p.key});case Ft.Enter:if(p.preventDefault(),p.stopPropagation(),c({type:1}),o.activeItemIndex!==null){let{dataRef:N}=o.items[o.activeItemIndex];(w=(v=N.current)==null?void 0:v.domRef.current)==null||w.click()}Vy(o.buttonRef.current);break;case Ft.ArrowDown:return p.preventDefault(),p.stopPropagation(),c({type:2,focus:Js.Next});case Ft.ArrowUp:return p.preventDefault(),p.stopPropagation(),c({type:2,focus:Js.Previous});case Ft.Home:case Ft.PageUp:return p.preventDefault(),p.stopPropagation(),c({type:2,focus:Js.First});case Ft.End:case Ft.PageDown:return p.preventDefault(),p.stopPropagation(),c({type:2,focus:Js.Last});case Ft.Escape:p.preventDefault(),p.stopPropagation(),c({type:1}),sr().nextFrame(()=>{var N;return(N=o.buttonRef.current)==null?void 0:N.focus({preventScroll:!0})});break;case Ft.Tab:p.preventDefault(),p.stopPropagation(),c({type:1}),sr().nextFrame(()=>{Ek(o.buttonRef.current,p.shiftKey?Ar.Previous:Ar.Next)});break;default:p.key.length===1&&(c({type:3,value:p.key}),h.setTimeout(()=>c({type:4}),350));break}}),g=Be(p=>{switch(p.key){case Ft.Space:p.preventDefault();break}}),y=u.useMemo(()=>({open:o.menuState===0}),[o]),b={"aria-activedescendant":o.activeItemIndex===null||(r=o.items[o.activeItemIndex])==null?void 0:r.id,"aria-labelledby":(n=o.buttonRef.current)==null?void 0:n.id,id:i,onKeyDown:x,onKeyUp:g,role:"menu",tabIndex:0,ref:d};return ts({ourProps:b,theirProps:l,slot:y,defaultTag:d4,features:u4,visible:j,name:"Menu.Items"})}let h4=u.Fragment;function x4(e,t){let r=Wr(),{id:n=`headlessui-menu-item-${r}`,disabled:a=!1,...i}=e,[l,o]=ed("Menu.Item"),c=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===n:!1,d=u.useRef(null),m=ms(t,d);Ut(()=>{if(l.__demoMode||l.menuState!==0||!c||l.activationTrigger===0)return;let N=sr();return N.requestAnimationFrame(()=>{var A,z;(z=(A=d.current)==null?void 0:A.scrollIntoView)==null||z.call(A,{block:"nearest"})}),N.dispose},[l.__demoMode,d,c,l.menuState,l.activationTrigger,l.activeItemIndex]);let h=e4(d),f=u.useRef({disabled:a,domRef:d,get textValue(){return h()}});Ut(()=>{f.current.disabled=a},[f,a]),Ut(()=>(o({type:5,id:n,dataRef:f}),()=>o({type:6,id:n})),[f,n]);let j=Be(()=>{o({type:1})}),x=Be(N=>{if(a)return N.preventDefault();o({type:1}),Vy(l.buttonRef.current)}),g=Be(()=>{if(a)return o({type:2,focus:Js.Nothing});o({type:2,focus:Js.Specific,id:n})}),y=Pk(),b=Be(N=>y.update(N)),p=Be(N=>{y.wasMoved(N)&&(a||c||o({type:2,focus:Js.Specific,id:n,trigger:0}))}),v=Be(N=>{y.wasMoved(N)&&(a||c&&o({type:2,focus:Js.Nothing}))}),w=u.useMemo(()=>({active:c,disabled:a,close:j}),[c,a,j]);return ts({ourProps:{id:n,ref:m,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,disabled:void 0,onClick:x,onFocus:g,onPointerEnter:b,onMouseEnter:b,onPointerMove:p,onMouseMove:p,onPointerLeave:v,onMouseLeave:v},theirProps:i,slot:w,defaultTag:h4,name:"Menu.Item"})}let f4=Vt(l4),g4=Vt(c4),p4=Vt(m4),y4=Vt(x4),zi=Object.assign(f4,{Button:g4,Items:p4,Item:y4});function b4(e=0){let[t,r]=u.useState(e),n=Gl(),a=u.useCallback(c=>{n.current&&r(d=>d|c)},[t,n]),i=u.useCallback(c=>!!(t&c),[t]),l=u.useCallback(c=>{n.current&&r(d=>d&~c)},[r,n]),o=u.useCallback(c=>{n.current&&r(d=>d^c)},[r]);return{flags:t,addFlag:a,hasFlag:i,removeFlag:l,toggleFlag:o}}function v4(e){let t={called:!1};return(...r)=>{if(!t.called)return t.called=!0,e(...r)}}function qd(e,...t){e&&t.length>0&&e.classList.add(...t)}function Wd(e,...t){e&&t.length>0&&e.classList.remove(...t)}function j4(e,t){let r=sr();if(!e)return r.dispose;let{transitionDuration:n,transitionDelay:a}=getComputedStyle(e),[i,l]=[n,a].map(c=>{let[d=0]=c.split(",").filter(Boolean).map(m=>m.includes("ms")?parseFloat(m):parseFloat(m)*1e3).sort((m,h)=>h-m);return d}),o=i+l;if(o!==0){r.group(d=>{d.setTimeout(()=>{t(),d.dispose()},o),d.addEventListener(e,"transitionrun",m=>{m.target===m.currentTarget&&d.dispose()})});let c=r.addEventListener(e,"transitionend",d=>{d.target===d.currentTarget&&(t(),c())})}else t();return r.add(()=>t()),r.dispose}function w4(e,t,r,n){let a=r?"enter":"leave",i=sr(),l=n!==void 0?v4(n):()=>{};a==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let o=Dt(a,{enter:()=>t.enter,leave:()=>t.leave}),c=Dt(a,{enter:()=>t.enterTo,leave:()=>t.leaveTo}),d=Dt(a,{enter:()=>t.enterFrom,leave:()=>t.leaveFrom});return Wd(e,...t.base,...t.enter,...t.enterTo,...t.enterFrom,...t.leave,...t.leaveFrom,...t.leaveTo,...t.entered),qd(e,...t.base,...o,...d),i.nextFrame(()=>{Wd(e,...t.base,...o,...d),qd(e,...t.base,...o,...c),j4(e,()=>(Wd(e,...t.base,...o),qd(e,...t.base,...t.entered),l()))}),i.dispose}function N4({immediate:e,container:t,direction:r,classes:n,onStart:a,onStop:i}){let l=Gl(),o=Vl(),c=Ir(r);Ut(()=>{e&&(c.current="enter")},[e]),Ut(()=>{let d=sr();o.add(d.dispose);let m=t.current;if(m&&c.current!=="idle"&&l.current)return d.dispose(),a.current(c.current),d.add(w4(m,n.current,c.current==="enter",()=>{d.dispose(),i.current(c.current)})),d.dispose},[r])}function Vr(e=""){return e.split(/\s+/).filter(t=>t.length>1)}let td=u.createContext(null);td.displayName="TransitionContext";var k4=(e=>(e.Visible="visible",e.Hidden="hidden",e))(k4||{});function S4(){let e=u.useContext(td);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function C4(){let e=u.useContext(sd);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let sd=u.createContext(null);sd.displayName="NestingContext";function rd(e){return"children"in e?rd(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function mb(e,t){let r=Ir(e),n=u.useRef([]),a=Gl(),i=Vl(),l=Be((j,x=pn.Hidden)=>{let g=n.current.findIndex(({el:y})=>y===j);g!==-1&&(Dt(x,{[pn.Unmount](){n.current.splice(g,1)},[pn.Hidden](){n.current[g].state="hidden"}}),i.microTask(()=>{var y;!rd(n)&&a.current&&((y=r.current)==null||y.call(r))}))}),o=Be(j=>{let x=n.current.find(({el:g})=>g===j);return x?x.state!=="visible"&&(x.state="visible"):n.current.push({el:j,state:"visible"}),()=>l(j,pn.Unmount)}),c=u.useRef([]),d=u.useRef(Promise.resolve()),m=u.useRef({enter:[],leave:[],idle:[]}),h=Be((j,x,g)=>{c.current.splice(0),t&&(t.chains.current[x]=t.chains.current[x].filter(([y])=>y!==j)),t==null||t.chains.current[x].push([j,new Promise(y=>{c.current.push(y)})]),t==null||t.chains.current[x].push([j,new Promise(y=>{Promise.all(m.current[x].map(([b,p])=>p)).then(()=>y())})]),x==="enter"?d.current=d.current.then(()=>t==null?void 0:t.wait.current).then(()=>g(x)):g(x)}),f=Be((j,x,g)=>{Promise.all(m.current[x].splice(0).map(([y,b])=>b)).then(()=>{var y;(y=c.current.shift())==null||y()}).then(()=>g(x))});return u.useMemo(()=>({children:n,register:o,unregister:l,onStart:h,onStop:f,wait:d,chains:m}),[o,l,n,h,f,m,d])}function _4(){}let E4=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Zx(e){var t;let r={};for(let n of E4)r[n]=(t=e[n])!=null?t:_4;return r}function M4(e){let t=u.useRef(Zx(e));return u.useEffect(()=>{t.current=Zx(e)},[e]),t}let T4="div",hb=hi.RenderStrategy;function A4(e,t){var r,n;let{beforeEnter:a,afterEnter:i,beforeLeave:l,afterLeave:o,enter:c,enterFrom:d,enterTo:m,entered:h,leave:f,leaveFrom:j,leaveTo:x,...g}=e,y=u.useRef(null),b=ms(y,t),p=(r=g.unmount)==null||r?pn.Unmount:pn.Hidden,{show:v,appear:w,initial:N}=S4(),[A,z]=u.useState(v?"visible":"hidden"),F=C4(),{register:Z,unregister:q}=F;u.useEffect(()=>Z(y),[Z,y]),u.useEffect(()=>{if(p===pn.Hidden&&y.current){if(v&&A!=="visible"){z("visible");return}return Dt(A,{hidden:()=>q(y),visible:()=>Z(y)})}},[A,y,Z,q,v,p]);let O=Ir({base:Vr(g.className),enter:Vr(c),enterFrom:Vr(d),enterTo:Vr(m),entered:Vr(h),leave:Vr(f),leaveFrom:Vr(j),leaveTo:Vr(x)}),V=M4({beforeEnter:a,afterEnter:i,beforeLeave:l,afterLeave:o}),J=Ci();u.useEffect(()=>{if(J&&A==="visible"&&y.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[y,A,J]);let pe=N&&!w,ke=w&&v&&N,we=!J||pe?"idle":v?"enter":"leave",B=b4(0),M=Be(ge=>Dt(ge,{enter:()=>{B.addFlag(qt.Opening),V.current.beforeEnter()},leave:()=>{B.addFlag(qt.Closing),V.current.beforeLeave()},idle:()=>{}})),X=Be(ge=>Dt(ge,{enter:()=>{B.removeFlag(qt.Opening),V.current.afterEnter()},leave:()=>{B.removeFlag(qt.Closing),V.current.afterLeave()},idle:()=>{}})),Y=mb(()=>{z("hidden"),q(y)},F),ee=u.useRef(!1);N4({immediate:ke,container:y,classes:O,direction:we,onStart:Ir(ge=>{ee.current=!0,Y.onStart(y,ge,M)}),onStop:Ir(ge=>{ee.current=!1,Y.onStop(y,ge,X),ge==="leave"&&!rd(Y)&&(z("hidden"),q(y))})});let ie=g,ne={ref:b};return ke?ie={...ie,className:wc(g.className,...O.current.enter,...O.current.enterFrom)}:ee.current&&(ie.className=wc(g.className,(n=y.current)==null?void 0:n.className),ie.className===""&&delete ie.className),Le.createElement(sd.Provider,{value:Y},Le.createElement(tb,{value:Dt(A,{visible:qt.Open,hidden:qt.Closed})|B.flags},ts({ourProps:ne,theirProps:ie,defaultTag:T4,features:hb,visible:A==="visible",name:"Transition.Child"})))}function R4(e,t){let{show:r,appear:n=!1,unmount:a=!0,...i}=e,l=u.useRef(null),o=ms(l,t);Ci();let c=Zc();if(r===void 0&&c!==null&&(r=(c&qt.Open)===qt.Open),![!0,!1].includes(r))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,m]=u.useState(r?"visible":"hidden"),h=mb(()=>{m("hidden")}),[f,j]=u.useState(!0),x=u.useRef([r]);Ut(()=>{f!==!1&&x.current[x.current.length-1]!==r&&(x.current.push(r),j(!1))},[x,r]);let g=u.useMemo(()=>({show:r,appear:n,initial:f}),[r,n,f]);u.useEffect(()=>{if(r)m("visible");else if(!rd(h))m("hidden");else{let v=l.current;if(!v)return;let w=v.getBoundingClientRect();w.x===0&&w.y===0&&w.width===0&&w.height===0&&m("hidden")}},[r,h]);let y={unmount:a},b=Be(()=>{var v;f&&j(!1),(v=e.beforeEnter)==null||v.call(e)}),p=Be(()=>{var v;f&&j(!1),(v=e.beforeLeave)==null||v.call(e)});return Le.createElement(sd.Provider,{value:h},Le.createElement(td.Provider,{value:g},ts({ourProps:{...y,as:u.Fragment,children:Le.createElement(xb,{ref:o,...y,...i,beforeEnter:b,beforeLeave:p})},theirProps:{},defaultTag:u.Fragment,features:hb,visible:d==="visible",name:"Transition"})))}function P4(e,t){let r=u.useContext(td)!==null,n=Zc()!==null;return Le.createElement(Le.Fragment,null,!r&&n?Le.createElement(vm,{ref:t,...e}):Le.createElement(xb,{ref:t,...e}))}let vm=Vt(R4),xb=Vt(A4),$4=Vt(P4),Ji=Object.assign(vm,{Child:$4,Root:vm});/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),F4=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),ef=e=>{const t=F4(e);return t.charAt(0).toUpperCase()+t.slice(1)},fb=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),I4=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var O4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=u.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...o},c)=>u.createElement("svg",{ref:c,...O4,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:fb("lucide",a),...!i&&!I4(o)&&{"aria-hidden":"true"},...o},[...l.map(([d,m])=>u.createElement(d,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=(e,t)=>{const r=u.forwardRef(({className:n,...a},i)=>u.createElement(D4,{ref:i,iconNode:t,className:fb(`lucide-${L4(ef(e))}`,`lucide-${e}`,n),...a}));return r.displayName=ef(e),r};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],gb=ue("archive",z4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],H4=ue("arrow-down",U4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],q4=ue("arrow-left",B4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]],Ui=ue("at-sign",W4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Q4=ue("book-open",K4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V4=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],G4=ue("bot",V4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y4=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],pb=ue("building-2",Y4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],X4=ue("building",J4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],yb=ue("calendar",Z4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],t3=ue("camera",e3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],jm=ue("check",s3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ws=ue("chevron-down",r3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Jl=ue("chevron-right",n3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],xi=ue("chevron-left",a3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ur=ue("chevron-up",i3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],oa=ue("circle-alert",l3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],lt=ue("circle-check-big",o3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],br=ue("circle-x",c3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],gr=ue("clipboard",d3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ys=ue("clock",u3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],h3=ue("cloud",m3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],bb=ue("code",x3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],vb=ue("copy",f3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],p3=ue("dollar-sign",g3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Sc=ue("download",y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],cl=ue("external-link",b3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],zh=ue("facebook",v3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],w3=ue("eye",j3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tf=ue("file-text",N3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],Wo=ue("file",k3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],C3=ue("funnel",S3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],sf=ue("git-merge",_3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Uh=ue("globe",E3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ot=ue("hash",M3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Cc=ue("image",T3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],jb=ue("inbox",A3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],wm=ue("info",R3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],Hh=ue("instagram",P3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],L3=ue("languages",$3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],wb=ue("loader-circle",F3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],rr=ue("mail",I3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],D3=ue("message-circle",O3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Br=ue("message-square",z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Nb=ue("package",U3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],St=ue("paperclip",H3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Bh=ue("pen",B3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],kb=ue("pencil",q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ba=ue("phone",W3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],nd=ue("plus",K3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Xi=ue("refresh-cw",Q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Sb=ue("rotate-ccw",V3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Y3=ue("ruler",G3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Xl=ue("save",J3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],fi=ue("search",X3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ad=ue("send",Z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gi=ue("settings",eS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],sS=ue("shield",tS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],dl=ue("shopping-bag",rS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],aS=ue("smile",nS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],er=ue("sparkles",iS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],oS=ue("star",lS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],_c=ue("sticky-note",cS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],Cb=ue("store",dS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],rf=ue("tag",uS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],hS=ue("ticket",mS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],pi=ue("trash-2",xS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],gS=ue("triangle-alert",fS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],_b=ue("upload",pS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Rl=ue("user-plus",yS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],yn=ue("user",bS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Zl=ue("users",vS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],_t=ue("x",jS);function wS({ticketCounts:e={all:0,myTickets:0,pending:0,unassigned:0,snoozed:0,resolved:0,escalated:0,escalatedToMe:0,vip:0,allAssigned:0,staffCounts:{}},isCollapsed:t,onToggle:r}){var R;const{data:n}=me({queryKey:["staff-list-sidebar"],queryFn:async()=>(await I.get("/api/staff")).data,staleTime:6e4}),a=(n==null?void 0:n.staff)||[],i=Fn(),l=jr(),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(!1),[j,x]=u.useState(!1),[g,y]=u.useState(!1),[b,p]=u.useState(!1),[v,w]=u.useState(!1),[N,A]=u.useState(!1),[z,F]=u.useState(!1),[Z,q]=u.useState(!1),[O,V]=u.useState(!1),[J,pe]=u.useState(!1),ke=ae=>i.pathname===ae,we=({title:ae,icon:je,isExpanded:_,onToggle:G,children:W,hasSubmenu:Q=!0})=>s.jsxs("div",{className:"mb-2",children:[s.jsxs("button",{onClick:G,className:"w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsxs("span",{className:"flex items-center text-gray-700 font-medium",children:[je,s.jsx("span",{className:je?"ml-2":"",children:ae})]}),Q&&(_?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"}))]}),_&&W&&s.jsx("div",{className:"ml-6 mt-1 space-y-1",children:W})]}),B=({to:ae,children:je,count:_})=>{const G=()=>{const[W,Q]=ae.split("?"),H=i.pathname,he=i.search;return Q?H===W&&he.includes(Q):H===W&&!he};return s.jsxs(Ye,{to:ae,preventScrollReset:!0,className:`flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${G()?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:je}),_!==void 0&&s.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-200 text-gray-700",children:_})]})},M=({to:ae,children:je})=>s.jsx(Ye,{to:ae,preventScrollReset:!0,className:`block px-3 py-1.5 text-sm rounded-lg transition-colors ${ke(ae)?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-500 hover:bg-gray-50 hover:text-gray-700"}`,children:je}),X=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),Y=()=>s.jsxs("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),ee=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),ie=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),ne=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),ge=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),$e=()=>s.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});return s.jsxs("div",{className:`bg-white border-r border-gray-200 h-screen flex flex-col transition-all duration-300 ${t?"w-16":"w-64"}`,children:[s.jsx("div",{className:"flex-shrink-0 h-14 flex items-center px-4 border-b border-gray-200",children:s.jsx("button",{onClick:r,className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:t?"Expand Navigation":"Collapse Navigation",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),t?s.jsxs("div",{className:"flex flex-col items-center py-4 space-y-3",children:[s.jsx("button",{onClick:()=>{r(),l("/tickets"),c(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname==="/tickets"||i.pathname.startsWith("/tickets/")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Tickets",children:s.jsx(X,{})}),s.jsx("button",{onClick:()=>{r(),l("/chat")},className:`p-2 rounded-lg transition-colors ${i.pathname==="/chat"?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"AI Chat",children:s.jsx(Y,{})}),s.jsx("button",{onClick:()=>{r(),l("/group-chat"),x(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/group-chat")||i.pathname==="/notifications"||i.pathname==="/mentions"?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Group Chat",children:s.jsx(ee,{})}),s.jsx("button",{onClick:()=>{r(),l("/staff"),f(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/staff")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Staff",children:s.jsx(ie,{})}),s.jsx("button",{onClick:()=>{r(),l("/customers"),m(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/customers")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Customers",children:s.jsx(ne,{})}),s.jsx("button",{onClick:()=>{r(),l("/analytics/ai-agent")},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/analytics")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Analytics",children:s.jsx(ge,{})}),s.jsx("button",{onClick:()=>{r(),l("/settings"),y(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/settings")||i.pathname.startsWith("/ai-agent")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Settings",children:s.jsx($e,{})})]}):s.jsxs("div",{className:"overflow-y-auto flex-1 p-3",children:[s.jsxs(we,{title:"Tickets",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),isExpanded:o,onToggle:()=>c(!o),children:[s.jsx(B,{to:"/tickets",count:e.all,children:"All Tickets"}),s.jsx(B,{to:"/tickets?filter=my",count:e.myTickets,children:"My Tickets"}),s.jsx(B,{to:"/tickets?status=open",count:e.pending,children:"Open (in-progress)"}),s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>p(!b),className:"w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx("span",{className:"text-gray-600",children:"Assigned"}),b?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),b&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(B,{to:"/tickets?filter=all-assigned",count:e.allAssigned,children:"All"}),a.filter(ae=>ae.id!=="ai-agent-001").map(ae=>{var je;return s.jsx(B,{to:`/tickets?assigned=${ae.id}`,count:((je=e.staffCounts)==null?void 0:je[ae.id])||0,children:ae.first_name},ae.id)}),s.jsx(B,{to:"/tickets?assigned=ai-agent-001",count:((R=e.staffCounts)==null?void 0:R["ai-agent-001"])||0,children:"McCarthy AI"})]})]}),s.jsx(B,{to:"/tickets?filter=unassigned",count:e.unassigned,children:"Unassigned"}),s.jsx(B,{to:"/tickets?status=snoozed",count:e.snoozed,children:"Snoozed"}),s.jsx(B,{to:"/tickets?filter=vip",count:e.vip,children:"VIP"}),s.jsx(B,{to:"/tickets?status=resolved",count:e.resolved,children:"Resolved"})]}),s.jsxs(Ye,{to:"/chat",className:`flex items-center px-3 py-2 mb-2 text-sm rounded-lg transition-colors ${ke("/chat")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[s.jsxs("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),"AI Chat"]}),s.jsxs(we,{title:"Group Chat",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),isExpanded:j,onToggle:()=>x(!j),children:[s.jsx(M,{to:"/group-chat",children:"All Chats"}),s.jsx(M,{to:"/mentions",children:"@Mentions"}),s.jsx(M,{to:"/memo",children:"@Memos"}),s.jsx(M,{to:"/tags",children:"Tags"})]}),s.jsx(we,{title:"Staff",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),isExpanded:h,onToggle:()=>f(!h),children:s.jsx(M,{to:"/staff",children:"List"})}),s.jsxs(we,{title:"Customers",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),isExpanded:d,onToggle:()=>m(!d),children:[s.jsx(M,{to:"/customers",children:"All Customers"}),s.jsx(M,{to:"/customers/vip",children:"VIP Customers"})]}),s.jsxs(Ye,{to:"/analytics/ai-agent",className:`flex items-center px-3 py-2 mb-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/analytics")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics"]}),s.jsxs(we,{title:"Settings",icon:s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),isExpanded:g,onToggle:()=>y(!g),children:[s.jsx(M,{to:"/settings/dartmouth-os",children:"Dartmouth OS"}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>V(!O),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/business")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Business"}),O?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),O&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(M,{to:"/settings/business-hours",children:"Operational Hours"}),s.jsx(M,{to:"/settings/auto-assignment",children:"Auto-Assignment"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>pe(!J),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/ai-agent")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"AI Agent"}),J?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),J&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(M,{to:"/ai-agent/widget",children:"Widget & Embed"}),s.jsx(M,{to:"/ai-agent/knowledge",children:"RAG Knowledge"}),s.jsx(M,{to:"/ai-agent/system-message",children:"System Message"}),s.jsx(M,{to:"/ai-agent/regional-overrides",children:"Regional Overrides"})]})]}),s.jsx(M,{to:"/settings/group-chat",children:"Group Chat"}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>w(!v),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/integrations")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Integrations"}),v?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),v&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(M,{to:"/settings/integrations/perp",children:"Print ERP"}),s.jsx(M,{to:"/settings/integrations/shopify",children:"Shopify"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>A(!N),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/meta")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Meta"}),N?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),N&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(M,{to:"/settings/meta/facebook",children:"Facebook"}),s.jsx(M,{to:"/settings/meta/instagram",children:"Instagram"}),s.jsx(M,{to:"/settings/meta/messenger",children:"Messenger"}),s.jsx(M,{to:"/settings/meta/whatsapp",children:"WhatsApp"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>F(!z),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/general")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"General"}),z?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),z&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(M,{to:"/settings/general/auth",children:"Auth & Security"}),s.jsx(M,{to:"/settings/email",children:"Email"}),s.jsx(M,{to:"/settings/general/templates",children:"Templates"}),s.jsx(M,{to:"/settings/tags",children:"Tags"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>q(!Z),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/billing")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Billing"}),Z?s.jsx(ur,{className:"w-4 h-4 text-gray-400"}):s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),Z&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(M,{to:"/settings/billing/subscription",children:"Subscription"}),s.jsx(M,{to:"/settings/billing/transactions",children:"Transactions"})]})]})]})]})]})}function NS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const nf=u.forwardRef(NS);function kS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const SS=u.forwardRef(kS);function CS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const _S=u.forwardRef(CS);function ES({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const MS=u.forwardRef(ES);function TS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const AS=u.forwardRef(TS);function RS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const PS=u.forwardRef(RS);function $S({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Nm=u.forwardRef($S);function LS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const km=u.forwardRef(LS);function FS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Sm=u.forwardRef(FS);function IS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Ko=u.forwardRef(IS);function OS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const DS=u.forwardRef(OS);function zS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const US=u.forwardRef(zS);function HS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const BS=u.forwardRef(HS);function qS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"}))}const WS=u.forwardRef(qS);function KS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const QS=u.forwardRef(KS);function VS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const GS=u.forwardRef(VS);function YS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const JS=u.forwardRef(YS),Kd={online:{color:"bg-green-500",ringColor:"ring-green-400",label:"Online"},away:{color:"bg-yellow-500",ringColor:"ring-yellow-400",label:"Away"},offline:{color:"bg-gray-400",ringColor:"ring-gray-400",label:"Offline"}};function XS(){var d,m,h,f,j,x;const e=jr(),{user:t,logout:r}=us(),n=mt(),{data:a}=me({queryKey:["currentStaff"],queryFn:()=>rt.me().then(g=>g.data.staff),enabled:!!t,refetchInterval:3e4}),i=Ce({mutationFn:g=>rt.updateAvailability((t==null?void 0:t.id)||"",g),onSuccess:()=>{n.invalidateQueries({queryKey:["currentStaff"]})}}),l=(a==null?void 0:a.availability_status)||"offline",o=Kd[l],c=()=>{r(),e("/login")};return s.jsxs(zi,{as:"div",className:"relative",children:[s.jsxs(zi.Button,{className:"flex items-center gap-2 rounded-lg p-1.5 hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${o.color}`}),l==="online"&&s.jsx("div",{className:`absolute inset-0 w-2.5 h-2.5 rounded-full ${o.color} animate-ping opacity-50`})]}),s.jsx("div",{className:"relative",children:a!=null&&a.avatar_url?s.jsx("img",{src:rt.getAvatarUrl(a.avatar_url)||"",alt:`${a.first_name} ${a.last_name}`,className:"w-8 h-8 rounded-full object-cover"}):s.jsxs("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-sm font-semibold",children:[((d=a==null?void 0:a.first_name)==null?void 0:d[0])||((m=t==null?void 0:t.firstName)==null?void 0:m[0])||"U",((h=a==null?void 0:a.last_name)==null?void 0:h[0])||((f=t==null?void 0:t.lastName)==null?void 0:f[0])||""]})})]}),s.jsx(Ji,{as:u.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:s.jsxs(zi.Items,{className:"absolute right-0 mt-2 w-64 origin-top-right rounded-xl bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:[s.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center gap-3",children:[a!=null&&a.avatar_url?s.jsx("img",{src:rt.getAvatarUrl(a.avatar_url)||"",alt:`${a.first_name} ${a.last_name}`,className:"w-10 h-10 rounded-full object-cover"}):s.jsxs("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:[(j=a==null?void 0:a.first_name)==null?void 0:j[0],(x=a==null?void 0:a.last_name)==null?void 0:x[0]]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:a==null?void 0:a.email})]})]})}),s.jsxs("div",{className:"px-2 py-2 border-b border-gray-100",children:[s.jsx("p",{className:"px-2 py-1 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),Object.keys(Kd).map(g=>{const y=Kd[g],b=g===l;return s.jsxs("button",{onClick:()=>i.mutate(g),disabled:i.isPending,className:`w-full flex items-center gap-3 px-2 py-2 rounded-lg text-left transition-colors ${b?"bg-indigo-50 text-indigo-700":"hover:bg-gray-50 text-gray-700"}`,children:[s.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${y.color}`}),s.jsx("span",{className:"text-sm font-medium flex-1",children:y.label}),b&&s.jsx(Nm,{className:"w-4 h-4 text-indigo-600"})]},g)})]}),s.jsx("div",{className:"px-2 py-2",children:s.jsx(zi.Item,{children:({active:g})=>s.jsxs("button",{onClick:()=>e("/account"),className:`${g?"bg-gray-50":""} flex items-center gap-3 w-full px-2 py-2 text-sm text-gray-700 rounded-lg`,children:[s.jsx(GS,{className:"w-5 h-5 text-gray-400"}),"My Account"]})})}),s.jsx("div",{className:"px-2 py-2 border-t border-gray-100",children:s.jsx(zi.Item,{children:({active:g})=>s.jsxs("button",{onClick:c,className:`${g?"bg-red-50":""} flex items-center gap-3 w-full px-2 py-2 text-sm text-red-600 rounded-lg`,children:[s.jsx(SS,{className:"w-5 h-5"}),"Sign Out"]})})})]})})]})}const ZS=[{name:"Tickets",href:"/tickets",icon:WS},{name:"Mentions",href:"/mentions",icon:MS},{name:"Task Digest",href:"/task-digest",icon:km},{name:"Settings",href:"/settings",icon:Ko}];function e6(){const[e,t]=u.useState(!1),[r,n]=u.useState(!0),a=Fn(),{user:i}=us(),{data:l}=me({queryKey:["tickets-all"],queryFn:async()=>(await Ie.list({limit:1e3})).data.tickets,refetchInterval:3e4}),o=l||[];console.log("DashboardLayout - All tickets:",o.map(d=>({id:d.ticket_number,assigned:d.assigned_to,status:d.status,channel:d.channel})));const c={all:o.filter(d=>d.status!=="resolved"&&d.status!=="closed").length,myTickets:o.filter(d=>(d.assigned_to===(i==null?void 0:i.id)||d.is_escalated_to_me===1)&&d.status!=="resolved"&&d.status!=="closed").length,pending:o.filter(d=>(d.status==="open"||d.status==="in-progress")&&d.assigned_to&&d.assigned_to!==null&&d.status!=="resolved"&&d.status!=="closed").length,unassigned:o.filter(d=>(!d.assigned_to||d.assigned_to===null)&&d.status!=="resolved"&&d.status!=="closed").length,snoozed:o.filter(d=>d.status==="snoozed").length,resolved:o.filter(d=>d.status==="resolved"||d.status==="closed").length,escalated:o.filter(d=>d.has_escalation===1).length,escalatedToMe:o.filter(d=>d.is_escalated_to_me===1).length,vip:o.filter(d=>d.vip===1&&d.status!=="resolved"&&d.status!=="closed").length,allAssigned:o.filter(d=>d.assigned_to&&d.assigned_to!==null&&d.status!=="resolved"&&d.status!=="closed").length,staffCounts:o.filter(d=>d.assigned_to&&d.status!=="resolved"&&d.status!=="closed").reduce((d,m)=>(d[m.assigned_to]=(d[m.assigned_to]||0)+1,d),{})};return console.log("DashboardLayout - Staff counts:",c.staffCounts),console.log("DashboardLayout - McCarthy AI count:",c.staffCounts["ai-agent-001"]),u.useEffect(()=>{const d=m=>{(m.ctrlKey||m.metaKey)&&m.key==="b"&&(m.preventDefault(),n(h=>!h))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[]),s.jsxs("div",{children:[s.jsx(Ji.Root,{show:e,as:u.Fragment,children:s.jsxs(Yx,{as:"div",className:"relative z-50 lg:hidden",onClose:t,children:[s.jsx(Ji.Child,{as:u.Fragment,enter:"transition-opacity ease-linear duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity ease-linear duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"fixed inset-0 bg-gray-900/80"})}),s.jsx("div",{className:"fixed inset-0 flex",children:s.jsx(Ji.Child,{as:u.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"-translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",children:s.jsxs(Yx.Panel,{className:"relative mr-16 flex w-full max-w-xs flex-1",children:[s.jsx(Ji.Child,{as:u.Fragment,enter:"ease-in-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"absolute left-full top-0 flex w-16 justify-center pt-5",children:s.jsxs("button",{type:"button",className:"-m-2.5 p-2.5",onClick:()=>t(!1),children:[s.jsx("span",{className:"sr-only",children:"Close sidebar"}),s.jsx(JS,{className:"h-6 w-6 text-white","aria-hidden":"true"})]})})}),s.jsxs("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-white px-6 pb-2",children:[s.jsx("div",{className:"flex h-16 shrink-0 items-center",children:s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"CS Dashboard"})}),s.jsx("nav",{className:"flex flex-1 flex-col",children:s.jsx("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:s.jsx("li",{children:s.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:ZS.map(d=>{const m=a.pathname.startsWith(d.href);return s.jsx("li",{children:s.jsxs(Ye,{to:d.href,className:af(m?"bg-gray-50 text-primary-600":"text-gray-700 hover:text-primary-600 hover:bg-gray-50","group flex gap-x-3 rounded-md p-2 text-sm leading-6 font-semibold"),children:[s.jsx(d.icon,{className:af(m?"text-primary-600":"text-gray-400 group-hover:text-primary-600","h-6 w-6 shrink-0"),"aria-hidden":"true"}),d.name]})},d.name)})})})})})]})]})})})]})}),s.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:flex-col",children:s.jsx(wS,{ticketCounts:c,isCollapsed:r,onToggle:()=>n(!r)})}),s.jsx("div",{className:`fixed top-0 right-0 z-40 transition-all duration-300 ${r?"lg:left-16":"lg:left-64"} left-0`,children:s.jsxs("div",{className:"flex items-center justify-between h-14 px-4 bg-white border-b border-gray-200 shadow-sm",children:[s.jsxs("button",{type:"button",className:"-m-2.5 p-2.5 text-gray-700 lg:hidden",onClick:()=>t(!0),children:[s.jsx("span",{className:"sr-only",children:"Open sidebar"}),s.jsx(_S,{className:"h-6 w-6","aria-hidden":"true"})]}),s.jsx("div",{className:"hidden lg:block"}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsx(XS,{})})]})}),s.jsx("main",{className:`transition-all duration-300 pt-14 ${r?"lg:pl-16":"lg:pl-64"}`,children:s.jsx(W1,{})})]})}function af(...e){return e.filter(Boolean).join(" ")}function Wt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function t6(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const _o=43200,lf=1440;let s6={};function r6(){return s6}function of(e){const t=Wt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Qo(e,t){const r=Wt(e),n=Wt(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function n6(e){return t6(e,Date.now())}function a6(e,t){const r=Wt(e),n=Wt(t),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}function i6(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function l6(e,t){return+Wt(e)-+Wt(t)}function o6(e){const t=Wt(e);return t.setHours(23,59,59,999),t}function c6(e){const t=Wt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function d6(e){const t=Wt(e);return+o6(t)==+c6(t)}function u6(e,t){const r=Wt(e),n=Wt(t),a=Qo(r,n),i=Math.abs(a6(r,n));let l;if(i<1)l=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let o=Qo(r,n)===-a;d6(Wt(e))&&i===1&&Qo(e,n)===1&&(o=!1),l=a*(i-Number(o))}return l===0?0:l}function m6(e,t,r){const n=l6(e,t)/1e3;return i6(r==null?void 0:r.roundingMethod)(n)}const h6={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},x6=(e,t,r)=>{let n;const a=h6[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Qd(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const f6={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},g6={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},p6={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},y6={date:Qd({formats:f6,defaultWidth:"full"}),time:Qd({formats:g6,defaultWidth:"full"}),dateTime:Qd({formats:p6,defaultWidth:"full"})},b6={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},v6=(e,t,r,n)=>b6[e];function Hi(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;a=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[l]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const j6={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},w6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},N6={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},k6={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},S6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},C6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_6=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},E6={ordinalNumber:_6,era:Hi({values:j6,defaultWidth:"wide"}),quarter:Hi({values:w6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Hi({values:N6,defaultWidth:"wide"}),day:Hi({values:k6,defaultWidth:"wide"}),dayPeriod:Hi({values:S6,defaultWidth:"wide",formattingValues:C6,defaultFormattingWidth:"wide"})};function Bi(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const l=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?T6(o,h=>h.test(l)):M6(o,h=>h.test(l));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const m=t.slice(l.length);return{value:d,rest:m}}}function M6(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function T6(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function A6(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let l=e.valueCallback?e.valueCallback(i[0]):i[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(a.length);return{value:l,rest:o}}}const R6=/^(\d+)(th|st|nd|rd)?/i,P6=/\d+/i,$6={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},L6={any:[/^b/i,/^(a|c)/i]},F6={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},I6={any:[/1/i,/2/i,/3/i,/4/i]},O6={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},D6={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},z6={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},U6={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},H6={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},B6={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},q6={ordinalNumber:A6({matchPattern:R6,parsePattern:P6,valueCallback:e=>parseInt(e,10)}),era:Bi({matchPatterns:$6,defaultMatchWidth:"wide",parsePatterns:L6,defaultParseWidth:"any"}),quarter:Bi({matchPatterns:F6,defaultMatchWidth:"wide",parsePatterns:I6,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Bi({matchPatterns:O6,defaultMatchWidth:"wide",parsePatterns:D6,defaultParseWidth:"any"}),day:Bi({matchPatterns:z6,defaultMatchWidth:"wide",parsePatterns:U6,defaultParseWidth:"any"}),dayPeriod:Bi({matchPatterns:H6,defaultMatchWidth:"any",parsePatterns:B6,defaultParseWidth:"any"})},W6={code:"en-US",formatDistance:x6,formatLong:y6,formatRelative:v6,localize:E6,match:q6,options:{weekStartsOn:0,firstWeekContainsDate:1}};function K6(e,t,r){const n=r6(),a=(r==null?void 0:r.locale)??n.locale??W6,i=2520,l=Qo(e,t);if(isNaN(l))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:l});let c,d;l>0?(c=Wt(t),d=Wt(e)):(c=Wt(e),d=Wt(t));const m=m6(d,c),h=(of(d)-of(c))/1e3,f=Math.round((m-h)/60);let j;if(f<2)return r!=null&&r.includeSeconds?m<5?a.formatDistance("lessThanXSeconds",5,o):m<10?a.formatDistance("lessThanXSeconds",10,o):m<20?a.formatDistance("lessThanXSeconds",20,o):m<40?a.formatDistance("halfAMinute",0,o):m<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):f===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",f,o);if(f<45)return a.formatDistance("xMinutes",f,o);if(f<90)return a.formatDistance("aboutXHours",1,o);if(f<lf){const x=Math.round(f/60);return a.formatDistance("aboutXHours",x,o)}else{if(f<i)return a.formatDistance("xDays",1,o);if(f<_o){const x=Math.round(f/lf);return a.formatDistance("xDays",x,o)}else if(f<_o*2)return j=Math.round(f/_o),a.formatDistance("aboutXMonths",j,o)}if(j=u6(d,c),j<12){const x=Math.round(f/_o);return a.formatDistance("xMonths",x,o)}else{const x=j%12,g=Math.trunc(j/12);return x<3?a.formatDistance("aboutXYears",g,o):x<9?a.formatDistance("overXYears",g,o):a.formatDistance("almostXYears",g+1,o)}}function ys(e,t){return K6(e,n6(e),t)}function Eb({isOpen:e,onClose:t,onReassign:r,currentAssignment:n,bulkMode:a,selectedTickets:i}){const[l,o]=u.useState(""),[c,d]=u.useState(""),[m,h]=u.useState([]),{data:f}=me({queryKey:["staff-list"],queryFn:async()=>{var v;return((v=(await I.get("/api/staff")).data)==null?void 0:v.staff)||[]},enabled:e}),{data:j}=me({queryKey:["tickets-for-reassign"],queryFn:async()=>{var v;return((v=(await Ie.list({limit:1e3})).data)==null?void 0:v.tickets)||[]},enabled:e});if(u.useEffect(()=>{if(f&&j){const p=f.map(v=>{const w=j.filter(N=>N.assigned_to===v.id&&(N.status==="open"||N.status==="in-progress")).length;return{id:v.id,name:`${v.first_name} ${v.last_name}`,role:v.title||"Staff",online:v.availability_status==="online",availability_status:v.availability_status||"offline",openTickets:w}});h(p)}},[f,j]),u.useEffect(()=>{e&&(o(""),d(""))},[e]),!e)return null;const g=m.filter(p=>p.online).length===1,y=()=>{if(l){if(l==="unassigned")r(null,"Unassigned",c||void 0);else{const p=m.find(v=>v.id===l);p&&r(p.id,p.name,c||void 0)}t()}},b=a&&i?i.length:1;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a?`Reassign ${b} Ticket${b>1?"s":""}`:"Reassign Ticket"})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[a&&i&&i.length>0?s.jsxs("div",{className:"mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Reassign the following ticket",b>1?"s":""," to another staff member:"]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 max-h-32 overflow-y-auto",children:s.jsx("ul",{className:"space-y-1",children:i.map(p=>s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"font-medium text-gray-900",children:p.ticket_number}),s.jsxs("span",{className:"text-gray-500 truncate",children:["- ",p.subject]})]},p.ticket_id))})})]}):s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reassign ticket #",n||"Unassigned"," to another staff member:"]}),g&&s.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),s.jsxs("div",{className:"space-y-2",children:[m.filter(p=>p.id==="ai-agent-001").map(p=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l===p.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:p.id,checked:l===p.id,onChange:v=>o(v.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-green-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[s.jsx(er,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Return to AI handling"})]}),s.jsx("div",{className:"text-right min-w-[60px]",children:s.jsxs("p",{className:"text-xs text-gray-500",children:[p.openTickets," open"]})})]},p.id)),m.filter(p=>p.id!=="ai-agent-001").map(p=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l===p.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:p.id,checked:l===p.id,onChange:v=>o(v.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${p.availability_status==="online"?"bg-green-500":p.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.name}),s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:p.availability_status||"Offline"})]}),s.jsx("div",{className:"text-right min-w-[60px]",children:s.jsxs("p",{className:"text-xs text-gray-500",children:[p.openTickets," open"]})})]},p.id))]}),s.jsx("div",{className:"mt-2",children:s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l==="unassigned"?"border-amber-500 bg-amber-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:"unassigned",checked:l==="unassigned",onChange:p=>o(p.target.value),className:"h-4 w-4 text-amber-600 focus:ring-amber-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-gray-400"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Remove Assignment"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Ticket will be unassigned"})]})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),s.jsx("textarea",{value:c,onChange:p=>d(p.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:y,disabled:!l,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:a?`Reassign ${b} Ticket${b>1?"s":""}`:"Reassign Ticket"})]})]})})}function Mb({isOpen:e,onClose:t,parentTaskId:r,parentTaskNumber:n}){const a=mt(),{user:i}=us(),[l,o]=u.useState("email"),[c,d]=u.useState(""),[m,h]=u.useState(""),[f,j]=u.useState(""),[x,g]=u.useState(""),[y,b]=u.useState(""),[p,v]=u.useState(""),[w,N]=u.useState("normal"),[A,z]=u.useState(""),[F,Z]=u.useState(""),[q,O]=u.useState("17"),[V,J]=u.useState("00");u.useEffect(()=>{i!=null&&i.id&&z(i.id)},[i==null?void 0:i.id,l]);const{data:pe}=me({queryKey:["staff-users"],queryFn:async()=>(await rt.list()).data}),ke=(pe==null?void 0:pe.staff)||[],we=Ce({mutationFn:async ne=>(await Ie.createManual(ne)).data,onSuccess:()=>{a.invalidateQueries({queryKey:["tickets"]}),t(),B()}}),B=()=>{d(""),h(""),j(""),g(""),b(""),v(""),N("normal"),Z(""),O("17"),J("00"),i!=null&&i.id&&z(i.id)},M=ne=>{ne.preventDefault();let ge=null;Y==="task"&&F&&(ge=`${F}T${q}:${V}:00`);let $e=(x==null?void 0:x.trim())||null;$e&&$e.startsWith("@")&&($e=`TKT-${$e.substring(1)}`),we.mutate({customer_name:c||(Y==="task"?"Internal Task":""),customer_email:m||(Y==="task"?"task@internal":""),customer_phone:f,subject:y,message:p,channel:Y,priority:w,assign_to:A==="auto"?null:A,related_ticket:$e,deadline:ge,parent_task_id:r||null})};if(!e)return null;const X=!!r,Y=X?"task":l,ee=Array.from({length:24},(ne,ge)=>ge.toString().padStart(2,"0")),ie=["00","15","30","45"];return s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),s.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:s.jsxs("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:X?`Create Sub-Task for ${n}`:Y==="email"?"Create Email Ticket":"Create Task"}),s.jsx("button",{onClick:t,className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",children:s.jsx(_t,{className:"h-6 w-6"})})]}),!X&&s.jsxs("div",{className:"flex border-b border-gray-200 mb-4",children:[s.jsxs("button",{type:"button",onClick:()=>o("email"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors ${l==="email"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(rr,{className:"w-4 h-4 text-gray-500"}),"Email"]}),s.jsxs("button",{type:"button",onClick:()=>o("task"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors ${l==="task"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(gr,{className:"w-4 h-4 text-gray-500"}),"Task"]})]}),s.jsxs("form",{onSubmit:M,className:"space-y-4",children:[Y==="email"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700",children:"Customer Name *"}),s.jsx("input",{type:"text",id:"customerName",required:!0,value:c,onChange:ne=>d(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"John Smith"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerEmail",className:"block text-sm font-medium text-gray-700",children:"Customer Email *"}),s.jsx("input",{type:"email",id:"customerEmail",required:!0,value:m,onChange:ne=>h(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"john@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerPhone",className:"block text-sm font-medium text-gray-700",children:"Customer Phone"}),s.jsx("input",{type:"tel",id:"customerPhone",value:f,onChange:ne=>j(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"0412 345 678"})]})]})]}),Y==="task"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700",children:"Customer (optional)"}),s.jsx("input",{type:"text",id:"customerName",value:c,onChange:ne=>d(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"Customer name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"relatedTicket",className:"block text-sm font-medium text-gray-700",children:"Ticket Number (optional)"}),s.jsx("input",{type:"text",id:"relatedTicket",value:x,onChange:ne=>g(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"TKT-123 or @123"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deadline (optional)"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",value:F,onChange:ne=>Z(ne.target.value),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("select",{value:q,onChange:ne=>O(ne.target.value),className:"w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-2 py-2 border",children:ee.map(ne=>s.jsx("option",{value:ne,children:ne},ne))}),s.jsx("span",{className:"text-gray-500 font-medium",children:":"}),s.jsx("select",{value:V,onChange:ne=>J(ne.target.value),className:"w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-2 py-2 border",children:ie.map(ne=>s.jsx("option",{value:ne,children:ne},ne))})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700",children:"Priority *"}),s.jsxs("select",{id:"priority",value:w,onChange:ne=>N(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",children:[s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"normal",children:"Normal"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"urgent",children:"Urgent"}),s.jsx("option",{value:"critical",children:"Critical"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"assignTo",className:"block text-sm font-medium text-gray-700",children:"Assign To"}),s.jsxs("select",{id:"assignTo",value:A,onChange:ne=>z(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",children:[ke.filter(ne=>ne.id!=="ai-agent-001").map(ne=>s.jsxs("option",{value:ne.id,children:[ne.first_name," ",ne.last_name]},ne.id)),s.jsx("option",{value:"ai-agent-001",children:"McCarthy AI"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700",children:Y==="email"?"Subject *":"Task Subject Title *"}),s.jsx("input",{type:"text",id:"subject",required:!0,value:y,onChange:ne=>b(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:Y==="email"?"Order status inquiry":"Update shipping info for order #12345"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:Y==="email"?"Email Message *":"Task Description *"}),s.jsx("textarea",{id:"message",required:!0,rows:6,value:p,onChange:ne=>v(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:Y==="email"?"Your email message to the customer...":"Describe what needs to be done..."})]}),Y==="email"&&s.jsxs("div",{className:"rounded-md bg-blue-50 p-3 flex items-center gap-2",children:[s.jsx(rr,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),s.jsx("p",{className:"text-sm text-blue-800",children:"This will send an email to the customer and create a ticket."})]}),we.isError&&s.jsx("div",{className:"rounded-md bg-red-50 p-4",children:s.jsxs("p",{className:"text-sm text-red-800",children:["Failed to create ",Y==="email"?"ticket":"task",". Please try again."]})}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:we.isPending,className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",children:we.isPending?"Creating...":Y==="email"?"Send Email & Create Ticket":"Create Task"})]})]})]})})]})})}const Vd=[{value:"all",label:"All Platforms",icon:null},{value:"email",label:"Email",icon:rr},{value:"chat",label:"Live Chat",icon:Br},{value:"phone",label:"Phone",icon:ba},{value:"whatsapp",label:"WhatsApp",icon:Br},{value:"instagram",label:"Instagram",icon:Hh},{value:"facebook",label:"Messenger",icon:zh}];function Q6({value:e,onChange:t}){const[r,n]=u.useState(!1),a=u.useRef(null),i=Vd.find(o=>o.value===e)||Vd[0],l=i.icon;return u.useEffect(()=>{function o(c){a.current&&!a.current.contains(c.target)&&n(!1)}return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]),s.jsxs("div",{className:"relative",ref:a,children:[s.jsxs("button",{type:"button",onClick:()=>n(!r),className:"w-full flex items-center justify-between gap-2 rounded-lg border-2 border-gray-300 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[l&&s.jsx(l,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{children:i.label})]}),s.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),r&&s.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-lg border border-gray-200 bg-white shadow-lg",children:Vd.map(o=>{const c=o.icon;return s.jsxs("button",{type:"button",onClick:()=>{t(o.value),n(!1)},className:`w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${o.value===e?"bg-indigo-50 text-indigo-700":"text-gray-700"}`,children:[c&&s.jsx(c,{className:"w-4 h-4"}),s.jsx("span",{children:o.label})]},o.value)})})]})}const cf={open:"bg-green-50 text-green-700 ring-green-600/20",pending:"bg-yellow-50 text-yellow-700 ring-yellow-600/20","in-progress":"bg-blue-50 text-blue-700 ring-blue-600/20",resolved:"bg-gray-50 text-gray-700 ring-gray-600/20",closed:"bg-gray-50 text-gray-700 ring-gray-600/20",snoozed:"bg-purple-50 text-purple-700 ring-purple-600/20"},V6=({platform:e,className:t="w-4 h-4"})=>{switch(e){case"task":return s.jsx(gr,{className:`${t} text-amber-600`});case"chat":return s.jsx(Br,{className:`${t} text-indigo-500`});case"phone":return s.jsx(ba,{className:`${t} text-red-500`});case"whatsapp":return s.jsx(Br,{className:`${t} text-green-600`});case"facebook":return s.jsx(zh,{className:`${t} text-blue-600`});case"instagram":return s.jsx(Hh,{className:`${t} text-pink-500`});case"email":default:return s.jsx(rr,{className:`${t} text-gray-500`})}},df={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},uf={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},G6={positive:"",neutral:"",negative:"",angry:""},Gd={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson","00000000-0000-0000-0000-000000000004":"Gaille Hutchison","ai-agent-001":"McCarthy AI"},Y6=e=>{const t=e.match(/^([A-Z]+)-?(\d+)-(\d+)$/);if(t){const l=t[1],o=parseInt(t[2],10),c=parseInt(t[3],10);return`${l}-${o}-${c}`}const r=e.match(/^([A-Z]+)-?/),n=e.match(/\d+/);if(!n)return e;const a=r?r[1]:"TKT",i=parseInt(n[0],10);return`${a}-${i}`};function J6(){const[e]=Bl(),{user:t}=us(),[r,n]=u.useState("all"),[a,i]=u.useState("all"),[l,o]=u.useState("created_at"),[c,d]=u.useState("desc"),[m,h]=u.useState("all"),[f,j]=u.useState("all"),[x,g]=u.useState("all"),[y,b]=u.useState("all"),[p,v]=u.useState(!1),[w,N]=u.useState(!1),[A,z]=u.useState(""),[F,Z]=u.useState([]),[q,O]=u.useState(!1),[V,J]=u.useState(!1),[pe,ke]=u.useState(!1),[we,B]=u.useState(!1),[M,X]=u.useState(!1),[Y,ee]=u.useState(!1);u.useEffect(()=>{const _=e.get("filter"),G=e.get("assigned"),W=e.get("status"),Q=()=>{n("all"),b("all"),i("all"),h("all"),j("all"),g("all"),v(!1)};W==="open"?(Q(),n("open-in-progress")):W==="resolved"?(Q(),n("resolved")):W==="snoozed"?(Q(),n("snoozed")):_==="my"?(Q(),b((t==null?void 0:t.id)||"00000000-0000-0000-0000-000000000001")):_==="vip"?(Q(),v(!0)):_==="unassigned"?(Q(),b("unassigned")):_==="all-escalated"?(Q(),b("all-escalated")):_==="all-assigned"?(Q(),b("all-assigned")):G==="ted"?(Q(),b("00000000-0000-0000-0000-000000000002")):G==="sam"?(Q(),b("00000000-0000-0000-0000-000000000003")):G?(Q(),b(G)):!_&&!W&&!G&&Q()},[e,t==null?void 0:t.id]),u.useEffect(()=>{const _=e.get("search");_&&(z(_),N(!0))},[e]);const{data:ie,isLoading:ne}=me({queryKey:["tickets-all"],queryFn:async()=>{const _={limit:1e3};return(await Ie.list(_)).data.tickets},refetchInterval:3e4});u.useEffect(()=>{if(A.trim()&&ie&&ie.length>0){const _=A.trim();let G=ie.filter(W=>{if(!W.ticket_number)return!1;const Q=W.ticket_number.toLowerCase(),H=_.toLowerCase();if(Q===H)return!0;const he=W.ticket_number.replace(/\D/g,"").replace(/^0+/,""),ze=_.replace(/\D/g,"").replace(/^0+/,"");return!!(he===ze&&ze.length>0||Q.includes(H))});if(G.length===1&&G[0].id){const W=G[0];console.log("[TicketsPage] Auto-navigating to ticket:",W.ticket_number,W.id),setTimeout(()=>{window.location.href=`/tickets/${W.id}`},1e3)}else G.length===0?console.log("[TicketsPage] No tickets found for search:",_):G.length>1&&console.log("[TicketsPage] Multiple tickets found:",G.length,"- showing list")}},[A,ie]);const{data:ge}=me({queryKey:["staff-list"],queryFn:async()=>(await I.get("/api/staff")).data,staleTime:6e4}),$e=(ge==null?void 0:ge.staff)||[];if(ne)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading tickets..."})});let R=ie||[];if(r==="open-in-progress"?R=R.filter(_=>_.status==="open"||_.status==="in-progress"||_.status==="pending"):r==="snoozed"?R=R.filter(_=>_.status==="snoozed"):r==="resolved"?R=R.filter(_=>_.status==="resolved"||_.status==="closed"):R=R.filter(_=>_.status!=="resolved"&&_.status!=="closed"),y!=="all"&&(y==="unassigned"?R=R.filter(_=>!_.assigned_to||_.assigned_to===null):y==="all-assigned"?R=R.filter(_=>_.assigned_to&&_.assigned_to!==null):y==="all-escalated"?R=R.filter(_=>_.has_escalation===1):y==="resolved"?R=(ie||[]).filter(_=>_.status==="resolved"||_.status==="closed"):R=R.filter(_=>_.assigned_to===y||_.is_escalated_to_me===1)),p&&(R=R.filter(_=>_.vip===1)),a!=="all"&&(R=R.filter(_=>_.priority===a)),m!=="all"&&(R=R.filter(_=>_.sentiment===m)),f!=="all"&&(R=R.filter(_=>_.channel===f)),x!=="all"){const _=new Date;let G;x==="today"?G=new Date(_.getFullYear(),_.getMonth(),_.getDate()):x==="week"?G=new Date(_.getTime()-7*24*60*60*1e3):x==="month"?G=new Date(_.getTime()-30*24*60*60*1e3):G=new Date(0),R=R.filter(W=>new Date(W.created_at)>=G)}if(A.trim()){const _=A.trim();if(/^(TKT-|TSK-)?[\d,\s-]+$/.test(_)){const W=_.replace(/TKT-/gi,"").replace(/TSK-/gi,"").split(",").map(Q=>Q.trim().replace(/\D/g,"")).filter(Q=>Q.length>0);R=R.filter(Q=>{var he;const H=((he=Q.ticket_number)==null?void 0:he.replace(/\D/g,"").replace(/^0+/,""))||"";return W.some(ze=>{var le;const be=ze.replace(/^0+/,"");return H===be||H.endsWith(be)||((le=Q.ticket_number)==null?void 0:le.toLowerCase().includes(ze.toLowerCase()))})})}else{const W=_.toLowerCase();R=R.filter(Q=>{var H,he,ze,be,le;return((H=Q.ticket_number)==null?void 0:H.toLowerCase().includes(W))||((he=Q.customer_name)==null?void 0:he.toLowerCase().includes(W))||((ze=Q.customer_email)==null?void 0:ze.toLowerCase().includes(W))||((be=Q.subject)==null?void 0:be.toLowerCase().includes(W))||((le=Q.description)==null?void 0:le.toLowerCase().includes(W))})}}const ae=_=>{l===_?d(c==="asc"?"desc":"asc"):(o(_),d("asc"))};R=R.sort((_,G)=>{var H,he,ze,be;let W=_[l],Q=G[l];return l==="created_at"?(W=new Date(_.created_at).getTime(),Q=new Date(G.created_at).getTime()):l==="customer_name"?(W=((H=_.customer_name)==null?void 0:H.toLowerCase())||"",Q=((he=G.customer_name)==null?void 0:he.toLowerCase())||""):l==="subject"?(W=((ze=_.subject)==null?void 0:ze.toLowerCase())||"",Q=((be=G.subject)==null?void 0:be.toLowerCase())||""):l==="assigned_to"&&(W=Gd[_.assigned_to]||"Unassigned",Q=Gd[G.assigned_to]||"Unassigned"),c==="asc"?W>Q?1:W<Q?-1:0:W<Q?1:W>Q?-1:0});const je=()=>{if(y===(t==null?void 0:t.id))return"My Tickets";if(y==="unassigned")return"Unassigned";if(y==="all-escalated")return" All Escalated Tickets";if(y==="all-assigned")return"All Assigned";if(y==="ai-agent-001")return"McCarthy AI";const _=$e.find(G=>G.id===y);return _?`${_.first_name} ${_.last_name}`:r==="snoozed"?"Snoozed":r==="resolved"?"Resolved":r==="open-in-progress"?"Open (in-progress)":p?"VIP":"All Tickets"};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"sticky top-0 z-10 bg-white pb-4 -mx-6 px-6 -mt-6 pt-6 border-b border-gray-200 mb-4",children:[s.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[s.jsxs("div",{className:"sm:flex-auto",children:[s.jsxs("h1",{className:"text-2xl font-semibold leading-6 text-gray-900 flex items-center gap-3",children:[je(),s.jsx("span",{className:"inline-flex items-center rounded-full bg-indigo-100 px-3 py-1 text-sm font-semibold text-indigo-700 ring-1 ring-inset ring-indigo-600/20",children:R.length}),s.jsx("button",{onClick:()=>N(!w),className:`p-1.5 rounded-lg transition-colors ${w?"bg-indigo-100 text-indigo-600":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,title:"Search tickets",children:s.jsx(fi,{className:"w-5 h-5"})})]}),s.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"A list of all customer service tickets including their status, priority, and assignment."})]}),s.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:s.jsxs("button",{type:"button",onClick:()=>B(!0),className:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:[s.jsx(nd,{className:"w-4 h-4"}),"Create Ticket"]})})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[s.jsxs("select",{value:y,onChange:_=>{const G=_.target.value;b(G),v(G==="vip")},className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Tickets"}),s.jsx("option",{value:(t==null?void 0:t.id)||"",children:"My Tickets"}),$e.filter(_=>_.id!=="ai-agent-001"&&_.id!==(t==null?void 0:t.id)).map(_=>s.jsxs("option",{value:_.id,children:[_.first_name," ",_.last_name]},_.id)),s.jsx("option",{value:"ai-agent-001",children:"McCarthy AI"}),s.jsx("option",{value:"all-assigned",children:"Assigned All"}),s.jsx("option",{value:"unassigned",children:"Unassigned"}),s.jsx("option",{value:"resolved",children:"Resolved"})]}),s.jsx(Q6,{value:f,onChange:j}),s.jsxs("select",{value:r,onChange:_=>n(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"open-in-progress",children:"Open (in-progress)"}),s.jsx("option",{value:"snoozed",children:"Snoozed"}),s.jsx("option",{value:"resolved",children:"Resolved"})]}),s.jsxs("select",{value:a,onChange:_=>i(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Priorities"}),s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"normal",children:"Normal"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"urgent",children:"Urgent"}),s.jsx("option",{value:"critical",children:"Critical"})]}),s.jsxs("select",{value:m,onChange:_=>h(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Sentiments"}),s.jsx("option",{value:"positive",children:" Positive"}),s.jsx("option",{value:"neutral",children:" Neutral"}),s.jsx("option",{value:"negative",children:" Negative"}),s.jsx("option",{value:"angry",children:" Angry"})]}),s.jsxs("select",{value:x,onChange:_=>g(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Time"}),s.jsx("option",{value:"today",children:"Today"}),s.jsx("option",{value:"week",children:"This Week"}),s.jsx("option",{value:"month",children:"This Month"})]})]}),w&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsxs("div",{className:"relative flex-1 max-w-lg",children:[s.jsx(fi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:A,onChange:_=>z(_.target.value),placeholder:"Search by ticket #, name, email, description... or enter ticket numbers: 112, 119, 122",className:"w-full pl-10 pr-10 py-2 rounded-lg border-2 border-indigo-300 text-sm focus:border-indigo-500 focus:ring-indigo-500 bg-white",autoFocus:!0}),A&&s.jsx("button",{onClick:()=>z(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-4 h-4"})})]}),s.jsx("button",{onClick:()=>{N(!1),z("")},className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Close"})]}),F.length>0&&(()=>{const _=F.map(Q=>R.find(H=>H.ticket_id===Q)).filter(Boolean),G=new Set(_.map(Q=>Q==null?void 0:Q.customer_email)),W=F.length>=2&&G.size===1;return s.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-indigo-50 border border-indigo-200 rounded-lg px-4 py-2",children:[s.jsxs("span",{className:"text-sm font-medium text-indigo-700 mr-2",children:[F.length," ticket",F.length>1?"s":""," selected"]}),F.length>=2&&s.jsxs("button",{onClick:()=>W?O(!0):alert("Can only merge tickets from the same customer email address"),className:`flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg ${W?"text-white bg-indigo-600 hover:bg-indigo-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,title:W?"Merge selected tickets":"Can only merge tickets from the same customer email",children:[s.jsx(sf,{className:"w-4 h-4"}),s.jsx("span",{children:"Merge"}),!W&&s.jsx("span",{className:"text-xs",children:"(different emails)"})]}),s.jsxs("button",{onClick:()=>ke(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),s.jsx("span",{children:"Reassign"})]}),(t==null?void 0:t.role)==="admin"&&s.jsxs("button",{onClick:()=>X(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg",children:[s.jsx(pi,{className:"w-4 h-4"}),s.jsx("span",{children:"Delete"})]}),s.jsx("button",{onClick:()=>Z([]),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-white rounded-lg border border-gray-300",children:"Clear"})]})})()]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg",children:s.jsxs("table",{className:"w-full divide-y divide-gray-300",style:{tableLayout:"fixed"},children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"py-3.5 w-14 text-center",children:s.jsx("input",{type:"checkbox",checked:F.length>0&&F.length===R.length,onChange:_=>{_.target.checked?Z(R.map(G=>G.ticket_id)):Z([])},className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"})}),s.jsx("th",{scope:"col",className:"py-3.5 pl-2 pr-2 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100 whitespace-nowrap",onClick:()=>ae("ticket_number"),style:{width:"9%",minWidth:"90px"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Ticket #",l==="ticket_number"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("created_at"),style:{width:"10%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Created",l==="created_at"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("customer_name"),style:{width:"14%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Customer",l==="customer_name"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("subject"),style:{width:"22%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Subject",l==="subject"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("priority"),style:{width:"8%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Priority",l==="priority"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("status"),style:{width:"9%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Status",l==="status"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("assigned_to"),style:{width:"10%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Assignment",l==="assigned_to"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 pr-2 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("sentiment"),style:{width:"10%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Sentiment",l==="sentiment"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:R.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:10,className:"py-8 text-center text-sm text-gray-500",children:"No tickets found"})}):R.map(_=>{let G;if(_.channel==="chat")G=`/chat-ticket/${_.ticket_id}`;else{const he=new URLSearchParams;p?he.set("filter","vip"):y!=="all"&&y!=="vip"&&he.set("from",y),G=he.toString()?`/tickets/${_.ticket_id}?${he.toString()}`:`/tickets/${_.ticket_id}`}const W=_.has_escalation===1?"bg-orange-50":_.status==="snoozed"?"bg-purple-100":_.merged_from?"bg-cyan-50":"",Q=F.includes(_.ticket_id),H=F.indexOf(_.ticket_id);return s.jsxs("tr",{className:`${W} ${Q?"bg-indigo-50":""}`,children:[s.jsxs("td",{className:"py-3 w-14 text-center relative",children:[s.jsx("input",{type:"checkbox",checked:Q,onChange:he=>{he.target.checked?Z([...F,_.ticket_id]):Z(F.filter(ze=>ze!==_.ticket_id))},className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),Q&&H===0&&s.jsx("span",{className:"absolute -right-1 top-1/2 -translate-y-1/2 text-xs font-bold text-indigo-600",title:"Primary ticket (will be kept)",children:""})]}),s.jsx("td",{className:"py-3 pl-2 pr-2 text-sm font-medium",children:s.jsxs(Ye,{to:G,className:"text-indigo-600 hover:text-indigo-900 font-medium flex items-center gap-1.5",children:[s.jsx(V6,{platform:_.channel||"email",className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{className:"text-xs whitespace-nowrap",children:Y6(_.ticket_number)})]})}),s.jsxs("td",{className:"px-2 py-3 text-sm text-gray-500",children:[s.jsx("div",{className:"text-xs truncate",children:new Date(_.created_at).toLocaleString()}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:ys(new Date(_.created_at),{addSuffix:!0})})]}),s.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:s.jsx(Ye,{to:`/tickets?customer=${encodeURIComponent(_.customer_email)}`,className:"block hover:bg-gray-50 -m-1 p-1 rounded transition-colors",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-900 hover:text-indigo-600 font-medium text-xs truncate",children:_.customer_name}),_.vip===1&&s.jsx("span",{className:"text-yellow-500 text-xs flex-shrink-0",title:"VIP Customer",children:""})]}),s.jsx("div",{className:"text-gray-500 hover:text-indigo-500 text-xs truncate",children:_.customer_email})]})})}),s.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:s.jsx("div",{className:"truncate text-xs",children:_.subject||_.description||"No subject"})}),s.jsx("td",{className:"px-2 py-3 text-sm",children:s.jsx("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${df[_.priority]||df.normal}`,children:_.priority})}),s.jsx("td",{className:"px-2 py-3 text-sm",children:s.jsxs("div",{className:"relative inline-block",children:[s.jsx("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${cf[_.status]||cf.open}`,children:_.status}),_.is_escalated_to_me===1&&s.jsx("span",{className:"absolute -top-1 -right-1 text-xs leading-none",title:"Escalated - You've been asked for help",children:""})]})}),s.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:_.assigned_to?s.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-1.5 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 truncate",children:Gd[_.assigned_to]||_.assigned_staff_name||_.assigned_to}):s.jsx("span",{className:"inline-flex items-center rounded-md bg-gray-50 px-1.5 py-0.5 text-xs font-medium text-gray-500 ring-1 ring-inset ring-gray-300",children:"Unassigned"})}),s.jsx("td",{className:"px-2 py-3 pr-2 text-sm",children:s.jsxs("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${uf[_.sentiment]||uf.neutral}`,children:[G6[_.sentiment]||""," ",_.sentiment||"neutral"]})})]},_.ticket_id)})})]})})}),q&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:s.jsx(sf,{className:"w-6 h-6 text-indigo-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Merge Tickets"})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["You are about to merge ",s.jsxs("span",{className:"font-semibold",children:[F.length," tickets"]})," into one."]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Tickets to merge:"}),s.jsx("ul",{className:"space-y-1",children:F.map((_,G)=>{const W=R.find(Q=>Q.ticket_id===_);return s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[G===0?s.jsx("span",{className:"text-xs font-bold text-indigo-600 bg-indigo-100 px-1.5 py-0.5 rounded",children:"PRIMARY"}):s.jsx("span",{className:"text-xs text-gray-400 bg-gray-200 px-1.5 py-0.5 rounded",children:"merge"}),s.jsx("span",{className:"font-medium",children:W==null?void 0:W.ticket_number}),s.jsxs("span",{className:"text-gray-500 truncate",children:["- ",W==null?void 0:W.subject]})]},_)})})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:s.jsxs("p",{className:"text-xs text-yellow-800",children:[s.jsx("strong",{children:"What will happen:"}),s.jsx("br",{})," All messages will be merged into the PRIMARY ticket in chronological order",s.jsx("br",{})," Secondary tickets will be closed with a note",s.jsx("br",{})," This action cannot be undone"]})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>O(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:V,children:"Cancel"}),s.jsx("button",{onClick:async()=>{var _,G;J(!0);try{const[W,...Q]=F;await Ie.merge(W,Q),O(!1),Z([]),window.location.reload()}catch(W){console.error("Failed to merge tickets:",W),alert(`Failed to merge tickets: ${((G=(_=W.response)==null?void 0:_.data)==null?void 0:G.error)||W.message||"Unknown error"}`)}finally{J(!1)}},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",disabled:V,children:V?"Merging...":"Merge Tickets"})]})]})}),s.jsx(Eb,{isOpen:pe,onClose:()=>ke(!1),onReassign:async(_,G,W)=>{var Q,H;try{await Ie.bulkAssign(F,_),W&&console.log("Bulk reassignment reason:",W),ke(!1),Z([]),window.location.reload()}catch(he){console.error("Failed to reassign tickets:",he),alert(`Failed to reassign tickets: ${((H=(Q=he.response)==null?void 0:Q.data)==null?void 0:H.error)||he.message||"Unknown error"}`)}},bulkMode:!0,selectedTickets:F.map(_=>{const G=R.find(W=>W.ticket_id===_);return{ticket_id:_,ticket_number:(G==null?void 0:G.ticket_number)||"",subject:(G==null?void 0:G.subject)||""}})}),M&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:s.jsx(pi,{className:"w-6 h-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Tickets"})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Are you sure you want to delete ",s.jsxs("span",{className:"font-semibold",children:[F.length," ticket",F.length>1?"s":""]}),"?"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 max-h-48 overflow-y-auto",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Tickets to delete:"}),s.jsx("ul",{className:"space-y-1",children:F.map(_=>{const G=R.find(W=>W.ticket_id===_);return s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"font-medium text-red-600",children:G==null?void 0:G.ticket_number}),s.jsxs("span",{className:"text-gray-500 truncate",children:["- ",G==null?void 0:G.subject]})]},_)})})]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsxs("p",{className:"text-xs text-red-800",children:[s.jsx("strong",{children:" Warning:"})," This action cannot be undone. All selected tickets and their messages will be permanently deleted."]})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>X(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:Y,children:"Cancel"}),s.jsx("button",{onClick:async()=>{var _,G;ee(!0);try{for(const W of F)await Ie.delete(W);X(!1),Z([]),window.location.reload()}catch(W){console.error("Failed to delete tickets:",W),alert(`Failed to delete tickets: ${((G=(_=W.response)==null?void 0:_.data)==null?void 0:G.error)||W.message||"Unknown error"}`)}finally{ee(!1)}},className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50",disabled:Y,children:Y?"Deleting...":`Delete ${F.length} Ticket${F.length>1?"s":""}`})]})]})}),s.jsx(Mb,{isOpen:we,onClose:()=>B(!1)})]})}const X6=["open","pending","in-progress","resolved","closed","escalated"];function Z6({currentStatus:e,onClose:t,onSave:r}){const[n,a]=u.useState(e),[i,l]=u.useState(!1),o=async()=>{l(!0);try{await r(n),t()}catch(c){console.error("Failed to update status:",c),alert("Failed to update status")}finally{l(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Change Status"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"space-y-2",children:X6.map(c=>s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"radio",value:c,checked:n===c,onChange:d=>a(d.target.value),className:"text-indigo-600"}),s.jsx("span",{className:"capitalize",children:c})]},c))}),s.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:o,disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:i?"Saving...":"Save"})]})]})})}const mf=[{id:"00000000-0000-0000-0000-000000000001",name:"John Hutchison",role:"Admin",online:!0},{id:"00000000-0000-0000-0000-000000000002",name:"Ted Smith",role:"Team Lead",online:!1},{id:"00000000-0000-0000-0000-000000000003",name:"Sam Johnson",role:"Manager",online:!1}];function eC({isOpen:e,onClose:t,onConfirm:r,ticketNumber:n}){const[a,i]=u.useState(""),[l,o]=u.useState("");if(!e)return null;const c=h=>{const f=mf.find(j=>j.id===h);if(f){i(h);const j=f.name.split(" ")[0];o(x=>{const g=x.replace(/@\w+\s*/g,"").trim();return g?`@${j} ${g}`:`@${j} `})}},d=()=>{!a||!l.trim()||(r("escalation",[a],l),i(""),o(""),t())},m=()=>{i(""),o(""),t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Escalate Ticket #",n]})]})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Request assistance from other staff members to help resolve this ticket."}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Notify Staff Members: ",s.jsx("span",{className:"text-gray-500 font-normal",children:"(Select one or more)"})]}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3",children:mf.map(h=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${a===h.id?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"escalate-staff",value:h.id,checked:a===h.id,onChange:()=>c(h.id),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${h.online?"bg-green-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:h.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[h.role,"  ",h.online?"Online":"Offline"]})]})]},h.id))}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[a?"1":"0"," staff member selected"]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Your Message: ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:l,onChange:h=>o(h.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"@mention message asking for help or advice on this ticket..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will be sent as an @mention linked to this ticket"})]}),s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex",children:[s.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Note:"}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Selected staff will receive an alert notification and this will appear in their @mentions with higher priority (at the top, in a different color)."})]})]})})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:d,disabled:!a||!l.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send Escalation"})]})]})})}const hf=[{id:"30-mins",title:"30 Minutes",description:"Quick snooze - resume in 30 mins",value:"30m"},{id:"later-today",title:"Later Today",description:"Resume in 3 hours",value:"3h"},{id:"tomorrow",title:"Tomorrow",description:"Next business day at 9:00 AM",value:"1d"},{id:"this-week",title:"This Week",description:"Friday at 9:00 AM",value:"friday"},{id:"next-week",title:"Next Week",description:"Following Monday at 9:00 AM",value:"1w"},{id:"custom",title:"Custom Date & Time",description:"Pick specific date and time",value:"custom"}];function tC({isOpen:e,onClose:t,onConfirm:r,onRemoveSnooze:n,ticketNumber:a,isSnoozed:i}){const[l,o]=u.useState(""),[c,d]=u.useState("");if(!e)return null;const m=()=>{if(!l)return;if(l==="custom"&&!c){alert("Please select a custom date and time");return}const f=hf.find(j=>j.id===l);f&&r(f.value,l==="custom"?c:void 0),o(""),d(""),t()},h=()=>{o(""),d(""),t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Snooze Ticket #",a]})]})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Temporarily hide this ticket and automatically resume it later."}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Snooze until:"}),s.jsx("div",{className:"space-y-2",children:hf.map(f=>s.jsxs("div",{children:[s.jsxs("label",{className:`flex items-start p-4 border rounded-lg cursor-pointer transition-colors ${l===f.id?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"snooze",value:f.id,checked:l===f.id,onChange:j=>o(j.target.value),className:"mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),s.jsxs("div",{className:"ml-3 flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:f.title}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:f.description})]})]}),f.id==="custom"&&l==="custom"&&s.jsxs("div",{className:"mt-2 ml-7 p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Select Date & Time:"}),s.jsx("input",{type:"datetime-local",value:c,onChange:j=>d(j.target.value),min:new Date().toISOString().slice(0,16),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]},f.id))})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-between gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:m,disabled:!l||l==="custom"&&!c,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Snooze Ticket"}),i&&n&&s.jsx("button",{onClick:()=>{n(),h()},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:"Remove Snooze"})]})]})]})})}function sC({isOpen:e,onClose:t,onConfirm:r}){const[n,a]=u.useState(""),[i,l]=u.useState("09"),[o,c]=u.useState("00"),d=()=>{const x=new Date,g=x.getFullYear(),y=(x.getMonth()+1).toString().padStart(2,"0"),b=x.getDate().toString().padStart(2,"0");return`${g}-${y}-${b}`},m=()=>{const g=new Date().getHours()+1;return g>=24?"09":g.toString().padStart(2,"0")};if(u.useEffect(()=>{e&&(a(d()),l(m()),c("00"))},[e]),!e)return null;const h=()=>{if(!n||!i||!o){alert("Please select date and time");return}const x=`${i}:${o}`;r(n,x),t()},f=()=>{t()},j=d();return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Reply"})]}),s.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Schedule when this message will be sent to the customer. Scheduled messages are only visible to staff until the scheduled time."}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),s.jsx("input",{type:"date",value:n,onChange:x=>a(x.target.value),min:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("select",{value:i,onChange:x=>l(x.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:24},(x,g)=>{const y=g.toString().padStart(2,"0");return s.jsx("option",{value:y,children:y},y)})}),s.jsx("span",{className:"flex items-center text-gray-500 font-semibold",children:":"}),s.jsx("select",{value:o,onChange:x=>c(x.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:60},(x,g)=>{const y=g.toString().padStart(2,"0");return s.jsx("option",{value:y,children:y},y)})})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Note:"})," This message will be sent automatically at the scheduled time during business hours (9 AM - 6 PM)."]})})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200",children:[s.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:h,disabled:!n,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Schedule Reply"})]})]})})}function rC({isOpen:e,onClose:t,onConfirm:r,onRemove:n,message:a}){const[i,l]=u.useState(""),[o,c]=u.useState(""),[d,m]=u.useState("09"),[h,f]=u.useState("00");if(u.useEffect(()=>{if(e&&a){l(a.content);const y=new Date(a.scheduled_for);c(y.toISOString().split("T")[0]),m(y.getHours().toString().padStart(2,"0")),f(y.getMinutes().toString().padStart(2,"0"))}},[e,a]),!e)return null;const j=()=>{if(!i.trim()){alert("Message content cannot be empty");return}if(!o){alert("Please select a date");return}const y=`${d}:${h}`;r(i,o,y),t()},x=()=>{l(""),c(""),m("09"),f("00"),t()},g=new Date().toISOString().split("T")[0];return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Scheduled Message"})]}),s.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Edit the message content and scheduled time for this reply."}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Content"}),s.jsx("textarea",{value:i,onChange:y=>l(y.target.value),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none",placeholder:"Enter your message..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Date"}),s.jsx("input",{type:"date",value:o,onChange:y=>c(y.target.value),min:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Time"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("select",{value:d,onChange:y=>m(y.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:24},(y,b)=>{const p=b.toString().padStart(2,"0");return s.jsx("option",{value:p,children:p},p)})}),s.jsx("span",{className:"flex items-center text-gray-500 font-semibold",children:":"}),s.jsx("select",{value:h,onChange:y=>f(y.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:60},(y,b)=>{const p=b.toString().padStart(2,"0");return s.jsx("option",{value:p,children:p},p)})})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Note:"})," This message will be sent automatically at the scheduled time."]})})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-between gap-3 border-t border-gray-200",children:[s.jsx("button",{onClick:x,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:j,disabled:!i.trim()||!o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Changes"}),n&&s.jsx("button",{onClick:()=>{confirm("Are you sure you want to remove this scheduled message? It will not be sent.")&&(n(),x())},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:"Remove"})]})]})]})})}const nC=({draft:e,loading:t,onApprove:r,onEdit:n,onReject:a})=>{const[i,l]=u.useState(!1),[o,c]=u.useState(""),[d,m]=u.useState(""),[h,f]=u.useState(!1),[j,x]=u.useState(!1);if(t)return s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(er,{className:"w-5 h-5 text-blue-500 animate-pulse"}),s.jsx("span",{className:"text-gray-600",children:"AI is analyzing this ticket..."})]})});if(!e)return null;const g=Math.round(e.confidence_score*100),y=g>=85?"text-green-600 bg-green-50":g>=70?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",b=async()=>{x(!0);try{await r()}finally{x(!1)}},p=async()=>{if(!i){c(e.draft_content),l(!0);return}x(!0);try{await n(o),l(!1)}finally{x(!1)}},v=async()=>{x(!0);try{await a(d),f(!1),m("")}finally{x(!1)}};return s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg shadow-lg p-6 border-2 border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(er,{className:"w-6 h-6 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Draft Response"}),s.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y}`,children:[g,"% Confidence"]})]}),e.processing_time_ms&&e.processing_time_ms>0&&s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx(Ys,{className:"w-4 h-4"}),s.jsxs("span",{children:[e.processing_time_ms,"ms"]})]})]}),e.should_escalate===!0&&s.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(gS,{className:"w-5 h-5 text-yellow-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Escalation Recommended"}),s.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:e.escalation_reason})]})]})}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Draft Response:"}),i?s.jsx("textarea",{value:o,onChange:w=>c(w.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:8}):s.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 whitespace-pre-wrap",children:e.draft_content})]}),s.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"AI Reasoning:"}),s.jsx("p",{className:"text-sm text-gray-600",children:e.reasoning}),s.jsx("div",{className:"mt-3",children:s.jsxs("p",{className:"text-xs text-gray-500",children:["Intent: ",s.jsx("span",{className:"font-medium",children:e.intent})," | Handler: ",s.jsx("span",{className:"font-medium",children:e.handler_used})]})})]}),e.suggested_actions&&e.suggested_actions.length>0&&s.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Suggested Actions:"}),s.jsx("ul",{className:"space-y-1",children:e.suggested_actions.map((w,N)=>s.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[s.jsx("span",{className:"text-blue-500 mr-2",children:""}),w]},N))})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:b,disabled:j||i,className:"flex-1 flex items-center justify-center px-4 py-2 bg-green-50 text-green-700 border border-green-200 rounded-lg hover:bg-green-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[s.jsx(lt,{className:"w-4 h-4 mr-2"}),j?"Sending...":"Approve & Send"]}),s.jsxs("button",{onClick:p,disabled:j,className:"flex-1 flex items-center justify-center px-4 py-2 bg-yellow-50 text-yellow-700 border border-yellow-200 rounded-lg hover:bg-yellow-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[s.jsx(Bh,{className:"w-4 h-4 mr-2"}),i?j?"Sending...":"Send Edited":"Edit & Send"]}),s.jsxs("button",{onClick:()=>f(!0),disabled:j||i,className:"flex-1 flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[s.jsx(br,{className:"w-4 h-4 mr-2"}),"Reject"]})]}),i&&s.jsx("button",{onClick:()=>{l(!1),c("")},className:"mt-2 w-full px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel Editing"}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject AI Draft"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this draft (optional):"}),s.jsx("textarea",{value:d,onChange:w=>m(w.target.value),placeholder:"e.g., Incorrect information, wrong tone, missing details...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",rows:3}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>{f(!1),m("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:v,disabled:j,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:j?"Rejecting...":"Reject Draft"})]})]})})]})};function aC({isOpen:e,onClose:t,onSubmit:r}){const[n,a]=u.useState(0),[i,l]=u.useState(null),[o,c]=u.useState(""),[d,m]=u.useState(!1),[h,f]=u.useState(0);if(!e)return null;const j=async()=>{if(n===0||i===null){alert("Please rate the draft and indicate if it was helpful");return}m(!0);try{await r({qualityScore:n,wasHelpful:i,improvementNotes:o}),t()}catch(g){console.error("Failed to submit feedback:",g),alert("Failed to submit feedback. Please try again.")}finally{m(!1)}},x=()=>{t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" Help Improve the AI"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"How good was the AI draft?"}),s.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(g=>s.jsx("button",{onClick:()=>a(g),onMouseEnter:()=>f(g),onMouseLeave:()=>f(0),className:"transition-transform hover:scale-110",children:s.jsx(oS,{className:`w-8 h-8 ${g<=(h||n)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},g)),s.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:[n===0&&"Click to rate",n===1&&"Poor",n===2&&"Fair",n===3&&"Good",n===4&&"Very Good",n===5&&"Excellent"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Did the AI draft save you time?"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>l(!0),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${i===!0?"border-green-500 bg-green-50 text-green-700":"border-gray-300 text-gray-700 hover:border-green-300"}`,children:" Yes"}),s.jsx("button",{onClick:()=>l(!1),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${i===!1?"border-red-500 bg-red-50 text-red-700":"border-gray-300 text-gray-700 hover:border-red-300"}`,children:" No"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What could be improved? (Optional)"}),s.jsx("textarea",{value:o,onChange:g=>c(g.target.value),placeholder:"e.g., Too formal, missing product details, wrong tone...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-xs text-blue-800",children:[" ",s.jsx("strong",{children:"Your feedback helps the AI learn!"})," Every rating makes the AI smarter and more helpful for future tickets."]})})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{onClick:x,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",disabled:d,children:"Skip for now"}),s.jsx("button",{onClick:j,disabled:d||n===0||i===null,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium",children:d?"Submitting...":"Submit Feedback"})]})]})})}function eo(e){return e?e.split(",").map(t=>t.trim()).filter(t=>t.length>0):[]}const Tb="Use #keyword to add tags (e.g., #james-scott, #artwork-issue)",xf={open:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200","in-progress":"bg-blue-100 text-blue-800 border-blue-200",resolved:"bg-gray-100 text-gray-800 border-gray-200",closed:"bg-gray-100 text-gray-800 border-gray-200",snoozed:"bg-purple-100 text-purple-800 border-purple-200"},ff={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},gf={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},iC={positive:"",neutral:"",negative:"",angry:""},pf={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson"},Sa=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"",cr=e=>{const t=e.match(/^([A-Z]+)-?(\d+)-(\d+)$/);if(t){const l=t[1],o=parseInt(t[2],10),c=parseInt(t[3],10);return`${l}-${o}-${c}`}const r=e.match(/^([A-Z]+)-?/),n=e.match(/\d+/);if(!n)return e;const a=r?r[1]:"TKT",i=parseInt(n[0],10);return`${a}-${i}`};function lC(){var qh,Wh,Kh,Qh;const{id:e}=uy(),t=jr(),[r]=Bl(),n=mt(),{user:a}=us(),[i,l]=u.useState(!1),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(0),[j,x]=u.useState(null),[g,y]=u.useState(""),[b,p]=u.useState(!1),[v,w]=u.useState([]),N=u.useRef(null),A=u.useRef(null),z=u.useRef(null),[F,Z]=u.useState(!1),[q,O]=u.useState(!1),[V,J]=u.useState(!1),[pe,ke]=u.useState(!1),[we,B]=u.useState(!1),[M,X]=u.useState(!1),[Y,ee]=u.useState(!1),[ie,ne]=u.useState(null),[ge,$e]=u.useState(!1),[R,ae]=u.useState(!1),[je,_]=u.useState(!1),[G,W]=u.useState(!1),[Q,H]=u.useState(null),[he,ze]=u.useState(!1),[be,le]=u.useState(!1),[D,Me]=u.useState("approve"),[Te,P]=u.useState(""),[se,oe]=u.useState(250),[_e,Ee]=u.useState(250),[We,et]=u.useState(!1),[it,kt]=u.useState(!1),[Gt,ss]=u.useState([]),[Et,rs]=u.useState(null),[Hs,ks]=u.useState(""),[wr,Rs]=u.useState(null),[de,Nr]=u.useState(null),[hs,Ps]=u.useState(!1),[ar,Ss]=u.useState(null),{data:Xe,isLoading:$,refetch:fe}=me({queryKey:["ticket",e],queryFn:async()=>(await Ie.get(e)).data,enabled:!!e}),{data:Fe}=me({queryKey:["tickets"],queryFn:async()=>(await Ie.list()).data}),{data:De,refetch:at}=me({queryKey:["scheduledMessages",e],queryFn:async()=>(await Ie.getScheduledMessages(e)).data,enabled:!!e}),{data:Pt,isLoading:In,refetch:E}=me({queryKey:["aiDraft",e],queryFn:async()=>{var k;try{return(await Ie.getAIDraft(e)).data}catch(K){if(((k=K.response)==null?void 0:k.status)===404)return null;throw K}},enabled:!!e,retry:!1}),T=Xe==null?void 0:Xe.ticket,Ae=(Xe==null?void 0:Xe.messages)||[],Re=(Xe==null?void 0:Xe.notes)||[],Ge=(De==null?void 0:De.scheduledMessages)||[];let yt=(Fe==null?void 0:Fe.tickets)||[];const Ei=r.get("filter"),On=r.get("from");Ei==="my"||On==="my"?yt=yt.filter(k=>k.assigned_to==="00000000-0000-0000-0000-000000000001"):Ei==="vip"||On==="vip"?yt=yt.filter(k=>k.vip===1):On&&(yt=yt.filter(k=>k.assigned_to===On));const Kr=yt.findIndex(k=>k.ticket_id===e),S=Kr>0,ve=Kr>=0&&Kr<yt.length-1,ye=()=>{if(S){const k=yt[Kr-1],K=new URLSearchParams(r);k.channel==="chat"?t(`/chat-ticket/${k.ticket_id}?${K.toString()}`):t(`/tickets/${k.ticket_id}?${K.toString()}`)}},Pe=()=>{if(ve){const k=yt[Kr+1],K=new URLSearchParams(r);k.channel==="chat"?t(`/chat-ticket/${k.ticket_id}?${K.toString()}`):t(`/tickets/${k.ticket_id}?${K.toString()}`)}};u.useEffect(()=>{if(T&&T.channel==="chat"){const k=new URLSearchParams(r);t(`/chat-ticket/${T.ticket_id}?${k.toString()}`,{replace:!0})}},[T,t,r]),u.useEffect(()=>{f(0)},[e,d]),u.useEffect(()=>{T&&z.current&&setTimeout(()=>{var k;(k=z.current)==null||k.scrollIntoView({behavior:"smooth"})},100)},[T==null?void 0:T.ticket_id]),u.useEffect(()=>{d&&(T!=null&&T.customer_email)&&!de&&(Ps(!0),Ss(null),yk.getTicketData(T.customer_email).then(k=>{Nr(k.data)}).catch(k=>{var K,L;console.error("Failed to fetch Shopify data:",k),Ss(((L=(K=k.response)==null?void 0:K.data)==null?void 0:L.error)||"Failed to load Shopify data")}).finally(()=>{Ps(!1)}))},[d,T==null?void 0:T.customer_email,de]);const He=k=>{const K=k.target.files;K&&(Array.from(K).forEach(L=>{if(L.size>10*1024*1024){alert(`File ${L.name} is too large. Maximum size is 10MB.`);return}const re=new FileReader;re.onload=Ne=>{var Ht;const Qe=(Ht=Ne.target)==null?void 0:Ht.result;w(Dn=>[...Dn,{name:L.name,content:Qe,type:L.type,size:L.size}])},re.readAsDataURL(L)}),N.current&&(N.current.value=""))},st=k=>{w(K=>K.filter((L,re)=>re!==k))},ct=k=>new Promise((K,L)=>{const re=new FileReader;re.readAsDataURL(k),re.onload=()=>K(re.result),re.onerror=Ne=>L(Ne)}),$t=async k=>{const K=Array.from(k.target.files||[]);for(const L of K)if(L.size>10*1024*1024){alert(`File ${L.name} is too large. Maximum size is 10MB.`),k.target.value="";return}ss(L=>[...L,...K]),k.target.value=""},ir=k=>{ss(K=>K.filter((L,re)=>re!==k))},Ke=async()=>{var k,K,L;if(!(!g.trim()&&v.length===0||!T)){p(!0);try{console.log("Sending reply to ticket:",T.ticket_id,"with",v.length,"attachments");const re=await Ie.reply(T.ticket_id,g,v);console.log("Reply sent successfully:",re),y(""),w([]),fe()}catch(re){console.error("Failed to send reply:",re),console.error("Error details:",((k=re.response)==null?void 0:k.data)||re.message),alert(`Failed to send reply: ${((L=(K=re.response)==null?void 0:K.data)==null?void 0:L.error)||re.message||"Unknown error"}`)}finally{p(!1)}}},Mt=async()=>{var k,K;if(T)try{await Ie.delete(T.ticket_id),console.log("Ticket deleted successfully"),_(!1),t("/tickets")}catch(L){console.error("Failed to delete ticket:",L),alert(`Failed to delete ticket: ${((K=(k=L.response)==null?void 0:k.data)==null?void 0:K.error)||L.message||"Unknown error"}`)}},va=async k=>{T&&(await Ie.updateStatus(T.ticket_id,k),fe())},Ab=async(k,K,L)=>{var re,Ne;if(T)try{await Ie.assign(T.ticket_id,k||""),L&&console.log("Reassignment reason:",L),O(!1),fe()}catch(Qe){console.error("Failed to reassign ticket:",Qe),alert(`Failed to reassign ticket: ${((Ne=(re=Qe.response)==null?void 0:re.data)==null?void 0:Ne.error)||Qe.message||"Unknown error"}`)}},Rb=async(k,K,L)=>{var re,Ne;if(T){console.log("Escalating ticket:",{level:k,staffIds:K,reason:L});try{await Ie.escalate(T.ticket_id,K,L),console.log("Ticket escalated successfully"),J(!1),fe()}catch(Qe){console.error("Failed to escalate ticket:",Qe),alert(`Failed to escalate ticket: ${((Ne=(re=Qe.response)==null?void 0:re.data)==null?void 0:Ne.error)||Qe.message||"Unknown error"}`)}}},Pb=async(k,K)=>{var Ne,Qe;if(!T)return;console.log("Snoozing ticket:",{duration:k,customDate:K});let L;const re=new Date;switch(k){case"30m":L=new Date(re.getTime()+30*60*1e3);break;case"3h":L=new Date(re.getTime()+3*60*60*1e3);break;case"1d":L=new Date(re.getTime()+24*60*60*1e3),L.setHours(9,0,0,0);break;case"friday":L=new Date(re);const Ht=(5-re.getDay()+7)%7||7;L.setDate(re.getDate()+Ht),L.setHours(9,0,0,0);break;case"1w":L=new Date(re.getTime()+7*24*60*60*1e3),L.setHours(9,0,0,0);break;case"custom":if(!K)return;L=new Date(K);break;default:return}try{await Ie.snooze(T.ticket_id,L.toISOString(),`Snoozed until ${L.toLocaleString()}`),console.log("Ticket snoozed successfully"),ke(!1),fe()}catch(Ht){console.error("Failed to snooze ticket:",Ht),alert(`Failed to snooze ticket: ${((Qe=(Ne=Ht.response)==null?void 0:Ne.data)==null?void 0:Qe.error)||Ht.message||"Unknown error"}`)}},$b=async()=>{var k,K;if(T)try{await Ie.unsnooze(T.ticket_id),console.log("Snooze removed successfully"),ke(!1),fe()}catch(L){console.error("Failed to remove snooze:",L),alert(`Failed to remove snooze: ${((K=(k=L.response)==null?void 0:k.data)==null?void 0:K.error)||L.message||"Unknown error"}`)}},ja=((Fe==null?void 0:Fe.tickets)||[]).filter(k=>k.customer_email===(T==null?void 0:T.customer_email)&&k.ticket_id!==(T==null?void 0:T.ticket_id)&&(k.status==="open"||k.status==="in-progress"||k.status==="snoozed")),Lb=async()=>{var k,K;if(!(!T||!Q)){ze(!0);try{await Ie.merge(T.ticket_id,[Q]),console.log("Tickets merged successfully"),W(!1),H(null),fe()}catch(L){console.error("Failed to merge tickets:",L),alert(`Failed to merge tickets: ${((K=(k=L.response)==null?void 0:k.data)==null?void 0:K.error)||L.message||"Unknown error"}`)}finally{ze(!1)}}},Fb=async()=>{var k,K;if(T&&confirm("Mark this ticket as resolved and close it?"))try{await Ie.updateStatus(T.ticket_id,"resolved"),t("/tickets")}catch(L){console.error("Failed to resolve ticket:",L),alert(`Failed to resolve ticket: ${((K=(k=L.response)==null?void 0:k.data)==null?void 0:K.error)||L.message||"Unknown error"}`)}},Ib=()=>{if(!g.trim()||!T){alert("Please write a response first");return}B(!0)},Ob=async(k,K)=>{var L,re;if(T)try{const Ne=`${k}T${K}:00`,Qe=new Date(Ne),Ht=Qe.toISOString();console.log("Scheduling reply:",{input:Ne,localDate:Qe.toString(),utcDate:Ht,serverNow:new Date().toISOString()}),await Ie.scheduleReply(T.ticket_id,g,Ht),y(""),B(!1),fe(),at()}catch(Ne){console.error("Failed to schedule reply:",Ne),alert(`Failed to schedule reply: ${((re=(L=Ne.response)==null?void 0:L.data)==null?void 0:re.error)||Ne.message||"Unknown error"}`)}},Db=k=>{ne(k),X(!0)},zb=async()=>{var k,K;if(ie)try{await Ie.deleteScheduledMessage(ie.id),console.log("[handleRemoveScheduledMessage] Deleted successfully"),X(!1),ne(null),fe()}catch(L){console.error("[handleRemoveScheduledMessage] Error:",L),alert(`Failed to remove scheduled message: ${((K=(k=L.response)==null?void 0:k.data)==null?void 0:K.error)||L.message||"Unknown error"}`)}},Ub=async()=>{var k,K;if(e)try{await Ie.approveAIDraft(e),fe(),E(),Me("approve"),le(!0)}catch(L){console.error("Failed to approve AI draft:",L),alert(`Failed to approve AI draft: ${((K=(k=L.response)==null?void 0:k.data)==null?void 0:K.error)||L.message||"Unknown error"}`)}},Hb=async k=>{var K,L;if(e)try{await Ie.editAIDraft(e,k),fe(),E(),Me("edit"),le(!0)}catch(re){console.error("Failed to edit AI draft:",re),alert(`Failed to edit AI draft: ${((L=(K=re.response)==null?void 0:K.data)==null?void 0:L.error)||re.message||"Unknown error"}`)}},Bb=async k=>{var K,L;if(e)try{await Ie.rejectAIDraft(e,k),E()}catch(re){console.error("Failed to reject AI draft:",re),alert(`Failed to reject AI draft: ${((L=(K=re.response)==null?void 0:K.data)==null?void 0:L.error)||re.message||"Unknown error"}`)}},qb=async k=>{if(e)try{await Ie.submitAIDraftFeedback(e,{...k,action:D}),console.log("Feedback submitted successfully")}catch(K){console.error("Failed to submit feedback:",K)}},Wb=async(k,K,L)=>{var re,Ne;if(console.log("[handleEditScheduledMessageConfirm] Called with:",{newContent:k,scheduledDate:K,scheduledTime:L,messageToEdit:ie}),!ie){console.error("[handleEditScheduledMessageConfirm] No message to edit!");return}try{const Qe=`${K}T${L}:00`,Ht=new Date(Qe),Dn=Ht.toISOString();console.log("[handleEditScheduledMessageConfirm] Updating:",{messageId:ie.id,input:Qe,localDate:Ht.toString(),utcDate:Dn,serverNow:new Date().toISOString()});const zn=await Ie.updateScheduledMessage(ie.id,k,Dn);console.log("[handleEditScheduledMessageConfirm] Response:",zn),X(!1),ne(null),fe(),at()}catch(Qe){console.error("[handleEditScheduledMessageConfirm] Error:",Qe),alert(`Failed to update message: ${((Ne=(re=Qe.response)==null?void 0:re.data)==null?void 0:Ne.error)||Qe.message||"Unknown error"}`)}},wa=k=>{var Ne,Qe,Ht,Dn;if(!T)return;let K="";const L=de==null?void 0:de.latestOrder,re=de==null?void 0:de.customer;switch(k){case"order-status":if(L){const zn=((Ne=L.lineItems)==null?void 0:Ne.slice(0,3).map(Na=>`- ${Na.quantity}x ${Na.title}`).join(`
`))||"";K=`Hi ${T.customer_name||"there"},

I can see your order details:

Order #${L.orderNumber}
Status: ${L.fulfillmentStatus||"Unfulfilled"}
Payment: ${L.financialStatus||"Pending"}
Total: $${(Qe=L.totalPrice)==null?void 0:Qe.toFixed(2)} ${L.currency||"AUD"}
Ordered: ${new Date(L.createdAt).toLocaleDateString()}

Items:
${zn}

Is there anything else I can help you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else K=`Hi ${T.customer_name||"there"},

I'm checking on your order status now. Let me look that up for you.

Order #: [ORDER_NUMBER]
Status: [STATUS]

Is there anything else I can help you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"tracking":L!=null&&L.trackingNumber?K=`Hi ${T.customer_name||"there"},

Here's your tracking information:

Order #${L.orderNumber}
Tracking #: ${L.trackingNumber}
${L.trackingCompany?`Carrier: ${L.trackingCompany}
`:""}${L.trackingUrl?`
Track your package: ${L.trackingUrl}`:""}

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`:L?K=`Hi ${T.customer_name||"there"},

I can see your order #${L.orderNumber} is currently ${L.fulfillmentStatus||"unfulfilled"}. Once it ships, I'll send you the tracking information right away.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`:K=`Hi ${T.customer_name||"there"},

Let me look up your tracking information for you.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"vip-wallet":if(re){const zn=re.totalSpent>=1e3?"Platinum":re.totalSpent>=500?"Gold":re.totalSpent>=100?"Silver":"Bronze";K=`Hi ${T.customer_name||"there"},

Thank you for being a valued customer!

Customer Stats:
- Total Orders: ${re.ordersCount||0}
- Total Spent: $${((Ht=re.totalSpent)==null?void 0:Ht.toFixed(2))||"0.00"}
- VIP Tier: ${zn}
- Member Since: ${re.createdAt?new Date(re.createdAt).toLocaleDateString():"N/A"}

Is there anything else I can assist you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else K=`Hi ${T.customer_name||"there"},

Let me check your customer account details.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"artwork":K=`Hi ${T.customer_name||"there"},

I've reviewed your artwork file. Here's what I found:

 Resolution: [DPI]
 Color mode: [COLOR_MODE]
 File format: [FORMAT]

Recommendations:
[RECOMMENDATIONS]

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"quote":K=`Hi ${T.customer_name||"there"},

Thank you for your quote request. Here are the details:

Product: [PRODUCT]
Quantity: [QUANTITY]
Price per unit: $[PRICE]
Total: $[TOTAL]

This quote is valid for 30 days. Would you like to proceed with the order?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"products":if(L!=null&&L.lineItems&&L.lineItems.length>0){const zn=L.lineItems.map(Na=>{var Vh;return`- ${Na.title}
  Quantity: ${Na.quantity}
  Price: $${((Vh=Na.price)==null?void 0:Vh.toFixed(2))||"0.00"} each`}).join(`

`);K=`Hi ${T.customer_name||"there"},

Here are the products from your order #${L.orderNumber}:

${zn}

Total: $${(Dn=L.totalPrice)==null?void 0:Dn.toFixed(2)} ${L.currency||"AUD"}

Is there anything else you'd like to know about these products?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else K=`Hi ${T.customer_name||"there"},

Let me look up your product details for you.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;default:return}y(K)};return u.useEffect(()=>{const k=K=>{(K.ctrlKey||K.metaKey)&&K.key==="y"&&(K.preventDefault(),$e(L=>(L||ae(!1),!L))),(K.ctrlKey||K.metaKey)&&K.key==="r"&&(K.preventDefault(),ae(L=>(L||$e(!1),!L)))};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[]),u.useEffect(()=>{const k=L=>{if(!We)return;const re=se+(window.innerHeight-L.clientY-se),Ne=150,Qe=window.innerHeight*.6;re>=Ne&&re<=Qe&&oe(re)},K=()=>{et(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return We&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",k),window.addEventListener("mouseup",K)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",K)}},[We,se]),u.useEffect(()=>{const k=L=>{if(!it)return;const re=_e+(window.innerHeight-L.clientY-_e),Ne=150,Qe=window.innerHeight*.6;re>=Ne&&re<=Qe&&Ee(re)},K=()=>{kt(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return it&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",k),window.addEventListener("mouseup",K)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",K)}},[it,_e]),$?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading ticket..."})}):T?s.jsxs("div",{className:"flex h-[calc(100vh-4rem)] bg-gray-50",children:[s.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ye,{to:"/tickets",className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[T.channel==="task"?s.jsx(gr,{className:"w-4 h-4 text-amber-600"}):T.channel==="phone"||(qh=T.subject)!=null&&qh.toLowerCase().includes("callback request")?s.jsx(ba,{className:"w-4 h-4 text-red-600"}):T.channel==="chat"?s.jsx(Br,{className:"w-4 h-4 text-indigo-500"}):T.channel==="whatsapp"?s.jsx(Br,{className:"w-4 h-4 text-green-600"}):T.channel==="facebook"?s.jsx(zh,{className:"w-4 h-4 text-blue-600"}):T.channel==="instagram"?s.jsx(Hh,{className:"w-4 h-4 text-pink-500"}):s.jsx(rr,{className:"w-4 h-4 text-gray-500"}),s.jsx("h1",{className:"text-base font-semibold text-gray-900",children:cr(T.ticket_number)})]}),T.vip===1&&s.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 rounded-lg text-xs border border-yellow-200 font-medium",children:" VIP"}),s.jsx("button",{onClick:()=>Z(!0),className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium hover:opacity-80 ${xf[T.status]||xf.open}`,children:T.status}),s.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${ff[T.priority]||ff.normal}`,children:T.priority}),s.jsxs("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${gf[T.sentiment]||gf.neutral}`,children:[iC[T.sentiment]||""," ",T.sentiment||"neutral"]}),T.channel==="task"&&T.sla_due_at&&s.jsxs("span",{className:`inline-flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${new Date(T.sla_due_at)<new Date?"bg-red-50 text-red-700 ring-red-600/20":"bg-amber-50 text-amber-700 ring-amber-600/20"}`,children:[s.jsx(Ys,{className:"w-3 h-3"}),new Date(T.sla_due_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]}),T.related_ticket_id&&(()=>{let k=T.related_ticket_id,K=T.related_ticket_id;if(k.startsWith("@"))K=`TKT-${k.substring(1)}`;else if(!k.includes("-"))K=`TKT-${k}`,k=`@${k}`;else{const L=k.match(/^[A-Z]+-(\d+)$/);L&&(k=`@${L[1]}`)}return s.jsx(Ye,{to:`/tickets?search=${K}`,className:"inline-flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-indigo-50 text-indigo-700 ring-indigo-600/20 hover:bg-indigo-100",children:k})})()]}),s.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:T.assigned_to?pf[T.assigned_to]||T.assigned_to:"Unassigned"})]}),s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:T.customer_name||T.customer_email}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(T.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[s.jsx("span",{className:"font-medium",children:"Subject:"})," ",T.subject]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[T.channel==="task"&&s.jsxs("button",{onClick:()=>ee(!0),className:"text-xs px-2 py-1 bg-amber-50 border border-amber-300 rounded-lg hover:bg-amber-100 flex items-center gap-1 text-amber-900",children:[s.jsx(gr,{className:"w-3 h-3"}),s.jsx("span",{children:"Create Sub-Task"})]}),s.jsxs("button",{onClick:()=>O(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:"Reassign"})]}),s.jsxs("button",{onClick:()=>J(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{children:"Escalate"})]}),s.jsxs("button",{onClick:()=>ke(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{children:"Snooze"})]}),s.jsxs("button",{onClick:()=>W(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",title:ja.length===0?"No other tickets from this customer":`${ja.length} other ticket(s) from this customer`,children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),s.jsx("span",{children:"Merge"}),ja.length>0&&s.jsx("span",{className:"bg-indigo-100 text-indigo-700 px-1 rounded text-xs",children:ja.length})]}),(a==null?void 0:a.role)==="admin"&&s.jsxs("button",{onClick:()=>_(!0),className:"text-xs px-2 py-1 bg-white border border-red-300 text-red-600 rounded-lg hover:bg-red-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{children:"Delete"})]})]})]})]}),s.jsxs("div",{className:"p-4 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>l(!i),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(yn,{className:"w-3 h-3"}),s.jsx("span",{children:"Customer Info"})]}),s.jsxs("button",{onClick:()=>c(!o),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(Nb,{className:"w-3 h-3"}),s.jsx("span",{children:"Order History"})]}),s.jsxs("button",{onClick:()=>m(!d),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${d?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[s.jsx(dl,{className:"w-3 h-3"}),s.jsx("span",{children:"Shopify"})]}),T.merged_from&&s.jsxs("div",{className:"h-7 text-xs px-2 py-1 bg-indigo-50 border border-indigo-200 rounded-lg flex items-center gap-1.5 text-indigo-900",children:[s.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsxs("span",{children:[s.jsx("strong",{children:"Merged:"})," ",cr(T.ticket_number)," and ",cr(T.merged_from||"")]})]}),(Xe==null?void 0:Xe.relatedTasks)&&Xe.relatedTasks.length>0&&s.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Xe.relatedTasks.map(k=>s.jsxs(Ye,{to:`/tickets?search=${k.ticket_number}`,className:"h-7 text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[s.jsx(gr,{className:"w-3 h-3 text-amber-600"}),s.jsxs("span",{children:[cr(k.ticket_number),": ",k.subject]})]},k.ticket_number))}),T.channel==="task"&&(Xe==null?void 0:Xe.subTasks)&&Xe.subTasks.length>0&&s.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Xe.subTasks.map(k=>s.jsxs(Ye,{to:`/tickets?search=${k.ticket_number}`,className:"h-7 text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[s.jsx(gr,{className:"w-3 h-3 text-amber-600"}),s.jsxs("span",{children:[cr(k.ticket_number),": ",k.subject]})]},k.ticket_number))}),T.channel==="task"&&T.parent_task_id&&(Xe==null?void 0:Xe.parentTask)&&s.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:s.jsxs(Ye,{to:`/tickets?search=${Xe.parentTask.ticket_number}`,className:"h-7 text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[s.jsx(gr,{className:"w-3 h-3 text-amber-600"}),s.jsxs("span",{children:[cr(Xe.parentTask.ticket_number),": ",Xe.parentTask.subject]})]})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[Ge.length>0&&s.jsxs("div",{className:"h-7 text-xs px-2 py-1 bg-yellow-100 border border-yellow-300 rounded-lg flex items-center gap-1.5 font-medium text-yellow-900",title:`${Ge.length} scheduled message${Ge.length>1?"s":""}`,children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("span",{children:[Ge.length," Scheduled"]})]}),s.jsx("button",{onClick:ye,disabled:!S,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(xi,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:Pe,disabled:!ve,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Jl,{className:"w-3.5 h-3.5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[i&&s.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"}),s.jsx("span",{className:"ml-2 font-medium",children:T.customer_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"VIP:"}),s.jsx("span",{className:"ml-2 font-medium text-amber-600",children:T.vip?"Yes":"No"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"Email:"}),s.jsx("span",{className:"ml-2 font-medium",children:T.customer_email})]})]})]})}),o&&s.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),s.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[s.jsxs("div",{className:"p-4 rounded-lg bg-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-gray-300",children:s.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:T.customer_name}),s.jsx("span",{className:"text-xs text-gray-400",children:T.created_at&&typeof T.created_at=="string"?ys(new Date(T.created_at.includes("Z")?T.created_at:T.created_at+"Z"),{addSuffix:!0}):""})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:T.description})]}),Ae.map(k=>{var Ne;const K=k.sender_type==="customer",L=k.sender_id==="ai-agent-001",re=k.was_scheduled===!0||k.was_scheduled===1;return s.jsxs("div",{className:`p-4 rounded-lg ${K?"bg-gray-100":L?"bg-purple-50":"bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${K?"bg-gray-300":L?"bg-purple-200":"bg-blue-200"}`,children:K?s.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}):L?s.jsx(er,{className:"w-3 h-3 text-purple-600"}):s.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:K?k.sender_name||"Customer":L?"McCarthy AI":k.sender_name?k.sender_name.split(" ")[0]:"Staff"}),s.jsx("span",{className:"text-xs text-gray-400",children:k.created_at&&typeof k.created_at=="string"?ys(new Date(k.created_at.includes("Z")?k.created_at:k.created_at+"Z"),{addSuffix:!0}):""}),re&&!K&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-blue-100 text-blue-600 text-xs rounded",title:"This message was scheduled",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Scheduled"]})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:k.content}),k.attachment_url&&s.jsx("div",{className:"mt-2 ml-8",children:(Ne=k.attachment_type)!=null&&Ne.startsWith("image/")?s.jsxs("a",{href:Sa(k.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Sa(k.attachment_url),alt:k.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:k.attachment_name})]}):s.jsxs("a",{href:Sa(k.attachment_url),download:k.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:k.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(k.attachment_size/1024).toFixed(1)," KB)"]})]})})]},k.id)}),Ge.map(k=>s.jsxs("div",{className:"p-4 rounded-lg bg-yellow-50 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-yellow-200",children:s.jsx("svg",{className:"w-3 h-3 text-yellow-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:k.first_name}),s.jsxs("button",{onClick:()=>Db(k),className:"inline-flex items-center gap-1 px-2 py-0.5 bg-yellow-100 border border-yellow-300 text-yellow-800 text-xs font-medium rounded hover:bg-yellow-200 transition-colors",title:"Click to edit message and scheduled time",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Scheduled: ",new Date(k.scheduled_for).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:k.content})]},k.id)),Pt!=null&&Pt.draft?s.jsx("div",{className:"mt-4",children:s.jsx(nC,{ticketId:e,draft:Pt.draft,loading:In,onApprove:Ub,onEdit:Hb,onReject:Bb})}):null,s.jsx("div",{ref:z})]})]}),s.jsxs("div",{className:"flex-shrink-0",children:[s.jsxs("div",{className:"border-t border-gray-200 bg-white",children:[R&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-purple-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>et(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-purple-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-purple-50 to-purple-100 border-b border-purple-200 flex items-center gap-2 cursor-pointer hover:from-purple-100 hover:to-purple-150 transition-colors",onClick:()=>{ae(k=>(k||$e(!1),!k))},children:[s.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Response Area"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+R"})]}),R&&s.jsxs("div",{className:"p-4 flex flex-col",style:{height:`${se}px`},children:[v.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:v.map((k,K)=>s.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-gray-100 rounded-lg text-xs",children:[s.jsx(St,{className:"w-3 h-3 text-gray-500"}),s.jsx("span",{className:"max-w-[150px] truncate",children:k.name}),s.jsx("button",{onClick:()=>st(K),className:"text-gray-400 hover:text-red-500",children:s.jsx(_t,{className:"w-3 h-3"})})]},K))}),s.jsx("div",{className:"flex-1 mb-2 min-h-0",children:s.jsx("textarea",{value:g,onChange:k=>y(k.target.value),placeholder:"Type your response...",className:"w-full h-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500 resize-none min-h-0"})}),s.jsxs("div",{className:"space-y-3 flex-shrink-0",children:[s.jsx("input",{type:"file",ref:N,onChange:He,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>{var k;return(k=N.current)==null?void 0:k.click()},className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]}),s.jsx("button",{className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" All Templates"}),s.jsx("button",{onClick:()=>wa("order-status"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @order-status"}),s.jsx("button",{onClick:()=>wa("tracking"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @tracking"}),s.jsx("button",{onClick:()=>wa("vip-wallet"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @vip-wallet"}),s.jsx("button",{onClick:()=>wa("artwork"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @artwork"}),s.jsx("button",{onClick:()=>wa("quote"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @quote"}),s.jsx("button",{onClick:()=>wa("products"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" Products"}),s.jsx("button",{className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" Generate Invoice"})]}),s.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[s.jsxs("button",{onClick:Ke,disabled:!g.trim()&&v.length===0||b,className:"px-4 py-2 text-sm bg-purple-200 text-purple-800 border border-purple-300 rounded-lg hover:bg-purple-300 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),b?"Sending...":`Send Reply${v.length>0?` (${v.length})`:""}`]}),s.jsxs("button",{onClick:Ib,className:"px-4 py-2 text-sm bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 font-medium flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Schedule Reply"]}),s.jsxs("button",{onClick:Fb,className:"px-4 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 font-medium flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Resolve & Close"]})]})]})]})]}),s.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[ge&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>kt(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>{$e(k=>(k||ae(!1),!k))},children:[s.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),ge&&s.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${_e}px`},children:[Re&&Re.length>0&&s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:Re.map(k=>{var K;return s.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:k.first_name||"Staff"}),s.jsx("span",{className:"text-xs text-gray-500",children:k.created_at&&typeof k.created_at=="string"?ys(new Date(k.created_at.includes("Z")?k.created_at:k.created_at+"Z"),{addSuffix:!0}):""}),k.edited_at&&s.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[(k.staff_id===(a==null?void 0:a.id)||(a==null?void 0:a.role)==="admin")&&Et!==k.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{rs(k.id),ks(k.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),s.jsx("button",{onClick:()=>Rs(k.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]}),k.note_type==="escalation"&&k.escalated_to===(a==null?void 0:a.id)&&(k.escalation_status==="pending"?s.jsx("button",{type:"button",onClick:async()=>{var L,re;if(!(!T||!k.escalation_id))try{await Ie.resolveEscalation(T.ticket_id,k.escalation_id),fe()}catch(Ne){console.error("Failed to resolve escalation:",Ne),alert(`Failed to resolve escalation: ${((re=(L=Ne.response)==null?void 0:L.data)==null?void 0:re.error)||Ne.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Resolve"}):k.escalation_status==="resolved"&&k.resolved_at?s.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["Resolved: ",new Date(k.resolved_at).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})]}):null)]})]}),Et===k.id?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:Hs,onChange:L=>ks(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:async()=>{var L,re;if(!(!T||!Hs.trim()))try{await Ie.editNote(T.ticket_id,k.id,Hs),rs(null),ks(""),n.invalidateQueries({queryKey:["ticket",e]})}catch(Ne){console.error("Failed to edit note:",Ne),alert(`Failed to edit note: ${((re=(L=Ne.response)==null?void 0:L.data)==null?void 0:re.error)||Ne.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{rs(null),ks("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:(()=>{let L=k.content||"";return L.includes("MERGE_TIMESTAMP:")&&(L=L.replace(/MERGE_TIMESTAMP:([^\n]+)\n?/g,(re,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})+`
`}catch{return""}})),L.includes("SCHEDULE_TIME:")&&(L=L.replace(/SCHEDULE_TIME:([^\s]+)/g,(re,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Ne}})),L.includes("SNOOZE_TIME:")&&(L=L.replace(/SNOOZE_TIME:(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?)/g,(re,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Ne}})),L.includes("BULK_REASSIGN_TIME:")&&(L=L.replace(/BULK_REASSIGN_TIME:(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?)/g,(re,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Ne}})),L})()}),k.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(k.tags).map((L,re)=>s.jsxs(Ye,{to:`/tags?search=${encodeURIComponent(L)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[s.jsx(Ot,{className:"w-3 h-3 mr-1"}),L]},re))}),k.attachment_url&&s.jsx("div",{className:"mt-2",children:(K=k.attachment_type)!=null&&K.startsWith("image/")?s.jsxs("a",{href:Sa(k.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Sa(k.attachment_url),alt:k.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:k.attachment_name})]}):s.jsxs("a",{href:Sa(k.attachment_url),download:k.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:k.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(k.attachment_size/1024).toFixed(1)," KB)"]})]})})]},k.id)})}),wr&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),s.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[s.jsx("button",{onClick:()=>Rs(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:async()=>{var k,K;if(T)try{await Ie.deleteNote(T.ticket_id,wr),Rs(null),n.invalidateQueries({queryKey:["ticket",e]})}catch(L){console.error("Failed to delete note:",L),alert(`Failed to delete note: ${((K=(k=L.response)==null?void 0:k.data)==null?void 0:K.error)||L.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[Gt.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:Gt.map((k,K)=>s.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"max-w-[150px] truncate",children:k.name}),s.jsx("button",{onClick:()=>ir(K),className:"text-red-500 hover:text-red-700",children:s.jsx(_t,{className:"w-3 h-3"})})]},K))}),s.jsx("textarea",{value:Te,onChange:k=>P(k.target.value),onKeyDown:async k=>{var K,L;if(k.key==="Enter"&&!k.shiftKey&&Te.trim()&&T){k.preventDefault(),console.log("[Staff Notes] Submitting note");try{const re=await Promise.all(Gt.map(async Ne=>({name:Ne.name,content:await ct(Ne),type:Ne.type,size:Ne.size})));await Ie.addNote(T.ticket_id,Te,void 0,re.length>0?re:void 0),P(""),ss([]),fe()}catch(re){console.error("Failed to add note:",re),alert(`Failed to add note: ${((L=(K=re.response)==null?void 0:K.data)==null?void 0:L.error)||re.message||"Unknown error"}`)}}},placeholder:"Add internal notes... Use @to mention staff, #keyword to add tags (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),s.jsx("input",{type:"file",ref:A,onChange:$t,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("button",{onClick:()=>{var k;return(k=A.current)==null?void 0:k.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]})]}),s.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${d?"w-96":"w-0"}`,children:d&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(dl,{className:"w-5 h-5 text-green-600"}),s.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),s.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),hs&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}),ar&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:[s.jsx("p",{className:"text-sm text-red-600",children:ar}),s.jsx("button",{onClick:()=>{Nr(null),Ss(null)},className:"text-xs text-red-700 underline mt-2",children:"Try again"})]}),de&&!de.configured&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:s.jsx("p",{className:"text-sm text-yellow-700",children:de.message})}),de&&de.configured&&!de.customer&&s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:s.jsx("p",{className:"text-sm text-gray-600",children:de.message||"Customer not found in Shopify"})}),de&&de.customer&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[de.customer.firstName," ",de.customer.lastName]}),s.jsx("p",{className:"text-xs text-gray-500",children:de.customer.email}),de.customer.phone&&s.jsx("p",{className:"text-xs text-gray-500",children:de.customer.phone}),de.customer.isVIP&&s.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[s.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),s.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((Wh=de.customer.totalSpent)==null?void 0:Wh.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),s.jsx("span",{className:"font-semibold text-gray-900",children:de.customer.ordersCount||0})]}),de.customer.lastOrderDate&&s.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[s.jsx("span",{className:"text-gray-500",children:"Last Order:"}),s.jsx("span",{className:"text-gray-900",children:new Date(de.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),de.orders&&de.orders.length>0?s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",h+1," OF ",de.orders.length]}),de.orders.length>1&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>f(Math.max(0,h-1)),disabled:h===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>f(Math.min(de.orders.length-1,h+1)),disabled:h===de.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",de.orders[h].orderNumber]}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${de.orders[h].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":de.orders[h].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:de.orders[h].fulfillmentStatus||"Unfulfilled"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",s.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(Kh=de.orders[h].totalPrice)==null?void 0:Kh.toFixed(2)," ",de.orders[h].currency]})]})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Created:"}),s.jsx("span",{className:"text-gray-900",children:new Date(de.orders[h].createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Payment:"}),s.jsx("span",{className:`font-medium ${de.orders[h].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:de.orders[h].financialStatus||"Pending"})]})]}),de.orders[h].lineItems&&de.orders[h].lineItems.length>0&&s.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),s.jsx("div",{className:"space-y-2",children:de.orders[h].lineItems.map((k,K)=>{var L;return s.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[s.jsxs("button",{onClick:()=>x(j===k.id?null:k.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:k.title}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["x",k.quantity]}),s.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${j===k.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),j===k.id&&s.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Price:"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(L=k.price)==null?void 0:L.toFixed(2)]})]}),k.sku&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"SKU:"}),s.jsx("span",{className:"text-gray-900 font-mono",children:k.sku})]}),k.variantTitle&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Variant:"}),s.jsx("span",{className:"text-gray-900",children:k.variantTitle})]}),k.customAttributes&&k.customAttributes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),k.customAttributes.map((re,Ne)=>s.jsxs("div",{className:"flex justify-between py-0.5",children:[s.jsxs("span",{className:"text-gray-500",children:[re.key.replace("_",""),":"]}),re.key.includes("Link")||re.key.includes("link")?s.jsx("a",{href:re.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:Qe=>Qe.stopPropagation(),children:"View "}):s.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:re.value})]},Ne))]})]})]},k.id||K)})})]})]})]}):s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),de.orders&&((Qh=de.orders[h])==null?void 0:Qh.trackingNumber)&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),s.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:de.orders[h].trackingNumber}),de.orders[h].trackingCompany&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",s.jsx("span",{className:"text-gray-900",children:de.orders[h].trackingCompany})]})]}),de.orders[h].trackingUrl&&s.jsx("a",{href:de.orders[h].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]}),!hs&&!ar&&!de&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(dl,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})]})]})}),F&&s.jsx(Z6,{currentStatus:T.status,onClose:()=>Z(!1),onSave:va}),s.jsx(Eb,{isOpen:q,onClose:()=>O(!1),onReassign:Ab,currentAssignment:T.assigned_to?pf[T.assigned_to]:void 0}),s.jsx(eC,{isOpen:V,onClose:()=>J(!1),onConfirm:Rb,ticketNumber:T.ticket_number}),s.jsx(tC,{isOpen:pe,onClose:()=>ke(!1),onConfirm:Pb,onRemoveSnooze:$b,ticketNumber:T.ticket_number,isSnoozed:T.status==="snoozed"}),s.jsx(sC,{isOpen:we,onClose:()=>B(!1),onConfirm:Ob}),s.jsx(rC,{isOpen:M,onClose:()=>{X(!1),ne(null)},onConfirm:Wb,onRemove:zb,message:ie}),je&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Ticket"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Are you sure you want to delete ticket ",s.jsx("span",{className:"font-medium",children:cr(T.ticket_number)}),"? This action cannot be undone."]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:Mt,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Delete Ticket"})]})]})}),s.jsx(aC,{isOpen:be,onClose:()=>le(!1),onSubmit:qb}),G&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Merge Tickets"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Select a ticket to merge into ",s.jsx("span",{className:"font-medium",children:cr(T.ticket_number)})," (primary).",s.jsx("br",{}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Only showing tickets from: ",T.customer_email]})]}),ja.length===0?s.jsxs("div",{className:"py-8 text-center text-gray-500",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("p",{className:"text-sm",children:"No other open tickets from this customer"})]}):s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 mb-4",children:ja.map(k=>s.jsxs("label",{className:`flex items-start p-3 rounded-lg border cursor-pointer transition-colors ${Q===k.ticket_id?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"}`,children:[s.jsx("input",{type:"radio",name:"mergeTicket",value:k.ticket_id,checked:Q===k.ticket_id,onChange:()=>H(k.ticket_id),className:"mt-1 mr-3 text-purple-600 focus:ring-purple-500"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-sm text-gray-900",children:cr(k.ticket_number)}),s.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${k.status==="snoozed"?"bg-purple-100 text-purple-700":k.status==="in-progress"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:k.status}),s.jsx("span",{className:"text-xs text-gray-400",children:ys(new Date(k.created_at),{addSuffix:!0})})]}),s.jsx("p",{className:"text-sm text-gray-600 truncate",children:k.subject})]})]},k.ticket_id))}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[s.jsx("button",{onClick:()=>{W(!1),H(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:Lb,disabled:!Q||he,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:he?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Merging..."]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Merge into ",cr(T.ticket_number)]})})]})]})}),s.jsx(Mb,{isOpen:Y,onClose:()=>{ee(!1),fe()},parentTaskId:T==null?void 0:T.ticket_id,parentTaskNumber:T==null?void 0:T.ticket_number})]}):s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Ticket not found"})})}function oC(){var D,Me,Te;const e=jr(),t=mt(),r=us(P=>P.user),[n,a]=u.useState(null),[i,l]=u.useState(!1),[o,c]=u.useState([]),[d,m]=u.useState(null),h=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager",[f,j]=u.useState("my-mentions"),[x,g]=u.useState(""),[y,b]=u.useState(""),[p,v]=u.useState(""),[w,N]=u.useState(""),[A,z]=u.useState("all"),[F,Z]=u.useState("active"),[q,O]=u.useState(""),[V,J]=u.useState(""),[pe,ke]=u.useState(""),{data:we}=me({queryKey:["staff-users"],queryFn:async()=>(await rt.list()).data}),B=Le.useMemo(()=>[...(we==null?void 0:we.staff)||[],{id:"ai-agent-001",firstName:"McCarthy",lastName:"AI",email:"mccarthy@dartmouth.ai"}],[we]),{data:M,isLoading:X}=me({queryKey:["mentions",f,x,y,p,w,A,F,q,V],queryFn:async()=>{const P={};return f==="my-mentions"||(f==="all-mentions"&&h?P.view_all=!0:f==="by-staff"&&x?P.mentioned_staff_id=x:f==="by-ticket"&&y&&(P.ticket_number=y)),p&&(P.channel_id=p),w&&w!=="all"&&(P.time_filter=w),A==="unread"&&(P.is_read=!1),A==="read"&&(P.is_read=!0),F==="archived"&&(P.is_archived=!0),F==="active"&&(P.is_archived=!1),q&&(P.start_date=q),V&&(P.end_date=V),(await Un.getMentions(P)).data},refetchInterval:3e4,refetchOnWindowFocus:!1}),Y=(M==null?void 0:M.mentions)||[],ee=Le.useMemo(()=>{if(!pe.trim())return Y;const P=pe.toLowerCase().trim();return Y.filter(se=>{var Ee,We,et,it;const oe=(Ee=P.match(/\d+/))==null?void 0:Ee[0];if(oe&&se.message_content){const kt=se.message_content.toLowerCase();if([`@${oe}`,`#${oe}`,`*${oe}`,`ticket ${oe}`,`tkt-${oe}`,`tkt-000${oe}`,`tsk-${oe}`,`tsk-000${oe}`].some(ss=>kt.includes(ss))||kt.includes(oe))return!0}return!!(oe&&se.ticket_number&&((We=se.ticket_number.match(/\d+/))==null?void 0:We[0])===oe||`${se.mentioning_first_name} ${se.mentioning_last_name}`.toLowerCase().includes(P)||(et=se.message_content)!=null&&et.toLowerCase().includes(P)||(it=se.channel_name)!=null&&it.toLowerCase().includes(P))})},[Y,pe]);Le.useEffect(()=>{ee.length>0&&!n&&a(ee[0])},[ee]),Le.useEffect(()=>{n&&ee.find(P=>P.id===n.id)},[n]);const ie=()=>{if(!n||ee.length===0)return;const P=ee.findIndex(se=>se.id===n.id);if(P>0){const se=ee[P-1];a(se)}},ne=()=>{if(!n||ee.length===0)return;const P=ee.findIndex(se=>se.id===n.id);if(P<ee.length-1){const se=ee[P+1];a(se)}},ge=n?ee.findIndex(P=>P.id===n.id):-1,{data:$e}=me({queryKey:["mentions-unread-count"],queryFn:async()=>(await Un.getUnreadCount()).data,refetchInterval:5e3}),R=($e==null?void 0:$e.count)||0,{data:ae}=me({queryKey:["group-chat-channels"],queryFn:async()=>(await xt.listChannels()).data}),je=(ae==null?void 0:ae.channels)||[],_=Ce({mutationFn:async P=>{console.log("[Mentions] Marking as read:",P);const se=await Un.markAsRead(P);return console.log("[Mentions] Mark as read response:",se),se},onMutate:async P=>{console.log("[Mentions] onMutate - marking as read:",P);const se=["mentions",f,x,y,p,w,A,F,q,V];await t.cancelQueries({queryKey:se});const oe=t.getQueryData(se);return t.setQueryData(se,_e=>_e!=null&&_e.mentions?{..._e,mentions:_e.mentions.map(Ee=>Ee.id===P?{...Ee,is_read:1,read_at:new Date().toISOString()}:Ee)}:_e),n&&n.id===P&&a({...n,is_read:1,read_at:new Date().toISOString()}),{previousMentions:oe,currentQueryKey:se}},onError:(P,se,oe)=>{console.error("[Mentions] Error marking as read:",P),t.setQueryData(oe.currentQueryKey,oe.previousMentions),t.invalidateQueries({queryKey:oe.currentQueryKey}),t.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{console.log("[Mentions] Successfully marked as read"),t.invalidateQueries({queryKey:["mentions-unread-count"]})}}),G=Ce({mutationFn:async P=>{console.log("[Mentions] Marking as unread:",P);const se=await Un.markAsUnread(P);return console.log("[Mentions] Mark as unread response:",se),se},onMutate:async P=>{const se=["mentions",f,x,y,p,w,A,F,q,V];await t.cancelQueries({queryKey:se});const oe=t.getQueryData(se);return t.setQueryData(se,_e=>_e!=null&&_e.mentions?{..._e,mentions:_e.mentions.map(Ee=>Ee.id===P?{...Ee,is_read:0,read_at:null}:Ee)}:_e),n&&n.id===P&&a({...n,is_read:0,read_at:null}),{previousMentions:oe,currentQueryKey:se}},onError:(P,se,oe)=>{t.setQueryData(oe.currentQueryKey,oe.previousMentions),t.invalidateQueries({queryKey:oe.currentQueryKey}),t.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{t.invalidateQueries({queryKey:["mentions-unread-count"]})}}),W=Ce({mutationFn:async P=>{const se=P.mentionIds.map(oe=>P.isRead?Un.markAsRead(oe):Un.markAsUnread(oe));return Promise.all(se)},onMutate:async P=>{const se=["mentions",f,x,y,p,w,A,F,q,V];await t.cancelQueries({queryKey:se});const oe=t.getQueryData(se);return t.setQueryData(se,_e=>_e!=null&&_e.mentions?{..._e,mentions:_e.mentions.map(Ee=>P.mentionIds.includes(Ee.id)?{...Ee,is_read:P.isRead?1:0,read_at:P.isRead?new Date().toISOString():null}:Ee)}:_e),{previousMentions:oe,currentQueryKey:se}},onError:(P,se,oe)=>{t.setQueryData(oe.currentQueryKey,oe.previousMentions),t.invalidateQueries({queryKey:oe.currentQueryKey}),t.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{c([]),t.invalidateQueries({queryKey:["mentions-unread-count"]})}}),Q=Ce({mutationFn:async()=>{const se=Y.filter(oe=>oe.is_read===1&&oe.is_archived===0).map(oe=>Un.archiveMention(oe.id));return Promise.all(se)},onSuccess:()=>{t.invalidateQueries({queryKey:["mentions"]})}}),H=(P,se)=>{if(console.log("[MentionsPage] Clicking mention:",P.id),se!=null&&se.shiftKey&&d!==null){const oe=ee.findIndex(et=>et.id===P.id),_e=Math.min(d,oe),Ee=Math.max(d,oe),We=ee.slice(_e,Ee+1).map(et=>et.id);c(We)}else se!=null&&se.ctrlKey||se!=null&&se.metaKey?(c(oe=>oe.includes(P.id)?oe.filter(_e=>_e!==P.id):[...oe,P.id]),m(ee.findIndex(oe=>oe.id===P.id))):(c([]),m(ee.findIndex(oe=>oe.id===P.id)),a(P))},he=()=>{n&&(n.context_type==="group_chat"?e(`/group-chat?channel=${n.context_id}&message=${n.message_id}`):n.ticket_id&&e(`/tickets/${n.ticket_id}`))},ze=P=>{if(!P)return"";const se=P.match(/\d+/);return se?`@${parseInt(se[0],10)}`:P},be=(P,se="w-3 h-3")=>{switch(P){case"email":return s.jsx(rr,{className:se});case"phone":case"callback":return s.jsx(ba,{className:`${se} text-red-600`});case"chat":return s.jsx(Br,{className:se});case"whatsapp":case"facebook":case"instagram":return s.jsx(D3,{className:se});default:return s.jsx(Br,{className:se})}},le=P=>{if(!P)return null;const se=/(@(\d+)|TKT-(\d+)|ticket\s+(\d+)|#(\d+)|\*(\d+)(?:-(\d+))?|TSK-(\d+)(?:-(\d+))?)/gi,oe=[];let _e=0,Ee;for(;(Ee=se.exec(P))!==null;){Ee.index>_e&&oe.push({text:P.substring(_e,Ee.index),isTicket:!1});const We=Ee[2]||Ee[3]||Ee[4]||Ee[5],et=Ee[6]||Ee[8],it=Ee[7]||Ee[9],kt=et!==void 0,Gt=kt?et:We;oe.push({text:Ee[0],isTicket:!kt,ticketNumber:Gt,isTask:kt,subTaskNumber:it}),_e=Ee.index+Ee[0].length}return _e<P.length&&oe.push({text:P.substring(_e),isTicket:!1}),oe.length===0?s.jsx("span",{children:P}):s.jsx("span",{children:oe.map((We,et)=>We.isTicket||We.isTask?s.jsx("a",{href:We.isTask?`/tickets?search=${We.subTaskNumber?`TSK-${We.ticketNumber}-${We.subTaskNumber}`:`TSK-${We.ticketNumber}`}`:`/tickets?search=TKT-${We.ticketNumber}`,target:"_blank",rel:"noopener noreferrer",className:We.isTask?"text-amber-600 hover:text-amber-800 hover:underline font-medium cursor-pointer":"text-blue-600 hover:text-blue-800 hover:underline font-medium cursor-pointer",onClick:it=>{it.stopPropagation()},children:We.text},et):s.jsx("span",{children:We.text},et))})};return s.jsxs("div",{className:"flex h-full",children:[s.jsxs("div",{className:"w-96 bg-white flex flex-col h-full border-r border-gray-200",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h1",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Ui,{className:"w-6 h-6"}),"Mentions",f==="all-mentions"&&h&&s.jsx("span",{title:"Admin View",children:s.jsx(sS,{className:"w-5 h-5 text-blue-600"})})]}),R>0&&f==="my-mentions"&&s.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:R})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[f==="my-mentions"&&"Messages where you were mentioned",f==="all-mentions"&&h&&"All mentions (Admin view)",f==="by-staff"&&x&&`Mentions for ${((D=B.find(P=>P.id===x))==null?void 0:D.firstName)||"staff member"}`,f==="by-staff"&&!x&&"Select a staff member to view their mentions",f==="by-ticket"&&y&&`Mentions in ${y}`,f==="by-ticket"&&!y&&"Enter a ticket number to view mentions"]}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[pe?`${ee.length} of ${Y.length}`:`${Y.length}`," mention",Y.length!==1?"s":""," ",pe?"matching":"found"]})]}),s.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-white",children:s.jsxs("div",{className:"relative",children:[s.jsx(fi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:pe,onChange:P=>ke(P.target.value),placeholder:"Search by ticket (@261), task (*123), staff name, or message...",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),pe&&s.jsx("button",{onClick:()=>ke(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:"Clear search",children:s.jsx(_t,{className:"w-4 h-4"})})]})}),s.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 text-sm font-semibold text-gray-700 hover:text-gray-900",children:[s.jsx(C3,{className:"w-4 h-4"}),"Filters ",i?"":""]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsxs("button",{onClick:()=>{o.length>0?W.mutate({mentionIds:o,isRead:!1}):z("unread")},className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors ${A==="unread"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:o.length>0?`Mark ${o.length} as unread`:"Show unread only",children:["Unread (",Y.filter(P=>P.is_read===0&&P.is_archived===0).length,")"]}),s.jsxs("button",{onClick:()=>{o.length>0?W.mutate({mentionIds:o,isRead:!0}):z("read")},className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors ${A==="read"?"bg-gray-100 text-gray-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:o.length>0?`Mark ${o.length} as read`:"Show read only",children:["Read (",Y.filter(P=>P.is_read===1&&P.is_archived===0).length,")"]}),s.jsx("button",{onClick:()=>{F==="archived"?Z("active"):Q.mutate()},disabled:Q.isPending,className:"px-2 py-0.5 text-xs font-medium rounded-full transition-colors bg-pink-100 text-pink-700 hover:bg-pink-200 disabled:opacity-50",title:"Archive all Read mentions",children:"Archive"})]})]}),o.length>0?s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[" ",o.length," selected  Click pill to toggle read/unread"]}):s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:" Shift+Click: Select range  Ctrl/Cmd+Click: Toggle selection"}),!i&&s.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[f!==(h?"all-mentions":"my-mentions")&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:[f==="my-mentions"&&"My Mentions",f==="all-mentions"&&"All Mentions",f==="by-staff"&&x&&`Staff: ${(Me=B.find(P=>P.id===x))==null?void 0:Me.firstName}`,f==="by-ticket"&&y&&`Ticket: ${y}`]}),p&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full",children:["#",((Te=je.find(P=>P.id===p))==null?void 0:Te.name)||"Channel"]}),A!=="all"&&s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${A==="unread"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:A==="unread"?"Unread":"Read"}),w&&w!==""&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded-full",children:[w==="hour"&&"Last hour",w==="12hours"&&"Last 12h",w==="24hours"&&"Last 24h",w==="custom"&&"Custom dates"]}),!p&&A==="all"&&!w&&f===(h?"all-mentions":"my-mentions")&&s.jsx("span",{className:"text-xs text-gray-500 italic",children:"No filters applied"})]}),i&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"View"}),s.jsxs("select",{value:f,onChange:P=>{j(P.target.value),g(""),b("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"my-mentions",children:"My Mentions"}),h&&s.jsx("option",{value:"all-mentions",children:"All Mentions (Admin)"}),s.jsx("option",{value:"by-staff",children:"By Staff Member"}),s.jsx("option",{value:"by-ticket",children:"By Ticket Number"})]})]}),f==="by-staff"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Staff Member"}),s.jsxs("select",{value:x,onChange:P=>g(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select staff member..."}),B.map(P=>s.jsxs("option",{value:P.id,children:[P.firstName," ",P.lastName]},P.id))]})]}),f==="by-ticket"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Ticket Number"}),s.jsx("input",{type:"text",value:y,onChange:P=>b(P.target.value),placeholder:"e.g., TKT-000261",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Channel"}),s.jsxs("select",{value:p,onChange:P=>v(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"All channels"}),je.map(P=>s.jsxs("option",{value:P.id,children:["#",P.name]},P.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:A,onChange:P=>z(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"All"}),s.jsx("option",{value:"unread",children:"Unread only"}),s.jsx("option",{value:"read",children:"Read only"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Archive"}),s.jsxs("select",{value:F,onChange:P=>Z(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"active",children:"Active mentions"}),s.jsx("option",{value:"archived",children:"All Archived"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Time Range"}),s.jsxs("select",{value:w,onChange:P=>N(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"All time"}),s.jsx("option",{value:"hour",children:"Last hour"}),s.jsx("option",{value:"12hours",children:"Last 12 hours"}),s.jsx("option",{value:"24hours",children:"Last 24 hours"}),s.jsx("option",{value:"custom",children:"Custom date range"})]})]}),w==="custom"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"From"}),s.jsx("input",{type:"date",value:q,onChange:P=>O(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"To"}),s.jsx("input",{type:"date",value:V,onChange:P=>J(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s.jsx("button",{onClick:()=>{j(h?"all-mentions":"my-mentions"),g(""),b(""),v(""),N(""),z("all"),O(""),J("")},className:"w-full px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg border border-gray-300",children:"Clear All Filters"})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:X?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("div",{className:"text-gray-500",children:"Loading mentions..."})}):ee.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[s.jsx(Ui,{className:"w-16 h-16 text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"No mentions yet"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"When someone mentions you with @yourname, it will appear here"})]}):s.jsx("div",{className:"divide-y divide-gray-200",children:ee.map(P=>{const se=(n==null?void 0:n.id)===P.id,oe=o.includes(P.id),_e=P.is_read===0;let Ee="",We="";return oe?(Ee="bg-indigo-100",We="border-indigo-500"):se?(Ee=_e?"bg-blue-100":"bg-gray-100",We=_e?"border-blue-500":"border-gray-500",console.log("[MentionsPage] Selected mention:",P.id,"border:",We)):(Ee=_e?"bg-blue-50":"bg-white",We="border-transparent"),s.jsxs("button",{onClick:et=>H(P,et),style:{borderLeft:oe?"6px solid #6366f1":se?_e?"6px solid #3b82f6":"6px solid #6b7280":"6px solid transparent"},className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${Ee} relative`,children:[oe&&s.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-indigo-600 rounded flex items-center justify-center",children:s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[P.context_type==="group_chat"?s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-indigo-100 text-indigo-700 rounded-full",children:[s.jsx(Ot,{className:"w-3 h-3"}),P.channel_name]}):s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-purple-100 text-purple-700 rounded-full",children:[be(P.ticket_channel),ze(P.ticket_number)]}),s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-orange-50 text-orange-600 rounded-full",children:[s.jsx(Ui,{className:"w-3 h-3"}),"Mention by ",P.mentioning_first_name]}),s.jsx("span",{className:"text-xs text-gray-600",children:new Date(P.created_at).toLocaleString()}),P.is_read===0?s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-semibold bg-blue-100 text-blue-700 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Unread"]}):s.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-emerald-100 text-emerald-700 rounded-full",children:" Read"})]}),P.message_content&&s.jsx("div",{className:`text-sm line-clamp-2 ${P.is_read===0?"text-gray-900 font-medium":"text-gray-600"}`,children:le(P.message_content)}),P.attachment_url&&s.jsxs("div",{onClick:et=>{et.stopPropagation(),P.context_type==="group_chat"&&e(`/group-chat?channel=${P.context_id}&message=${P.message_id}`)},className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 mt-1 cursor-pointer",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"hover:underline",children:P.attachment_name||"Attachment"})]})]})]},P.id)})})})]}),s.jsx("div",{className:"flex-1 bg-white flex flex-col h-full",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.context_type==="group_chat"?s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-700 rounded-full",children:[s.jsx(Ot,{className:"w-3.5 h-3.5"}),n.channel_name]}):s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-purple-100 text-purple-700 rounded-full",children:[be(n.ticket_channel,"w-3.5 h-3.5"),ze(n.ticket_number)]}),s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-orange-50 text-orange-600 rounded-full",children:[s.jsx(Ui,{className:"w-3.5 h-3.5"}),"Mention by ",n.mentioning_first_name]}),s.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-medium bg-slate-100 text-slate-700 rounded-full",children:[s.jsx(yb,{className:"w-3.5 h-3.5"}),new Date(n.created_at).toLocaleString()]}),n.is_read===0?s.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-semibold bg-blue-100 text-blue-700 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Unread"]}):s.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-medium bg-emerald-100 text-emerald-700 rounded-full",children:" Read"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:ie,disabled:ge===0,className:"p-1.5 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",title:"Previous mention",children:s.jsx(xi,{className:"w-4 h-4"})}),s.jsx("button",{onClick:ne,disabled:ge===ee.length-1,className:"p-1.5 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",title:"Next mention",children:s.jsx(Jl,{className:"w-4 h-4"})}),n.is_read===1?s.jsx("button",{onClick:()=>G.mutate(n.id),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg border border-gray-300",children:"Mark as Unread"}):s.jsx("button",{onClick:()=>_.mutate(n.id),className:"px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded-lg border border-blue-300",children:"Mark as Read"}),s.jsxs("button",{onClick:he,className:"px-3 py-1.5 text-sm bg-blue-600 text-white hover:bg-blue-700 rounded-lg flex items-center gap-1",children:[s.jsx(cl,{className:"w-4 h-4"}),"Go to Chat"]})]})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"max-w-3xl",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Message"}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-gray-900 whitespace-pre-wrap text-base leading-relaxed",children:n.message_content?le(n.message_content):"No message content available"}),n.attachment_url&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>{n.context_type==="group_chat"&&e(`/group-chat?channel=${n.context_id}&message=${n.message_id}`)},className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 hover:underline",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:n.attachment_name||"Attachment"}),n.attachment_size&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(n.attachment_size/1024).toFixed(1)," KB)"]})]}),s.jsx("p",{className:"text-xs text-gray-400 mt-1 ml-6",children:"Click to view in Group Chat"})]})]})]})})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ui,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"Select a mention to view details"})]})})})]})}function cC(){const e=mt(),t=u.useRef(null),r=u.useRef(null),[n,a]=u.useState(""),[i,l]=u.useState(null),[o,c]=u.useState(null),[d,m]=u.useState(""),[h,f]=u.useState(!1),[j,x]=u.useState(null),[g,y]=u.useState(""),[b,p]=u.useState([]),[v,w]=u.useState(0),[N,A]=u.useState(!1),[z,F]=u.useState(null),{data:Z}=me({queryKey:["memos"],queryFn:async()=>(await Gi.getMemos()).data,refetchInterval:1e4}),q=(Z==null?void 0:Z.memos)||[];u.useEffect(()=>{r.current&&r.current.scrollIntoView({behavior:"smooth",block:"end"})},[q]),u.useEffect(()=>{const R=setTimeout(()=>{r.current&&r.current.scrollIntoView({behavior:"auto",block:"end"})},100);return()=>clearTimeout(R)},[]);const O=Ce({mutationFn:async R=>Gi.createMemo(R),onSuccess:()=>{a(""),l(null),e.invalidateQueries({queryKey:["memos"]})}}),V=Ce({mutationFn:({memoId:R,content:ae,deleteAttachment:je})=>Gi.editMemo(R,{content:ae,deleteAttachment:je}),onSuccess:()=>{c(null),f(!1),m(""),e.invalidateQueries({queryKey:["memos"]})}}),J=Ce({mutationFn:R=>Gi.deleteMemo(R),onSuccess:()=>{x(null),e.invalidateQueries({queryKey:["memos"]})}}),pe=R=>{if(y(R),!R.trim()||!q.length){p([]),w(0);return}const ae=R.toLowerCase(),je=[];[...q].reverse().forEach(_=>{let G=!1;_.content.toLowerCase().includes(ae)&&(G=!0),_.tags&&_.tags.split(",").map(Q=>Q.trim().toLowerCase()).some(Q=>Q.includes(ae))&&(G=!0),G&&je.push(_.id)}),p(je),w(0),je.length>0&&ke(je[0])},ke=R=>{F(R),setTimeout(()=>{const ae=document.getElementById(`memo-${R}`);ae&&ae.scrollIntoView({behavior:"smooth",block:"center"})},100),setTimeout(()=>{F(null)},5e3)},we=()=>{if(b.length===0)return;const R=(v+1)%b.length;w(R),ke(b[R])},B=()=>{if(b.length===0)return;const R=v===0?b.length-1:v-1;w(R),ke(b[R])},M=R=>{var je;const ae=(je=R.target.files)==null?void 0:je[0];ae&&l(ae)},X=R=>new Promise((ae,je)=>{const _=new FileReader;_.readAsDataURL(R),_.onload=()=>ae(_.result),_.onerror=G=>je(G)}),Y=async()=>{if(!n.trim()&&!i||O.isPending)return;let R=null;i&&(R={data:await X(i),name:i.name,type:i.type,size:i.size}),O.mutate({content:n.trim()||"(Attachment)",attachment:R})},ee=R=>{c(R.id),m(R.content),f(!1)},ie=()=>{!o||!d.trim()||V.mutate({memoId:o,content:d,deleteAttachment:h})},ne=async(R,ae)=>{try{const _=await(await fetch(R)).blob(),G=URL.createObjectURL(_),W=document.createElement("a");W.href=G,W.download=ae,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(G)}catch(je){console.error("Error downloading file:",je)}},ge=R=>R.split(/(@\w+|@\d+|#\d+|TKT-\d+|ticket\s+\d+|\*\d+(?:-\d+)?|TSK-\d+(?:-\d+)?)/gi).map((je,_)=>{if(je.match(/^@\w+$/)&&!je.match(/^@\d+$/))return s.jsx("span",{className:"bg-blue-100 text-blue-700 font-semibold px-1 rounded",children:je},_);const G=je.match(/^@(\d+)$|^#(\d+)$|^TKT-(\d+)$|^ticket\s+(\d+)$/i);if(G){const Q=G[1]||G[2]||G[3]||G[4];return s.jsx(Ye,{to:`/tickets?search=TKT-${Q}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",onClick:H=>{H.stopPropagation()},children:je},_)}const W=je.match(/^\*(\d+)(?:-(\d+))?$|^TSK-(\d+)(?:-(\d+))?$/i);if(W){const Q=W[1]||W[3],H=W[2]||W[4],he=H?`TSK-${Q}-${H}`:`TSK-${Q}`;return s.jsx(Ye,{to:`/tickets?search=${he}`,target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800 hover:underline font-medium",onClick:ze=>{ze.stopPropagation()},children:je},_)}return je}),$e=R=>R.startsWith("http")?R:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${R}`;return s.jsxs("div",{className:"flex flex-col overflow-hidden bg-gray-50",style:{height:"calc(100vh - 3.5rem)"},children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(_c,{className:"w-6 h-6 text-yellow-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"@Memos"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Personal notes to yourself"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:()=>A(!N),className:`p-2 rounded-lg ${N?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Search memos",children:s.jsx(fi,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-sm text-gray-500",children:[q.length," memo",q.length!==1?"s":""]})]})]}),N&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{type:"text",value:g,onChange:R=>pe(R.target.value),placeholder:"Search memos and tags... (e.g., James Scott, #james-scott)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),b.length>0&&s.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2 bg-white px-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[v+1," / ",b.length]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:B,className:"p-1 hover:bg-gray-100 rounded",title:"Previous result",children:s.jsx(ur,{className:"w-4 h-4"})}),s.jsx("button",{onClick:we,className:"p-1 hover:bg-gray-100 rounded",title:"Next result",children:s.jsx(Ws,{className:"w-4 h-4"})})]})]})]}),s.jsx("button",{onClick:()=>{A(!1),y(""),p([]),w(0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Close search",children:s.jsx(_t,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[q.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(_c,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500",children:"No @Memos yet. Create your first note below!"})]}):q.map(R=>{var je;const ae=z===R.id;return s.jsx("div",{id:`memo-${R.id}`,className:`bg-white rounded-lg shadow-sm border border-gray-200 p-4 transition-colors duration-500 ${ae?"bg-yellow-100 border-yellow-400":""}`,children:o===R.id?s.jsxs("div",{className:"space-y-3",children:[s.jsx("textarea",{value:d,onChange:_=>m(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3}),R.attachment_url&&!h&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:R.attachment_name}),s.jsx("button",{onClick:()=>f(!0),className:"text-red-600 hover:text-red-700 text-xs",children:"Remove"})]}),h&&s.jsx("div",{className:"text-sm text-red-600",children:"Attachment will be removed when you save"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:ie,disabled:!d.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:"Save"}),s.jsx("button",{onClick:()=>{c(null),f(!1)},className:"px-3 py-1.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm",children:"Cancel"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap break-words",children:ge(R.content)}),R.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(R.tags).map((_,G)=>s.jsxs(Ye,{to:`/tags?tag=${encodeURIComponent(_)}`,className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-sm rounded hover:bg-blue-200 transition-colors",children:[s.jsx(Ot,{className:"w-3 h-3"}),_]},G))}),R.attachment_url&&s.jsx("div",{className:"mt-3",children:(je=R.attachment_type)!=null&&je.startsWith("image/")?s.jsxs("div",{className:"relative group inline-block",children:[s.jsx("img",{src:$e(R.attachment_url),alt:R.attachment_name||"Attachment",className:"max-w-md max-h-64 rounded-lg border border-gray-200"}),s.jsx("div",{className:"absolute top-2 right-2 bg-white rounded-full shadow-md p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("button",{onClick:()=>ne($e(R.attachment_url),R.attachment_name||"download"),className:"text-gray-500 hover:text-blue-600",title:"Download image",children:s.jsx(Sc,{className:"w-4 h-4"})})})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("a",{href:$e(R.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:R.attachment_name}),R.attachment_size&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(R.attachment_size/1024).toFixed(1)," KB)"]})]}),s.jsx("button",{onClick:()=>ne($e(R.attachment_url),R.attachment_name||"download"),className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Download file",children:s.jsx(Sc,{className:"w-4 h-4"})})]})})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>ee(R),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Edit memo",children:s.jsx(Bh,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>x(R.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete memo",children:s.jsx(pi,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-500",children:[s.jsx("span",{children:new Date(R.created_at).toLocaleString()}),R.edited_at&&s.jsxs("span",{className:"italic",children:["(edited ",new Date(R.edited_at).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),")"]})]})]})},R.id)}),s.jsx("div",{ref:r})]}),s.jsxs("div",{className:"bg-white p-4 flex-shrink-0",children:[i&&s.jsxs("div",{className:"mb-3 flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-2",children:[i.type.startsWith("image/")?s.jsx(Cc,{className:"w-4 h-4 text-gray-600"}):s.jsx(Wo,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm text-gray-700",children:i.name}),s.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600 ml-auto",children:s.jsx(_t,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"file",ref:t,onChange:M,className:"hidden"}),s.jsx("button",{onClick:()=>{var R;return(R=t.current)==null?void 0:R.click()},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(St,{className:"w-5 h-5"})}),s.jsx("input",{value:n,onChange:R=>a(R.target.value),onKeyDown:R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),Y())},placeholder:"Write a note... Use #keyword to add tags (e.g., #james-scott, #artwork-issue)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"absolute -top-6 left-0 text-xs text-gray-500",children:Tb}),s.jsx("button",{onClick:Y,disabled:!n.trim()&&!i||O.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:O.isPending?s.jsxs(s.Fragment,{children:[s.jsx(wb,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ad,{className:"w-4 h-4"}),"Add"]})})]})]}),j&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Memo?"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this memo? This action cannot be undone."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>x(null),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>j&&J.mutate(j),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})})]})}function yf({rating:e,size:t="sm"}){const r={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return s.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(n=>s.jsx("svg",{className:`${r[t]} ${n<=e?"text-yellow-400 fill-yellow-400":"text-gray-300"}`,viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},n))})}function Eo({title:e,value:t,subtitle:r,trend:n,icon:a,color:i="indigo"}){const l={indigo:"bg-indigo-50 text-indigo-600",green:"bg-green-50 text-green-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600",blue:"bg-blue-50 text-blue-600"};return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:`p-2 rounded-lg ${l[i]}`,children:a}),n&&s.jsxs("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${n.positive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[n.positive?"":""," ",n.value]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500",children:e}),s.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:t}),r&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:r})]})]})}function dC(){var c,d;const[e,t]=u.useState("7d"),{data:r,isLoading:n}=me({queryKey:["ai-agent-analytics",e],queryFn:async()=>(await Bx.getAIAgentStats(e)).data.data}),{data:a}=me({queryKey:["ai-learning-examples"],queryFn:async()=>(await Bx.getLearningExamples(10)).data.data}),i=(r==null?void 0:r.stats)||{totalDrafts:0,avgQualityScore:0,helpfulRate:0,approvalRate:0,editRate:0,rejectRate:0},l=(r==null?void 0:r.qualityDistribution)||[],o=(r==null?void 0:r.intentPerformance)||[];return n?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(m=>s.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},m))})]})}):s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"AI Agent Analytics"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor AI performance, quality scores, and learning progress"})]}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("select",{value:e,onChange:m=>t(m.target.value),className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[s.jsx("option",{value:"24h",children:"Last 24 hours"}),s.jsx("option",{value:"7d",children:"Last 7 days"}),s.jsx("option",{value:"30d",children:"Last 30 days"}),s.jsx("option",{value:"all",children:"All time"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(Eo,{title:"Total AI Drafts",value:i.totalDrafts,subtitle:"Responses generated",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),color:"indigo"}),s.jsx(Eo,{title:"Average Quality",value:`${i.avgQualityScore.toFixed(1)}/5`,subtitle:"Staff rating",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),color:"yellow"}),s.jsx(Eo,{title:"Helpful Rate",value:`${i.helpfulRate.toFixed(0)}%`,subtitle:"Saved staff time",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),color:"green"}),s.jsx(Eo,{title:"Approval Rate",value:`${i.approvalRate.toFixed(0)}%`,subtitle:"Sent without edits",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"blue"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quality Score Distribution"}),s.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(m=>{const h=l.find(f=>f.score===m)||{count:0,percentage:0};return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-1 w-20",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:m}),s.jsx("svg",{className:"w-4 h-4 text-yellow-400 fill-yellow-400",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})]}),s.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-4 overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${m>=4?"bg-green-500":m===3?"bg-yellow-500":"bg-red-500"}`,style:{width:`${h.percentage}%`}})}),s.jsxs("span",{className:"text-sm text-gray-600 w-16 text-right",children:[h.count," (",h.percentage.toFixed(0),"%)"]})]},m)})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Response Actions"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Approved (No Edits)"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Sent exactly as AI generated"})]})]}),s.jsxs("span",{className:"text-lg font-semibold text-green-700",children:[i.approvalRate.toFixed(0),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Edited Before Sending"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Modified by staff"})]})]}),s.jsxs("span",{className:"text-lg font-semibold text-yellow-700",children:[i.editRate.toFixed(0),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Rejected"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Staff wrote new response"})]})]}),s.jsxs("span",{className:"text-lg font-semibold text-red-700",children:[i.rejectRate.toFixed(0),"%"]})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm mb-8",children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance by Intent"}),o.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Intent"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Volume"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Quality"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Helpful %"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trend"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map(m=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 capitalize",children:m.intent.replace(/_/g," ")}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.count}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yf,{rating:Math.round(m.avgQuality),size:"sm"}),s.jsx("span",{className:"text-sm text-gray-600",children:m.avgQuality.toFixed(1)})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m.helpfulRate>=80?"bg-green-100 text-green-800":m.helpfulRate>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[m.helpfulRate.toFixed(0),"%"]})}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.trend>0?s.jsx("span",{className:"text-green-600",children:" Improving"}):m.trend<0?s.jsx("span",{className:"text-red-600",children:" Declining"}):s.jsx("span",{className:"text-gray-500",children:" Stable"})})]},m.intent))})]})}):s.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No intent data available yet. Start approving AI drafts to see performance by intent."})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Learning Examples"}),s.jsx("p",{className:"text-sm text-gray-500",children:"High-quality responses (4-5 stars) used to improve AI"})]}),s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[((c=a==null?void 0:a.examples)==null?void 0:c.length)||0," examples"]})]}),((d=a==null?void 0:a.examples)==null?void 0:d.length)>0?s.jsx("div",{className:"space-y-4",children:a.examples.slice(0,5).map(m=>{var h;return s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-500 capitalize px-2 py-1 bg-gray-100 rounded",children:((h=m.intent)==null?void 0:h.replace(/_/g," "))||"General"}),s.jsx(yf,{rating:m.quality_score,size:"sm"})]}),s.jsx("span",{className:"text-xs text-gray-500",children:m.created_at?ys(new Date(m.created_at),{addSuffix:!0}):""})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Customer Message"}),s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:m.customer_message})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"AI Response"}),s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:m.ai_response})]})]})]},m.id)})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No learning examples yet"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Rate AI responses 4-5 stars to add them as learning examples"})]})]})]})}const uC=[1,2,3,4,5,6,0],bf=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function mC(){const e=mt(),[t,r]=u.useState(bf.map((x,g)=>({day_of_week:g,day_name:x,is_open:g>=1&&g<=5,open_time:"09:00",close_time:"17:00"}))),[n,a]=u.useState("Australia/Sydney"),[i,l]=u.useState("idle"),[o,c]=u.useState(""),{data:d,isLoading:m}=me({queryKey:["businessHours"],queryFn:()=>$r.getBusinessHours().then(x=>x.data.businessHours)}),{data:h}=me({queryKey:["chatSettings"],queryFn:()=>$r.getSettings().then(x=>x.data.settings)});u.useEffect(()=>{d&&r(d)},[d]),u.useEffect(()=>{h!=null&&h.timezone&&a(h.timezone)},[h]);const f=Ce({mutationFn:async()=>{await $r.updateBusinessHours(t.map(x=>({day_of_week:x.day_of_week,is_open:x.is_open,open_time:x.is_open?x.open_time:null,close_time:x.is_open?x.close_time:null}))),await $r.updateSettings({timezone:n})},onSuccess:()=>{e.invalidateQueries({queryKey:["businessHours"]}),e.invalidateQueries({queryKey:["chatSettings"]}),l("success"),setTimeout(()=>l("idle"),3e3)},onError:x=>{l("error"),c(x.message),setTimeout(()=>l("idle"),5e3)}}),j=(x,g,y)=>{r(b=>b.map(p=>p.day_of_week===x?{...p,[g]:y}:p))};return m?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Business Hours"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Set your operating hours for live chat availability"})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),s.jsxs("select",{value:n,onChange:x=>a(x.target.value),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"Australia/Sydney",children:"Australia/Sydney (AEST/AEDT)"}),s.jsx("option",{value:"Australia/Melbourne",children:"Australia/Melbourne"}),s.jsx("option",{value:"Australia/Brisbane",children:"Australia/Brisbane"}),s.jsx("option",{value:"Australia/Perth",children:"Australia/Perth (AWST)"}),s.jsx("option",{value:"Pacific/Auckland",children:"New Zealand (NZST/NZDT)"}),s.jsx("option",{value:"America/New_York",children:"US Eastern (EST/EDT)"}),s.jsx("option",{value:"America/Los_Angeles",children:"US Pacific (PST/PDT)"}),s.jsx("option",{value:"Europe/London",children:"UK (GMT/BST)"})]})]}),s.jsx("div",{className:"space-y-3",children:uC.map(x=>{const g=t.find(y=>y.day_of_week===x)||{day_of_week:x,day_name:bf[x],is_open:!1,open_time:"09:00",close_time:"17:00"};return s.jsxs("div",{className:"flex items-center gap-4 py-3 border-b border-gray-100 last:border-0",children:[s.jsx("div",{className:"w-28",children:s.jsx("span",{className:"font-medium text-gray-900",children:g.day_name})}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer min-w-[80px]",children:[s.jsx("input",{type:"checkbox",checked:g.is_open,onChange:y=>j(g.day_of_week,"is_open",y.target.checked),className:"h-4 w-4 text-indigo-600 rounded border-gray-300"}),s.jsx("span",{className:"text-sm text-gray-600",children:g.is_open?"Open":"Closed"})]}),g.is_open?s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("input",{type:"time",value:g.open_time||"09:00",onChange:y=>j(g.day_of_week,"open_time",y.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm"}),s.jsx("span",{className:"text-gray-500",children:"to"}),s.jsx("input",{type:"time",value:g.close_time||"17:00",onChange:y=>j(g.day_of_week,"close_time",y.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm"})]}):s.jsx("span",{className:"text-sm text-gray-400 italic flex-1",children:"Closed all day"})]},g.day_of_week)})}),s.jsxs("div",{className:"flex gap-2 pt-6 mt-4 border-t border-gray-200",children:[s.jsx("button",{onClick:()=>r(x=>x.map(g=>({...g,is_open:g.day_of_week>=1&&g.day_of_week<=5,open_time:"09:00",close_time:"17:00"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"Mon-Fri 9am-5pm"}),s.jsx("button",{onClick:()=>r(x=>x.map(g=>({...g,is_open:g.day_of_week>=1&&g.day_of_week<=6,open_time:"08:00",close_time:"18:00"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"Mon-Sat 8am-6pm"}),s.jsx("button",{onClick:()=>r(x=>x.map(g=>({...g,is_open:!0,open_time:"00:00",close_time:"23:59"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"24/7"})]}),s.jsxs("div",{className:"flex justify-end pt-6 mt-6 border-t border-gray-200",children:[i==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),i==="error"&&s.jsx("span",{className:"text-red-600 text-sm",children:o||"Failed to save"}),s.jsx("button",{onClick:()=>f.mutate(),disabled:f.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:f.isPending?"Saving...":"Save Business Hours"})]})]})]})}function hC(){const e=mt(),[t,r]=u.useState({is_enabled:!0,primary_color:"#1e40af",secondary_color:"#ffffff",button_text:"Chat with us",welcome_message:"Hi! How can we help you today?",offline_message:"Our team is currently offline. Please leave a message.",show_business_hours:!0,require_email_when_offline:!0}),[n,a]=u.useState("idle"),[i,l]=u.useState(""),{data:o,isLoading:c}=me({queryKey:["chatSettings"],queryFn:()=>$r.getSettings().then(m=>m.data.settings)});u.useEffect(()=>{o&&r(o)},[o]);const d=Ce({mutationFn:()=>$r.updateSettings(t),onSuccess:()=>{e.invalidateQueries({queryKey:["chatSettings"]}),a("success"),setTimeout(()=>a("idle"),3e3)},onError:m=>{a("error"),l(m.message),setTimeout(()=>a("idle"),5e3)}});return c?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AI Chat Widget"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure the chat widget appearance and behavior"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Enable Chat Widget"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Show the chat widget on your website"})]}),s.jsx("button",{onClick:()=>r(m=>({...m,is_enabled:!m.is_enabled})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${t.is_enabled?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${t.is_enabled?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:t.primary_color,onChange:m=>r(h=>({...h,primary_color:m.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm",style:{backgroundColor:t.primary_color}})]}),s.jsx("input",{type:"text",value:t.primary_color,onChange:m=>r(h=>({...h,primary_color:m.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:t.secondary_color,onChange:m=>r(h=>({...h,secondary_color:m.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm",style:{backgroundColor:t.secondary_color}})]}),s.jsx("input",{type:"text",value:t.secondary_color,onChange:m=>r(h=>({...h,secondary_color:m.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),s.jsx("input",{type:"text",value:t.button_text,onChange:m=>r(h=>({...h,button_text:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Chat with us"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),s.jsx("textarea",{value:t.welcome_message,onChange:m=>r(h=>({...h,welcome_message:m.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Hi! How can we help you today?"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"First message shown when chat opens"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Offline Message"}),s.jsx("textarea",{value:t.offline_message,onChange:m=>r(h=>({...h,offline_message:m.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Our team is currently offline..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown when no staff are online"})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Business Hours"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Display hours in the widget"})]}),s.jsx("button",{onClick:()=>r(m=>({...m,show_business_hours:!m.show_business_hours})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${t.show_business_hours?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${t.show_business_hours?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Require Email When Offline"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Collect email for follow-up"})]}),s.jsx("button",{onClick:()=>r(m=>({...m,require_email_when_offline:!m.require_email_when_offline})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${t.require_email_when_offline?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${t.require_email_when_offline?"translate-x-5":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:[n==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),n==="error"&&s.jsx("span",{className:"text-red-600 text-sm",children:i||"Failed to save"}),s.jsx("button",{onClick:()=>d.mutate(),disabled:d.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:d.isPending?"Saving...":"Save Settings"})]})]})}),s.jsxs("div",{className:"bg-gray-100 rounded-lg p-6",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Preview"}),s.jsxs("div",{className:"bg-white rounded-lg shadow-inner h-96 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 p-4",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),s.jsx("div",{className:"h-24 bg-gray-100 rounded mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),s.jsx("div",{className:"absolute bottom-4 right-4",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-5 py-3 rounded-full shadow-lg cursor-pointer transform hover:scale-105 transition-transform",style:{backgroundColor:t.primary_color,color:t.secondary_color},children:[s.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx("span",{className:"font-medium",children:t.button_text})]})})]})]})]})]})}const Yd={email:"",first_name:"",last_name:"",role:"agent",job_title:"",phone:"",department:"Customer Service",password:""};function xC(){const e=mt(),{user:t}=us(),r=(t==null?void 0:t.role)==="admin",[n,a]=u.useState(!1),[i,l]=u.useState(null),[o,c]=u.useState(Yd),[d,m]=u.useState(""),[h,f]=u.useState(null),j=u.useRef(null),[x,g]=u.useState(null),{data:y,isLoading:b}=me({queryKey:["staffUsers"],queryFn:()=>rt.list().then(B=>{const M=B.data.staff;return!r&&(t!=null&&t.id)?M.filter(X=>X.id===t.id):M})}),{data:p}=me({queryKey:["tickets","all"],queryFn:()=>Ie.list({limit:1e3}).then(B=>B.data.tickets)}),v=B=>p?p.filter(M=>M.assigned_to===B&&M.status!=="resolved"&&M.status!=="closed").length:0,w=Ce({mutationFn:({staffId:B,status:M})=>rt.updateAvailability(B,M),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]})}}),N=Ce({mutationFn:B=>rt.create({...B,password:B.password||""}),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),ke()},onError:B=>{var M,X;m(((X=(M=B.response)==null?void 0:M.data)==null?void 0:X.error)||"Failed to create staff member")}}),A=Ce({mutationFn:({id:B,data:M})=>rt.update(B,M),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),ke()},onError:B=>{var M,X;m(((X=(M=B.response)==null?void 0:M.data)==null?void 0:X.error)||"Failed to update staff member")}}),z=Ce({mutationFn:({staffId:B,file:M})=>rt.uploadAvatar(B,M),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),e.invalidateQueries({queryKey:["currentStaff"]}),f(null)},onError:B=>{var M,X;m(((X=(M=B.response)==null?void 0:M.data)==null?void 0:X.error)||"Failed to upload photo"),f(null)}}),F=B=>{var M;!r&&B!==(t==null?void 0:t.id)||(g(B),(M=j.current)==null||M.click())},Z=B=>{var X;const M=(X=B.target.files)==null?void 0:X[0];if(M&&x){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(M.type)){m("Invalid file type. Please use JPEG, PNG, GIF, or WebP");return}if(M.size>5*1024*1024){m("File too large. Maximum size is 5MB");return}f(x),z.mutate({staffId:x,file:M})}j.current&&(j.current.value=""),g(null)},q={online:{color:"bg-green-500",label:"Available",badgeClass:"bg-green-100 text-green-700 border-green-200"},offline:{color:"bg-gray-400",label:"Offline",badgeClass:"bg-gray-100 text-gray-600 border-gray-200"},away:{color:"bg-amber-500",label:"Away",badgeClass:"bg-amber-100 text-amber-700 border-amber-200"}},O=B=>{if(B.job_title)return B.job_title;switch(B.role){case"admin":return"Administrator";case"manager":return"Customer Service Manager";default:return"Support Agent"}},V=B=>new Date(B).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}),J=()=>{l(null),c(Yd),m(""),a(!0)},pe=B=>{!r&&B.id!==(t==null?void 0:t.id)||(l(B),c({email:B.email,first_name:B.first_name,last_name:B.last_name,role:B.role,job_title:B.job_title||"",phone:B.phone||"",department:B.department||"Customer Service",password:""}),m(""),a(!0))},ke=()=>{a(!1),l(null),c(Yd),m("")},we=B=>{if(B.preventDefault(),m(""),!o.email||!o.first_name){m("Email and First Name are required");return}if(i){const M={first_name:o.first_name,last_name:o.last_name,job_title:o.job_title,phone:o.phone,department:o.department};r&&(M.role=o.role,M.email=o.email),o.password&&(M.password=o.password),A.mutate({id:i.id,data:M})}else{if(!o.password){m("Password is required for new staff members");return}N.mutate(o)}};return b?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Members"}),s.jsx("p",{className:"text-gray-600 mt-1",children:r?"Manage your support team and their availability":"View and edit your profile"})]}),r&&s.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[s.jsx(nd,{className:"w-5 h-5"}),"Add Staff Member"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y==null?void 0:y.map(B=>{const M=B.availability_status||"offline",X=q[M],Y=v(B.id),ee=B.id===(t==null?void 0:t.id),ie=r||ee;return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"p-5 pb-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative group",children:[B.avatar_url?s.jsx("img",{src:rt.getAvatarUrl(B.avatar_url)||"",alt:`${B.first_name} ${B.last_name}`,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-gray-500",children:s.jsx(Zl,{className:"w-6 h-6"})}),s.jsx("span",{className:`absolute bottom-0 right-0 w-3.5 h-3.5 rounded-full border-2 border-white ${X.color}`}),(r||ee)&&s.jsx("button",{onClick:()=>F(B.id),className:"absolute inset-0 rounded-full bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",title:"Upload photo",children:h===B.id?s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):s.jsx(t3,{className:"w-5 h-5 text-white"})})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:[ee?"You":`${B.first_name}`,B.last_name&&!ee&&` ${B.last_name}`]}),s.jsx("p",{className:"text-sm text-gray-500",children:O(B)})]})]}),r||ee?s.jsxs("select",{value:M,onChange:ne=>w.mutate({staffId:B.id,status:ne.target.value}),className:`text-xs font-medium px-3 py-1 rounded-full border cursor-pointer ${X.badgeClass}`,children:[s.jsx("option",{value:"online",children:"Available"}),s.jsx("option",{value:"away",children:"Away"}),s.jsx("option",{value:"offline",children:"Offline"})]}):s.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full border ${X.badgeClass}`,children:X.label})]})}),s.jsxs("div",{className:"px-5 pb-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(rr,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"truncate",children:B.email})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(ba,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{children:B.phone||"Not set"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(pb,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{children:B.department||"Customer Service"})]})]}),s.jsxs("div",{className:"px-5 py-3 bg-gray-50 border-t border-gray-100 flex items-center justify-between text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Active Tickets: "}),s.jsx("span",{className:`font-medium ${Y>0?"text-indigo-600":"text-gray-900"}`,children:Y})]}),ie?s.jsxs("button",{onClick:()=>pe(B),className:"flex items-center gap-1 text-indigo-600 hover:text-indigo-800 font-medium",children:[s.jsx(kb,{className:"w-4 h-4"}),"Edit"]}):s.jsxs("div",{className:"text-gray-500",children:["Joined: ",s.jsx("span",{className:"font-medium text-gray-700",children:V(B.created_at)})]})]})]},B.id)})}),(!y||y.length===0)&&s.jsx("div",{className:"text-center py-12 text-gray-500 bg-white rounded-lg border border-gray-200",children:"No team members found"}),s.jsx("input",{ref:j,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:Z,className:"hidden"}),n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i?"Edit Staff Member":"Add Staff Member"}),s.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:we,className:"p-6 space-y-4",children:[d&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:o.first_name,onChange:B=>c(M=>({...M,first_name:B.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),s.jsx("input",{type:"text",value:o.last_name,onChange:B=>c(M=>({...M,last_name:B.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"email",value:o.email,onChange:B=>c(M=>({...M,email:B.target.value})),disabled:!!i&&!r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:text-gray-500",required:!0}),i&&!r&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Contact an admin to change your email"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),s.jsx("input",{type:"tel",value:o.phone,onChange:B=>c(M=>({...M,phone:B.target.value})),placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title"}),s.jsx("input",{type:"text",value:o.job_title,onChange:B=>c(M=>({...M,job_title:B.target.value})),placeholder:"e.g., Senior Support Agent",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),s.jsx("input",{type:"text",value:o.department,onChange:B=>c(M=>({...M,department:B.target.value})),placeholder:"e.g., Customer Service",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),r&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),s.jsxs("select",{value:o.role,onChange:B=>c(M=>({...M,role:B.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[s.jsx("option",{value:"agent",children:"Support Agent"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"admin",children:"Administrator"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i?"New Password":"Password",!i&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"password",value:o.password,onChange:B=>c(M=>({...M,password:B.target.value})),placeholder:i?"Leave blank to keep current password":"Enter password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!i})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:ke,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:N.isPending||A.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:N.isPending||A.isPending?"Saving...":i?"Save Changes":"Add Staff Member"})]})]})]})})]})}function fC(){const{data:e,isLoading:t}=me({queryKey:["staffUsers"],queryFn:()=>rt.list().then(r=>r.data.staff)});return t?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Staff Performance"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Track team productivity and response metrics"})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Performance Analytics Coming Soon"}),s.jsx("p",{className:"text-gray-600 max-w-md mx-auto mb-6",children:"We're building detailed performance metrics including response times, ticket resolution rates, customer satisfaction scores, and more."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto mt-8",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Avg Response Time"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Tickets Resolved"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Satisfaction Score"})]})]}),s.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-8",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-4",children:["Team Members (",(e==null?void 0:e.length)||0,")"]}),s.jsx("div",{className:"flex justify-center gap-2 flex-wrap",children:e==null?void 0:e.map(r=>{var n,a;return s.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 rounded-full px-3 py-1.5",children:[s.jsxs("div",{className:"w-6 h-6 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 text-xs font-medium",children:[(n=r.first_name)==null?void 0:n[0],(a=r.last_name)==null?void 0:a[0]]}),s.jsx("span",{className:"text-sm text-gray-700",children:r.first_name})]},r.id)})})]})]})]})}const Gr={listConversations:async e=>(await I.get(`/api/chat/conversations?tab=${e}`)).data,getConversation:async e=>(await I.get(`/api/chat/conversation/${e}`)).data,takeoverConversation:async e=>(await I.post(`/api/chat/conversation/${e}/takeover`)).data,replyToConversation:async(e,t)=>(await I.post(`/api/chat/conversation/${e}/reply`,{message:t})).data,closeConversation:async(e,t)=>(await I.post(`/api/chat/conversation/${e}/close`,{resolution_type:t})).data,pickupFromQueue:async e=>(await I.post(`/api/chat/conversation/${e}/pickup`)).data,reassignConversation:async(e,t,r)=>(await I.post(`/api/chat/conversation/${e}/reassign`,{assignTo:t,reason:r})).data,getStaffList:async()=>(await I.get("/api/staff")).data},vf=[{key:"ai",label:"AI",icon:s.jsx(er,{className:"w-4 h-4"}),description:"Active chats with AI"},{key:"staff",label:"Staff",icon:s.jsx(Zl,{className:"w-4 h-4"}),description:"Escalated to staff"},{key:"queued",label:"Queued",icon:s.jsx(jb,{className:"w-4 h-4"}),description:"Awaiting staff"},{key:"closed",label:"Closed",icon:s.jsx(gb,{className:"w-4 h-4"}),description:"Resolved & inactive"}],Jd=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"";function gC(){var Fe,De,at,Pt,In;const{user:e}=us(),t=mt(),[r,n]=Bl(),[a,i]=u.useState("ai"),[l,o]=u.useState(null),[c,d]=u.useState(""),[m,h]=u.useState(!1),[f,j]=u.useState(!1),[x,g]=u.useState(""),[y,b]=u.useState(""),[p,v]=u.useState(!1),[w,N]=u.useState(""),[A,z]=u.useState(250),[F,Z]=u.useState(null),[q,O]=u.useState(""),[V,J]=u.useState(null),[pe,ke]=u.useState(!1),[we,B]=u.useState([]),[M,X]=u.useState(!1),[Y,ee]=u.useState(!1),[ie,ne]=u.useState(!1),[ge,$e]=u.useState("all"),[R,ae]=u.useState(0),[je,_]=u.useState(null),G=u.useRef(null),W=u.useRef(null);u.useEffect(()=>{ae(0)},[l,ie]),u.useEffect(()=>{const E=T=>{(T.ctrlKey||T.metaKey)&&T.key==="y"&&(T.preventDefault(),v(Ae=>!Ae))};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[]),u.useEffect(()=>{const E=r.get("conversation"),T=r.get("ticket");E?(o(E),r.delete("conversation"),n(r,{replace:!0})):T&&(I.get(`/api/chat/conversation/by-ticket/${T}`).then(Ae=>{if(Ae.data.conversation){o(Ae.data.conversation.id);const Re=Ae.data.conversation;Re.status==="closed"||Re.resolution_type?i("closed"):Re.status==="queued"?i("queued"):Re.status==="ai_handling"?i("ai"):Re.status==="assigned"||Re.status==="staff_handling"?i("staff"):i("ai")}}).catch(Ae=>console.error("Failed to find conversation for ticket:",Ae)),r.delete("ticket"),n(r,{replace:!0}))},[r,n]);const{data:Q,isLoading:H}=me({queryKey:["chat-conversations",a],queryFn:()=>Gr.listConversations(a),refetchInterval:5e3}),{data:he}=me({queryKey:["chat-tab-counts"],queryFn:async()=>{const[E,T,Ae,Re]=await Promise.all([I.get("/api/chat/conversations?tab=ai&count_only=true"),I.get("/api/chat/conversations?tab=staff&count_only=true"),I.get("/api/chat/conversations?tab=queued&count_only=true"),I.get("/api/chat/conversations?tab=closed&count_only=true")]);return{ai:E.data.count||0,staff:T.data.count||0,queued:Ae.data.count||0,closed:Re.data.count||0}},refetchInterval:1e4}),{data:ze,isLoading:be}=me({queryKey:["chat-conversation",l],queryFn:()=>Gr.getConversation(l),enabled:!!l,refetchInterval:3e3}),le=(ze==null?void 0:ze.messages)||[],D=ze==null?void 0:ze.conversation,{data:Me,isLoading:Te}=me({queryKey:["shopify-data",D==null?void 0:D.customer_email],queryFn:async()=>D!=null&&D.customer_email?(await I.get(`/api/shopify/ticket-data?email=${encodeURIComponent(D.customer_email)}`)).data:null,enabled:!!(D!=null&&D.customer_email)&&ie}),{data:P,refetch:se}=me({queryKey:["ticket-notes",D==null?void 0:D.ticket_id],queryFn:async()=>D!=null&&D.ticket_id?(await Ie.get(D.ticket_id)).data:null,enabled:!!(D!=null&&D.ticket_id)}),oe=(P==null?void 0:P.notes)||[],_e=Ce({mutationFn:E=>Gr.takeoverConversation(E),onSuccess:()=>{t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-conversation"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]})}}),Ee=Ce({mutationFn:E=>Gr.pickupFromQueue(E),onSuccess:()=>{t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-conversation"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]}),i("staff")}}),We=Ce({mutationFn:({id:E,message:T})=>Gr.replyToConversation(E,T),onSuccess:()=>{d(""),t.invalidateQueries({queryKey:["chat-conversation"]})}}),et=Ce({mutationFn:({id:E,resolutionType:T})=>Gr.closeConversation(E,T),onSuccess:()=>{o(null),h(!1),t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]})}}),it=Ce({mutationFn:({id:E,assignTo:T,reason:Ae})=>Gr.reassignConversation(E,T,Ae),onSuccess:()=>{j(!1),g(""),b(""),t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-conversation"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]})}}),{data:kt}=me({queryKey:["staff-list"],queryFn:()=>Gr.getStaffList(),enabled:f||a==="staff"}),Gt=(kt==null?void 0:kt.staff)||[],ss=(Q==null?void 0:Q.conversations)||[];u.useEffect(()=>{!l&&ss.length>0&&!H&&o(ss[0].id)},[ss,l,H]);const Et=ss.filter(E=>ge==="all"||E.assigned_to===ge),rs=()=>{if(!l||Et.length===0)return;const E=Et.findIndex(T=>T.id===l);E>0&&o(Et[E-1].id)},Hs=()=>{if(!l||Et.length===0)return;const E=Et.findIndex(T=>T.id===l);E<Et.length-1&&o(Et[E+1].id)},ks=l?Et.findIndex(E=>E.id===l):-1,wr=ks>0,Rs=ks>=0&&ks<Et.length-1;u.useEffect(()=>{const E=Ae=>{if(!pe)return;const Re=A+(window.innerHeight-Ae.clientY-A),Ge=150,yt=window.innerHeight*.6;Re>=Ge&&Re<=yt&&z(Re)},T=()=>{ke(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return pe&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",E),window.addEventListener("mouseup",T)),()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",T)}},[pe,A]);const de=E=>new Promise((T,Ae)=>{const Re=new FileReader;Re.readAsDataURL(E),Re.onload=()=>T(Re.result),Re.onerror=Ge=>Ae(Ge)}),Nr=async E=>{const T=Array.from(E.target.files||[]);for(const Ae of T)if(Ae.size>10*1024*1024){alert(`File ${Ae.name} is too large. Maximum size is 10MB.`),E.target.value="";return}B(Ae=>[...Ae,...T]),E.target.value=""},hs=E=>{B(T=>T.filter((Ae,Re)=>Re!==E))},Ps=()=>{!l||!c.trim()||(We.mutate({id:l,message:c.trim()}),setTimeout(()=>{var E;(E=W.current)==null||E.scrollIntoView({behavior:"smooth"})},100))},ar=E=>new Date(E).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"}),Ss=E=>{if(!E)return null;const T=new Date(E),Re=new Date().getTime()-T.getTime(),Ge=Math.floor(Re/6e4);return Ge<1?"Just now":Ge===1?"1 min":`${Ge} mins`},Xe=E=>{switch(E){case"urgent":case"critical":return s.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700",children:E});case"high":return s.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-orange-100 text-orange-700",children:"high"});default:return null}},$=E=>{switch(E){case"angry":return s.jsx("span",{className:"text-xs",children:""});case"negative":return s.jsx("span",{className:"text-xs",children:""});case"positive":return s.jsx("span",{className:"text-xs",children:""});default:return null}},fe=E=>{switch(E){case"ai_resolved":return s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-100 text-green-700 flex items-center gap-1",children:[s.jsx(lt,{className:"w-3 h-3"})," AI Resolved"]});case"staff_resolved":return s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 flex items-center gap-1",children:[s.jsx(lt,{className:"w-3 h-3"})," Staff Resolved"]});case"inactive_closed":return s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600 flex items-center gap-1",children:[s.jsx(br,{className:"w-3 h-3"})," Inactive"]});default:return null}};return s.jsxs("div",{className:"h-[calc(100vh-4rem)] flex",children:[s.jsxs("div",{className:"w-80 border-r border-gray-200 bg-white flex flex-col",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-2",children:[s.jsx(Ye,{to:"/tickets",className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",title:"Back to Tickets",children:s.jsx(xi,{className:"w-5 h-5 text-gray-500"})}),s.jsxs("svg",{className:"w-5 h-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),"Live Chats"]}),s.jsx("div",{className:"flex gap-1 mb-2",children:vf.map(E=>s.jsxs("button",{onClick:()=>{i(E.key),o(null)},className:`flex-1 flex flex-col items-center px-2 py-1.5 text-xs rounded-lg transition-colors ${a===E.key?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:E.description,children:[E.icon,s.jsx("span",{className:"mt-0.5",children:E.label}),he&&he[E.key]>0&&s.jsx("span",{className:`mt-0.5 px-1.5 py-0.5 text-xs rounded-full ${a===E.key?"bg-white/20 text-white":"bg-indigo-100 text-indigo-700"}`,children:he[E.key]})]},E.key))}),s.jsxs("select",{value:a==="staff"?ge:"all",onChange:E=>$e(E.target.value),disabled:a!=="staff",className:`w-full h-7 text-xs border rounded-lg px-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a==="staff"?"border-indigo-300 bg-white":"border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[s.jsx("option",{value:"all",children:"All Staff"}),Gt.filter(E=>E.id!=="ai-agent-001").map(E=>s.jsxs("option",{value:E.id,children:[E.first_name," ",E.last_name," (",E.availability_status==="online"?"Online":E.availability_status==="away"?"Away":"Offline",")"]},E.id))]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:H?s.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading..."}):Et.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsxs("div",{className:"text-gray-300 mb-2",children:[a==="ai"&&s.jsx(G4,{className:"w-8 h-8 mx-auto"}),a==="staff"&&s.jsx(Zl,{className:"w-8 h-8 mx-auto"}),a==="queued"&&s.jsx(jb,{className:"w-8 h-8 mx-auto"}),a==="closed"&&s.jsx(gb,{className:"w-8 h-8 mx-auto"})]}),ge!=="all"?"No chats for selected staff member":`No ${(Fe=vf.find(E=>E.key===a))==null?void 0:Fe.label.toLowerCase()} chats`]}):Et.map(E=>s.jsxs("div",{onClick:()=>o(E.id),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${l===E.id?"bg-indigo-50 border-l-4 border-l-indigo-600":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:s.jsx(yn,{className:"w-4 h-4 text-indigo-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm",children:E.customer_name}),s.jsx("p",{className:"text-xs text-gray-500",children:E.customer_email})]})]}),s.jsx("span",{className:"text-xs text-gray-400",children:ar(E.last_message_at)})]}),s.jsx("p",{className:"mt-2 text-sm text-gray-600 truncate",children:E.last_message==="__SHOW_CALLBACK_FORM__"?"CALL BACK REQUEST":E.last_message||"No messages yet"}),s.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[Xe(E.priority),$(E.sentiment),a==="ai"&&s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-purple-100 text-purple-700 flex items-center gap-1",children:[s.jsx(er,{className:"w-3 h-3"})," McCarthy AI"]}),a==="staff"&&E.assigned_staff_first_name&&s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-700",children:[" ",E.assigned_staff_first_name]}),a==="queued"&&s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3"})," ",Ss(E.queue_entered_at)||"Waiting"]}),a==="closed"&&fe(E.resolution_type),s.jsxs("span",{className:"text-xs text-gray-400",children:[E.message_count," msgs"]})]})]},E.id))})]}),s.jsx("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden",children:l?be?s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Loading conversation..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[(De=D==null?void 0:D.subject)!=null&&De.toLowerCase().includes("callback request")?s.jsx(ba,{className:"w-4 h-4 text-red-600 fill-current"}):s.jsxs("svg",{className:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),D!=null&&D.ticket_number?s.jsx(Ye,{to:`/tickets?search=${encodeURIComponent(D.ticket_number)}`,className:"text-base font-semibold text-blue-600 hover:text-blue-800 hover:underline",title:"View in All Tickets",children:D.ticket_number}):s.jsx("h1",{className:"text-base font-semibold text-gray-900",children:"Chat"})]}),s.jsx("button",{className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium ${(D==null?void 0:D.status)==="ai_handling"?"bg-green-100 text-green-800 border-green-200":(D==null?void 0:D.status)==="staff_handling"||(D==null?void 0:D.status)==="assigned"?"bg-blue-100 text-blue-800 border-blue-200":(D==null?void 0:D.status)==="queued"?"bg-green-100 text-green-800 border-green-200":(D==null?void 0:D.status)==="closed"?"bg-gray-100 text-gray-800 border-gray-200":"bg-green-100 text-green-800 border-green-200"}`,children:(D==null?void 0:D.status)==="ai_handling"?"open":(D==null?void 0:D.status)==="staff_handling"||(D==null?void 0:D.status)==="assigned"?"in-progress":(D==null?void 0:D.status)==="queued"?"open":(D==null?void 0:D.status)==="closed"?"resolved":D==null?void 0:D.status}),s.jsx("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-blue-50 text-blue-700 ring-blue-600/20",children:(D==null?void 0:D.priority)||"normal"}),s.jsxs("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-gray-50 text-gray-600 ring-gray-500/20",children:[(D==null?void 0:D.sentiment)==="positive"?"":(D==null?void 0:D.sentiment)==="negative"?"":(D==null?void 0:D.sentiment)==="angry"?"":""," ",(D==null?void 0:D.sentiment)||"neutral"]})]}),s.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(D==null?void 0:D.assigned_to)==="ai-agent-001"?"McCarthy AI":D!=null&&D.assigned_staff_first_name?`${D.assigned_staff_first_name} ${D.assigned_staff_last_name||""}`:"Unassigned"})]}),s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:(D==null?void 0:D.customer_name)||(D==null?void 0:D.customer_email)}),s.jsx("span",{className:"text-xs text-gray-500",children:(D==null?void 0:D.started_at)&&new Date(D.started_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[s.jsx("span",{className:"font-medium",children:"Subject:"})," Live Chat Conversation"]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(D==null?void 0:D.status)==="queued"&&s.jsxs("button",{onClick:()=>Ee.mutate(l),disabled:Ee.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Rl,{className:"w-3 h-3"}),s.jsx("span",{children:"Pick Up"})]}),(D==null?void 0:D.status)==="ai_handling"&&(D==null?void 0:D.assigned_to)==="ai-agent-001"&&s.jsxs("button",{onClick:()=>_e.mutate(l),disabled:_e.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Rl,{className:"w-3 h-3"}),s.jsx("span",{children:"Take Over"})]}),s.jsxs("button",{onClick:()=>j(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:"Reassign"})]}),(D==null?void 0:D.status)!=="closed"&&s.jsxs("button",{onClick:()=>h(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx(lt,{className:"w-3 h-3"}),s.jsx("span",{children:"Close Chat"})]})]})]})]}),s.jsxs("div",{className:"px-4 py-3 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>X(!M),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(yn,{className:"w-3 h-3"}),s.jsx("span",{children:"Customer Info"})]}),s.jsxs("button",{onClick:()=>ee(!Y),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(Ys,{className:"w-3 h-3"}),s.jsx("span",{children:"Order History"})]}),s.jsxs("button",{onClick:()=>ne(!ie),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${ie?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[s.jsx(lt,{className:"w-3 h-3"}),s.jsx("span",{children:"Shopify"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:rs,disabled:!wr,className:`p-1 border border-gray-200 rounded ${wr?"text-gray-400 hover:text-gray-600 hover:bg-gray-50":"text-gray-200 cursor-not-allowed"}`,children:s.jsx(xi,{className:"w-4 h-4"})}),s.jsx("button",{onClick:Hs,disabled:!Rs,className:`p-1 border border-gray-200 rounded ${Rs?"text-gray-400 hover:text-gray-600 hover:bg-gray-50":"text-gray-200 cursor-not-allowed"}`,children:s.jsx(Jl,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[M&&s.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"}),s.jsx("span",{className:"ml-2 font-medium",children:D==null?void 0:D.customer_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"VIP:"}),s.jsx("span",{className:"ml-2 font-medium text-amber-600",children:"No"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"Email:"}),s.jsx("span",{className:"ml-2 font-medium",children:D==null?void 0:D.customer_email})]})]})]})}),Y&&s.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),s.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[le.map(E=>{const T=E.sender_type==="customer",Ae=E.sender_type==="system",Re=E.sender_type==="ai";if(Ae){const Ge=E.content==="__SHOW_CALLBACK_FORM__"?"CALL BACK REQUEST":E.content;return s.jsx("div",{className:"py-3 text-center",children:s.jsx("span",{className:"inline-block px-3 py-1 text-xs text-gray-500 bg-gray-100 rounded-full",children:Ge})},E.id)}return s.jsxs("div",{className:`p-4 rounded-lg ${T?"bg-gray-100":Re?"bg-purple-50":"bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${T?"bg-gray-300":Re?"bg-purple-200":"bg-blue-200"}`,children:T?s.jsx(yn,{className:"w-3 h-3 text-gray-600"}):Re?s.jsx(er,{className:"w-3 h-3 text-purple-600"}):s.jsx(yn,{className:"w-3 h-3 text-blue-600"})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:E.sender_name||(T?D==null?void 0:D.customer_name:Re?"McCarthy AI":"Staff")}),s.jsx("span",{className:"text-xs text-gray-400",children:E.created_at&&ys(new Date(E.created_at),{addSuffix:!0})})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:E.content})]},E.id)}),s.jsx("div",{ref:W})]})]}),(a==="staff"||a==="ai"&&(D==null?void 0:D.assigned_to)!=="ai-agent-001")&&(D==null?void 0:D.status)!=="closed"&&s.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-t border-gray-200 p-4",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("textarea",{value:c,onChange:E=>d(E.target.value),onKeyDown:E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),Ps())},placeholder:"Type your reply... (Press Enter to send, Shift+Enter for new line)",className:"flex-1 border border-gray-300 rounded-lg px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white",rows:3}),s.jsxs("button",{onClick:Ps,disabled:!c.trim()||We.isPending,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium transition-colors self-end",children:[s.jsx(ad,{className:"w-4 h-4"}),"Send"]})]})}),(D==null?void 0:D.status)==="closed"&&s.jsxs("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:[s.jsx(lt,{className:"w-5 h-5 inline-block mr-2"}),s.jsx("span",{className:"text-sm",children:"This chat has been closed"})]}),s.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[p&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>ke(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>v(!p),children:[s.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),p&&s.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${A}px`},children:[oe&&oe.length>0&&s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:oe.map(E=>{var T;return s.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:E.first_name||"Staff"}),s.jsx("span",{className:"text-xs text-gray-500",children:E.created_at&&typeof E.created_at=="string"?ys(new Date(E.created_at.includes("Z")?E.created_at:E.created_at+"Z"),{addSuffix:!0}):""}),E.edited_at&&s.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),s.jsx("div",{className:"flex items-center gap-2",children:(E.staff_id===(e==null?void 0:e.id)||(e==null?void 0:e.role)==="admin")&&F!==E.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{Z(E.id),O(E.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),s.jsx("button",{onClick:()=>J(E.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]})})]}),F===E.id?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:q,onChange:Ae=>O(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:async()=>{var Ae,Re;if(!(!(P!=null&&P.ticket)||!q.trim()))try{await Ie.editNote(P.ticket.ticket_id,E.id,q),Z(null),O(""),t.invalidateQueries({queryKey:["ticket-notes",D==null?void 0:D.ticket_id]})}catch(Ge){console.error("Failed to edit note:",Ge),alert(`Failed to edit note: ${((Re=(Ae=Ge.response)==null?void 0:Ae.data)==null?void 0:Re.error)||Ge.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{Z(null),O("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:E.content}),E.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(E.tags).map((Ae,Re)=>s.jsxs(Ye,{to:`/tags?search=${encodeURIComponent(Ae)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[s.jsx(Ot,{className:"w-3 h-3 mr-1"}),Ae]},Re))}),E.attachment_url&&s.jsx("div",{className:"mt-2",children:(T=E.attachment_type)!=null&&T.startsWith("image/")?s.jsxs("a",{href:Jd(E.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Jd(E.attachment_url),alt:E.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:E.attachment_name})]}):s.jsxs("a",{href:Jd(E.attachment_url),download:E.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:E.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(E.attachment_size/1024).toFixed(1)," KB)"]})]})})]},E.id)})}),V&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),s.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[s.jsx("button",{onClick:()=>J(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:async()=>{var E,T;if(P!=null&&P.ticket)try{await Ie.deleteNote(P.ticket.ticket_id,V),J(null),t.invalidateQueries({queryKey:["ticket-notes",D==null?void 0:D.ticket_id]})}catch(Ae){console.error("Failed to delete note:",Ae),alert(`Failed to delete note: ${((T=(E=Ae.response)==null?void 0:E.data)==null?void 0:T.error)||Ae.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[we.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:we.map((E,T)=>s.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"max-w-[150px] truncate",children:E.name}),s.jsx("button",{onClick:()=>hs(T),className:"text-red-500 hover:text-red-700",children:s.jsx(_t,{className:"w-3 h-3"})})]},T))}),s.jsx("textarea",{value:w,onChange:E=>N(E.target.value),onKeyDown:async E=>{var T,Ae;if(E.key==="Enter"&&!E.shiftKey){E.preventDefault();const Re=E.currentTarget.value.trim();if(Re&&D){console.log("[DASHBOARD STAFF NOTES] Submitting note:",Re);try{const Ge=await Promise.all(we.map(async yt=>({name:yt.name,content:await de(yt),type:yt.type,size:yt.size})));await Ie.addNote(D.ticket_id,Re,void 0,Ge.length>0?Ge:void 0),N(""),B([]),se(),console.log("[DASHBOARD STAFF NOTES] Note saved successfully")}catch(Ge){console.error("Failed to add note:",Ge),alert(`Failed to add note: ${((Ae=(T=Ge.response)==null?void 0:T.data)==null?void 0:Ae.error)||Ge.message||"Unknown error"}`)}}}},placeholder:"Add internal notes for other staff members... (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),s.jsx("input",{type:"file",ref:G,onChange:Nr,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("button",{onClick:()=>{var E;return(E=G.current)==null?void 0:E.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx("p",{children:"Select a conversation to view"})]})})}),s.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${ie?"w-96":"w-0"}`,children:ie&&D&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600"}),s.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),s.jsx("button",{onClick:()=>ne(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(br,{className:"w-5 h-5"})})]}),Te&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})}),Me&&Me.customer&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Me.customer.firstName," ",Me.customer.lastName]}),s.jsx("p",{className:"text-xs text-gray-500",children:Me.customer.email}),Me.customer.phone&&s.jsx("p",{className:"text-xs text-gray-500",children:Me.customer.phone}),Me.customer.isVIP&&s.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[s.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),s.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((at=Me.customer.totalSpent)==null?void 0:at.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),s.jsx("span",{className:"font-semibold text-gray-900",children:Me.customer.ordersCount||0})]}),Me.customer.lastOrderDate&&s.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[s.jsx("span",{className:"text-gray-500",children:"Last Order:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Me.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),Me.orders&&Me.orders.length>0?s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",R+1," OF ",Me.orders.length]}),Me.orders.length>1&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>ae(Math.max(0,R-1)),disabled:R===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>ae(Math.min(Me.orders.length-1,R+1)),disabled:R===Me.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",Me.orders[R].orderNumber]}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${Me.orders[R].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":Me.orders[R].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Me.orders[R].fulfillmentStatus||"Unfulfilled"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",s.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(Pt=Me.orders[R].totalPrice)==null?void 0:Pt.toFixed(2)," ",Me.orders[R].currency]})]})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Created:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Me.orders[R].createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Payment:"}),s.jsx("span",{className:`font-medium ${Me.orders[R].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:Me.orders[R].financialStatus||"Pending"})]})]}),Me.orders[R].lineItems&&Me.orders[R].lineItems.length>0&&s.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),s.jsx("div",{className:"space-y-2",children:Me.orders[R].lineItems.map((E,T)=>{var Ae;return s.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[s.jsxs("button",{onClick:()=>_(je===E.id?null:E.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:E.title}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["x",E.quantity]}),s.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${je===E.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),je===E.id&&s.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Price:"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(Ae=E.price)==null?void 0:Ae.toFixed(2)]})]}),E.sku&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"SKU:"}),s.jsx("span",{className:"text-gray-900 font-mono",children:E.sku})]}),E.variantTitle&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Variant:"}),s.jsx("span",{className:"text-gray-900",children:E.variantTitle})]}),E.customAttributes&&E.customAttributes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),E.customAttributes.map((Re,Ge)=>s.jsxs("div",{className:"flex justify-between py-0.5",children:[s.jsxs("span",{className:"text-gray-500",children:[Re.key.replace("_",""),":"]}),Re.key.includes("Link")||Re.key.includes("link")?s.jsx("a",{href:Re.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:yt=>yt.stopPropagation(),children:"View "}):s.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:Re.value})]},Ge))]})]})]},E.id||T)})})]})]})]}):s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),Me.orders&&((In=Me.orders[R])==null?void 0:In.trackingNumber)&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),s.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:Me.orders[R].trackingNumber}),Me.orders[R].trackingCompany&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",s.jsx("span",{className:"text-gray-900",children:Me.orders[R].trackingCompany})]})]}),Me.orders[R].trackingUrl&&s.jsx("a",{href:Me.orders[R].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]})]})}),m&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Close Chat"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"How would you like to close this chat?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>et.mutate({id:l,resolutionType:"resolved"}),disabled:et.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[s.jsx(lt,{className:"w-6 h-6 text-green-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Mark as Resolved"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer's issue was solved"})]})]}),s.jsxs("button",{onClick:()=>et.mutate({id:l,resolutionType:"closed"}),disabled:et.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(br,{className:"w-6 h-6 text-gray-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Close as Inactive"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer stopped responding"})]})]})]}),s.jsx("button",{onClick:()=>h(!1),className:"w-full mt-4 px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})}),f&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reassign Chat"})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Reassign this chat to another staff member:"}),Gt.filter(E=>E.availability_status==="online").length===1&&s.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${x==="ai-agent-001"?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:"ai-agent-001",checked:x==="ai-agent-001",onChange:E=>g(E.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-purple-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[s.jsx(er,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Return to McCarthy AI"})]})]}),Gt.filter(E=>E.id!=="ai-agent-001").map(E=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${x===E.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:E.id,checked:x===E.id,onChange:T=>g(T.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${E.availability_status==="online"?"bg-green-500":E.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[E.first_name," ",E.last_name]}),s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:E.availability_status||"Offline"})]})]},E.id))]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),s.jsx("textarea",{value:y,onChange:E=>b(E.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:()=>{j(!1),g(""),b("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>{x&&l&&it.mutate({id:l,assignTo:x,reason:y||void 0})},disabled:!x||it.isPending,className:"flex-1 px-4 py-2 text-sm text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:it.isPending?"Reassigning...":"Reassign"})]})]})})]})}const pC={"in-progress":"bg-blue-100 text-blue-800 border-blue-200"},jf={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},wf={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},yC={positive:"",neutral:"",negative:"",angry:""},bC={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson","ai-agent-001":"McCarthy AI"},Yr={getConversationByTicket:async e=>(await I.get(`/api/chat/conversation/by-ticket/${e}`)).data,getConversation:async e=>(await I.get(`/api/chat/conversation/${e}`)).data,takeoverConversation:async e=>(await I.post(`/api/chat/conversation/${e}/takeover`)).data,replyToConversation:async(e,t)=>(await I.post(`/api/chat/conversation/${e}/reply`,{message:t})).data,closeConversation:async(e,t)=>(await I.post(`/api/chat/conversation/${e}/close`,{resolution_type:t})).data,pickupFromQueue:async e=>(await I.post(`/api/chat/conversation/${e}/pickup`)).data,reassignConversation:async(e,t,r)=>(await I.post(`/api/chat/conversation/${e}/reassign`,{assignTo:t,reason:r})).data,getStaffList:async()=>(await I.get("/api/staff")).data},Ca=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"";function vC(){var Ps,ar,Ss,Xe;const{id:e}=uy(),t=jr(),r=mt(),[n]=Bl(),{user:a}=us(),[i,l]=u.useState(!1),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(0),[j,x]=u.useState(null),[g,y]=u.useState(""),[b,p]=u.useState(!1),[v,w]=u.useState(""),[N,A]=u.useState(250),[z,F]=u.useState(null),[Z,q]=u.useState(""),[O,V]=u.useState(null),[J,pe]=u.useState(!1),[ke,we]=u.useState(!1),[B,M]=u.useState([]),[X,Y]=u.useState(!1),[ee,ie]=u.useState(""),[ne,ge]=u.useState(""),$e=u.useRef(null),R=u.useRef(null),{data:ae,isLoading:je}=me({queryKey:["ticket",e],queryFn:async()=>(await Ie.get(e)).data,enabled:!!e}),{data:_,isLoading:G}=me({queryKey:["chat-conversation-by-ticket",e],queryFn:async()=>{const $=await Yr.getConversationByTicket(e);return $.conversation?await Yr.getConversation($.conversation.id):null},enabled:!!e,refetchInterval:3e3}),{data:W}=me({queryKey:["tickets"],queryFn:async()=>(await Ie.list()).data}),{data:Q}=me({queryKey:["staff-list"],queryFn:()=>Yr.getStaffList(),enabled:X}),H=(Q==null?void 0:Q.staff)||[],{data:he,refetch:ze}=me({queryKey:["ticket-notes",e],queryFn:async()=>(await Ie.get(e)).data,enabled:!!e}),be=ae==null?void 0:ae.ticket,le=_==null?void 0:_.conversation,D=(_==null?void 0:_.messages)||[],Me=(he==null?void 0:he.notes)||[],{data:Te,isLoading:P}=me({queryKey:["shopify-data",be==null?void 0:be.customer_email],queryFn:async()=>be!=null&&be.customer_email?(await I.get(`/api/shopify/ticket-data?email=${encodeURIComponent(be.customer_email)}`)).data:null,enabled:!!(be!=null&&be.customer_email)&&d});let se=(W==null?void 0:W.tickets)||[];const oe=n.get("filter"),_e=n.get("from");oe==="my"||_e==="my"?se=se.filter($=>$.assigned_to==="00000000-0000-0000-0000-000000000001"):oe==="vip"||_e==="vip"?se=se.filter($=>$.vip===1):_e&&(se=se.filter($=>$.assigned_to===_e));const Ee=se.findIndex($=>$.ticket_id===e),We=Ee>0,et=Ee>=0&&Ee<se.length-1,it=()=>{if(We){const $=se[Ee-1],fe=new URLSearchParams(n);$.channel==="chat"?t(`/chat-ticket/${$.ticket_id}?${fe.toString()}`):t(`/tickets/${$.ticket_id}?${fe.toString()}`)}},kt=()=>{if(et){const $=se[Ee+1],fe=new URLSearchParams(n);$.channel==="chat"?t(`/chat-ticket/${$.ticket_id}?${fe.toString()}`):t(`/tickets/${$.ticket_id}?${fe.toString()}`)}},Gt=Ce({mutationFn:()=>Yr.takeoverConversation(le.id),onSuccess:()=>{r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),ss=Ce({mutationFn:()=>Yr.pickupFromQueue(le.id),onSuccess:()=>{r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),Et=Ce({mutationFn:$=>Yr.replyToConversation(le.id,$),onSuccess:()=>{y(""),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),rs=Ce({mutationFn:$=>Yr.closeConversation(le.id,$),onSuccess:()=>{we(!1),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]}),r.invalidateQueries({queryKey:["tickets"]})}}),Hs=Ce({mutationFn:({assignTo:$,reason:fe})=>Yr.reassignConversation(le.id,$,fe),onSuccess:()=>{Y(!1),ie(""),ge(""),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),ks=()=>{!g.trim()||!le||(Et.mutate(g.trim()),setTimeout(()=>{var $;($=R.current)==null||$.scrollIntoView({behavior:"smooth"})},100))};u.useEffect(()=>{f(0)},[e,d]),u.useEffect(()=>{const $=fe=>{(fe.ctrlKey||fe.metaKey)&&fe.key==="y"&&(fe.preventDefault(),p(Fe=>!Fe))};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[]);const wr=$=>new Promise((fe,Fe)=>{const De=new FileReader;De.readAsDataURL($),De.onload=()=>fe(De.result),De.onerror=at=>Fe(at)}),Rs=async $=>{const fe=Array.from($.target.files||[]);for(const Fe of fe)if(Fe.size>10*1024*1024){alert(`File ${Fe.name} is too large. Maximum size is 10MB.`),$.target.value="";return}M(Fe=>[...Fe,...fe]),$.target.value=""},de=$=>{M(fe=>fe.filter((Fe,De)=>De!==$))};if(u.useEffect(()=>{const $=Fe=>{if(!J)return;const De=N+(window.innerHeight-Fe.clientY-N),at=150,Pt=window.innerHeight*.6;De>=at&&De<=Pt&&A(De)},fe=()=>{pe(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return J&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",$),window.addEventListener("mouseup",fe)),()=>{window.removeEventListener("mousemove",$),window.removeEventListener("mouseup",fe)}},[J,N]),je||G)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})});if(!be)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Ticket not found"})});const hs=le&&(le.status==="staff_handling"||le.status==="assigned"||le.status==="ai_handling"&&le.assigned_to!=="ai-agent-001");return s.jsxs("div",{className:"flex h-[calc(100vh-4rem)] bg-gray-50",children:[s.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ye,{to:"/tickets",className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[(Ps=be.subject)!=null&&Ps.toLowerCase().includes("callback request")?s.jsx(ba,{className:"w-4 h-4 text-red-600 fill-current"}):s.jsxs("svg",{className:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx(Ye,{to:`/tickets?search=${encodeURIComponent(be.ticket_number)}`,className:"text-base font-semibold text-blue-600 hover:text-blue-800 hover:underline",title:"View in All Tickets",children:be.ticket_number})]}),be.vip===1&&s.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 rounded-lg text-xs border border-yellow-200 font-medium",children:" VIP"}),s.jsx("button",{className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium ${pC["in-progress"]}`,children:(le==null?void 0:le.status)==="ai_handling"?"open":(le==null?void 0:le.status)==="staff_handling"||(le==null?void 0:le.status)==="assigned"?"in-progress":(le==null?void 0:le.status)==="queued"?"open":(le==null?void 0:le.status)==="closed"?"resolved":be.status}),s.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${jf[be.priority]||jf.normal}`,children:be.priority}),s.jsxs("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${wf[be.sentiment]||wf.neutral}`,children:[yC[be.sentiment]||""," ",be.sentiment||"neutral"]})]}),s.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(le==null?void 0:le.assigned_to)==="ai-agent-001"?"McCarthy AI":le!=null&&le.assigned_staff_first_name?`${le.assigned_staff_first_name} ${le.assigned_staff_last_name||""}`:be.assigned_to?bC[be.assigned_to]||be.assigned_to:"Unassigned"})]}),s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:be.customer_name||be.customer_email}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(be.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[s.jsx("span",{className:"font-medium",children:"Subject:"})," ",be.subject||"Live Chat Conversation"]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(le==null?void 0:le.status)==="queued"&&s.jsxs("button",{onClick:()=>ss.mutate(),disabled:ss.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Rl,{className:"w-3 h-3"}),s.jsx("span",{children:"Pick Up"})]}),(le==null?void 0:le.status)==="ai_handling"&&(le==null?void 0:le.assigned_to)==="ai-agent-001"&&s.jsxs("button",{onClick:()=>Gt.mutate(),disabled:Gt.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Rl,{className:"w-3 h-3"}),s.jsx("span",{children:"Take Over"})]}),s.jsxs("button",{onClick:()=>Y(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:"Reassign"})]}),(le==null?void 0:le.status)!=="closed"&&s.jsxs("button",{onClick:()=>we(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx(lt,{className:"w-3 h-3"}),s.jsx("span",{children:"Close Chat"})]})]})]})]}),s.jsxs("div",{className:"p-4 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>l(!i),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(yn,{className:"w-3 h-3"}),s.jsx("span",{children:"Customer Info"})]}),s.jsxs("button",{onClick:()=>c(!o),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(Nb,{className:"w-3 h-3"}),s.jsx("span",{children:"Order History"})]}),s.jsxs("button",{onClick:()=>m(!d),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${d?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[s.jsx(dl,{className:"w-3 h-3"}),s.jsx("span",{children:"Shopify"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:it,disabled:!We,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(xi,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:kt,disabled:!et,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Jl,{className:"w-3.5 h-3.5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[i&&s.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"}),s.jsx("span",{className:"ml-2 font-medium",children:be.customer_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"VIP:"}),s.jsx("span",{className:"ml-2 font-medium text-amber-600",children:be.vip?"Yes":"No"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"Email:"}),s.jsx("span",{className:"ml-2 font-medium",children:be.customer_email})]})]})]})}),o&&s.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),s.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[D.length===0?s.jsxs("div",{className:"text-center text-gray-500 py-8",children:[s.jsxs("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx("p",{children:"No messages yet"})]}):D.map($=>{var at;const fe=$.sender_type==="customer",Fe=$.sender_type==="system",De=$.sender_type==="ai";return Fe?s.jsx("div",{className:"text-center py-2",children:s.jsx("span",{className:"inline-block px-3 py-1 text-xs text-gray-500 bg-gray-100 rounded-full",children:$.content})},$.id):s.jsxs("div",{className:`p-4 rounded-lg ${fe?"bg-gray-100":De?"bg-purple-50":"bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${fe?"bg-gray-300":De?"bg-purple-200":"bg-blue-200"}`,children:fe?s.jsx(yn,{className:"w-3 h-3 text-gray-600"}):De?s.jsx(er,{className:"w-3 h-3 text-purple-600"}):s.jsx(yn,{className:"w-3 h-3 text-blue-600"})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:fe?$.sender_name||be.customer_name||"Customer":De?"McCarthy AI":$.sender_name?$.sender_name.split(" ")[0]:"Staff"}),s.jsx("span",{className:"text-xs text-gray-400",children:$.created_at&&typeof $.created_at=="string"?ys(new Date($.created_at.includes("Z")?$.created_at:$.created_at+"Z"),{addSuffix:!0}):""})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:$.content}),$.attachment_url&&s.jsx("div",{className:"mt-2 ml-8",children:(at=$.attachment_type)!=null&&at.startsWith("image/")?s.jsxs("a",{href:Ca($.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Ca($.attachment_url),alt:$.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:$.attachment_name})]}):s.jsxs("a",{href:Ca($.attachment_url),download:$.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:$.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(($.attachment_size||0)/1024).toFixed(1)," KB)"]})]})})]},$.id)}),s.jsx("div",{ref:R})]})]}),hs&&s.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-t border-gray-200 p-4",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("textarea",{value:g,onChange:$=>y($.target.value),onKeyDown:$=>{$.key==="Enter"&&!$.shiftKey&&($.preventDefault(),ks())},placeholder:"Type your reply... (Press Enter to send, Shift+Enter for new line)",className:"flex-1 border border-gray-300 rounded-lg px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white",rows:3}),s.jsxs("button",{onClick:ks,disabled:!g.trim()||Et.isPending,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium transition-colors self-end",children:[s.jsx(ad,{className:"w-4 h-4"}),"Send"]})]})}),!hs&&(le==null?void 0:le.status)!=="closed"&&s.jsx("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:s.jsx("p",{className:"text-sm",children:(le==null?void 0:le.status)==="ai_handling"?'AI is handling this chat. Click "Take Over" to respond.':(le==null?void 0:le.status)==="queued"?'This chat is in queue. Click "Pick Up" to respond.':"Unable to respond to this chat."})}),(le==null?void 0:le.status)==="closed"&&s.jsxs("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:[s.jsx(lt,{className:"w-5 h-5 inline-block mr-2"}),s.jsx("span",{className:"text-sm",children:"This chat has been closed"})]}),s.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[b&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>pe(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>p(!b),children:[s.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),b&&s.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${N}px`},children:[Me&&Me.length>0&&s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:Me.map($=>{var fe;return s.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:$.first_name||"Staff"}),s.jsx("span",{className:"text-xs text-gray-500",children:$.created_at&&typeof $.created_at=="string"?ys(new Date($.created_at.includes("Z")?$.created_at:$.created_at+"Z"),{addSuffix:!0}):""}),$.edited_at&&s.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),s.jsx("div",{className:"flex items-center gap-2",children:($.staff_id===(a==null?void 0:a.id)||(a==null?void 0:a.role)==="admin")&&z!==$.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{F($.id),q($.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),s.jsx("button",{onClick:()=>V($.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]})})]}),z===$.id?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:Z,onChange:Fe=>q(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:async()=>{var Fe,De;if(!(!be||!Z.trim()))try{await Ie.editNote(be.ticket_id,$.id,Z),F(null),q(""),r.invalidateQueries({queryKey:["ticket",e]})}catch(at){console.error("Failed to edit note:",at),alert(`Failed to edit note: ${((De=(Fe=at.response)==null?void 0:Fe.data)==null?void 0:De.error)||at.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{F(null),q("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:$.content}),$.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo($.tags).map((Fe,De)=>s.jsxs(Ye,{to:`/tags?search=${encodeURIComponent(Fe)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[s.jsx(Ot,{className:"w-3 h-3 mr-1"}),Fe]},De))}),$.attachment_url&&s.jsx("div",{className:"mt-2",children:(fe=$.attachment_type)!=null&&fe.startsWith("image/")?s.jsxs("a",{href:Ca($.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Ca($.attachment_url),alt:$.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:$.attachment_name})]}):s.jsxs("a",{href:Ca($.attachment_url),download:$.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:$.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",($.attachment_size/1024).toFixed(1)," KB)"]})]})})]},$.id)})}),O&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),s.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[s.jsx("button",{onClick:()=>V(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:async()=>{var $,fe;if(be)try{await Ie.deleteNote(be.ticket_id,O),V(null),r.invalidateQueries({queryKey:["ticket",e]})}catch(Fe){console.error("Failed to delete note:",Fe),alert(`Failed to delete note: ${((fe=($=Fe.response)==null?void 0:$.data)==null?void 0:fe.error)||Fe.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[B.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:B.map(($,fe)=>s.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"max-w-[150px] truncate",children:$.name}),s.jsx("button",{onClick:()=>de(fe),className:"text-red-500 hover:text-red-700",children:s.jsx(_t,{className:"w-3 h-3"})})]},fe))}),s.jsx("textarea",{"data-test":"chat-staff-notes-textarea",value:v,onChange:$=>{console.log("[CHAT STAFF NOTES] onChange fired:",$.target.value),w($.target.value)},onKeyDown:async $=>{var fe,Fe;if(console.log("[CHAT STAFF NOTES] onKeyDown fired - key:",$.key),$.key==="Enter"&&!$.shiftKey){$.preventDefault();const De=$.currentTarget.value.trim();if(De&&be){console.log("[CHAT STAFF NOTES] Submitting note:",De);try{const at=await Promise.all(B.map(async Pt=>({name:Pt.name,content:await wr(Pt),type:Pt.type,size:Pt.size})));await Ie.addNote(be.ticket_id,De,void 0,at.length>0?at:void 0),w(""),M([]),ze()}catch(at){console.error("Failed to add note:",at),alert(`Failed to add note: ${((Fe=(fe=at.response)==null?void 0:fe.data)==null?void 0:Fe.error)||at.message||"Unknown error"}`)}}else console.log("[CHAT STAFF NOTES] Cannot submit - noteText:",De,"ticket:",!!be)}},onFocus:()=>console.log("[CHAT STAFF NOTES] onFocus fired"),onBlur:()=>console.log("[CHAT STAFF NOTES] onBlur fired"),placeholder:"Add internal notes... Use @to mention staff, #keyword to add tags (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),s.jsx("input",{type:"file",ref:$e,onChange:Rs,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("button",{onClick:()=>{var $;return($=$e.current)==null?void 0:$.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]}),s.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${d?"w-96":"w-0"}`,children:d&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(dl,{className:"w-5 h-5 text-green-600"}),s.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),s.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),P&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})}),Te&&Te.customer&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Te.customer.firstName," ",Te.customer.lastName]}),s.jsx("p",{className:"text-xs text-gray-500",children:Te.customer.email}),Te.customer.phone&&s.jsx("p",{className:"text-xs text-gray-500",children:Te.customer.phone}),Te.customer.isVIP&&s.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[s.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),s.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((ar=Te.customer.totalSpent)==null?void 0:ar.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),s.jsx("span",{className:"font-semibold text-gray-900",children:Te.customer.ordersCount||0})]}),Te.customer.lastOrderDate&&s.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[s.jsx("span",{className:"text-gray-500",children:"Last Order:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Te.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),Te.orders&&Te.orders.length>0?s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",h+1," OF ",Te.orders.length]}),Te.orders.length>1&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>f(Math.max(0,h-1)),disabled:h===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>f(Math.min(Te.orders.length-1,h+1)),disabled:h===Te.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",Te.orders[h].orderNumber]}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${Te.orders[h].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":Te.orders[h].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Te.orders[h].fulfillmentStatus||"Unfulfilled"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",s.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(Ss=Te.orders[h].totalPrice)==null?void 0:Ss.toFixed(2)," ",Te.orders[h].currency]})]})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Created:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Te.orders[h].createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Payment:"}),s.jsx("span",{className:`font-medium ${Te.orders[h].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:Te.orders[h].financialStatus||"Pending"})]})]}),Te.orders[h].lineItems&&Te.orders[h].lineItems.length>0&&s.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),s.jsx("div",{className:"space-y-2",children:Te.orders[h].lineItems.map(($,fe)=>{var Fe;return s.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[s.jsxs("button",{onClick:()=>x(j===$.id?null:$.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:$.title}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["x",$.quantity]}),s.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${j===$.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),j===$.id&&s.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Price:"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(Fe=$.price)==null?void 0:Fe.toFixed(2)]})]}),$.sku&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"SKU:"}),s.jsx("span",{className:"text-gray-900 font-mono",children:$.sku})]}),$.variantTitle&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Variant:"}),s.jsx("span",{className:"text-gray-900",children:$.variantTitle})]}),$.customAttributes&&$.customAttributes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),$.customAttributes.map((De,at)=>s.jsxs("div",{className:"flex justify-between py-0.5",children:[s.jsxs("span",{className:"text-gray-500",children:[De.key.replace("_",""),":"]}),De.key.includes("Link")||De.key.includes("link")?s.jsx("a",{href:De.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:Pt=>Pt.stopPropagation(),children:"View "}):s.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:De.value})]},at))]})]})]},$.id||fe)})})]})]})]}):s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),Te.orders&&((Xe=Te.orders[h])==null?void 0:Xe.trackingNumber)&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),s.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:Te.orders[h].trackingNumber}),Te.orders[h].trackingCompany&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",s.jsx("span",{className:"text-gray-900",children:Te.orders[h].trackingCompany})]})]}),Te.orders[h].trackingUrl&&s.jsx("a",{href:Te.orders[h].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]})]})}),ke&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Close Chat"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"How would you like to close this chat?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>rs.mutate("resolved"),disabled:rs.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[s.jsx(lt,{className:"w-6 h-6 text-green-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Mark as Resolved"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer's issue was solved"})]})]}),s.jsxs("button",{onClick:()=>rs.mutate("closed"),disabled:rs.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(br,{className:"w-6 h-6 text-gray-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Close as Inactive"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer stopped responding"})]})]})]}),s.jsx("button",{onClick:()=>we(!1),className:"w-full mt-4 px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})}),X&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reassign Chat"})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reassign chat #",be==null?void 0:be.ticket_number," to another staff member:"]}),H.filter($=>$.availability_status==="online").length===1&&s.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${ee==="ai-agent-001"?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:"ai-agent-001",checked:ee==="ai-agent-001",onChange:$=>ie($.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-purple-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[s.jsx(er,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Return to McCarthy AI"})]})]}),H.filter($=>$.id!=="ai-agent-001").map($=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${ee===$.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:$.id,checked:ee===$.id,onChange:fe=>ie(fe.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${$.availability_status==="online"?"bg-green-500":$.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[$.first_name," ",$.last_name]}),s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:$.availability_status||"Offline"})]})]},$.id))]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),s.jsx("textarea",{value:ne,onChange:$=>ge($.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:()=>{Y(!1),ie(""),ge("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>{ee&&Hs.mutate({assignTo:ee,reason:ne||void 0})},disabled:!ee||Hs.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:Hs.isPending?"Reassigning...":"Reassign Chat"})]})]})})]})}function jC(){const[e,t]=u.useState(!1),{data:r,isLoading:n,error:a}=me({queryKey:["chat-embed-code"],queryFn:async()=>(await I.get("/api/chat/embed-code")).data}),i=async()=>{r!=null&&r.embedCode&&(await navigator.clipboard.writeText(r.embedCode),t(!0),setTimeout(()=>t(!1),2e3))};return n?s.jsx("div",{className:"p-8",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),s.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):a?s.jsx("div",{className:"p-8",children:s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:"Failed to load embed code. Please try again."})}):s.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(bb,{className:"w-7 h-7 text-indigo-600"}),"Chat Widget Embed Code"]}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Add the McCarthy AI chat widget to your website with a simple code snippet."})]}),s.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-indigo-900 mb-3",children:"Installation Instructions"}),s.jsx("ol",{className:"list-decimal list-inside space-y-2 text-indigo-800",children:r==null?void 0:r.instructions.map((l,o)=>s.jsx("li",{children:l},o))})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Embed Code"}),s.jsx("button",{onClick:i,className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${e?"bg-green-100 text-green-700":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:e?s.jsxs(s.Fragment,{children:[s.jsx(jm,{className:"w-4 h-4"}),"Copied!"]}):s.jsxs(s.Fragment,{children:[s.jsx(vb,{className:"w-4 h-4"}),"Copy Code"]})})]}),s.jsx("div",{className:"p-4 bg-gray-900 overflow-x-auto",children:s.jsx("pre",{className:"text-sm text-gray-100 whitespace-pre-wrap font-mono",children:r==null?void 0:r.embedCode})})]}),s.jsxs("div",{className:"mt-6 bg-white border border-gray-200 rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Widget Settings"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Primary Color"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("div",{className:"w-6 h-6 rounded border border-gray-200",style:{backgroundColor:(r==null?void 0:r.settings.primary_color)||"#4F46E5"}}),s.jsx("span",{className:"font-mono text-sm",children:(r==null?void 0:r.settings.primary_color)||"#4F46E5"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Button Text"}),s.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.button_text)||"Chat with us"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Welcome Message"}),s.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.welcome_message)||"Hi!  I'm McCarthy AI. How can I help you today?"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Offline Message"}),s.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.offline_message)||"We're currently offline. Please leave a message!"})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs("a",{href:"/settings/chat-widget",className:"inline-flex items-center gap-2 text-indigo-600 hover:text-indigo-800 font-medium",children:[s.jsx(cl,{className:"w-4 h-4"}),"Customize Widget Settings"]})})]}),s.jsxs("div",{className:"mt-6 bg-amber-50 border border-amber-200 rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-amber-900 mb-2",children:"Test Your Widget"}),s.jsx("p",{className:"text-amber-800 mb-4",children:"After adding the embed code to your website, test the widget to ensure it's working correctly:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-amber-800",children:[s.jsx("li",{children:"Check that the chat bubble appears in the bottom-right corner"}),s.jsx("li",{children:"Click the bubble to open the chat window"}),s.jsx("li",{children:"Enter your name and email to start a conversation"}),s.jsx("li",{children:"Send a test message and verify you receive an AI response"}),s.jsx("li",{children:"Check the Chat Dashboard to see the conversation appear"})]})]})]})}function wC(){const e=mt(),[t,r]=u.useState("widget"),[n,a]=u.useState(!1),[i,l]=u.useState("idle"),[o,c]=u.useState(""),[d,m]=u.useState({is_enabled:!0,primary_color:"#4F46E5",secondary_color:"#FFFFFF",button_text:"Chat with us",welcome_message:"Hi!  I'm McCarthy AI. How can I help you today?",offline_message:"We're currently offline. Please leave a message and we'll get back to you!",show_business_hours:!0,require_email_when_offline:!0}),{data:h,isLoading:f}=me({queryKey:["chatSettings"],queryFn:()=>$r.getSettings().then(y=>y.data)}),{data:j}=me({queryKey:["embedCode"],queryFn:()=>$r.getEmbedCode().then(y=>y.data)});u.useEffect(()=>{h!=null&&h.settings&&m({is_enabled:h.settings.is_enabled??!0,primary_color:h.settings.primary_color||"#4F46E5",secondary_color:h.settings.secondary_color||"#FFFFFF",button_text:h.settings.button_text||"Chat with us",welcome_message:h.settings.welcome_message||"Hi!  I'm McCarthy AI. How can I help you today?",offline_message:h.settings.offline_message||"We're currently offline. Please leave a message!",show_business_hours:h.settings.show_business_hours??!0,require_email_when_offline:h.settings.require_email_when_offline??!0})},[h]);const x=Ce({mutationFn:()=>$r.updateSettings(d),onSuccess:()=>{l("success"),e.invalidateQueries({queryKey:["chatSettings"]}),e.invalidateQueries({queryKey:["embedCode"]}),setTimeout(()=>l("idle"),3e3)},onError:y=>{l("error"),c(y.message||"Failed to save settings"),setTimeout(()=>l("idle"),5e3)}}),g=()=>{j!=null&&j.embedCode&&(navigator.clipboard.writeText(j.embedCode),a(!0),setTimeout(()=>a(!1),2e3))};return f?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AI Chat Widget"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure and embed the McCarthy AI chat widget on your website"})]}),s.jsx("div",{className:"border-b border-gray-200 mb-6",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsxs("button",{onClick:()=>r("widget"),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${t==="widget"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(gi,{className:"w-4 h-4"}),"Widget Settings"]}),s.jsxs("button",{onClick:()=>r("embed"),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${t==="embed"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(bb,{className:"w-4 h-4"}),"Embed Code"]})]})}),t==="widget"&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Enable Chat Widget"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Show the chat widget on your website"})]}),s.jsx("button",{onClick:()=>m(y=>({...y,is_enabled:!y.is_enabled})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.is_enabled?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.is_enabled?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:d.primary_color,onChange:y=>m(b=>({...b,primary_color:y.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm cursor-pointer",style:{backgroundColor:d.primary_color}})]}),s.jsx("input",{type:"text",value:d.primary_color,onChange:y=>m(b=>({...b,primary_color:y.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:d.secondary_color,onChange:y=>m(b=>({...b,secondary_color:y.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm cursor-pointer",style:{backgroundColor:d.secondary_color}})]}),s.jsx("input",{type:"text",value:d.secondary_color,onChange:y=>m(b=>({...b,secondary_color:y.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),s.jsx("input",{type:"text",value:d.button_text,onChange:y=>m(b=>({...b,button_text:y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Chat with us"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),s.jsx("textarea",{value:d.welcome_message,onChange:y=>m(b=>({...b,welcome_message:y.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Hi! How can we help you today?"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"First message shown when chat opens"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Offline Message"}),s.jsx("textarea",{value:d.offline_message,onChange:y=>m(b=>({...b,offline_message:y.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Our team is currently offline..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown when no staff are online"})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Business Hours"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Display hours in the widget"})]}),s.jsx("button",{onClick:()=>m(y=>({...y,show_business_hours:!y.show_business_hours})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.show_business_hours?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.show_business_hours?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Require Email When Offline"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Collect email for follow-up"})]}),s.jsx("button",{onClick:()=>m(y=>({...y,require_email_when_offline:!y.require_email_when_offline})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.require_email_when_offline?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.require_email_when_offline?"translate-x-5":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[i==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-2 text-sm",children:[s.jsx(jm,{className:"w-4 h-4"})," Saved"]}),i==="error"&&s.jsx("span",{className:"text-red-600 text-sm",children:o||"Failed to save"}),s.jsx("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:x.isPending?"Saving...":"Save Settings"})]})]})}),s.jsxs("div",{className:"bg-gray-100 rounded-lg p-6",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Preview"}),s.jsxs("div",{className:"bg-white rounded-lg shadow-inner h-96 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 p-4",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),s.jsx("div",{className:"h-24 bg-gray-100 rounded mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),s.jsx("div",{className:"absolute bottom-4 right-4",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-5 py-3 rounded-full shadow-lg cursor-pointer transform hover:scale-105 transition-transform",style:{backgroundColor:d.primary_color,color:d.secondary_color},children:[s.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M12 3l1.5 4.5L18 9l-4.5 1.5L12 15l-1.5-4.5L6 9l4.5-1.5L12 3z"}),s.jsx("path",{d:"M5 19l1 3 1-3 3-1-3-1-1-3-1 3-3 1 3 1z"})]}),s.jsx("span",{className:"font-medium",children:d.button_text})]})})]})]})]}),t==="embed"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Embed Code"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Copy and paste this code into your website, just before the closing ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"</body>"})," tag."]}),s.jsxs("div",{className:"relative bg-gray-800 rounded-lg p-4 text-sm font-mono text-green-400 overflow-x-auto",children:[s.jsx("pre",{className:"whitespace-pre-wrap",children:(j==null?void 0:j.embedCode)||"Loading..."}),s.jsx("button",{onClick:g,className:"absolute top-2 right-2 p-2 rounded-md bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors",title:"Copy to clipboard",children:n?s.jsx(jm,{className:"w-5 h-5 text-green-400"}):s.jsx(vb,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Widget Settings"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Enabled:"})," ",d.is_enabled?"Yes":"No"]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Button Color:"})," ",s.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:d.primary_color}})," ",d.primary_color]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Text Color:"})," ",s.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:d.secondary_color}})," ",d.secondary_color]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Button Text:"}),' "',d.button_text,'"']})]}),s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Welcome Message:"}),' "',d.welcome_message,'"']}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Offline Message:"}),' "',d.offline_message,'"']}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Show Business Hours:"})," ",d.show_business_hours?"Yes":"No"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Testing Checklist"}),s.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-700",children:[s.jsx("li",{children:"Ensure the widget appears on your website"}),s.jsx("li",{children:"Test starting a new chat when online"}),s.jsx("li",{children:"Verify custom colors and messages are applied"}),s.jsx("li",{children:"Check responsiveness on mobile devices"}),s.jsx("li",{children:"Test the AI responses"}),s.jsx("li",{children:"Test escalation to human staff"})]})]})]})]})}const NC=[{value:"policies",label:"Policies",description:"Returns, shipping, terms, privacy"},{value:"products",label:"Products",description:"Product information and specs"},{value:"faq",label:"FAQ",description:"Frequently asked questions"},{value:"general",label:"General",description:"Company info, ordering process"},{value:"other",label:"Other",description:"Miscellaneous documents"}];function kC(){const e=mt(),[t,r]=u.useState("general"),[n,a]=u.useState(!1),[i,l]=u.useState("idle"),[o,c]=u.useState(""),{data:d,isLoading:m}=me({queryKey:["rag-documents"],queryFn:()=>wo.listDocuments().then(N=>N.data)}),h=(d==null?void 0:d.documents)||[],f=Ce({mutationFn:({file:N,category:A})=>wo.uploadDocument(N,A).then(z=>z.data),onSuccess:N=>{l("success"),c(N.message||"Document uploaded successfully"),e.invalidateQueries({queryKey:["rag-documents"]}),setTimeout(()=>l("idle"),3e3)},onError:N=>{var A,z;l("error"),c(((z=(A=N.response)==null?void 0:A.data)==null?void 0:z.error)||N.message||"Failed to upload document"),setTimeout(()=>l("idle"),5e3)}}),j=Ce({mutationFn:N=>wo.deleteDocument(N),onSuccess:()=>{e.invalidateQueries({queryKey:["rag-documents"]})}}),x=Ce({mutationFn:()=>wo.reprocessDocuments(),onSuccess:()=>{e.invalidateQueries({queryKey:["rag-documents"]})}}),g=N=>{N.preventDefault(),N.stopPropagation(),N.type==="dragenter"||N.type==="dragover"?a(!0):N.type==="dragleave"&&a(!1)},y=N=>{N.preventDefault(),N.stopPropagation(),a(!1),N.dataTransfer.files&&N.dataTransfer.files[0]&&p(N.dataTransfer.files[0])},b=N=>{N.target.files&&N.target.files[0]&&p(N.target.files[0])},p=N=>{var F;const A=[".md",".txt",".pdf"],z="."+((F=N.name.split(".").pop())==null?void 0:F.toLowerCase());if(!A.includes(z)){l("error"),c("Invalid file type. Please upload .md, .txt, or .pdf files."),setTimeout(()=>l("idle"),5e3);return}if(N.size>5*1024*1024){l("error"),c("File too large. Maximum size is 5MB."),setTimeout(()=>l("idle"),5e3);return}l("uploading"),f.mutate({file:N,category:t})},v=N=>{switch(N){case"active":return s.jsx(lt,{className:"w-4 h-4 text-green-500"});case"processing":return s.jsx(Xi,{className:"w-4 h-4 text-yellow-500 animate-spin"});case"error":return s.jsx(br,{className:"w-4 h-4 text-red-500"});default:return s.jsx(oa,{className:"w-4 h-4 text-gray-400"})}},w=N=>({policies:"bg-blue-100 text-blue-700",products:"bg-green-100 text-green-700",faq:"bg-purple-100 text-purple-700",general:"bg-gray-100 text-gray-700",other:"bg-yellow-100 text-yellow-700"})[N]||"bg-gray-100 text-gray-700";return s.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Q4,{className:"w-6 h-6 text-indigo-600"}),"RAG Knowledge Base"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Upload documents to enhance the AI Agent's knowledge. The AI will use these documents to provide accurate, context-aware responses."})]}),s.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[s.jsx("h3",{className:"font-semibold text-indigo-900 mb-2",children:"What is RAG?"}),s.jsxs("p",{className:"text-sm text-indigo-800",children:[s.jsx("strong",{children:"RAG (Retrieval-Augmented Generation)"})," allows the AI to search through your uploaded documents and use relevant information when responding to customers. This ensures accurate, up-to-date answers based on your actual policies, products, and procedures - eliminating AI hallucinations."]}),s.jsxs("ul",{className:"mt-2 text-sm text-indigo-700 list-disc list-inside",children:[s.jsx("li",{children:"Upload your policies, FAQs, and product information"}),s.jsx("li",{children:"AI searches documents for relevant context"}),s.jsx("li",{children:"Responses are grounded in your actual content"}),s.jsx("li",{children:"Update documents anytime to keep AI knowledge current"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload Document"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),s.jsx("select",{value:t,onChange:N=>r(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",children:NC.map(N=>s.jsxs("option",{value:N.value,children:[N.label," - ",N.description]},N.value))})]}),s.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${n?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:y,children:[s.jsx(_b,{className:"w-10 h-10 mx-auto text-gray-400 mb-3"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drag & drop a file here, or"}),s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("span",{className:"px-4 py-2 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 inline-block",children:"Browse Files"}),s.jsx("input",{type:"file",className:"hidden",accept:".md,.txt,.pdf",onChange:b})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Supported: .md, .txt, .pdf (max 5MB)"})]}),i!=="idle"&&s.jsxs("div",{className:`mt-4 p-3 rounded-lg text-sm ${i==="uploading"?"bg-blue-50 text-blue-700":i==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[i==="uploading"&&s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Xi,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}),i==="success"&&s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-4 h-4"}),o]}),i==="error"&&s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(br,{className:"w-4 h-4"}),o]})]}),s.jsxs("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"w-full mt-4 px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2 disabled:opacity-50",children:[s.jsx(Xi,{className:`w-4 h-4 ${x.isPending?"animate-spin":""}`}),"Reprocess All Documents"]})]})}),s.jsx("div",{className:"lg:col-span-2",children:s.jsxs("div",{className:"bg-white rounded-lg shadow",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Uploaded Documents (",h.length,")"]})}),m?s.jsxs("div",{className:"p-8 text-center text-gray-500",children:[s.jsx(Xi,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading documents..."]}):h.length===0?s.jsxs("div",{className:"p-8 text-center text-gray-500",children:[s.jsx(tf,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),s.jsx("p",{children:"No documents uploaded yet"}),s.jsx("p",{className:"text-sm mt-1",children:"Upload your first document to get started"})]}):s.jsx("div",{className:"divide-y divide-gray-200",children:h.map(N=>{var A;return s.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(tf,{className:"w-5 h-5 text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:N.title||N.filename}),v(N.status)]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:N.filename}),s.jsxs("div",{className:"flex items-center gap-3 mt-2 flex-wrap",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${w(N.category)}`,children:N.category}),s.jsxs("span",{className:"text-xs text-gray-400",children:[(A=N.word_count)==null?void 0:A.toLocaleString()," words"]}),s.jsxs("span",{className:"text-xs text-gray-400",children:[" ",new Date(N.uploaded_at).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})," at ",new Date(N.uploaded_at).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"})]})]}),N.content_preview&&s.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:N.content_preview})]})]}),s.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this document?")&&j.mutate(N.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete document",children:s.jsx(pi,{className:"w-4 h-4"})})]})},N.id)})})]})})]})]})}const Jr={role:"You are McCarthy AI, a friendly and professional customer service assistant for Amazing Transfers, an Australian company specializing in DTF (Direct to Film) and UV DTF transfers for custom printing.",personality:`- Warm, helpful, and professional
- Use Australian English (colour, metre, etc.)
- Friendly but not overly casual
- Patient and understanding
- Knowledgeable about DTF printing`,responsibilities:`- Answer questions about products, ordering, and policies
- Help customers with order inquiries
- Provide application instructions for DTF and UV DTF transfers
- Explain shipping, returns, and refund policies
- Assist with artwork requirements and file formats
- Escalate complex issues to human staff when needed`,dos:`- Always be polite and respectful
- Provide accurate information from the knowledge base
- Acknowledge customer frustrations with empathy
- Offer to escalate to human staff when you can't help
- Use the customer's name when known
- Confirm understanding before providing solutions`,donts:`- Never make up information or guess at policies
- Don't provide specific pricing (direct to website)
- Don't promise things you can't guarantee
- Never argue with customers
- Don't share internal business information
- Don't use American spelling (use colour not color)`,tone:"Professional yet friendly. Think of a knowledgeable colleague who genuinely wants to help. Not robotic, but not overly casual either. Match the customer's energy level.",custom_instructions:""};function SC(){const e=mt(),[t,r]=u.useState(Jr),[n,a]=u.useState("idle"),[i,l]=u.useState(""),[o,c]=u.useState(!1),{data:d,isLoading:m}=me({queryKey:["ai-system-message"],queryFn:()=>Od.getConfig().then(x=>x.data)});u.useEffect(()=>{d!=null&&d.config&&r({role:d.config.role||Jr.role,personality:d.config.personality||Jr.personality,responsibilities:d.config.responsibilities||Jr.responsibilities,dos:d.config.dos||Jr.dos,donts:d.config.donts||Jr.donts,tone:d.config.tone||Jr.tone,custom_instructions:d.config.custom_instructions||""})},[d]);const h=Ce({mutationFn:()=>Od.updateConfig(t),onSuccess:()=>{a("success"),e.invalidateQueries({queryKey:["ai-system-message"]}),setTimeout(()=>a("idle"),3e3)},onError:x=>{var g,y;a("error"),l(((y=(g=x.response)==null?void 0:g.data)==null?void 0:y.error)||x.message||"Failed to save"),setTimeout(()=>a("idle"),5e3)}}),f=Ce({mutationFn:()=>Od.resetToDefault(),onSuccess:()=>{r(Jr),e.invalidateQueries({queryKey:["ai-system-message"]})}}),j=()=>`# System Message for McCarthy AI

## Role
${t.role}

## Personality
${t.personality}

## Responsibilities
${t.responsibilities}

## Do's
${t.dos}

## Don'ts
${t.donts}

## Tone
${t.tone}

${t.custom_instructions?`## Custom Instructions
${t.custom_instructions}`:""}
`;return m?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(er,{className:"w-6 h-6 text-indigo-600"}),"AI System Message"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure the AI Agent's personality, role, and behavior guidelines. This defines how McCarthy AI interacts with customers."})]}),s.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"font-semibold text-indigo-900 mb-2 flex items-center gap-2",children:[s.jsx(wm,{className:"w-4 h-4"}),"What is a System Message?"]}),s.jsxs("p",{className:"text-sm text-indigo-800",children:["The ",s.jsx("strong",{children:"System Message"})," (also called a system prompt) defines the AI's identity, personality, and behavioral guidelines. It's the foundation that shapes how the AI responds to customers - its tone, what it can/can't do, and how it handles different situations."]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Role Definition",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Who is the AI?"})]}),s.jsx("textarea",{value:t.role,onChange:x=>r({...t,role:x.target.value}),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"You are McCarthy AI, a customer service assistant..."})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Personality Traits",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"How should the AI behave?"})]}),s.jsx("textarea",{value:t.personality,onChange:x=>r({...t,personality:x.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Friendly and professional
- Patient and understanding...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Responsibilities",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"What should the AI do?"})]}),s.jsx("textarea",{value:t.responsibilities,onChange:x=>r({...t,responsibilities:x.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Answer product questions
- Help with orders...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Do's ",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Best practices to follow"})]}),s.jsx("textarea",{value:t.dos,onChange:x=>r({...t,dos:x.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Always be polite
- Provide accurate information...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Don'ts ",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Things to avoid"})]}),s.jsx("textarea",{value:t.donts,onChange:x=>r({...t,donts:x.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Never make up information
- Don't promise things...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Tone of Voice",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"How should responses sound?"})]}),s.jsx("textarea",{value:t.tone,onChange:x=>r({...t,tone:x.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Professional yet friendly..."})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Custom Instructions",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Any additional guidelines"})]}),s.jsx("textarea",{value:t.custom_instructions,onChange:x=>r({...t,custom_instructions:x.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Add any specific instructions, business rules, or special handling..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use this for business-specific rules, special promotions, or temporary instructions."})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Actions"}),n==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-1 text-sm",children:[s.jsx(lt,{className:"w-4 h-4"})," Saved"]}),n==="error"&&s.jsxs("span",{className:"text-red-600 flex items-center gap-1 text-sm",children:[s.jsx(oa,{className:"w-4 h-4"})," ",i]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>h.mutate(),disabled:h.isPending,className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[s.jsx(Xl,{className:"w-4 h-4"}),h.isPending?"Saving...":"Save Configuration"]}),s.jsx("button",{onClick:()=>c(!o),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2",children:o?"Hide Preview":"Show Full Preview"}),s.jsxs("button",{onClick:()=>{confirm("Reset to default configuration? This will overwrite your current settings.")&&f.mutate()},disabled:f.isPending,className:"w-full px-4 py-2 border border-red-300 rounded-lg text-red-700 hover:bg-red-50 flex items-center justify-center gap-2 disabled:opacity-50",children:[s.jsx(Xi,{className:`w-4 h-4 ${f.isPending?"animate-spin":""}`}),"Reset to Default"]})]})]}),o&&s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Full System Message Preview"}),s.jsx("div",{className:"bg-gray-900 rounded-lg p-4 text-sm font-mono text-green-400 overflow-auto max-h-96",children:s.jsx("pre",{className:"whitespace-pre-wrap",children:j()})})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:" Tips for Better AI Responses"}),s.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[s.jsx("li",{children:" Be specific about what the AI should and shouldn't do"}),s.jsx("li",{children:" Include examples of ideal responses in custom instructions"}),s.jsx("li",{children:" Update regularly based on common customer issues"}),s.jsx("li",{children:" Use bullet points for clarity"}),s.jsx("li",{children:" Test changes with sample conversations"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Configuration Size"}),s.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[j().length.toLocaleString(),s.jsx("span",{className:"text-sm font-normal text-gray-500 ml-2",children:"characters"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: Keep under 4,000 characters for optimal performance"})]})]})]})]})}const CC={tenant_id:"default",business_name:"",business_email:"",business_phone:"",business_address:"",business_website:"",timezone:"Australia/Brisbane",language:"en-AU",measurement_system:"metric",currency:"AUD",currency_symbol:"$",date_format:"DD/MM/YYYY",time_format:"12h"};function _C(){var j,x;const e=mt(),[t,r]=u.useState(CC),[n,a]=u.useState(!1),{data:i,isLoading:l}=me({queryKey:["tenant-settings"],queryFn:async()=>(await I.get("/api/tenant/settings")).data}),{data:o}=me({queryKey:["tenant-settings-options"],queryFn:async()=>(await I.get("/api/tenant/settings/options")).data});u.useEffect(()=>{i&&r(i)},[i]);const c=Ce({mutationFn:async g=>(await I.put("/api/tenant/settings",g)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["tenant-settings"]}),alert("Settings saved successfully!")},onError:g=>{alert(`Failed to save settings: ${g.message}`)}}),d=()=>{c.mutate(t)},m=()=>{a(!0)},h=()=>{r({tenant_id:"default",business_name:"",business_email:"",business_phone:"",business_address:"",business_website:"",timezone:"Australia/Brisbane",language:"en-AU",measurement_system:"metric",currency:"AUD",currency_symbol:"$",date_format:"DD/MM/YYYY",time_format:"12h"}),a(!1)},f=g=>{const y=o==null?void 0:o.currencies.find(b=>b.value===g);r({...t,currency:g,currency_symbol:(y==null?void 0:y.symbol)||"$"})};return l?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading settings..."})}):s.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:s.jsx(gi,{className:"w-6 h-6 text-indigo-600"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dartmouth OS Settings"})]}),s.jsx("p",{className:"text-gray-600",children:"Configure global settings for your Dartmouth OS instance. These settings apply to all agents unless overridden."})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(X4,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Business Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Business Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:t.business_name,onChange:g=>r({...t,business_name:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Amazing Transfers"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Email"}),s.jsx("input",{type:"email",value:t.business_email,onChange:g=>r({...t,business_email:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"support@amazingtransfers.com.au"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Phone"}),s.jsx("input",{type:"tel",value:t.business_phone,onChange:g=>r({...t,business_phone:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"+61 7 1234 5678"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),s.jsx("input",{type:"url",value:t.business_website,onChange:g=>r({...t,business_website:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"https://amazingtransfers.com.au"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Address"}),s.jsx("input",{type:"text",value:t.business_address,onChange:g=>r({...t,business_address:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"123 Transfer Lane, Brisbane QLD 4000"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Uh,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Regional Settings"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(Ys,{className:"w-4 h-4 inline mr-1"}),"Timezone"]}),s.jsx("select",{value:t.timezone,onChange:g=>r({...t,timezone:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.timezones.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(L3,{className:"w-4 h-4 inline mr-1"}),"Language / Spelling"]}),s.jsx("select",{value:t.language,onChange:g=>r({...t,language:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.languages.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(j=o==null?void 0:o.languages.find(g=>g.value===t.language))==null?void 0:j.spelling})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(Y3,{className:"w-4 h-4 inline mr-1"}),"Measurement System"]}),s.jsx("select",{value:t.measurement_system,onChange:g=>r({...t,measurement_system:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.measurementSystems.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(p3,{className:"w-4 h-4 inline mr-1"}),"Currency"]}),s.jsx("select",{value:t.currency,onChange:g=>f(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.currencies.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(yb,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Date & Time Formats"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),s.jsx("select",{value:t.date_format,onChange:g=>r({...t,date_format:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.dateFormats.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),s.jsx("select",{value:t.time_format,onChange:g=>r({...t,time_format:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.timeFormats.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]})]})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-xl border border-indigo-200 p-6 mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-indigo-900 mb-3",children:"Preview - How AI Will Format Responses"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Date:"}),s.jsx("p",{className:"text-indigo-900",children:((x=o==null?void 0:o.dateFormats.find(g=>g.value===t.date_format))==null?void 0:x.example)||"31/12/2025"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Time:"}),s.jsx("p",{className:"text-indigo-900",children:t.time_format==="12h"?"2:30 PM":"14:30"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Currency:"}),s.jsxs("p",{className:"text-indigo-900",children:[t.currency_symbol,"99.95 ",t.currency]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Measurement:"}),s.jsx("p",{className:"text-indigo-900",children:t.measurement_system==="metric"?"50 cm, 2.5 kg":"20 in, 5.5 lb"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(Sb,{className:"w-4 h-4"}),"Reset to Defaults"]}),s.jsxs("button",{onClick:d,disabled:c.isPending,className:"flex items-center gap-2 px-6 py-2 text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[s.jsx(Xl,{className:"w-4 h-4"}),c.isPending?"Saving...":"Save Settings"]})]}),n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Reset to Factory Defaults?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This will reset all settings to their factory defaults:"}),s.jsxs("ul",{className:"text-sm text-gray-600 mb-4 list-disc list-inside",children:[s.jsx("li",{children:"Timezone: Australia/Brisbane"}),s.jsx("li",{children:"Language: Australian English"}),s.jsx("li",{children:"Measurement: Metric"}),s.jsx("li",{children:"Currency: AUD ($)"}),s.jsx("li",{children:"Date Format: DD/MM/YYYY"}),s.jsx("li",{children:"Time Format: 12-hour"}),s.jsx("li",{children:"Business information will be cleared"})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:h,className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Reset Settings"})]})]})})]})}function EC(){var f,j;const e=mt(),[t,r]=u.useState({agent_id:"customer-service-agent",timezone:null,language:null,measurement_system:null,currency:null,currency_symbol:null,date_format:null,time_format:null}),{data:n}=me({queryKey:["tenant-settings"],queryFn:async()=>(await I.get("/api/tenant/settings")).data}),{data:a,isLoading:i}=me({queryKey:["agent-overrides"],queryFn:async()=>(await I.get("/api/ai-agent/regional-overrides")).data}),{data:l}=me({queryKey:["tenant-settings-options"],queryFn:async()=>(await I.get("/api/tenant/settings/options")).data});u.useEffect(()=>{a&&r(a)},[a]);const o=Ce({mutationFn:async x=>(await I.put("/api/ai-agent/regional-overrides",x)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["agent-overrides"]}),alert("Overrides saved successfully!")},onError:x=>{alert(`Failed to save overrides: ${x.message}`)}}),c=()=>{o.mutate(t)},d=()=>{r({agent_id:"customer-service-agent",timezone:null,language:null,measurement_system:null,currency:null,currency_symbol:null,date_format:null,time_format:null})},m=x=>{const g=t[x];return g!==null&&g!==""?g:(n==null?void 0:n[x])||""},h=x=>t[x]!==null&&t[x]!=="";return i?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading overrides..."})}):s.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(Ye,{to:"/ai-agent/system-message",className:"text-sm text-indigo-600 hover:text-indigo-800 flex items-center gap-1 mb-4",children:[s.jsx(q4,{className:"w-4 h-4"}),"Back to AI Agent Settings"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(Uh,{className:"w-6 h-6 text-purple-600"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agent Regional Overrides"})]}),s.jsx("p",{className:"text-gray-600",children:"Override tenant-level regional settings for this specific agent. Leave fields empty to inherit from Dartmouth OS Settings."})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"How it works:"}),' Settings left as "Inherit from tenant" will use the values from',s.jsx(Ye,{to:"/settings/dartmouth-os",className:"text-blue-600 hover:underline mx-1",children:"Dartmouth OS Settings"}),". Only set overrides if this agent needs different regional settings (e.g., for a US market)."]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(gi,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Regional Overrides"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Timezone",h("timezone")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.timezone||"",onChange:x=>r({...t,timezone:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.timezone,")"]}),l==null?void 0:l.timezones.map(x=>s.jsx("option",{value:x.value,children:x.label},x.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Language / Spelling",h("language")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.language||"",onChange:x=>r({...t,language:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",(f=l==null?void 0:l.languages.find(x=>x.value===(n==null?void 0:n.language)))==null?void 0:f.label,")"]}),l==null?void 0:l.languages.map(x=>s.jsx("option",{value:x.value,children:x.label},x.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Measurement System",h("measurement_system")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.measurement_system||"",onChange:x=>r({...t,measurement_system:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.measurement_system,")"]}),l==null?void 0:l.measurementSystems.map(x=>s.jsx("option",{value:x.value,children:x.label},x.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Currency",h("currency")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.currency||"",onChange:x=>{const g=l==null?void 0:l.currencies.find(y=>y.value===x.target.value);r({...t,currency:x.target.value||null,currency_symbol:(g==null?void 0:g.symbol)||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.currency,")"]}),l==null?void 0:l.currencies.map(x=>s.jsx("option",{value:x.value,children:x.label},x.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date Format",h("date_format")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.date_format||"",onChange:x=>r({...t,date_format:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.date_format,")"]}),l==null?void 0:l.dateFormats.map(x=>s.jsx("option",{value:x.value,children:x.label},x.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Time Format",h("time_format")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.time_format||"",onChange:x=>r({...t,time_format:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",(n==null?void 0:n.time_format)==="12h"?"12-hour":"24-hour",")"]}),l==null?void 0:l.timeFormats.map(x=>s.jsx("option",{value:x.value,children:x.label},x.value))]})]})]})]}),s.jsxs("div",{className:"bg-purple-50 rounded-xl border border-purple-200 p-6 mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-purple-900 mb-3",children:"Effective Settings for This Agent"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Timezone:"}),s.jsx("p",{className:"text-purple-900",children:m("timezone")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Language:"}),s.jsx("p",{className:"text-purple-900",children:((j=l==null?void 0:l.languages.find(x=>x.value===m("language")))==null?void 0:j.label)||m("language")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Measurement:"}),s.jsx("p",{className:"text-purple-900",children:m("measurement_system")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Currency:"}),s.jsx("p",{className:"text-purple-900",children:m("currency")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Date Format:"}),s.jsx("p",{className:"text-purple-900",children:m("date_format")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Time Format:"}),s.jsx("p",{className:"text-purple-900",children:m("time_format")==="12h"?"12-hour":"24-hour"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(Sb,{className:"w-4 h-4"}),"Clear All Overrides"]}),s.jsxs("button",{onClick:c,disabled:o.isPending,className:"flex items-center gap-2 px-6 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[s.jsx(Xl,{className:"w-4 h-4"}),o.isPending?"Saving...":"Save Overrides"]})]})]})}function MC(){var f,j;const e=mt(),[t,r]=u.useState({enabled:!1,maxAssignedTickets:8,refillThreshold:3,priorityOrder:"priority_first",channels:["email","chat"],businessHoursOnly:!0}),{data:n,isLoading:a}=me({queryKey:["autoAssignmentConfig"],queryFn:async()=>(await No.getConfig()).data}),{data:i,isLoading:l}=me({queryKey:["autoAssignmentHistory"],queryFn:async()=>(await No.getHistory(50)).data});u.useEffect(()=>{n!=null&&n.config&&r(n.config)},[n]);const o=Ce({mutationFn:x=>No.updateConfig(x),onSuccess:()=>{e.invalidateQueries({queryKey:["autoAssignmentConfig"]})}}),c=Ce({mutationFn:()=>No.runNow(),onSuccess:()=>{e.invalidateQueries({queryKey:["autoAssignmentHistory"]})}}),d=()=>{o.mutate(t)},m=()=>{c.mutate()},h=x=>{const g=t.channels.includes(x)?t.channels.filter(y=>y!==x):[...t.channels,x];r({...t,channels:g})};return a?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):s.jsxs("div",{className:"max-w-4xl mx-auto py-6 px-4",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Auto-Assignment Settings"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Configure automatic ticket assignment to online staff members"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6 pb-6 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Auto-Assignment"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatically assign unassigned tickets to online staff"})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:t.enabled,onChange:x=>r({...t,enabled:x.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max Tickets per Staff"}),s.jsx("input",{type:"number",min:"1",max:"50",value:t.maxAssignedTickets,onChange:x=>r({...t,maxAssignedTickets:parseInt(x.target.value)||8}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Maximum tickets auto-assigned per staff member"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Refill Threshold"}),s.jsx("input",{type:"number",min:"0",max:"20",value:t.refillThreshold,onChange:x=>r({...t,refillThreshold:parseInt(x.target.value)||3}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Auto-assign more when staff drops below this count"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Assignment Priority"}),s.jsxs("select",{value:t.priorityOrder,onChange:x=>r({...t,priorityOrder:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[s.jsx("option",{value:"priority_first",children:"High Priority First"}),s.jsx("option",{value:"oldest_first",children:"Oldest First (FIFO)"}),s.jsx("option",{value:"newest_first",children:"Newest First"})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Order in which unassigned tickets are assigned"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Business Hours Only"}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer mt-2",children:[s.jsx("input",{type:"checkbox",checked:t.businessHoursOnly,onChange:x=>r({...t,businessHoursOnly:x.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),s.jsx("span",{className:"ml-3 text-sm text-gray-600 dark:text-gray-400",children:"Only assign during business hours"})]})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Channels to Auto-Assign"}),s.jsx("div",{className:"flex gap-4",children:["email","chat","phone"].map(x=>s.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:t.channels.includes(x),onChange:()=>h(x),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300 capitalize",children:x})]},x))})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[s.jsxs("button",{onClick:d,disabled:o.isPending,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[o.isPending?s.jsx(nf,{className:"h-4 w-4 mr-2 animate-spin"}):s.jsx(PS,{className:"h-4 w-4 mr-2"}),"Save Settings"]}),s.jsxs("button",{onClick:m,disabled:c.isPending||!t.enabled,className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[c.isPending?s.jsx(nf,{className:"h-4 w-4 mr-2 animate-spin"}):s.jsx(BS,{className:"h-4 w-4 mr-2"}),"Run Now"]})]}),c.isSuccess&&c.data&&s.jsxs("div",{className:"mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:[s.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200",children:[" ",c.data.data.message]}),((f=c.data.data.results)==null?void 0:f.length)>0&&s.jsx("ul",{className:"mt-2 text-sm text-green-700 dark:text-green-300",children:c.data.data.results.map((x,g)=>s.jsxs("li",{children:[" ",x.ticketNumber,"  ",x.staffName]},g))})]}),o.isSuccess&&s.jsx("div",{className:"mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:s.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:" Settings saved successfully"})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(Sm,{className:"h-5 w-5"}),"Assignment History"]}),s.jsx("button",{onClick:()=>e.invalidateQueries({queryKey:["autoAssignmentHistory"]}),className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Refresh"})]}),l?s.jsx("div",{className:"flex items-center justify-center h-32",children:s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):((j=i==null?void 0:i.history)==null?void 0:j.length)>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Ticket"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Assigned To"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reason"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Staff Queue"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Time"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:i.history.map(x=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:x.ticket_number}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:[x.staff_first_name," ",x.staff_last_name||""]}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${x.reason==="auto_refill"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"}`,children:x.reason==="auto_refill"?"Refill":"Initial"})}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:[x.staff_ticket_count," tickets"]}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(x.assigned_at).toLocaleString()})]},x.id))})]})}):s.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[s.jsx(Sm,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),s.jsx("p",{children:"No auto-assignments yet"}),s.jsx("p",{className:"text-sm mt-1",children:"Enable auto-assignment and assignments will appear here"})]})]})]})}const TC=[{title:"Dartmouth OS",description:"Global system settings including timezone, language, currency, and regional preferences",path:"/settings/dartmouth-os",category:"System"},{title:"Operational Hours",description:"Set your business operating hours for live chat availability",path:"/settings/business-hours",category:"Business"},{title:"Auto-Assignment",description:"Configure automatic ticket assignment to online staff members",path:"/settings/auto-assignment",category:"Business"},{title:"Group Chat",description:"Configure Group Chat channels, permissions, and edit/delete timeframes",path:"/settings/group-chat",category:"Business"},{title:"Widget & Embed",description:"Configure the chat widget appearance and get embed code for your website",path:"/ai-agent/widget",category:"AI Agent"},{title:"RAG Knowledge",description:"Upload and manage documents for AI to reference when answering questions",path:"/ai-agent/knowledge",category:"AI Agent"},{title:"System Message",description:"Define AI agent personality, role, responsibilities, and guidelines",path:"/ai-agent/system-message",category:"AI Agent"},{title:"Regional Overrides",description:"Override regional settings for specific AI agents",path:"/ai-agent/regional-overrides",category:"AI Agent"},{title:"Print ERP",description:"Connect and configure your Print ERP system integration",path:"/settings/integrations/perp",category:"Integrations"},{title:"Shopify",description:"Connect and configure your Shopify store integration",path:"/settings/integrations/shopify",category:"Integrations"},{title:"Facebook",description:"Connect your Facebook page for customer support",path:"/settings/meta/facebook",category:"Meta"},{title:"Instagram",description:"Connect your Instagram business account for DMs",path:"/settings/meta/instagram",category:"Meta"},{title:"Messenger",description:"Configure Facebook Messenger integration",path:"/settings/meta/messenger",category:"Meta"},{title:"WhatsApp",description:"Connect WhatsApp Business for customer messaging",path:"/settings/meta/whatsapp",category:"Meta"},{title:"Auth & Security",description:"Authentication settings, password policies, and security options",path:"/settings/general/auth",category:"General"},{title:"Templates",description:"Manage email templates and canned responses",path:"/settings/general/templates",category:"General"},{title:"Tags",description:"Configure AI auto-tagging, tag suggestions, and display preferences",path:"/settings/tags",category:"General"},{title:"Subscription",description:"Manage your subscription plan and billing details",path:"/settings/billing/subscription",category:"Billing"},{title:"Transactions",description:"View billing history and transaction records",path:"/settings/billing/transactions",category:"Billing"}];function AC(){const e=jr(),t=TC.reduce((a,i)=>(a[i.category]||(a[i.category]=[]),a[i.category].push(i),a),{}),r=["System","Business","AI Agent","Integrations","Meta","General","Billing"],n=a=>{switch(a){case"System":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})});case"Business":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"AI Agent":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})});case"Integrations":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"})});case"Meta":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})});case"General":return s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});case"Billing":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})});default:return s.jsx(Ko,{className:"w-5 h-5"})}};return s.jsxs("div",{className:"max-w-5xl mx-auto py-8 px-4",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[s.jsx(Ko,{className:"h-8 w-8 text-indigo-600"}),"Settings"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Configure your system settings and integrations"})]}),r.map(a=>t[a]&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 border-b border-gray-200 dark:border-gray-700 pb-2 flex items-center gap-2",children:[n(a),a]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t[a].map(i=>s.jsxs("button",{onClick:()=>e(i.path),className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-md transition-all text-left group",children:[s.jsx("div",{className:"flex-shrink-0 p-2 bg-gray-100 dark:bg-gray-700 rounded-lg group-hover:bg-indigo-100 dark:group-hover:bg-indigo-900/30 transition-colors",children:s.jsx(Ko,{className:"h-6 w-6 text-gray-500 dark:text-gray-400 group-hover:text-indigo-600 dark:group-hover:text-indigo-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400",children:i.title}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:i.description})]}),s.jsx("div",{className:"flex-shrink-0 self-center",children:s.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},i.path))})]},a))]})}const Xd={online:{color:"bg-green-500",label:"Online",description:"Available for chats and tickets"},away:{color:"bg-yellow-500",label:"Away",description:"Temporarily unavailable"},offline:{color:"bg-gray-400",label:"Offline",description:"Not available for new assignments"}};function RC(){var F,Z,q;const{user:e}=us(),t=mt(),[r,n]=u.useState(""),[a,i]=u.useState(""),l=u.useRef(null),[o,c]=u.useState({first_name:"",last_name:"",email:"",job_title:"",phone:"",department:""}),{data:d,isLoading:m}=me({queryKey:["currentStaff"],queryFn:()=>rt.me().then(O=>O.data.staff),enabled:!!e}),{data:h}=me({queryKey:["my-tasks-digest"],queryFn:async()=>(await I.get("/api/tickets",{params:{channel:"task",assigned_to:e==null?void 0:e.id,limit:100}})).data.tickets,enabled:!!e}),f=new Date,j=(h==null?void 0:h.filter(O=>O.status!=="completed"&&O.status!=="cancelled"))||[],x=j.filter(O=>O.sla_due_at&&new Date(O.sla_due_at)<f),g=j.filter(O=>{if(!O.sla_due_at)return!1;const V=new Date(O.sla_due_at),J=new Date(f.getTime()+24*60*60*1e3);return V>f&&V<=J});u.useEffect(()=>{d&&c({first_name:d.first_name||"",last_name:d.last_name||"",email:d.email||"",job_title:d.job_title||"",phone:d.phone||"",department:d.department||""})},[d]);const y=Ce({mutationFn:O=>rt.update((e==null?void 0:e.id)||"",O),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),n("Profile updated successfully!"),i(""),setTimeout(()=>n(""),3e3)},onError:O=>{var V,J;i(((J=(V=O.response)==null?void 0:V.data)==null?void 0:J.error)||"Failed to update profile"),n("")}}),b=Ce({mutationFn:O=>rt.updateAvailability((e==null?void 0:e.id)||"",O),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),n("Status updated!"),setTimeout(()=>n(""),2e3)}}),p=Ce({mutationFn:O=>rt.uploadAvatar((e==null?void 0:e.id)||"",O),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),t.invalidateQueries({queryKey:["staffUsers"]}),n("Photo uploaded successfully!"),setTimeout(()=>n(""),3e3)},onError:O=>{var V,J;i(((J=(V=O.response)==null?void 0:V.data)==null?void 0:J.error)||"Failed to upload photo")}}),v=Ce({mutationFn:()=>rt.deleteAvatar((e==null?void 0:e.id)||""),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),t.invalidateQueries({queryKey:["staffUsers"]}),n("Photo removed"),setTimeout(()=>n(""),2e3)},onError:O=>{var V,J;i(((J=(V=O.response)==null?void 0:V.data)==null?void 0:J.error)||"Failed to remove photo")}}),w=O=>{var J;const V=(J=O.target.files)==null?void 0:J[0];if(V){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(V.type)){i("Invalid file type. Please use JPEG, PNG, GIF, or WebP");return}if(V.size>5*1024*1024){i("File too large. Maximum size is 5MB");return}p.mutate(V)}l.current&&(l.current.value="")},N=O=>{O.preventDefault(),y.mutate(o)},A=O=>{c(V=>({...V,[O.target.name]:O.target.value}))},z=(d==null?void 0:d.availability_status)||"offline";return m?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"py-6 px-4 sm:px-6 lg:px-8 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Account"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your profile information and availability status"})]}),r&&s.jsx("div",{className:"mb-6 rounded-md bg-green-50 p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx(Nm,{className:"h-5 w-5 text-green-400"}),s.jsx("p",{className:"ml-3 text-sm font-medium text-green-800",children:r})]})}),a&&s.jsx("div",{className:"mb-6 rounded-md bg-red-50 p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx(DS,{className:"h-5 w-5 text-red-400"}),s.jsx("p",{className:"ml-3 text-sm font-medium text-red-800",children:a})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{className:"relative group",children:[d!=null&&d.avatar_url?s.jsx("img",{src:rt.getAvatarUrl(d.avatar_url)||"",alt:`${d.first_name} ${d.last_name}`,className:"w-24 h-24 rounded-full object-cover"}):s.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-3xl font-bold",children:[(F=d==null?void 0:d.first_name)==null?void 0:F[0],(Z=d==null?void 0:d.last_name)==null?void 0:Z[0]]}),s.jsx("div",{className:`absolute bottom-1 right-1 w-5 h-5 rounded-full border-2 border-white ${Xd[z].color}`}),s.jsxs("div",{className:"absolute inset-0 rounded-full bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:[s.jsx("button",{onClick:()=>{var O;return(O=l.current)==null?void 0:O.click()},className:"p-2 text-white hover:text-indigo-200 transition-colors",title:"Upload photo",children:s.jsx(AS,{className:"w-6 h-6"})}),(d==null?void 0:d.avatar_url)&&s.jsx("button",{onClick:()=>v.mutate(),className:"p-2 text-white hover:text-red-300 transition-colors",title:"Remove photo",children:s.jsx(QS,{className:"w-6 h-6"})})]}),s.jsx("input",{ref:l,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:w,className:"hidden"})]}),p.isPending&&s.jsxs("div",{className:"mt-2 text-sm text-indigo-600 flex items-center gap-1",children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}),s.jsxs("h2",{className:"mt-4 text-lg font-semibold text-gray-900",children:[d==null?void 0:d.first_name," ",d==null?void 0:d.last_name]}),s.jsx("p",{className:"text-sm text-gray-500",children:(d==null?void 0:d.job_title)||"Team Member"}),s.jsx("span",{className:`mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(d==null?void 0:d.role)==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:(d==null?void 0:d.role)==="admin"?"Administrator":"Staff"})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Your Status"}),s.jsx("div",{className:"space-y-2",children:Object.keys(Xd).map(O=>{const V=Xd[O],J=O===z;return s.jsxs("button",{onClick:()=>b.mutate(O),disabled:b.isPending,className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-all ${J?"bg-indigo-50 ring-2 ring-indigo-500":"hover:bg-gray-50 border border-gray-200"}`,children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${V.color}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:`text-sm font-medium ${J?"text-indigo-700":"text-gray-700"}`,children:V.label}),s.jsx("p",{className:"text-xs text-gray-500",children:V.description})]}),J&&s.jsx(Nm,{className:"w-5 h-5 text-indigo-600"})]},O)})})]})]})}),s.jsxs("div",{className:"lg:col-span-2",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Profile Information"}),s.jsxs("form",{onSubmit:N,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700",children:"First Name"}),s.jsx("input",{type:"text",id:"first_name",name:"first_name",value:o.first_name,onChange:A,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),s.jsx("input",{type:"text",id:"last_name",name:"last_name",value:o.last_name,onChange:A,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),s.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:A,disabled:!0,className:"mt-1 block w-full rounded-lg border-gray-300 bg-gray-50 shadow-sm sm:text-sm cursor-not-allowed"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Email cannot be changed"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"job_title",className:"block text-sm font-medium text-gray-700",children:"Job Title"}),s.jsx("input",{type:"text",id:"job_title",name:"job_title",value:o.job_title,onChange:A,placeholder:"e.g. Customer Support Specialist",className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),s.jsx("input",{type:"tel",id:"phone",name:"phone",value:o.phone,onChange:A,placeholder:"e.g. 0412 345 678",className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700",children:"Department"}),s.jsxs("select",{id:"department",name:"department",value:o.department,onChange:A,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[s.jsx("option",{value:"",children:"Select a department"}),s.jsx("option",{value:"Customer Support",children:"Customer Support"}),s.jsx("option",{value:"Sales",children:"Sales"}),s.jsx("option",{value:"Production",children:"Production"}),s.jsx("option",{value:"Design",children:"Design"}),s.jsx("option",{value:"Management",children:"Management"}),s.jsx("option",{value:"Other",children:"Other"})]})]}),s.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:s.jsx("button",{type:"submit",disabled:y.isPending,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:y.isPending?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]})]}),s.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account Information"}),s.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Account ID"}),s.jsxs("dd",{className:"mt-1 text-sm text-gray-900 font-mono",children:[(q=e==null?void 0:e.id)==null?void 0:q.slice(0,8),"..."]})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Role"}),s.jsx("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:(d==null?void 0:d.role)||"Staff"})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Member Since"}),s.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:d!=null&&d.created_at?new Date(d.created_at).toLocaleDateString():"N/A"})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),s.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:d!=null&&d.updated_at?new Date(d.updated_at).toLocaleDateString():"N/A"})]})]})]})]}),s.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[s.jsx(km,{className:"w-5 h-5 text-amber-600"}),"My Task Digest"]}),s.jsx(Ye,{to:"/task-digest",className:"text-sm text-indigo-600 hover:text-indigo-800 font-medium",children:"View All Tasks "})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-amber-700 font-medium",children:"Open Tasks"}),s.jsx("p",{className:"text-2xl font-bold text-amber-900",children:j.length})]}),s.jsx(km,{className:"w-8 h-8 text-amber-500"})]})}),s.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Overdue"}),s.jsx("p",{className:"text-2xl font-bold text-red-900",children:x.length})]}),s.jsx(US,{className:"w-8 h-8 text-red-500"})]})}),s.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Due in 24h"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900",children:g.length})]}),s.jsx(Sm,{className:"w-8 h-8 text-orange-500"})]})})]}),(x.length>0||g.length>0)&&s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[" You have ",x.length," overdue task",x.length!==1?"s":"",g.length>0&&` and ${g.length} due in the next 24 hours`,"."," ",s.jsx(Ye,{to:"/task-digest",className:"font-medium underline hover:text-yellow-900",children:"Review now"})]})})]})]})]})]})}function PC(){var y,b,p,v,w,N,A,z,F,Z,q;const e=mt(),[t,r]=u.useState(null),[n,a]=u.useState({}),{data:i,isLoading:l}=me({queryKey:["integrations"],queryFn:async()=>(await I.get("/api/integrations")).data}),o=Ce({mutationFn:async O=>(await I.post(`/api/integrations/${O}/test`)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["integrations"]})}}),c=Ce({mutationFn:async({integrationId:O,settings:V})=>(await I.post(`/api/integrations/${O}/settings`,V)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["integrations"]}),r(null),a({})}}),d=[{id:"shopify",name:"Shopify",description:"Connect your Shopify store to view customer orders and data",icon:s.jsx(Cb,{className:"w-6 h-6"}),status:(y=i==null?void 0:i.shopify)!=null&&y.connected?"connected":"disconnected",settings:[{key:"SHOPIFY_DOMAIN",label:"Store Domain",type:"url",value:((b=i==null?void 0:i.shopify)==null?void 0:b.domain)||"",placeholder:"your-store.myshopify.com",required:!0,helpText:"Your Shopify store domain (e.g., your-store.myshopify.com)"},{key:"SHOPIFY_ACCESS_TOKEN",label:"Admin API Access Token",type:"password",value:((p=i==null?void 0:i.shopify)==null?void 0:p.accessToken)||"",placeholder:"shpat_xxxxxxxxxxxxx",required:!0,helpText:"Create a custom app in Shopify Admin  Settings  Apps and sales channels  Develop apps"}]},{id:"cloudflare-r2",name:"Cloudflare R2",description:"Object storage for file attachments",icon:s.jsx(h3,{className:"w-6 h-6"}),status:(v=i==null?void 0:i.r2)!=null&&v.connected?"connected":"disconnected",settings:[{key:"R2_BUCKET_NAME",label:"Bucket Name",type:"text",value:((w=i==null?void 0:i.r2)==null?void 0:w.bucketName)||"dartmouth-attachments",placeholder:"dartmouth-attachments",required:!0,helpText:"Your Cloudflare R2 bucket name"}]},{id:"email",name:"Email (Gmail)",description:"Send and receive emails via Gmail",icon:s.jsx(rr,{className:"w-6 h-6"}),status:(N=i==null?void 0:i.email)!=null&&N.connected?"connected":"disconnected",settings:[{key:"GMAIL_CLIENT_ID",label:"Gmail Client ID",type:"text",value:((A=i==null?void 0:i.email)==null?void 0:A.clientId)||"",placeholder:"xxxxx.apps.googleusercontent.com",required:!0},{key:"GMAIL_CLIENT_SECRET",label:"Gmail Client Secret",type:"password",value:((z=i==null?void 0:i.email)==null?void 0:z.clientSecret)||"",placeholder:"GOCSPX-xxxxx",required:!0},{key:"GMAIL_REFRESH_TOKEN",label:"Gmail Refresh Token",type:"password",value:((F=i==null?void 0:i.email)==null?void 0:F.refreshToken)||"",placeholder:"1//xxxxx",required:!0}]},{id:"resend",name:"Resend",description:"Email service for transactional emails",icon:s.jsx(rr,{className:"w-6 h-6"}),status:(Z=i==null?void 0:i.resend)!=null&&Z.connected?"connected":"disconnected",settings:[{key:"RESEND_API_KEY",label:"Resend API Key",type:"password",value:((q=i==null?void 0:i.resend)==null?void 0:q.apiKey)||"",placeholder:"re_xxxxx",required:!0,helpText:"Get your API key from resend.com"}]}],m=(O,V)=>{r(O);const J={};V.settings.forEach(pe=>{J[pe.key]=pe.value}),a(J)},h=O=>{c.mutate({integrationId:O,settings:n})},f=O=>{o.mutate(O)},j=O=>{switch(O){case"connected":return s.jsx(lt,{className:"w-5 h-5 text-green-600"});case"error":return s.jsx(br,{className:"w-5 h-5 text-red-600"});default:return s.jsx(oa,{className:"w-5 h-5 text-gray-400"})}},x=O=>{switch(O){case"connected":return"Connected";case"error":return"Error";default:return"Not Connected"}},g=O=>{switch(O){case"connected":return"text-green-600";case"error":return"text-red-600";default:return"text-gray-500"}};return l?s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"text-gray-500",children:"Loading integrations..."})}):s.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Integrations"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Connect and manage your third-party integrations"})]}),s.jsx("div",{className:"space-y-4",children:d.map(O=>s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg text-blue-600",children:O.icon}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:O.name}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.description}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[j(O.status),s.jsx("span",{className:`text-sm font-medium ${g(O.status)}`,children:x(O.status)})]})]})]}),s.jsx("div",{className:"flex gap-2",children:t===O.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{r(null),a({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>h(O.id),disabled:c.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:c.isPending?"Saving...":"Save"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>f(O.id),disabled:o.isPending||O.status==="disconnected",className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:o.isPending?"Testing...":"Test Connection"}),s.jsx("button",{onClick:()=>m(O.id,O),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Configure"})]})})]})}),t===O.id&&s.jsx("div",{className:"p-6 bg-gray-50",children:s.jsx("div",{className:"space-y-4",children:O.settings.map(V=>s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[V.label,V.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsx("input",{type:V.type,value:n[V.key]||"",onChange:J=>a({...n,[V.key]:J.target.value}),placeholder:V.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),V.helpText&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:V.helpText})]},V.key))})})]},O.id))}),s.jsxs("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Need Help?"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Shopify:"})," Create a custom app in your Shopify Admin to get API credentials"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Cloudflare R2:"})," Configured via wrangler.toml and Cloudflare dashboard"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Gmail:"})," Set up OAuth 2.0 credentials in Google Cloud Console"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Resend:"})," Sign up at resend.com and create an API key"]})]})]})]})}function $C(){var Z,q,O,V;const e=mt(),[t,r]=u.useState("config"),[n,a]=u.useState(!1),[i,l]=u.useState(""),[o,c]=u.useState(""),[d,m]=u.useState(null),[h,f]=u.useState(null),{data:j,isLoading:x}=me({queryKey:["integrations"],queryFn:async()=>(await I.get("/api/integrations")).data}),{data:g,refetch:y}=me({queryKey:["integrations-debug"],queryFn:async()=>(await I.get("/api/integrations/debug")).data,enabled:!1}),b=Ce({mutationFn:async J=>(await I.post("/api/integrations/shopify/settings",J)).data,onSuccess:()=>{f({success:!0,message:"Settings saved successfully!"}),a(!1),e.invalidateQueries({queryKey:["integrations"]}),l(""),c("")},onError:J=>{var pe,ke;f({success:!1,message:((ke=(pe=J.response)==null?void 0:pe.data)==null?void 0:ke.message)||"Failed to save settings"})}}),p=Ce({mutationFn:async()=>(await I.post("/api/integrations/shopify/test")).data,onSuccess:J=>{m(J),e.invalidateQueries({queryKey:["integrations"]})},onError:J=>{var pe,ke;m({success:!1,message:((ke=(pe=J.response)==null?void 0:pe.data)==null?void 0:ke.message)||"Connection test failed"})}}),v=j==null?void 0:j.shopify,w=v==null?void 0:v.connected,N=()=>{var J;a(!0),f(null),m(null),l(((J=v==null?void 0:v.domain)==null?void 0:J.replace(//g,""))||""),c("")},A=()=>{a(!1),l(""),c(""),f(null)},z=()=>{if(!i||!o){f({success:!1,message:"Both fields are required"});return}b.mutate({domain:i,accessToken:o})},F=()=>{m(null),p.mutate()};return x?s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"text-gray-500",children:"Loading..."})}):s.jsxs("div",{className:"p-6 max-w-4xl",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Shopify Integration"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Connect your Shopify store to view customer orders and data in tickets"})]}),s.jsx("div",{className:"mb-6 border-b border-gray-200",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsx("button",{onClick:()=>r("config"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Configuration"}),s.jsx("button",{onClick:()=>r("guide"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="guide"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Installation Guide"})]})}),t==="config"&&s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-3 bg-green-50 rounded-lg text-green-600",children:s.jsx(Cb,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Shopify Store"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View customer order history, tracking info, and purchase data"}),s.jsx("div",{className:"flex items-center gap-2 mt-3",children:w?s.jsxs(s.Fragment,{children:[s.jsx(lt,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Connected"})]}):s.jsxs(s.Fragment,{children:[s.jsx(oa,{className:"w-5 h-5 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Not Connected"})]})})]})]}),s.jsx("div",{className:"flex gap-2",children:n?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:A,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:z,disabled:b.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:b.isPending?"Saving...":"Save"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>y(),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Debug Info"}),s.jsx("button",{onClick:F,disabled:p.isPending||!w,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:p.isPending?"Testing...":"Test Connection"}),s.jsx("button",{onClick:N,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Configure"})]})})]})}),d&&s.jsx("div",{className:`p-4 border-b ${d.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[d.success?s.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5"}):s.jsx(br,{className:"w-5 h-5 text-red-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:`text-sm font-medium ${d.success?"text-green-900":"text-red-900"}`,children:d.success?"Connection Successful!":"Connection Failed"}),s.jsx("p",{className:`text-sm mt-1 ${d.success?"text-green-700":"text-red-700"}`,children:d.message})]})]})}),h&&s.jsx("div",{className:`p-4 border-b ${h.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[h.success?s.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5"}):s.jsx(br,{className:"w-5 h-5 text-red-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:`text-sm font-medium ${h.success?"text-green-900":"text-red-900"}`,children:h.success?"Saved Successfully!":"Save Failed"}),s.jsx("p",{className:`text-sm mt-1 ${h.success?"text-green-700":"text-red-700"}`,children:h.message})]})]})}),g&&s.jsxs("div",{className:"p-4 border-b bg-gray-50 border-gray-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Debug Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"KV Storage:"}),s.jsxs("p",{className:"text-gray-600",children:["Domain: ",((Z=g.kv)==null?void 0:Z.SHOPIFY_DOMAIN)||"not set"]}),s.jsxs("p",{className:"text-gray-600",children:["Token: ",((q=g.kv)==null?void 0:q.SHOPIFY_ACCESS_TOKEN)||"not set"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Secrets:"}),s.jsxs("p",{className:"text-gray-600",children:["Domain: ",((O=g.secrets)==null?void 0:O.SHOPIFY_DOMAIN)||"not set"]}),s.jsxs("p",{className:"text-gray-600",children:["Token: ",((V=g.secrets)==null?void 0:V.SHOPIFY_ACCESS_TOKEN)||"not set"]})]})]})]}),!n&&s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Current Settings"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Store Domain"}),s.jsx("div",{className:"text-sm text-gray-900",children:(v==null?void 0:v.domain)||"Not configured"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Access Token"}),s.jsx("div",{className:"text-sm text-gray-900",children:(v==null?void 0:v.accessToken)||"Not configured"})]})]})]}),n&&s.jsxs("div",{className:"p-6 bg-gray-50",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Shopify Configuration"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Store Domain ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i,onChange:J=>l(J.target.value),placeholder:"your-store.myshopify.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Shopify store domain (e.g., your-store.myshopify.com)"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Admin API Access Token ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"password",value:o,onChange:J=>c(J.target.value),placeholder:"shpat_xxxxxxxxxxxxx",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Shopify Admin API access token (starts with shpat_)"})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"How to get your Shopify credentials:"}),s.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[s.jsx("li",{children:"Go to Shopify Admin  Settings  Apps and sales channels"}),s.jsx("li",{children:'Click "Develop apps"  "Create an app" (name it "Dartmouth OS")'}),s.jsxs("li",{children:["Configure Admin API scopes: ",s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_customers"}),", ",s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_orders"}),", ",s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_products"})]}),s.jsx("li",{children:'Click "Install app" and copy the Admin API access token'})]}),s.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[s.jsx(cl,{className:"w-4 h-4 text-blue-600"}),s.jsx("a",{href:"https://help.shopify.com/en/manual/apps/app-types/custom-apps",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 underline",children:"Shopify Custom Apps Documentation"})]})]})]})]}),s.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"What You'll Get"}),s.jsxs("ul",{className:"space-y-3",children:[s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Customer Order History"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"View all orders from a customer when viewing their ticket"})]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Order Tracking"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"See tracking numbers and fulfillment status"})]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Product Information"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"View product details and variants from orders"})]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"AI Agent Context"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"AI can reference customer's order history when responding"})]})]})]})]})]}),t==="guide"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Shopify Installation Guide"}),s.jsx("p",{className:"text-gray-700 mb-4",children:"Follow these steps to connect your Shopify store to Dartmouth OS. This will allow you to view customer order history, tracking information, and product details directly in your support tickets."}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Time required:"})," 5-10 minutes",s.jsx("br",{}),s.jsx("strong",{children:"Shopify plan:"})," Any plan (Basic, Shopify, Advanced, Plus)",s.jsx("br",{}),s.jsx("strong",{children:"Access needed:"}),' Store owner or staff with "Develop apps" permission']})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Shopify Admin"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsx("span",{children:"Log in to your Shopify Admin panel"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Settings"})," (bottom left corner)"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Apps and sales channels"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"4."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Develop apps"})," (top right)"]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"}),` If you don't see "Develop apps", you may need to enable it first. Click "Allow custom app development" and confirm.`]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"2"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Create Custom App"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Create an app"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Enter app name: ",s.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Dartmouth OS"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsx("span",{children:"Select an app developer (usually yourself)"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"4."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Create app"})]})]})]})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"3"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Configure API Scopes"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Configure Admin API scopes"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsx("span",{children:"Search for and enable these scopes:"})]})]}),s.jsxs("div",{className:"mt-3 ml-6 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600"}),s.jsx("code",{className:"font-mono text-sm",children:"read_customers"}),s.jsx("span",{className:"text-xs text-gray-600",children:"- View customer information"})]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600"}),s.jsx("code",{className:"font-mono text-sm",children:"read_orders"}),s.jsx("span",{className:"text-xs text-gray-600",children:"- View order history"})]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[s.jsx(lt,{className:"w-5 h-5 text-green-600"}),s.jsx("code",{className:"font-mono text-sm",children:"read_products"}),s.jsx("span",{className:"text-xs text-gray-600",children:"- View product details"})]})]}),s.jsx("ol",{start:3,className:"space-y-3 text-gray-700 mt-3",children:s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Save"})]})]})}),s.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded",children:s.jsxs("p",{className:"text-sm text-red-800",children:[s.jsx("strong",{children:"Important:"})," Only enable these three scopes. Do not enable write permissions unless absolutely necessary."]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"4"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Install the App"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Install app"})," (top right)"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Review the permissions and click ",s.jsx("strong",{children:"Install"})]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"})," You must install the app before you can get the access token. If you skip this step, you'll get a 403 Forbidden error."]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Get API Credentials"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"API credentials"})," tab"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Copy your ",s.jsx("strong",{children:"Admin API access token"})," (starts with ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"shpat_"}),")"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsxs("span",{children:["Note your store domain (e.g., ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"your-store.myshopify.com"}),")"]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded",children:s.jsxs("p",{className:"text-sm text-red-800",children:[s.jsx("strong",{children:"Security Warning:"})," The access token is shown only once! Copy it immediately and store it securely. If you lose it, you'll need to uninstall and reinstall the app to get a new token."]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center font-bold",children:"6"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connect to Dartmouth OS"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Go to the ",s.jsx("strong",{children:"Configuration"})," tab above"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Configure"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsx("span",{children:"Enter your Store Domain and Admin API Access Token"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"4."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Save"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"5."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Test Connection"})," to verify everything works"]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:s.jsxs("p",{className:"text-sm text-green-800",children:[s.jsx("strong",{children:"Success!"})," If the test passes, you're all set. Customer order data will now appear in your support tickets."]})})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Troubleshooting Common Issues"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"403 Forbidden Error"}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This usually means:"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 ml-4",children:[s.jsx("li",{children:" The app wasn't installed (Step 4)"}),s.jsx("li",{children:" Wrong API scopes were configured"}),s.jsx("li",{children:" You copied the API Key instead of the Access Token"})]}),s.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[s.jsx("strong",{children:"Solution:"})," Go back to Step 3 and verify the scopes, then reinstall the app."]})]}),s.jsxs("div",{className:"border-l-4 border-yellow-500 pl-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"401 Unauthorized Error"}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This means the access token is invalid."}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Solution:"})," Double-check you copied the entire token (starts with shpat_). If still failing, uninstall and reinstall the app to get a new token."]})]}),s.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Connection Timeout"}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This means the domain is incorrect."}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Solution:"})," Verify your store domain is in the format: your-store.myshopify.com (not your custom domain)."]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Resources"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("a",{href:"https://help.shopify.com/en/manual/apps/app-types/custom-apps",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[s.jsx(cl,{className:"w-4 h-4"}),"Shopify Custom Apps Documentation"]}),s.jsxs("a",{href:"https://shopify.dev/docs/api/admin-rest",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[s.jsx(cl,{className:"w-4 h-4"}),"Shopify Admin API Reference"]})]})]})]})]})}function LC(){var yt,Ei,On,Kr;const{user:e}=us(),t=mt(),[r]=Bl(),n=u.useRef(null),a=u.useRef(null),[i,l]=u.useState(null),[o,c]=u.useState(null),[d,m]=u.useState(""),[h,f]=u.useState([]),[j,x]=u.useState(!1),[g,y]=u.useState(!0),[b,p]=u.useState(""),[v,w]=u.useState(""),[N,A]=u.useState(null),[z,F]=u.useState(null),[Z,q]=u.useState(""),[O,V]=u.useState(!1),[J,pe]=u.useState(null),[ke,we]=u.useState(null),[B,M]=u.useState(!1),[X,Y]=u.useState(""),[ee,ie]=u.useState(0),ne=u.useRef(null),[ge,$e]=u.useState(null),[R,ae]=u.useState(!1),[je,_]=u.useState(null),[G,W]=u.useState(""),[Q,H]=u.useState(null),[he,ze]=u.useState(null),[be,le]=u.useState(!1),D=u.useRef(null),[Me,Te]=u.useState(""),[P,se]=u.useState([]),[oe,_e]=u.useState(0),[Ee,We]=u.useState(!1),{data:et}=me({queryKey:["group-chat-channels"],queryFn:async()=>(await xt.listChannels()).data,refetchInterval:5e3}),it=(et==null?void 0:et.channels)||[],{data:kt}=me({queryKey:["group-chat-time-limit"],queryFn:async()=>(await xt.getTimeLimit()).data}),Gt=(kt==null?void 0:kt.timeLimit)??10,ss=S=>{if((e==null?void 0:e.role)==="admin"||Gt===0)return!0;const ve=new Date(S.created_at).getTime(),ye=Date.now(),Pe=Gt*60*1e3;return S.sender_id===(e==null?void 0:e.id)&&ye-ve<=Pe},Et=()=>{n.current&&n.current.scrollIntoView({behavior:"smooth",block:"end"})},rs=S=>{c(S),setTimeout(()=>{const ve=document.getElementById(`message-${S}`);ve&&ve.scrollIntoView({behavior:"smooth",block:"center"})},100),setTimeout(()=>{c(null)},5e3)},Hs=S=>{if(Te(S),!S.trim()||!de.length){se([]),_e(0);return}const ve=S.toLowerCase(),ye=[];[...de].reverse().forEach(Pe=>{let He=!1;Pe.content.toLowerCase().includes(ve)&&(He=!0),Pe.tags&&Pe.tags.split(",").map(ct=>ct.trim().toLowerCase()).some(ct=>ct.includes(ve))&&(He=!0),He&&ye.push(Pe.id)}),se(ye),_e(0),ye.length>0&&rs(ye[0])},ks=()=>{if(P.length===0)return;const S=(oe+1)%P.length;_e(S),rs(P[S])},wr=()=>{if(P.length===0)return;const S=oe===0?P.length-1:oe-1;_e(S),rs(P[S])};u.useEffect(()=>{!i&&it.length>0&&l(it[0].id)},[it,i]),u.useEffect(()=>{const S=r.get("channel"),ve=r.get("message");S&&l(S),ve&&(c(ve),setTimeout(()=>{const ye=document.getElementById(`message-${ve}`);ye&&ye.scrollIntoView({behavior:"smooth",block:"center"})},500),setTimeout(()=>{c(null)},5e3))},[r]),u.useEffect(()=>{const S=D.current;if(!S)return;const ve=()=>{const{scrollTop:ye,scrollHeight:Pe,clientHeight:He}=S,st=Pe-ye-He<100;le(!st)};return S.addEventListener("scroll",ve),()=>S.removeEventListener("scroll",ve)},[i]);const{data:Rs}=me({queryKey:["group-chat-messages",i],queryFn:async()=>i?(await xt.getMessages(i,{limit:50})).data:{messages:[]},enabled:!!i,refetchInterval:5e3,refetchOnWindowFocus:!1}),de=(Rs==null?void 0:Rs.messages)||[];u.useEffect(()=>{if(de.length>0){const S=de[de.length-1];S.id!==N&&(A(S.id),i&&xt.markAsRead(i,S.id))}},[de,N,i]);const{data:Nr}=me({queryKey:["group-chat-members",i],queryFn:async()=>i?(await xt.getMembers(i)).data:{members:[]},enabled:!!i}),hs=(Nr==null?void 0:Nr.members)||[],Ps=hs.find(S=>S.staff_id===(e==null?void 0:e.id)),ar=(Ps==null?void 0:Ps.role)==="admin";u.useEffect(()=>{n.current&&n.current.scrollIntoView({behavior:"smooth",block:"end"})},[de]),u.useEffect(()=>{const S=setTimeout(()=>{n.current&&n.current.scrollIntoView({behavior:"auto",block:"end"})},100);return()=>clearTimeout(S)},[]),u.useEffect(()=>{const S=()=>$e(null);if(ge)return document.addEventListener("click",S),()=>document.removeEventListener("click",S)},[ge]);const Ss=Ce({mutationFn:async S=>{if(!i)throw new Error("No active channel");return xt.sendMessage(i,S)},onSuccess:()=>{m(""),f([]),t.invalidateQueries({queryKey:["group-chat-messages",i]}),t.invalidateQueries({queryKey:["group-chat-channels"]})}}),Xe=Ce({mutationFn:S=>xt.createChannel(S),onSuccess:()=>{x(!1),p(""),w(""),t.invalidateQueries({queryKey:["group-chat-channels"]})}}),$=Ce({mutationFn:({messageId:S,content:ve,deleteAttachment:ye})=>xt.editMessage(S,ve,ye),onSuccess:()=>{F(null),V(!1),q(""),t.invalidateQueries({queryKey:["group-chat-messages",i]})}}),fe=Ce({mutationFn:S=>xt.deleteMessage(S),onSuccess:()=>{t.invalidateQueries({queryKey:["group-chat-messages",i]})}}),Fe=Ce({mutationFn:({messageId:S,emoji:ve})=>xt.addReaction(S,ve),onSuccess:()=>{t.invalidateQueries({queryKey:["group-chat-messages",i]}),pe(null)}}),De=async()=>{if(!d.trim()&&h.length===0||Ss.isPending)return;let S=[];if(h.length>0)for(const ye of h){const Pe=await Pt(ye);S.push({name:ye.name,content:Pe,type:ye.type,size:ye.size})}let ve=d;he&&(ve=` Replying to ${he.first_name}: "${he.content.substring(0,50)}${he.content.length>50?"...":""}" [msg:${he.id}]

${d}`),Ss.mutate({content:ve,attachments:S.length>0?S:void 0}),ze(null)},at=S=>{S.target.files&&S.target.files.length>0&&f(Array.from(S.target.files))},Pt=S=>new Promise((ve,ye)=>{const Pe=new FileReader;Pe.readAsDataURL(S),Pe.onload=()=>ve(Pe.result),Pe.onerror=He=>ye(He)}),In=async(S,ve)=>{try{const Pe=await(await fetch(S)).blob(),He=window.URL.createObjectURL(Pe),st=document.createElement("a");st.href=He,st.download=ve,document.body.appendChild(st),st.click(),document.body.removeChild(st),window.URL.revokeObjectURL(He)}catch(ye){console.error("Error downloading file:",ye)}},E=()=>{b.trim()&&Xe.mutate({name:b,description:v||void 0,channelType:"public"})},T=S=>S.startsWith("http")?S:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${S}`,Ae=S=>S.split(/(@\w+|@\d+|#\d+|TKT-\d+|ticket\s+\d+|\*\d+(?:-\d+)?|TSK-\d+(?:-\d+)?)/gi).map((ye,Pe)=>{if(ye.match(/^@\w+$/)&&!ye.match(/^@\d+$/))return s.jsx("span",{className:"bg-blue-100 text-blue-700 font-semibold px-1 rounded",children:ye},Pe);const He=ye.match(/^@(\d+)$|^#(\d+)$|^TKT-(\d+)$|^ticket\s+(\d+)$/i);if(He){const ct=He[1]||He[2]||He[3]||He[4];return s.jsx("a",{href:`/tickets?search=TKT-${ct}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",onClick:$t=>{$t.stopPropagation()},children:ye},Pe)}const st=ye.match(/^\*(\d+)(?:-(\d+))?$|^TSK-(\d+)(?:-(\d+))?$/i);if(st){const ct=st[1]||st[3],$t=st[2]||st[4],ir=$t?`TSK-${ct}-${$t}`:`TSK-${ct}`;return s.jsx("a",{href:`/tickets?search=${ir}`,target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800 hover:underline font-medium",onClick:Ke=>{Ke.stopPropagation()},children:ye},Pe)}return ye}),Re=S=>{const ve=S.content,ye=ve.match(/^ Replying to (\w+): "(.+?)" \[msg:([^\]]+)\]\n\n([\s\S]*)$/);if(ye){const[,Pe,He,st,ct]=ye;return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-2 pb-2 border-b border-gray-300",children:s.jsxs("button",{onClick:()=>{rs(st)},className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 hover:underline",title:"Click to view original message",children:[s.jsx("span",{className:"text-base",children:""}),s.jsxs("span",{children:["Replying to ",Pe,': "',He,'"']})]})}),s.jsx("div",{children:Ae(ct)})]})}return Ae(ve)},Ge=it.find(S=>S.id===i);return s.jsxs("div",{className:"w-full flex bg-gray-50",style:{height:"calc(100vh - 3.5rem)"},children:[s.jsxs("div",{className:"w-64 bg-white border-r border-gray-200 flex flex-col flex-shrink-0 h-full overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",style:{height:"73px"},children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Team Chat"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Internal Communication"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"p-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[s.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Channels"}),ar&&s.jsx("button",{onClick:()=>x(!0),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",title:"Create new channel (Admin only)",children:s.jsx(nd,{className:"w-4 h-4"})})]}),it.map(S=>s.jsxs("button",{onClick:()=>l(S.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg text-left transition-colors border ${i===S.id?"bg-indigo-50 text-indigo-900 font-semibold border-indigo-300":"text-gray-700 hover:bg-gray-50 border-transparent"}`,children:[s.jsx(Ot,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{className:"flex-1 truncate font-medium",children:S.name}),S.unread_count>0&&s.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5",children:S.unread_count})]},S.id))]})})]}),s.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:Ge?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",style:{minHeight:"73px"},children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsx(Ot,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:Ge.name}),Ge.description&&s.jsx("p",{className:"text-sm text-gray-500 truncate",children:Ge.description})]})]}),s.jsx("button",{onClick:()=>We(!Ee),className:`p-2 rounded-lg flex-shrink-0 ${Ee?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Search messages",children:s.jsx(fi,{className:"w-5 h-5"})}),s.jsxs("button",{onClick:()=>y(!g),className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg flex-shrink-0",children:[s.jsx(Zl,{className:"w-5 h-5"}),s.jsxs("span",{className:"text-sm font-medium",children:[hs.length," members"]})]})]}),Ee&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{type:"text",value:Me,onChange:S=>Hs(S.target.value),placeholder:"Search messages and tags... (e.g., James Scott, #james-scott)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),P.length>0&&s.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2 bg-white px-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[oe+1," / ",P.length]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:wr,className:"p-1 hover:bg-gray-100 rounded",title:"Previous result",children:s.jsx(ur,{className:"w-4 h-4"})}),s.jsx("button",{onClick:ks,className:"p-1 hover:bg-gray-100 rounded",title:"Next result",children:s.jsx(Ws,{className:"w-4 h-4"})})]})]})]}),s.jsx("button",{onClick:()=>{We(!1),Te(""),se([]),_e(0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Close search",children:s.jsx(_t,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{ref:D,className:"flex-1 overflow-y-auto p-6 space-y-3 relative",children:[de.map(S=>{var st,ct,$t,ir;const ve=S.sender_id===(e==null?void 0:e.id),ye=S.reactions?JSON.parse(S.reactions):[],Pe=z===S.id,He=o===S.id;return s.jsxs("div",{id:`message-${S.id}`,className:`group flex gap-3 -mx-2 px-2 py-1 rounded transition-all duration-300 ${He?"bg-yellow-100 border-l-4 border-yellow-500 pl-1":"hover:bg-gray-50"}`,onContextMenu:Ke=>{Ke.preventDefault(),$e({x:Ke.clientX,y:Ke.clientY,messageId:S.id})},children:[s.jsxs("div",{className:"flex-shrink-0",children:[S.profile_picture&&rt.getAvatarUrl(S.profile_picture)?s.jsx("img",{src:rt.getAvatarUrl(S.profile_picture)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-10 h-10 rounded-full object-cover",onError:Ke=>{var Mt;Ke.currentTarget.style.display="none",(Mt=Ke.currentTarget.nextElementSibling)==null||Mt.classList.remove("hidden")}}):null,s.jsxs("div",{className:`w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-semibold ${S.profile_picture&&rt.getAvatarUrl(S.profile_picture)?"hidden":""}`,children:[(st=S.first_name)==null?void 0:st[0],(ct=S.last_name)==null?void 0:ct[0]]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[s.jsxs("span",{className:"font-semibold text-gray-900 text-sm",children:[S.first_name," ",S.last_name]}),s.jsx("span",{className:"text-xs text-gray-500",children:(()=>{const Ke=new Date(S.created_at),Mt=new Date;return Ke.toDateString()===Mt.toDateString()?Ke.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Ke.toLocaleString([],{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})()}),S.edited_at&&s.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Edited at ${new Date(S.edited_at).toLocaleString()}`,children:["(edited ",new Date(S.edited_at).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),")"]}),ve&&!Pe&&ss(S)&&s.jsxs("div",{className:"ml-auto opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1",children:[s.jsx("button",{onClick:()=>{F(S.id),q(S.content),V(!1)},className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",title:"Edit message (within 10 mins)",children:s.jsx(kb,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:()=>we(S.id),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Delete message (within 10 mins)",children:s.jsx(pi,{className:"w-3.5 h-3.5"})})]})]}),Pe?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:Z,onChange:Ke=>q(Ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3,autoFocus:!0}),S.attachment_url&&!O&&s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded border border-gray-200",children:[($t=S.attachment_type)!=null&&$t.startsWith("image/")?s.jsx(Cc,{className:"w-4 h-4 text-gray-500"}):s.jsx(Wo,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700 flex-1",children:S.attachment_name}),s.jsx("button",{onClick:()=>V(!0),className:"p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded",title:"Remove attachment",children:s.jsx(_t,{className:"w-4 h-4"})})]}),O&&s.jsx("div",{className:"text-xs text-gray-500 italic",children:"Attachment will be removed when you save"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{$.mutate({messageId:S.id,content:Z,deleteAttachment:O})},className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{F(null),q(""),V(!1)},className:"px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300",children:"Cancel"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg px-4 py-2.5 border border-gray-200",children:[s.jsx("div",{className:"text-gray-900 text-sm whitespace-pre-wrap break-words",children:Re(S)}),S.attachment_url&&s.jsx("div",{className:"mt-2",children:(ir=S.attachment_type)!=null&&ir.startsWith("image/")?s.jsxs("div",{className:"relative inline-block",children:[s.jsx("a",{href:T(S.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:s.jsx("img",{src:T(S.attachment_url),alt:S.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300"})}),s.jsx("button",{onClick:()=>S.attachment_url&&In(T(S.attachment_url),S.attachment_name||"image.png"),className:"absolute top-2 right-2 p-2 bg-white/90 hover:bg-white text-gray-700 hover:text-blue-600 rounded-lg shadow-md border border-gray-200",title:"Download image",children:s.jsx(Sc,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("a",{href:T(S.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 hover:underline",children:[s.jsx(Wo,{className:"w-4 h-4"}),s.jsx("span",{children:S.attachment_name}),S.attachment_size&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(S.attachment_size/1024).toFixed(1)," KB)"]})]}),s.jsx("button",{onClick:()=>S.attachment_url&&In(T(S.attachment_url),S.attachment_name||"download"),className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Download file",children:s.jsx(Sc,{className:"w-4 h-4"})})]})}),S.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(S.tags).map((Ke,Mt)=>s.jsxs(Ye,{to:`/tags?tag=${encodeURIComponent(Ke)}`,className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors",children:[s.jsx(Ot,{className:"w-3 h-3"}),Ke]},Mt))})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[ye.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(ye.reduce((Ke,Mt)=>(Ke[Mt.emoji]=(Ke[Mt.emoji]||0)+1,Ke),{})).map(([Ke,Mt])=>s.jsxs("button",{onClick:()=>Fe.mutate({messageId:S.id,emoji:Ke}),className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-full text-xs",children:[s.jsx("span",{children:Ke}),s.jsx("span",{className:"text-blue-600 font-medium",children:Mt})]},Ke))}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>pe(J===S.id?null:S.id),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",title:"Add reaction",children:s.jsx(aS,{className:"w-4 h-4"})}),J===S.id&&s.jsx("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex gap-1 z-10",children:["","","","","","",""].map(Ke=>s.jsx("button",{onClick:()=>Fe.mutate({messageId:S.id,emoji:Ke}),className:"text-2xl hover:bg-gray-100 rounded p-1",children:Ke},Ke))})]})]})]})]})]},S.id)}),s.jsx("div",{ref:n})]}),be&&s.jsx("button",{onClick:Et,className:"absolute bottom-28 right-8 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-3 shadow-lg transition-all duration-200 z-50",title:"Scroll to bottom",children:s.jsx(H4,{className:"w-5 h-5"})}),s.jsxs("div",{className:"bg-white pt-8 pb-4 px-4",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:Tb}),h.length>0&&s.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:h.map((S,ve)=>s.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-2",children:[S.type.startsWith("image/")?s.jsx(Cc,{className:"w-4 h-4 text-gray-600"}):s.jsx(Wo,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm text-gray-700",children:S.name}),s.jsx("button",{onClick:()=>f(h.filter((ye,Pe)=>Pe!==ve)),className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-4 h-4"})})]},ve))}),he&&s.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-xs text-blue-600 font-semibold",children:["Replying to ",he.first_name," ",he.last_name]}),s.jsx("div",{className:"text-sm text-gray-600 truncate",children:he.content})]}),s.jsx("button",{onClick:()=>ze(null),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",children:s.jsx(_t,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"file",ref:a,onChange:at,className:"hidden",multiple:!0}),s.jsx("button",{onClick:()=>{var S;return(S=a.current)==null?void 0:S.click()},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(St,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{ref:ne,type:"text",value:d,onChange:S=>{const ve=S.target.value;m(ve);const ye=S.target.selectionStart||0,He=ve.substring(0,ye).match(/@(\w*)$/);He?(Y(He[1].toLowerCase()),ie(ye),M(!0)):M(!1)},onKeyDown:S=>{S.key==="Enter"&&!B?(S.preventDefault(),De()):S.key==="Escape"&&B&&M(!1)},placeholder:"Type a message... Use @ to mention, #keyword to add tags",className:"w-full px-4 h-[42px] border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),B&&hs.length>0&&s.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-50",children:[hs.filter(S=>{const ve=`${S.first_name} ${S.last_name}`.toLowerCase(),ye=S.first_name.toLowerCase();return ve.includes(X)||ye.includes(X)}).map(S=>s.jsxs("button",{onClick:()=>{var He;const ve=d.substring(0,ee).replace(/@\w*$/,""),ye=d.substring(ee),Pe=`${ve}@${S.first_name.toLowerCase()} ${ye}`;m(Pe),M(!1),(He=ne.current)==null||He.focus()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-2",children:[S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?s.jsx("img",{src:rt.getAvatarUrl(S.avatar_url)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-8 h-8 rounded-full object-cover",onError:ve=>{var ye;ve.currentTarget.style.display="none",(ye=ve.currentTarget.nextElementSibling)==null||ye.classList.remove("hidden")}}):null,s.jsxs("div",{className:`w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm font-semibold ${S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?"hidden":""}`,children:[S.first_name[0],S.last_name[0]]}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-sm",children:[S.first_name," ",S.last_name]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["@",S.first_name.toLowerCase()]})]})]},S.staff_id)),("mccarthy".includes(X)||"mc".includes(X))&&s.jsxs("button",{onClick:()=>{var Pe;const S=d.substring(0,ee).replace(/@\w*$/,""),ve=d.substring(ee),ye=`${S}@mccarthy ${ve}`;m(ye),M(!1),(Pe=ne.current)==null||Pe.focus()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-2 border-t border-gray-200",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500 text-white flex items-center justify-center text-sm font-semibold",children:"AI"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:"McCarthy AI"}),s.jsx("div",{className:"text-xs text-gray-500",children:"@mccarthy"})]})]})]})]}),s.jsx("button",{onClick:De,disabled:!d.trim()&&h.length===0||Ss.isPending,className:"px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 h-[42px]",children:Ss.isPending?s.jsxs(s.Fragment,{children:[s.jsx(wb,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"Uploading..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(ad,{className:"w-5 h-5"}),s.jsx("span",{children:"Send"})]})})]})]})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ot,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{className:"text-lg font-medium",children:"No channel selected"}),s.jsx("p",{className:"text-sm",children:"Select a channel from the sidebar to start chatting"})]})})}),g&&Ge&&s.jsxs("div",{className:"w-64 bg-white border-l border-gray-200 flex flex-col flex-shrink-0 h-full overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",style:{height:"73px"},children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Members"}),s.jsxs("p",{className:"text-sm text-gray-500",children:[hs.length," in this channel"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:hs.map(S=>{var ve,ye;return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative",children:[S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?s.jsx("img",{src:rt.getAvatarUrl(S.avatar_url)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-8 h-8 rounded-full object-cover",onError:Pe=>{var He;Pe.currentTarget.style.display="none",(He=Pe.currentTarget.nextElementSibling)==null||He.classList.remove("hidden")}}):null,s.jsxs("div",{className:`w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold ${S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?"hidden":""}`,children:[(ve=S.first_name)==null?void 0:ve[0],(ye=S.last_name)==null?void 0:ye[0]]}),S.availability_status==="available"&&s.jsx("div",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-white"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[S.first_name," ",S.last_name]}),S.role==="admin"&&s.jsx("span",{className:"text-xs text-blue-600",children:"Admin"})]})]},S.id)})})]}),j&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Channel"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),s.jsx("input",{type:"text",value:b,onChange:S=>p(S.target.value),placeholder:"e.g., general, support, sales",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),s.jsx("textarea",{value:v,onChange:S=>w(S.target.value),placeholder:"What is this channel for?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>{x(!1),p(""),w("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:E,disabled:!b.trim(),className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Channel"})]})]})}),ke&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Message"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this message? This action cannot be undone."}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>we(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>{fe.mutate(ke),we(null)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),ge&&s.jsxs("div",{className:"fixed bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",style:{top:ge.y,left:ge.x},onClick:S=>S.stopPropagation(),children:[s.jsxs("button",{onClick:()=>{var ve;const S=de.find(ye=>ye.id===ge.messageId);S&&(ze(S),$e(null),(ve=ne.current)==null||ve.focus())},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{children:""})," Reply"]}),s.jsxs("button",{onClick:()=>{_(ge.messageId),ae(!0),$e(null)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{children:""})," Share"]}),s.jsxs("button",{onClick:()=>{const S=de.find(ve=>ve.id===ge.messageId);S&&(navigator.clipboard.writeText(S.content),$e(null))},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{children:""})," Copy Message"]})]}),R&&je&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Share Message"}),Q?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Sharing to: ",s.jsx("span",{className:"font-semibold",children:Q==="MEMOS"?"@Memos":`#${(yt=it.find(S=>S.id===Q))==null?void 0:yt.name}`})]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Original message:"}),s.jsx("p",{className:"text-sm text-gray-900 line-clamp-3",children:(Ei=de.find(S=>S.id===je))==null?void 0:Ei.content}),((On=de.find(S=>S.id===je))==null?void 0:On.attachment_name)&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 mt-2",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{children:(Kr=de.find(S=>S.id===je))==null?void 0:Kr.attachment_name})]})]}),s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:Q==="MEMOS"?"Add your note (optional):":"Add your comment (optional - use @ to mention someone):"}),s.jsx("textarea",{value:G,onChange:S=>W(S.target.value),placeholder:Q==="MEMOS"?"Add a note about this shared message...":"@gaille can you review this?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>{H(null),W("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Back"}),s.jsx("button",{onClick:async()=>{var ve,ye;const S=de.find(Pe=>Pe.id===je);if(S&&i&&Q&&e)if(Q==="MEMOS"){const Pe=(ve=it.find(ct=>ct.id===i))==null?void 0:ve.name;let He="";G.trim()?He=`${G}

 Shared from #${Pe}:
${S.content}`:He=` Shared from #${Pe}:

${S.content}`;let st;if(S.attachment_url&&S.attachment_name)try{const $t=await(await fetch(T(S.attachment_url))).blob(),ir=await new Promise(Ke=>{const Mt=new FileReader;Mt.onloadend=()=>Ke(Mt.result),Mt.readAsDataURL($t)});st={name:S.attachment_name,data:ir,type:S.attachment_type||"application/octet-stream",size:S.attachment_size||0}}catch(ct){console.error("Error fetching attachment:",ct)}console.log("[Share to Memos] Creating memo with:",{content:He,attachment:st}),Gi.createMemo({content:He,attachment:st}).then(()=>{ae(!1),_(null),H(null),W(""),t.invalidateQueries({queryKey:["memos"]})}).catch(ct=>{console.error("Error creating memo:",ct),alert("Failed to share to @Memos. Please try again.")})}else{const Pe=(ye=it.find($t=>$t.id===i))==null?void 0:ye.name,He=`${e.firstName} ${e.lastName}`;let st="";G.trim()?st=`${G}

 ${He} shared from #${Pe}:
${S.content}`:st=` ${He} shared from #${Pe}:

${S.content}`;let ct;if(S.attachment_url&&S.attachment_name)try{const ir=await(await fetch(T(S.attachment_url))).blob(),Ke=await new Promise(Mt=>{const va=new FileReader;va.onloadend=()=>Mt(va.result),va.readAsDataURL(ir)});ct=[{name:S.attachment_name,content:Ke,type:S.attachment_type||"application/octet-stream",size:S.attachment_size||0}]}catch($t){console.error("Error fetching attachment:",$t)}xt.sendMessage(Q,{content:st,attachments:ct}).then(()=>{ae(!1),_(null),H(null),W(""),t.invalidateQueries({queryKey:["group-chat-channels"]})}).catch($t=>{console.error("Error sharing message:",$t),alert("Failed to share message. Please try again.")})}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Share"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select where to share this message:"}),s.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4",children:[it.filter(S=>S.id!==i).map(S=>s.jsxs("button",{onClick:()=>H(S.id),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded border border-gray-200 flex items-center gap-2",children:[s.jsx(Ot,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{children:S.name})]},S.id)),s.jsxs("button",{onClick:()=>H("MEMOS"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded border border-gray-200 flex items-center gap-2",children:[s.jsx(_c,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{children:"@Memos (Personal notes)"})]})]}),s.jsx("div",{className:"flex gap-3 justify-end",children:s.jsx("button",{onClick:()=>{ae(!1),_(null),H(null),W("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})})]})]})})]})}function FC(){const e=mt(),[t,r]=u.useState("channels"),[n,a]=u.useState(null),[i,l]=u.useState(!1),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,f]=u.useState(""),[j,x]=u.useState(""),[g,y]=u.useState(""),[b,p]=u.useState(""),[v,w]=u.useState(!0),[N,A]=u.useState(!0),[z,F]=u.useState(!0),[Z,q]=u.useState(10),[O,V]=u.useState(12),{data:J}=me({queryKey:["group-chat-channels-settings"],queryFn:async()=>(await xt.listChannels()).data}),pe=(J==null?void 0:J.channels)||[],{data:ke}=me({queryKey:["group-chat-time-limit"],queryFn:async()=>(await xt.getTimeLimit()).data});u.useState(()=>{(ke==null?void 0:ke.timeLimit)!==void 0&&q(ke.timeLimit)});const we=Ce({mutationFn:H=>xt.setTimeLimit(H),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-time-limit"]})}}),{data:B}=me({queryKey:["mentions-auto-archive"],queryFn:async()=>(await xt.getAutoArchiveHours()).data});u.useState(()=>{(B==null?void 0:B.hours)!==void 0&&V(B.hours)});const M=Ce({mutationFn:H=>xt.setAutoArchiveHours(H),onSuccess:()=>{e.invalidateQueries({queryKey:["mentions-auto-archive"]})}}),{data:X}=me({queryKey:["group-chat-members-settings",n==null?void 0:n.id],queryFn:async()=>n?(await xt.getMembers(n.id)).data:{members:[]},enabled:!!n}),Y=(X==null?void 0:X.members)||[],{data:ee}=me({queryKey:["staff-list"],queryFn:async()=>(await rt.list()).data}),ie=(ee==null?void 0:ee.staff)||[],ne=Ce({mutationFn:H=>xt.updateChannel(H.channelId,{name:H.name,description:H.description,allow_message_editing:H.allow_message_editing,allow_message_deletion:H.allow_message_deletion,allow_file_deletion:H.allow_file_deletion}),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-channels-settings"]}),l(!1),a(null)}}),ge=Ce({mutationFn:H=>xt.archiveChannel(H),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-channels-settings"]}),a(null)}}),$e=Ce({mutationFn:H=>xt.addMember(H.channelId,H.staffId),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-members-settings",n==null?void 0:n.id]})}}),R=Ce({mutationFn:H=>xt.removeMember(H.channelId,H.staffId),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-members-settings",n==null?void 0:n.id]})}}),ae=Ce({mutationFn:H=>xt.createChannel(H),onSuccess:()=>{m(!1),y(""),p(""),e.invalidateQueries({queryKey:["group-chat-channels-settings"]})}}),je=()=>{!n||!h.trim()||ne.mutate({channelId:n.id,name:h,description:j,allow_message_editing:v,allow_message_deletion:N,allow_file_deletion:z})},_=H=>{n&&$e.mutate({channelId:n.id,staffId:H})},G=H=>{n&&confirm("Are you sure you want to remove this member from the channel?")&&R.mutate({channelId:n.id,staffId:H})},W=ie.filter(H=>!Y.some(he=>he.staff_id===H.id)),Q=()=>{g.trim()&&ae.mutate({name:g,description:b||void 0,channelType:"public"})};return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Group Chat Settings"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage channels, members, and group chat configuration"})]}),s.jsx("div",{className:"mb-6 border-b border-gray-200",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsxs("button",{onClick:()=>r("channels"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="channels"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(Ot,{className:"w-4 h-4 inline-block mr-2"}),"Channels"]}),s.jsxs("button",{onClick:()=>r("global"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="global"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(gi,{className:"w-4 h-4 inline-block mr-2"}),"Global Settings"]}),s.jsx("button",{onClick:()=>r("mentions"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="mentions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"@Mentions"})]})}),t==="channels"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[s.jsx(nd,{className:"w-4 h-4"}),"Create Channel"]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Ot,{className:"w-5 h-5"}),"Channels"]}),pe.length===0?s.jsx("p",{className:"text-gray-500 text-center py-8",children:"No channels yet. Create one to get started!"}):s.jsx("div",{className:"space-y-2",children:pe.map(H=>s.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[s.jsx(Ot,{className:"w-4 h-4"}),H.name,H.is_archived===1&&s.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Archived"})]}),H.description&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:H.description})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{a(H),c(!0)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Manage Members",children:s.jsx(Zl,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>{a(H),f(H.name),x(H.description||""),l(!0)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Edit Channel",children:s.jsx(Bh,{className:"w-4 h-4"})}),H.is_archived===0&&s.jsx("button",{onClick:()=>{confirm(`Archive channel "${H.name}"?`)&&ge.mutate(H.id)},className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded",title:"Archive Channel",children:s.jsx(pi,{className:"w-4 h-4"})})]})]},H.id))})]})})]}),t==="global"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(gi,{className:"w-5 h-5"}),"Global Settings"]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Edit/Delete Time Limit"}),s.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"How long staff members can edit or delete their messages. Admins can always edit/delete."}),s.jsxs("select",{value:Z,onChange:H=>{const he=parseInt(H.target.value,10);q(he),we.mutate(he)},className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:5,children:"5 minutes"}),s.jsx("option",{value:10,children:"10 minutes (default)"}),s.jsx("option",{value:15,children:"15 minutes"}),s.jsx("option",{value:30,children:"30 minutes"}),s.jsx("option",{value:60,children:"1 hour"}),s.jsx("option",{value:0,children:"No limit (always allow)"})]}),we.isPending&&s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Saving..."}),we.isSuccess&&s.jsx("p",{className:"text-xs text-green-600 mt-2",children:" Saved successfully"})]})})]}),t==="mentions"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"@Mentions Settings"}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto Archive Mentions"}),s.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Automatically archive Read mentions after the specified time. This keeps your Mentions page clean and focused on active items."}),s.jsxs("select",{value:O,onChange:H=>{const he=parseInt(H.target.value,10);V(he),M.mutate(he)},className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:12,children:"12 Hours (default)"}),s.jsx("option",{value:24,children:"24 Hours"}),s.jsx("option",{value:36,children:"36 Hours"}),s.jsx("option",{value:48,children:"48 Hours"}),s.jsx("option",{value:72,children:"72 Hours"}),s.jsx("option",{value:0,children:"Never Archive"})]}),M.isPending&&s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Saving..."}),M.isSuccess&&s.jsx("p",{className:"text-xs text-green-600 mt-2",children:" Saved successfully"})]})})]}),i&&n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Channel"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),s.jsx("input",{type:"text",value:h,onChange:H=>f(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:j,onChange:H=>x(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Channel Permissions"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Message Editing"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Members can edit their own messages"})]}),s.jsx("input",{type:"checkbox",checked:v,onChange:H=>w(H.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("label",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Message Deletion"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Members can delete their own messages"})]}),s.jsx("input",{type:"checkbox",checked:N,onChange:H=>A(H.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("label",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow File Deletion"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Members can delete attached files"})]}),s.jsx("input",{type:"checkbox",checked:z,onChange:H=>F(H.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]})]})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>{l(!1),a(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:je,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Changes"})]})]})}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Channel"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),s.jsx("input",{type:"text",value:g,onChange:H=>y(H.target.value),placeholder:"e.g., general, support, sales",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),s.jsx("textarea",{value:b,onChange:H=>p(H.target.value),placeholder:"What is this channel for?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>{m(!1),y(""),p("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:Q,disabled:!g.trim()||ae.isPending,className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:ae.isPending?"Creating...":"Create Channel"})]})]})}),o&&n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Manage Members - #",n.name]}),s.jsx("button",{onClick:()=>{c(!1),a(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Current Members (",Y.length,")"]}),s.jsx("div",{className:"space-y-2",children:Y.map(H=>{var he,ze;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold",children:[(he=H.first_name)==null?void 0:he[0],(ze=H.last_name)==null?void 0:ze[0]]}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[H.first_name," ",H.last_name]}),s.jsx("p",{className:"text-xs text-gray-500",children:H.email})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[H.role==="admin"&&s.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:"Admin"}),s.jsx("button",{onClick:()=>G(H.staff_id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove member",children:s.jsx(_t,{className:"w-4 h-4"})})]})]},H.id)})})]}),W.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Add Members (",W.length," available)"]}),s.jsx("div",{className:"space-y-2",children:W.map(H=>{var he,ze;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold",children:[(he=H.first_name)==null?void 0:he[0],(ze=H.last_name)==null?void 0:ze[0]]}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[H.first_name," ",H.last_name]}),s.jsx("p",{className:"text-xs text-gray-500",children:H.email})]})]}),s.jsxs("button",{onClick:()=>_(H.id),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-800 text-white rounded-lg hover:bg-gray-900",children:[s.jsx(Rl,{className:"w-4 h-4"}),s.jsx("span",{children:"Add"})]})]},H.id)})})]}),W.length===0&&Y.length>0&&s.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"All staff members are already in this channel"})]})})]})}function IC(){const[e,t]=u.useState(null),[r,n]=u.useState(""),[a,i]=u.useState(0),{data:l,isLoading:o}=me({queryKey:["tags",r],queryFn:async()=>(await qx.getAllTags(r||void 0)).data}),{data:c,isLoading:d}=me({queryKey:["tag-content",e],queryFn:async()=>e?(await qx.searchTags(e)).data:{results:[]},enabled:!!e}),m=(l==null?void 0:l.tags)||[],h=(c==null?void 0:c.results)||[],f=h[a],j=()=>{a>0&&i(a-1)},x=()=>{a<h.length-1&&i(a+1)};return s.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(rf,{className:"w-6 h-6 text-blue-600"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tags"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[m.length," ",m.length===1?"tag":"tags"," found"]})]}),s.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(fi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",value:r,onChange:g=>n(g.target.value),placeholder:"Filter tags by name... (e.g., james-scott, urgent, team)",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r&&s.jsx("button",{onClick:()=>n(""),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:"Clear search",children:s.jsx(_t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsx("div",{className:"max-w-6xl mx-auto",children:o?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading tags..."})]}):m.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(rf,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tags yet"}),s.jsx("p",{className:"text-gray-600",children:"Tags will appear here when you add them to memos or group chat messages."})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(g=>s.jsxs("button",{onClick:()=>{const y=g.name===e?null:g.name;t(y),i(0)},className:`p-4 rounded-lg border-2 transition-all text-left ${e===g.name?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-semibold text-gray-900",children:g.name})]}),s.jsx("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded",children:g.count})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[g.count," ",g.count===1?"reference":"references"]})]},g.name))}),e&&s.jsx("div",{className:"mt-8",children:s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["#",e]}),s.jsxs("span",{className:"text-sm text-gray-500",children:["(",h.length," ",h.length===1?"reference":"references",")"]})]}),s.jsx("button",{onClick:()=>t(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),d?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Loading content..."})]}):h.length===0?s.jsx("p",{className:"text-center text-gray-500 py-8",children:"No content found with this tag."}):s.jsxs(s.Fragment,{children:[h.length>1&&s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-gray-200",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",a+1," of ",h.length]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:j,disabled:a===0,className:"p-2 text-blue-600 hover:bg-blue-50 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous",children:s.jsx(xi,{className:"w-5 h-5"})}),s.jsx("button",{onClick:x,disabled:a===h.length-1,className:"p-2 text-blue-600 hover:bg-blue-50 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Next",children:s.jsx(Jl,{className:"w-5 h-5"})})]})]}),f&&s.jsx("div",{children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:f.type==="memo"?s.jsx(_c,{className:"w-6 h-6 text-yellow-600"}):f.type==="group_chat"?s.jsx(Br,{className:"w-6 h-6 text-blue-600"}):s.jsx(hS,{className:"w-6 h-6 text-green-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-500 uppercase",children:f.type==="memo"?"@Memos":f.type==="group_chat"?"Group Chat":"Ticket"}),s.jsx("span",{className:"text-sm text-gray-400",children:""}),s.jsx("span",{className:"text-sm text-gray-500",children:new Date(f.created_at).toLocaleString()})]}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap mb-4",children:f.content}),f.tags&&s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:f.tags.split(",").map((g,y)=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-sm rounded",children:[s.jsx(Ot,{className:"w-3 h-3"}),g.trim()]},y))}),f.type==="memo"&&s.jsx(Ye,{to:"/memos",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"View in @Memos "}),f.type==="group_chat"&&f.channel_id&&s.jsx(Ye,{to:`/group-chat/${f.channel_id}`,className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"View in Group Chat "})]})]})})]})]})})]})})})]})}function OC(){const e=mt(),[t,r]=u.useState(!1),[n,a]=u.useState(!1),{data:i,isLoading:l}=me({queryKey:["tag-settings"],queryFn:async()=>({ai_auto_tagging_enabled:!0,tag_suggestions_enabled:!0,tag_display_position:"below"})}),[o,c]=u.useState({ai_auto_tagging_enabled:!0,tag_suggestions_enabled:!0,tag_display_position:"below"});Le.useEffect(()=>{i&&c(i)},[i]);const d=async()=>{r(!0);try{await new Promise(m=>setTimeout(m,500)),e.invalidateQueries({queryKey:["tag-settings"]}),a(!0),setTimeout(()=>a(!1),3e3)}catch(m){console.error("Error saving tag settings:",m),alert("Failed to save settings")}finally{r(!1)}};return l?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("div",{className:"text-gray-500",children:"Loading settings..."})}):s.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[s.jsxs("header",{className:"flex-shrink-0 bg-white border-b border-gray-200 px-6 py-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ot,{className:"w-6 h-6 text-blue-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Tags Settings"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Configure tagging behavior and display options"})]})]}),s.jsxs("button",{onClick:d,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(Xl,{className:"w-4 h-4"}),t?"Saving...":"Save Changes"]})]}),n&&s.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-800 text-sm",children:" Settings saved successfully"})]}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"McCarthy AI Auto-Tagging"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enable McCarthy AI to automatically tag tickets, Live Chat conversations, and Group Chat messages based on content analysis, sentiment, intent, and customer behavior (RFM)."}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 bg-blue-50 p-3 rounded-lg",children:[s.jsx(wm,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{children:"McCarthy AI analyzes content in real-time and suggests relevant tags. You can always manually add or remove tags."})]})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[s.jsx("input",{type:"checkbox",checked:o.ai_auto_tagging_enabled,onChange:m=>c({...o,ai_auto_tagging_enabled:m.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tag Suggestions"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Show tag suggestions while typing in Group Chat, Live Chat, and ticket notes. Suggestions are based on previously used tags and McCarthy AI recommendations."})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[s.jsx("input",{type:"checkbox",checked:o.tag_suggestions_enabled,onChange:m=>c({...o,tag_suggestions_enabled:m.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tag Display Position"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose how tags are displayed in messages and posts."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[s.jsx("input",{type:"radio",name:"tag_display_position",value:"below",checked:o.tag_display_position==="below",onChange:()=>c({...o,tag_display_position:"below"}),className:"w-4 h-4 text-blue-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Below Message"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Tags appear as blue pills below the message content (recommended)"})]})]}),s.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[s.jsx("input",{type:"radio",name:"tag_display_position",value:"inline",checked:o.tag_display_position==="inline",onChange:()=>c({...o,tag_display_position:"inline"}),className:"w-4 h-4 text-blue-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Inline with Message"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Tags appear within the message text as #keywords"})]})]})]})]})}),s.jsxs("div",{className:"bg-gray-100 rounded-lg border border-gray-300 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(wm,{className:"w-5 h-5"}),"Coming Soon"]}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Advanced tagging features currently in development:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"AI Confidence Threshold:"})," Set minimum confidence level for auto-tagging"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Tag Categories:"})," Organize tags into predefined categories (Customer Type, Product, Issue Type, etc.)"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"RFM Integration:"})," Auto-tag VIP customers based on Recency, Frequency, Monetary analysis"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Shopify Integration:"})," Map product categories to tags and auto-tag based on purchase history"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Tag Cleanup:"})," Auto-merge similar tags and archive unused ones"]})]})]})]})]})})]})}function DC(){const e=mt(),{user:t}=us(),[r,n]=u.useState(""),[a,i]=u.useState(""),[l,o]=u.useState(!1),c=u.useRef(null),[d,m]=u.useState("Amazing Transfers"),[h,f]=u.useState("info@amazingtransfers.com.au"),[j,x]=u.useState("amazingtransfers.com"),{data:g,isLoading:y}=me({queryKey:["email-signature-settings"],queryFn:async()=>(await ko.getSettings()).data});u.useEffect(()=>{g&&(i(g.logoUrl??""),m(g.companyName??"Amazing Transfers"),f(g.email??"info@amazingtransfers.com.au"),x(g.website??"amazingtransfers.com"))},[g]);const{data:b}=me({queryKey:["email-signature-preview",a,d,h,j],queryFn:async()=>(await ko.getPreviewFromSettings({logoUrl:a,companyName:d,email:h,website:j})).data,enabled:!!d&&!!h});u.useEffect(()=>{b!=null&&b.signatureHtml&&n(b.signatureHtml)},[b]);const p=Ce({mutationFn:()=>ko.saveSettings({logoUrl:a,companyName:d,email:h,website:j}),onSuccess:()=>{e.invalidateQueries({queryKey:["email-signature-settings"]}),e.invalidateQueries({queryKey:["email-signature-preview"]})}}),v=()=>{p.mutate()},w=async N=>{var z;const A=(z=N.target.files)==null?void 0:z[0];if(A){if(!A.type.startsWith("image/")){alert("Please upload an image file (PNG, JPG, etc.)");return}if(A.size>2*1024*1024){alert("Logo file size must be less than 2MB");return}o(!0);try{const F=new FileReader;F.onload=async()=>{const Z=F.result,O=(await ko.uploadLogo({name:A.name,data:Z,type:A.type,size:A.size})).data.logoUrl;i(O),alert(`Logo uploaded successfully!

URL: ${O}

You can now use this URL in your signature template.`)},F.readAsDataURL(A)}catch(F){console.error("Logo upload failed:",F),alert("Failed to upload logo. Please try again.")}finally{o(!1),c.current&&(c.current.value="")}}};return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(rr,{className:"w-7 h-7"}),"Email Settings"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure email signature template for all staff members"})]}),y?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading settings..."})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(gi,{className:"w-5 h-5"}),"Signature Builder"]}),s.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsxs("h3",{className:"text-sm font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[s.jsx(Cc,{className:"w-4 h-4"}),"Company Logo"]}),s.jsx("p",{className:"text-xs text-blue-800 mb-3",children:"Upload your logo - it will be hosted on Cloudflare and automatically included in your signature."}),s.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:w,className:"hidden"}),s.jsxs("button",{onClick:()=>{var N;return(N=c.current)==null?void 0:N.click()},disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[s.jsx(_b,{className:"w-4 h-4"}),l?"Uploading...":a?"Change Logo":"Upload Logo"]}),a&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsx("img",{src:a,alt:"Logo",className:"w-16 h-16 object-contain border border-gray-300 rounded bg-white p-1"}),s.jsx("p",{className:"text-xs text-green-700",children:" Logo uploaded"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[s.jsx(pb,{className:"w-4 h-4"}),"Company Name"]}),s.jsx("input",{type:"text",value:d,onChange:N=>m(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Amazing Transfers"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[s.jsx(rr,{className:"w-4 h-4"}),"Email Address"]}),s.jsx("input",{type:"email",value:h,onChange:N=>f(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., info@amazingtransfers.com.au"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[s.jsx(Uh,{className:"w-4 h-4"}),"Website"]}),s.jsx("input",{type:"text",value:j,onChange:N=>x(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., amazingtransfers.com"})]}),s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-xs text-blue-700",children:[s.jsx("strong",{children:"Note:"})," Staff names and job titles are automatically pulled from their profile settings."]})})]}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("button",{onClick:v,disabled:p.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[s.jsx(Xl,{className:"w-5 h-5"}),p.isPending?"Saving...":"Save Signature"]}),p.isSuccess&&s.jsx("p",{className:"text-sm text-green-600 mt-2 text-center",children:" Signature saved successfully!"}),p.isError&&s.jsx("p",{className:"text-sm text-red-600 mt-2 text-center",children:" Failed to save signature."})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(w3,{className:"w-5 h-5"}),"Preview (Your Signature)"]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["This is how the signature will appear for ",s.jsxs("strong",{children:[t==null?void 0:t.firstName," ",t==null?void 0:t.lastName]})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:s.jsx("div",{dangerouslySetInnerHTML:{__html:r},className:"prose prose-sm max-w-none"})}),s.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:" How it works:"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:" Upload your company logo (stored on Cloudflare)"}),s.jsx("li",{children:" Set your company name, email, and website"}),s.jsx("li",{children:" Staff names and job titles are pulled from their profiles automatically"}),s.jsx("li",{children:" Signatures are auto-appended to all email ticket replies"}),s.jsx("li",{children:" Each staff member gets a personalized signature"})]})]})]})]})]})}function zC(){const{user:e}=us(),{data:t,isLoading:r}=me({queryKey:["my-tasks"],queryFn:async()=>(await I.get("/api/tickets",{params:{channel:"task",assigned_to:e==null?void 0:e.id,limit:100}})).data.tickets,refetchInterval:3e4}),{data:n}=me({queryKey:["all-tasks"],queryFn:async()=>(await I.get("/api/tickets",{params:{channel:"task",limit:1e3}})).data.tickets,refetchInterval:3e4}),a=new Date,i=(t==null?void 0:t.filter(f=>f.status!=="completed"&&f.status!=="cancelled"))||[],l=i.filter(f=>f.sla_due_at&&new Date(f.sla_due_at)<a),o=i.filter(f=>{if(!f.sla_due_at)return!1;const j=new Date(f.sla_due_at),x=new Date(a.getTime()+24*60*60*1e3);return j>a&&j<=x}),c=(n==null?void 0:n.filter(f=>f.status!=="completed"&&f.status!=="cancelled"&&f.sla_due_at&&new Date(f.sla_due_at)<a))||[],d=f=>{const j=f.match(/^([A-Z]+)-?(\d+)-(\d+)$/);if(j){const p=j[1],v=parseInt(j[2],10),w=parseInt(j[3],10);return`${p}-${v}-${w}`}const x=f.match(/^([A-Z]+)-?/),g=f.match(/\d+/);if(!g)return f;const y=x?x[1]:"TSK",b=parseInt(g[0],10);return`${y}-${b}`},m=f=>{switch(f){case"critical":return"bg-red-100 text-red-800 ring-red-600/20";case"high":return"bg-orange-100 text-orange-800 ring-orange-600/20";case"normal":return"bg-blue-100 text-blue-800 ring-blue-600/20";case"low":return"bg-gray-100 text-gray-800 ring-gray-600/20";default:return"bg-gray-100 text-gray-800 ring-gray-600/20"}},h=f=>{switch(f){case"completed":return"bg-green-100 text-green-800";case"in-progress":return"bg-blue-100 text-blue-800";case"open":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(gr,{className:"w-6 h-6 text-amber-600"}),"Task Digest"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Your daily task overview and deadlines"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-amber-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"My Open Tasks"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length})]}),s.jsx(gr,{className:"w-8 h-8 text-amber-500"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-red-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"My Overdue"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:l.length})]}),s.jsx(oa,{className:"w-8 h-8 text-red-500"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-orange-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Due in 24h"}),s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o.length})]}),s.jsx(Ys,{className:"w-8 h-8 text-orange-500"})]})})]}),l.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-semibold text-red-600 flex items-center gap-2",children:[s.jsx(oa,{className:"w-5 h-5"}),"My Overdue Tasks (",l.length,")"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:l.map(f=>s.jsx(Ye,{to:`/tickets?search=${f.ticket_number}`,className:"block px-6 py-4 hover:bg-gray-50 transition-colors",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-amber-600",children:d(f.ticket_number)}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${h(f.status)}`,children:f.status}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ring-1 ring-inset ${m(f.priority)}`,children:f.priority})]}),s.jsx("p",{className:"text-sm text-gray-900 mb-1",children:f.subject}),f.sla_due_at&&s.jsxs("p",{className:"text-xs text-red-600 flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3"}),"Overdue by ",ys(new Date(f.sla_due_at))]})]})})},f.ticket_id))})]}),o.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-semibold text-orange-600 flex items-center gap-2",children:[s.jsx(Ys,{className:"w-5 h-5"}),"Due in Next 24 Hours (",o.length,")"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:o.map(f=>s.jsx(Ye,{to:`/tickets?search=${f.ticket_number}`,className:"block px-6 py-4 hover:bg-gray-50 transition-colors",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-amber-600",children:d(f.ticket_number)}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${h(f.status)}`,children:f.status}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ring-1 ring-inset ${m(f.priority)}`,children:f.priority})]}),s.jsx("p",{className:"text-sm text-gray-900 mb-1",children:f.subject}),f.sla_due_at&&s.jsxs("p",{className:"text-xs text-orange-600 flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3"}),"Due ",ys(new Date(f.sla_due_at),{addSuffix:!0})]})]})})},f.ticket_id))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(gr,{className:"w-5 h-5 text-amber-600"}),"All My Open Tasks (",i.length,")"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:r?s.jsx("div",{className:"px-6 py-8 text-center text-gray-500",children:"Loading..."}):i.length===0?s.jsxs("div",{className:"px-6 py-8 text-center text-gray-500 flex flex-col items-center gap-2",children:[s.jsx(lt,{className:"w-12 h-12 text-green-500"}),s.jsx("p",{children:"No open tasks! Great job!"})]}):i.map(f=>s.jsx(Ye,{to:`/tickets?search=${f.ticket_number}`,className:"block px-6 py-4 hover:bg-gray-50 transition-colors",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-amber-600",children:d(f.ticket_number)}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${h(f.status)}`,children:f.status}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ring-1 ring-inset ${m(f.priority)}`,children:f.priority})]}),s.jsx("p",{className:"text-sm text-gray-900 mb-1",children:f.subject}),f.sla_due_at&&s.jsxs("p",{className:"text-xs text-gray-600 flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3"}),"Due ",ys(new Date(f.sla_due_at),{addSuffix:!0})]})]})})},f.ticket_id))})]}),c.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow mt-6",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(oa,{className:"w-5 h-5 text-red-500"}),"Team Overdue Tasks (",c.length,")"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:c.slice(0,10).map(f=>s.jsx(Ye,{to:`/tickets?search=${f.ticket_number}`,className:"block px-6 py-4 hover:bg-gray-50 transition-colors",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-amber-600",children:d(f.ticket_number)}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${h(f.status)}`,children:f.status}),s.jsx("span",{className:`px-2 py-0.5 text-xs rounded ring-1 ring-inset ${m(f.priority)}`,children:f.priority})]}),s.jsx("p",{className:"text-sm text-gray-900 mb-1",children:f.subject}),f.sla_due_at&&s.jsxs("p",{className:"text-xs text-red-600 flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3"}),"Overdue by ",ys(new Date(f.sla_due_at))]})]})})},f.ticket_id))})]})]})})}function UC({children:e}){const{token:t}=us();return t?s.jsx(s.Fragment,{children:e}):s.jsx(gy,{to:"/login",replace:!0})}function HC(){return s.jsx(tw,{children:s.jsxs(Q1,{children:[s.jsx(Ze,{path:"/login",element:s.jsx(bk,{})}),s.jsxs(Ze,{path:"/",element:s.jsx(UC,{children:s.jsx(e6,{})}),children:[s.jsx(Ze,{index:!0,element:s.jsx(gy,{to:"/tickets",replace:!0})}),s.jsx(Ze,{path:"tickets",element:s.jsx(J6,{})}),s.jsx(Ze,{path:"tickets/:id",element:s.jsx(lC,{})}),s.jsx(Ze,{path:"mentions",element:s.jsx(oC,{})}),s.jsx(Ze,{path:"memo",element:s.jsx(cC,{})}),s.jsx(Ze,{path:"tags",element:s.jsx(IC,{})}),s.jsx(Ze,{path:"task-digest",element:s.jsx(zC,{})}),s.jsx(Ze,{path:"analytics/ai-agent",element:s.jsx(dC,{})}),s.jsx(Ze,{path:"settings",element:s.jsx(AC,{})}),s.jsx(Ze,{path:"settings/tags",element:s.jsx(OC,{})}),s.jsx(Ze,{path:"settings/email",element:s.jsx(DC,{})}),s.jsx(Ze,{path:"settings/business-hours",element:s.jsx(mC,{})}),s.jsx(Ze,{path:"settings/chat-widget",element:s.jsx(hC,{})}),s.jsx(Ze,{path:"settings/chat-embed",element:s.jsx(jC,{})}),s.jsx(Ze,{path:"ai-agent/widget",element:s.jsx(wC,{})}),s.jsx(Ze,{path:"ai-agent/knowledge",element:s.jsx(kC,{})}),s.jsx(Ze,{path:"ai-agent/system-message",element:s.jsx(SC,{})}),s.jsx(Ze,{path:"ai-agent/regional-overrides",element:s.jsx(EC,{})}),s.jsx(Ze,{path:"settings/dartmouth-os",element:s.jsx(_C,{})}),s.jsx(Ze,{path:"settings/auto-assignment",element:s.jsx(MC,{})}),s.jsx(Ze,{path:"staff",element:s.jsx(xC,{})}),s.jsx(Ze,{path:"staff/performance",element:s.jsx(fC,{})}),s.jsx(Ze,{path:"chat",element:s.jsx(gC,{})}),s.jsx(Ze,{path:"chat-ticket/:id",element:s.jsx(vC,{})}),s.jsx(Ze,{path:"group-chat",element:s.jsx(LC,{})}),s.jsx(Ze,{path:"settings/group-chat",element:s.jsx(FC,{})}),s.jsx(Ze,{path:"integrations",element:s.jsx(PC,{})}),s.jsx(Ze,{path:"settings/integrations/shopify",element:s.jsx($C,{})}),s.jsx(Ze,{path:"account",element:s.jsx(RC,{})})]})]})})}const BC=new zj({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});Zd.createRoot(document.getElementById("root")).render(s.jsx(Le.StrictMode,{children:s.jsx(Uj,{client:BC,children:s.jsx(HC,{})})}));
