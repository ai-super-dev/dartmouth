var Qh=e=>{throw TypeError(e)};var id=(e,t,r)=>t.has(e)||Qh("Cannot "+r);var C=(e,t,r)=>(id(e,t,"read from private field"),r?r.call(e):t.get(e)),Se=(e,t,r)=>t.has(e)?Qh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ce=(e,t,r,n)=>(id(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Ue=(e,t,r)=>(id(e,t,"access private method"),r);var eo=(e,t,r,n)=>({set _(a){ce(e,t,a,r)},get _(){return C(e,t,n)}});function Wb(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function Pg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $g={exports:{}},_c={},Lg={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Il=Symbol.for("react.element"),Kb=Symbol.for("react.portal"),Qb=Symbol.for("react.fragment"),Vb=Symbol.for("react.strict_mode"),Gb=Symbol.for("react.profiler"),Yb=Symbol.for("react.provider"),Jb=Symbol.for("react.context"),Xb=Symbol.for("react.forward_ref"),Zb=Symbol.for("react.suspense"),ev=Symbol.for("react.memo"),tv=Symbol.for("react.lazy"),Vh=Symbol.iterator;function sv(e){return e===null||typeof e!="object"?null:(e=Vh&&e[Vh]||e["@@iterator"],typeof e=="function"?e:null)}var Fg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ig=Object.assign,Og={};function xi(e,t,r){this.props=e,this.context=t,this.refs=Og,this.updater=r||Fg}xi.prototype.isReactComponent={};xi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};xi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Dg(){}Dg.prototype=xi.prototype;function Sm(e,t,r){this.props=e,this.context=t,this.refs=Og,this.updater=r||Fg}var Cm=Sm.prototype=new Dg;Cm.constructor=Sm;Ig(Cm,xi.prototype);Cm.isPureReactComponent=!0;var Gh=Array.isArray,zg=Object.prototype.hasOwnProperty,_m={current:null},Ug={key:!0,ref:!0,__self:!0,__source:!0};function Hg(e,t,r){var n,a={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)zg.call(t,n)&&!Ug.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Il,type:e,key:i,ref:l,props:a,_owner:_m.current}}function rv(e,t){return{$$typeof:Il,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Em(e){return typeof e=="object"&&e!==null&&e.$$typeof===Il}function nv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Yh=/\/+/g;function ld(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nv(""+e.key):t.toString(36)}function Eo(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Il:case Kb:l=!0}}if(l)return l=e,a=a(l),e=n===""?"."+ld(l,0):n,Gh(a)?(r="",e!=null&&(r=e.replace(Yh,"$&/")+"/"),Eo(a,t,r,"",function(d){return d})):a!=null&&(Em(a)&&(a=rv(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(Yh,"$&/")+"/")+e)),t.push(a)),1;if(l=0,n=n===""?".":n+":",Gh(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+ld(i,o);l+=Eo(i,t,r,c,a)}else if(c=sv(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+ld(i,o++),l+=Eo(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function to(e,t,r){if(e==null)return e;var n=[],a=0;return Eo(e,n,"","",function(i){return t.call(r,i,a++)}),n}function av(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var cs={current:null},Mo={transition:null},iv={ReactCurrentDispatcher:cs,ReactCurrentBatchConfig:Mo,ReactCurrentOwner:_m};function Bg(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:to,forEach:function(e,t,r){to(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return to(e,function(){t++}),t},toArray:function(e){return to(e,function(t){return t})||[]},only:function(e){if(!Em(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=xi;qe.Fragment=Qb;qe.Profiler=Gb;qe.PureComponent=Sm;qe.StrictMode=Vb;qe.Suspense=Zb;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iv;qe.act=Bg;qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ig({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=_m.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)zg.call(t,c)&&!Ug.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:Il,type:e.type,key:a,ref:i,props:n,_owner:l}};qe.createContext=function(e){return e={$$typeof:Jb,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Yb,_context:e},e.Consumer=e};qe.createElement=Hg;qe.createFactory=function(e){var t=Hg.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:Xb,render:e}};qe.isValidElement=Em;qe.lazy=function(e){return{$$typeof:tv,_payload:{_status:-1,_result:e},_init:av}};qe.memo=function(e,t){return{$$typeof:ev,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=Mo.transition;Mo.transition={};try{e()}finally{Mo.transition=t}};qe.unstable_act=Bg;qe.useCallback=function(e,t){return cs.current.useCallback(e,t)};qe.useContext=function(e){return cs.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return cs.current.useDeferredValue(e)};qe.useEffect=function(e,t){return cs.current.useEffect(e,t)};qe.useId=function(){return cs.current.useId()};qe.useImperativeHandle=function(e,t,r){return cs.current.useImperativeHandle(e,t,r)};qe.useInsertionEffect=function(e,t){return cs.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return cs.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return cs.current.useMemo(e,t)};qe.useReducer=function(e,t,r){return cs.current.useReducer(e,t,r)};qe.useRef=function(e){return cs.current.useRef(e)};qe.useState=function(e){return cs.current.useState(e)};qe.useSyncExternalStore=function(e,t,r){return cs.current.useSyncExternalStore(e,t,r)};qe.useTransition=function(){return cs.current.useTransition()};qe.version="18.3.1";Lg.exports=qe;var u=Lg.exports;const Le=Pg(u),ti=Wb({__proto__:null,default:Le},[u]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv=u,ov=Symbol.for("react.element"),cv=Symbol.for("react.fragment"),dv=Object.prototype.hasOwnProperty,uv=lv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mv={key:!0,ref:!0,__self:!0,__source:!0};function qg(e,t,r){var n,a={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)dv.call(t,n)&&!mv.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:ov,type:e,key:i,ref:l,props:a,_owner:uv.current}}_c.Fragment=cv;_c.jsx=qg;_c.jsxs=qg;$g.exports=_c;var s=$g.exports,Zd={},Wg={exports:{}},Ms={},Kg={exports:{}},Qg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,Y){var G=T.length;T.push(Y);e:for(;0<G;){var X=G-1>>>1,ie=T[X];if(0<a(ie,Y))T[X]=Y,T[G]=ie,G=X;else break e}}function r(T){return T.length===0?null:T[0]}function n(T){if(T.length===0)return null;var Y=T[0],G=T.pop();if(G!==Y){T[0]=G;e:for(var X=0,ie=T.length,se=ie>>>1;X<se;){var xe=2*(X+1)-1,$e=T[xe],P=xe+1,ae=T[P];if(0>a($e,G))P<ie&&0>a(ae,$e)?(T[X]=ae,T[P]=G,X=P):(T[X]=$e,T[xe]=G,X=xe);else if(P<ie&&0>a(ae,G))T[X]=ae,T[P]=G,X=P;else break e}}return Y}function a(T,Y){var G=T.sortIndex-Y.sortIndex;return G!==0?G:T.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],d=[],m=1,h=null,p=3,j=!1,f=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(T){for(var Y=r(d);Y!==null;){if(Y.callback===null)n(d);else if(Y.startTime<=T)n(d),Y.sortIndex=Y.expirationTime,t(c,Y);else break;Y=r(d)}}function w(T){if(g=!1,v(T),!f)if(r(c)!==null)f=!0,we(N);else{var Y=r(d);Y!==null&&H(w,Y.startTime-T)}}function N(T,Y){f=!1,g&&(g=!1,b(R),R=-1),j=!0;var G=p;try{for(v(Y),h=r(c);h!==null&&(!(h.expirationTime>Y)||T&&!K());){var X=h.callback;if(typeof X=="function"){h.callback=null,p=h.priorityLevel;var ie=X(h.expirationTime<=Y);Y=e.unstable_now(),typeof ie=="function"?h.callback=ie:h===r(c)&&n(c),v(Y)}else n(c);h=r(c)}if(h!==null)var se=!0;else{var xe=r(d);xe!==null&&H(w,xe.startTime-Y),se=!1}return se}finally{h=null,p=G,j=!1}}var _=!1,F=null,R=-1,J=5,q=-1;function K(){return!(e.unstable_now()-q<J)}function ne(){if(F!==null){var T=e.unstable_now();q=T;var Y=!0;try{Y=F(!0,T)}finally{Y?re():(_=!1,F=null)}}else _=!1}var re;if(typeof x=="function")re=function(){x(ne)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,ke=pe.port2;pe.port1.onmessage=ne,re=function(){ke.postMessage(null)}}else re=function(){y(ne,0)};function we(T){F=T,_||(_=!0,re())}function H(T,Y){R=y(function(){T(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){f||j||(f=!0,we(N))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(T){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var G=p;p=Y;try{return T()}finally{p=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,Y){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var G=p;p=T;try{return Y()}finally{p=G}},e.unstable_scheduleCallback=function(T,Y,G){var X=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?X+G:X):G=X,T){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=G+ie,T={id:m++,callback:Y,priorityLevel:T,startTime:G,expirationTime:ie,sortIndex:-1},G>X?(T.sortIndex=G,t(d,T),r(c)===null&&T===r(d)&&(g?(b(R),R=-1):g=!0,H(w,G-X))):(T.sortIndex=ie,t(c,T),f||j||(f=!0,we(N))),T},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(T){var Y=p;return function(){var G=p;p=Y;try{return T.apply(this,arguments)}finally{p=G}}}})(Qg);Kg.exports=Qg;var hv=Kg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fv=u,Es=hv;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vg=new Set,cl={};function fa(e,t){si(e,t),si(e+"Capture",t)}function si(e,t){for(cl[e]=t,e=0;e<t.length;e++)Vg.add(t[e])}var Ir=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eu=Object.prototype.hasOwnProperty,gv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jh={},Xh={};function xv(e){return eu.call(Xh,e)?!0:eu.call(Jh,e)?!1:gv.test(e)?Xh[e]=!0:(Jh[e]=!0,!1)}function pv(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function yv(e,t,r,n){if(t===null||typeof t>"u"||pv(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ds(e,t,r,n,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var Qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Qt[e]=new ds(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Qt[t]=new ds(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Qt[e]=new ds(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Qt[e]=new ds(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Qt[e]=new ds(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Qt[e]=new ds(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Qt[e]=new ds(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Qt[e]=new ds(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Qt[e]=new ds(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mm=/[\-:]([a-z])/g;function Tm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Mm,Tm);Qt[t]=new ds(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Mm,Tm);Qt[t]=new ds(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Mm,Tm);Qt[t]=new ds(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Qt[e]=new ds(e,1,!1,e.toLowerCase(),null,!1,!1)});Qt.xlinkHref=new ds("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Qt[e]=new ds(e,1,!1,e.toLowerCase(),null,!0,!0)});function Am(e,t,r,n){var a=Qt.hasOwnProperty(t)?Qt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(yv(t,r,a,n)&&(r=null),n||a===null?xv(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Hr=fv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,so=Symbol.for("react.element"),ka=Symbol.for("react.portal"),Sa=Symbol.for("react.fragment"),Rm=Symbol.for("react.strict_mode"),tu=Symbol.for("react.profiler"),Gg=Symbol.for("react.provider"),Yg=Symbol.for("react.context"),Pm=Symbol.for("react.forward_ref"),su=Symbol.for("react.suspense"),ru=Symbol.for("react.suspense_list"),$m=Symbol.for("react.memo"),Jr=Symbol.for("react.lazy"),Jg=Symbol.for("react.offscreen"),Zh=Symbol.iterator;function _i(e){return e===null||typeof e!="object"?null:(e=Zh&&e[Zh]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,od;function Hi(e){if(od===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);od=t&&t[1]||""}return`
`+od+e}var cd=!1;function dd(e,t){if(!e||cd)return"";cd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{cd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Hi(e):""}function bv(e){switch(e.tag){case 5:return Hi(e.type);case 16:return Hi("Lazy");case 13:return Hi("Suspense");case 19:return Hi("SuspenseList");case 0:case 2:case 15:return e=dd(e.type,!1),e;case 11:return e=dd(e.type.render,!1),e;case 1:return e=dd(e.type,!0),e;default:return""}}function nu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Sa:return"Fragment";case ka:return"Portal";case tu:return"Profiler";case Rm:return"StrictMode";case su:return"Suspense";case ru:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Yg:return(e.displayName||"Context")+".Consumer";case Gg:return(e._context.displayName||"Context")+".Provider";case Pm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $m:return t=e.displayName||null,t!==null?t:nu(e.type)||"Memo";case Jr:t=e._payload,e=e._init;try{return nu(e(t))}catch{}}return null}function vv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nu(t);case 8:return t===Rm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function En(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Xg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jv(e){var t=Xg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ro(e){e._valueTracker||(e._valueTracker=jv(e))}function Zg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Xg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Qo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function au(e,t){var r=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function e0(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=En(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ex(e,t){t=t.checked,t!=null&&Am(e,"checked",t,!1)}function iu(e,t){ex(e,t);var r=En(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lu(e,t.type,r):t.hasOwnProperty("defaultValue")&&lu(e,t.type,En(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function t0(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function lu(e,t,r){(t!=="number"||Qo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Bi=Array.isArray;function Ia(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+En(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ou(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function s0(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Z(92));if(Bi(r)){if(1<r.length)throw Error(Z(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:En(r)}}function tx(e,t){var r=En(t.value),n=En(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function r0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var no,rx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(no=no||document.createElement("div"),no.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=no.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function dl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ji={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wv=["Webkit","ms","Moz","O"];Object.keys(Ji).forEach(function(e){wv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ji[t]=Ji[e]})});function nx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ji.hasOwnProperty(e)&&Ji[e]?(""+t).trim():t+"px"}function ax(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=nx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Nv=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function du(e,t){if(t){if(Nv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function uu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mu=null;function Lm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hu=null,Oa=null,Da=null;function n0(e){if(e=zl(e)){if(typeof hu!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=Rc(t),hu(e.stateNode,e.type,t))}}function ix(e){Oa?Da?Da.push(e):Da=[e]:Oa=e}function lx(){if(Oa){var e=Oa,t=Da;if(Da=Oa=null,n0(e),t)for(e=0;e<t.length;e++)n0(t[e])}}function ox(e,t){return e(t)}function cx(){}var ud=!1;function dx(e,t,r){if(ud)return e(t,r);ud=!0;try{return ox(e,t,r)}finally{ud=!1,(Oa!==null||Da!==null)&&(cx(),lx())}}function ul(e,t){var r=e.stateNode;if(r===null)return null;var n=Rc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Z(231,t,typeof r));return r}var fu=!1;if(Ir)try{var Ei={};Object.defineProperty(Ei,"passive",{get:function(){fu=!0}}),window.addEventListener("test",Ei,Ei),window.removeEventListener("test",Ei,Ei)}catch{fu=!1}function kv(e,t,r,n,a,i,l,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(m){this.onError(m)}}var Xi=!1,Vo=null,Go=!1,gu=null,Sv={onError:function(e){Xi=!0,Vo=e}};function Cv(e,t,r,n,a,i,l,o,c){Xi=!1,Vo=null,kv.apply(Sv,arguments)}function _v(e,t,r,n,a,i,l,o,c){if(Cv.apply(this,arguments),Xi){if(Xi){var d=Vo;Xi=!1,Vo=null}else throw Error(Z(198));Go||(Go=!0,gu=d)}}function ga(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function ux(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function a0(e){if(ga(e)!==e)throw Error(Z(188))}function Ev(e){var t=e.alternate;if(!t){if(t=ga(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return a0(a),e;if(i===n)return a0(a),t;i=i.sibling}throw Error(Z(188))}if(r.return!==n.return)r=a,n=i;else{for(var l=!1,o=a.child;o;){if(o===r){l=!0,r=a,n=i;break}if(o===n){l=!0,n=a,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=a;break}if(o===n){l=!0,n=i,r=a;break}o=o.sibling}if(!l)throw Error(Z(189))}}if(r.alternate!==n)throw Error(Z(190))}if(r.tag!==3)throw Error(Z(188));return r.stateNode.current===r?e:t}function mx(e){return e=Ev(e),e!==null?hx(e):null}function hx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hx(e);if(t!==null)return t;e=e.sibling}return null}var fx=Es.unstable_scheduleCallback,i0=Es.unstable_cancelCallback,Mv=Es.unstable_shouldYield,Tv=Es.unstable_requestPaint,jt=Es.unstable_now,Av=Es.unstable_getCurrentPriorityLevel,Fm=Es.unstable_ImmediatePriority,gx=Es.unstable_UserBlockingPriority,Yo=Es.unstable_NormalPriority,Rv=Es.unstable_LowPriority,xx=Es.unstable_IdlePriority,Ec=null,fr=null;function Pv(e){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(Ec,e,void 0,(e.current.flags&128)===128)}catch{}}var Ys=Math.clz32?Math.clz32:Fv,$v=Math.log,Lv=Math.LN2;function Fv(e){return e>>>=0,e===0?32:31-($v(e)/Lv|0)|0}var ao=64,io=4194304;function qi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Jo(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~a;o!==0?n=qi(o):(i&=l,i!==0&&(n=qi(i)))}else l=r&~a,l!==0?n=qi(l):i!==0&&(n=qi(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ys(t),a=1<<r,n|=e[r],t&=~a;return n}function Iv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ov(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Ys(i),o=1<<l,c=a[l];c===-1?(!(o&r)||o&n)&&(a[l]=Iv(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function xu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function px(){var e=ao;return ao<<=1,!(ao&4194240)&&(ao=64),e}function md(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ol(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ys(t),e[t]=r}function Dv(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Ys(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Im(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ys(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var st=0;function yx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bx,Om,vx,jx,wx,pu=!1,lo=[],pn=null,yn=null,bn=null,ml=new Map,hl=new Map,Zr=[],zv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function l0(e,t){switch(e){case"focusin":case"focusout":pn=null;break;case"dragenter":case"dragleave":yn=null;break;case"mouseover":case"mouseout":bn=null;break;case"pointerover":case"pointerout":ml.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":hl.delete(t.pointerId)}}function Mi(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=zl(t),t!==null&&Om(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Uv(e,t,r,n,a){switch(t){case"focusin":return pn=Mi(pn,e,t,r,n,a),!0;case"dragenter":return yn=Mi(yn,e,t,r,n,a),!0;case"mouseover":return bn=Mi(bn,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return ml.set(i,Mi(ml.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,hl.set(i,Mi(hl.get(i)||null,e,t,r,n,a)),!0}return!1}function Nx(e){var t=Hn(e.target);if(t!==null){var r=ga(t);if(r!==null){if(t=r.tag,t===13){if(t=ux(r),t!==null){e.blockedOn=t,wx(e.priority,function(){vx(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function To(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=yu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);mu=n,r.target.dispatchEvent(n),mu=null}else return t=zl(r),t!==null&&Om(t),e.blockedOn=r,!1;t.shift()}return!0}function o0(e,t,r){To(e)&&r.delete(t)}function Hv(){pu=!1,pn!==null&&To(pn)&&(pn=null),yn!==null&&To(yn)&&(yn=null),bn!==null&&To(bn)&&(bn=null),ml.forEach(o0),hl.forEach(o0)}function Ti(e,t){e.blockedOn===t&&(e.blockedOn=null,pu||(pu=!0,Es.unstable_scheduleCallback(Es.unstable_NormalPriority,Hv)))}function fl(e){function t(a){return Ti(a,e)}if(0<lo.length){Ti(lo[0],e);for(var r=1;r<lo.length;r++){var n=lo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(pn!==null&&Ti(pn,e),yn!==null&&Ti(yn,e),bn!==null&&Ti(bn,e),ml.forEach(t),hl.forEach(t),r=0;r<Zr.length;r++)n=Zr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Zr.length&&(r=Zr[0],r.blockedOn===null);)Nx(r),r.blockedOn===null&&Zr.shift()}var za=Hr.ReactCurrentBatchConfig,Xo=!0;function Bv(e,t,r,n){var a=st,i=za.transition;za.transition=null;try{st=1,Dm(e,t,r,n)}finally{st=a,za.transition=i}}function qv(e,t,r,n){var a=st,i=za.transition;za.transition=null;try{st=4,Dm(e,t,r,n)}finally{st=a,za.transition=i}}function Dm(e,t,r,n){if(Xo){var a=yu(e,t,r,n);if(a===null)wd(e,t,n,Zo,r),l0(e,n);else if(Uv(a,e,t,r,n))n.stopPropagation();else if(l0(e,n),t&4&&-1<zv.indexOf(e)){for(;a!==null;){var i=zl(a);if(i!==null&&bx(i),i=yu(e,t,r,n),i===null&&wd(e,t,n,Zo,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else wd(e,t,n,null,r)}}var Zo=null;function yu(e,t,r,n){if(Zo=null,e=Lm(n),e=Hn(e),e!==null)if(t=ga(e),t===null)e=null;else if(r=t.tag,r===13){if(e=ux(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zo=e,null}function kx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Av()){case Fm:return 1;case gx:return 4;case Yo:case Rv:return 16;case xx:return 536870912;default:return 16}default:return 16}}var mn=null,zm=null,Ao=null;function Sx(){if(Ao)return Ao;var e,t=zm,r=t.length,n,a="value"in mn?mn.value:mn.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===a[i-n];n++);return Ao=a.slice(e,1<n?1-n:void 0)}function Ro(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function oo(){return!0}function c0(){return!1}function Ts(e){function t(r,n,a,i,l){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?oo:c0,this.isPropagationStopped=c0,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=oo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=oo)},persist:function(){},isPersistent:oo}),t}var pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Um=Ts(pi),Dl=pt({},pi,{view:0,detail:0}),Wv=Ts(Dl),hd,fd,Ai,Mc=pt({},Dl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ai&&(Ai&&e.type==="mousemove"?(hd=e.screenX-Ai.screenX,fd=e.screenY-Ai.screenY):fd=hd=0,Ai=e),hd)},movementY:function(e){return"movementY"in e?e.movementY:fd}}),d0=Ts(Mc),Kv=pt({},Mc,{dataTransfer:0}),Qv=Ts(Kv),Vv=pt({},Dl,{relatedTarget:0}),gd=Ts(Vv),Gv=pt({},pi,{animationName:0,elapsedTime:0,pseudoElement:0}),Yv=Ts(Gv),Jv=pt({},pi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xv=Ts(Jv),Zv=pt({},pi,{data:0}),u0=Ts(Zv),e2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},t2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},s2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=s2[e])?!!t[e]:!1}function Hm(){return r2}var n2=pt({},Dl,{key:function(e){if(e.key){var t=e2[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ro(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?t2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hm,charCode:function(e){return e.type==="keypress"?Ro(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ro(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),a2=Ts(n2),i2=pt({},Mc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),m0=Ts(i2),l2=pt({},Dl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hm}),o2=Ts(l2),c2=pt({},pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),d2=Ts(c2),u2=pt({},Mc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),m2=Ts(u2),h2=[9,13,27,32],Bm=Ir&&"CompositionEvent"in window,Zi=null;Ir&&"documentMode"in document&&(Zi=document.documentMode);var f2=Ir&&"TextEvent"in window&&!Zi,Cx=Ir&&(!Bm||Zi&&8<Zi&&11>=Zi),h0=" ",f0=!1;function _x(e,t){switch(e){case"keyup":return h2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ex(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ca=!1;function g2(e,t){switch(e){case"compositionend":return Ex(t);case"keypress":return t.which!==32?null:(f0=!0,h0);case"textInput":return e=t.data,e===h0&&f0?null:e;default:return null}}function x2(e,t){if(Ca)return e==="compositionend"||!Bm&&_x(e,t)?(e=Sx(),Ao=zm=mn=null,Ca=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cx&&t.locale!=="ko"?null:t.data;default:return null}}var p2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!p2[e.type]:t==="textarea"}function Mx(e,t,r,n){ix(n),t=ec(t,"onChange"),0<t.length&&(r=new Um("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var el=null,gl=null;function y2(e){zx(e,0)}function Tc(e){var t=Ma(e);if(Zg(t))return e}function b2(e,t){if(e==="change")return t}var Tx=!1;if(Ir){var xd;if(Ir){var pd="oninput"in document;if(!pd){var x0=document.createElement("div");x0.setAttribute("oninput","return;"),pd=typeof x0.oninput=="function"}xd=pd}else xd=!1;Tx=xd&&(!document.documentMode||9<document.documentMode)}function p0(){el&&(el.detachEvent("onpropertychange",Ax),gl=el=null)}function Ax(e){if(e.propertyName==="value"&&Tc(gl)){var t=[];Mx(t,gl,e,Lm(e)),dx(y2,t)}}function v2(e,t,r){e==="focusin"?(p0(),el=t,gl=r,el.attachEvent("onpropertychange",Ax)):e==="focusout"&&p0()}function j2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Tc(gl)}function w2(e,t){if(e==="click")return Tc(t)}function N2(e,t){if(e==="input"||e==="change")return Tc(t)}function k2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zs=typeof Object.is=="function"?Object.is:k2;function xl(e,t){if(Zs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!eu.call(t,a)||!Zs(e[a],t[a]))return!1}return!0}function y0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function b0(e,t){var r=y0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=y0(r)}}function Rx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Px(){for(var e=window,t=Qo();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Qo(e.document)}return t}function qm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function S2(e){var t=Px(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Rx(r.ownerDocument.documentElement,r)){if(n!==null&&qm(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=b0(r,i);var l=b0(r,n);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var C2=Ir&&"documentMode"in document&&11>=document.documentMode,_a=null,bu=null,tl=null,vu=!1;function v0(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vu||_a==null||_a!==Qo(n)||(n=_a,"selectionStart"in n&&qm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),tl&&xl(tl,n)||(tl=n,n=ec(bu,"onSelect"),0<n.length&&(t=new Um("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=_a)))}function co(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ea={animationend:co("Animation","AnimationEnd"),animationiteration:co("Animation","AnimationIteration"),animationstart:co("Animation","AnimationStart"),transitionend:co("Transition","TransitionEnd")},yd={},$x={};Ir&&($x=document.createElement("div").style,"AnimationEvent"in window||(delete Ea.animationend.animation,delete Ea.animationiteration.animation,delete Ea.animationstart.animation),"TransitionEvent"in window||delete Ea.transitionend.transition);function Ac(e){if(yd[e])return yd[e];if(!Ea[e])return e;var t=Ea[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in $x)return yd[e]=t[r];return e}var Lx=Ac("animationend"),Fx=Ac("animationiteration"),Ix=Ac("animationstart"),Ox=Ac("transitionend"),Dx=new Map,j0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tn(e,t){Dx.set(e,t),fa(t,[e])}for(var bd=0;bd<j0.length;bd++){var vd=j0[bd],_2=vd.toLowerCase(),E2=vd[0].toUpperCase()+vd.slice(1);Tn(_2,"on"+E2)}Tn(Lx,"onAnimationEnd");Tn(Fx,"onAnimationIteration");Tn(Ix,"onAnimationStart");Tn("dblclick","onDoubleClick");Tn("focusin","onFocus");Tn("focusout","onBlur");Tn(Ox,"onTransitionEnd");si("onMouseEnter",["mouseout","mouseover"]);si("onMouseLeave",["mouseout","mouseover"]);si("onPointerEnter",["pointerout","pointerover"]);si("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wi));function w0(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,_v(n,t,void 0,e),e.currentTarget=null}function zx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;w0(a,o,d),i=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;w0(a,o,d),i=c}}}if(Go)throw e=gu,Go=!1,gu=null,e}function ct(e,t){var r=t[Su];r===void 0&&(r=t[Su]=new Set);var n=e+"__bubble";r.has(n)||(Ux(t,e,2,!1),r.add(n))}function jd(e,t,r){var n=0;t&&(n|=4),Ux(r,e,n,t)}var uo="_reactListening"+Math.random().toString(36).slice(2);function pl(e){if(!e[uo]){e[uo]=!0,Vg.forEach(function(r){r!=="selectionchange"&&(M2.has(r)||jd(r,!1,e),jd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[uo]||(t[uo]=!0,jd("selectionchange",!1,t))}}function Ux(e,t,r,n){switch(kx(t)){case 1:var a=Bv;break;case 4:a=qv;break;default:a=Dm}r=a.bind(null,t,r,e),a=void 0,!fu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function wd(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=Hn(o),l===null)return;if(c=l.tag,c===5||c===6){n=i=l;continue e}o=o.parentNode}}n=n.return}dx(function(){var d=i,m=Lm(r),h=[];e:{var p=Dx.get(e);if(p!==void 0){var j=Um,f=e;switch(e){case"keypress":if(Ro(r)===0)break e;case"keydown":case"keyup":j=a2;break;case"focusin":f="focus",j=gd;break;case"focusout":f="blur",j=gd;break;case"beforeblur":case"afterblur":j=gd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=d0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=Qv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=o2;break;case Lx:case Fx:case Ix:j=Yv;break;case Ox:j=d2;break;case"scroll":j=Wv;break;case"wheel":j=m2;break;case"copy":case"cut":case"paste":j=Xv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=m0}var g=(t&4)!==0,y=!g&&e==="scroll",b=g?p!==null?p+"Capture":null:p;g=[];for(var x=d,v;x!==null;){v=x;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,b!==null&&(w=ul(x,b),w!=null&&g.push(yl(x,w,v)))),y)break;x=x.return}0<g.length&&(p=new j(p,f,null,r,m),h.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",p&&r!==mu&&(f=r.relatedTarget||r.fromElement)&&(Hn(f)||f[Or]))break e;if((j||p)&&(p=m.window===m?m:(p=m.ownerDocument)?p.defaultView||p.parentWindow:window,j?(f=r.relatedTarget||r.toElement,j=d,f=f?Hn(f):null,f!==null&&(y=ga(f),f!==y||f.tag!==5&&f.tag!==6)&&(f=null)):(j=null,f=d),j!==f)){if(g=d0,w="onMouseLeave",b="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=m0,w="onPointerLeave",b="onPointerEnter",x="pointer"),y=j==null?p:Ma(j),v=f==null?p:Ma(f),p=new g(w,x+"leave",j,r,m),p.target=y,p.relatedTarget=v,w=null,Hn(m)===d&&(g=new g(b,x+"enter",f,r,m),g.target=v,g.relatedTarget=y,w=g),y=w,j&&f)t:{for(g=j,b=f,x=0,v=g;v;v=ja(v))x++;for(v=0,w=b;w;w=ja(w))v++;for(;0<x-v;)g=ja(g),x--;for(;0<v-x;)b=ja(b),v--;for(;x--;){if(g===b||b!==null&&g===b.alternate)break t;g=ja(g),b=ja(b)}g=null}else g=null;j!==null&&N0(h,p,j,g,!1),f!==null&&y!==null&&N0(h,y,f,g,!0)}}e:{if(p=d?Ma(d):window,j=p.nodeName&&p.nodeName.toLowerCase(),j==="select"||j==="input"&&p.type==="file")var N=b2;else if(g0(p))if(Tx)N=N2;else{N=j2;var _=v2}else(j=p.nodeName)&&j.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=w2);if(N&&(N=N(e,d))){Mx(h,N,r,m);break e}_&&_(e,p,d),e==="focusout"&&(_=p._wrapperState)&&_.controlled&&p.type==="number"&&lu(p,"number",p.value)}switch(_=d?Ma(d):window,e){case"focusin":(g0(_)||_.contentEditable==="true")&&(_a=_,bu=d,tl=null);break;case"focusout":tl=bu=_a=null;break;case"mousedown":vu=!0;break;case"contextmenu":case"mouseup":case"dragend":vu=!1,v0(h,r,m);break;case"selectionchange":if(C2)break;case"keydown":case"keyup":v0(h,r,m)}var F;if(Bm)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Ca?_x(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(Cx&&r.locale!=="ko"&&(Ca||R!=="onCompositionStart"?R==="onCompositionEnd"&&Ca&&(F=Sx()):(mn=m,zm="value"in mn?mn.value:mn.textContent,Ca=!0)),_=ec(d,R),0<_.length&&(R=new u0(R,e,null,r,m),h.push({event:R,listeners:_}),F?R.data=F:(F=Ex(r),F!==null&&(R.data=F)))),(F=f2?g2(e,r):x2(e,r))&&(d=ec(d,"onBeforeInput"),0<d.length&&(m=new u0("onBeforeInput","beforeinput",null,r,m),h.push({event:m,listeners:d}),m.data=F))}zx(h,t)})}function yl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ec(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=ul(e,r),i!=null&&n.unshift(yl(e,i,a)),i=ul(e,t),i!=null&&n.push(yl(e,i,a))),e=e.return}return n}function ja(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function N0(e,t,r,n,a){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,c=o.alternate,d=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&d!==null&&(o=d,a?(c=ul(r,i),c!=null&&l.unshift(yl(r,c,o))):a||(c=ul(r,i),c!=null&&l.push(yl(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var T2=/\r\n?/g,A2=/\u0000|\uFFFD/g;function k0(e){return(typeof e=="string"?e:""+e).replace(T2,`
`).replace(A2,"")}function mo(e,t,r){if(t=k0(t),k0(e)!==t&&r)throw Error(Z(425))}function tc(){}var ju=null,wu=null;function Nu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ku=typeof setTimeout=="function"?setTimeout:void 0,R2=typeof clearTimeout=="function"?clearTimeout:void 0,S0=typeof Promise=="function"?Promise:void 0,P2=typeof queueMicrotask=="function"?queueMicrotask:typeof S0<"u"?function(e){return S0.resolve(null).then(e).catch($2)}:ku;function $2(e){setTimeout(function(){throw e})}function Nd(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),fl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);fl(t)}function vn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function C0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var yi=Math.random().toString(36).slice(2),mr="__reactFiber$"+yi,bl="__reactProps$"+yi,Or="__reactContainer$"+yi,Su="__reactEvents$"+yi,L2="__reactListeners$"+yi,F2="__reactHandles$"+yi;function Hn(e){var t=e[mr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Or]||r[mr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=C0(e);e!==null;){if(r=e[mr])return r;e=C0(e)}return t}e=r,r=e.parentNode}return null}function zl(e){return e=e[mr]||e[Or],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ma(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function Rc(e){return e[bl]||null}var Cu=[],Ta=-1;function An(e){return{current:e}}function ut(e){0>Ta||(e.current=Cu[Ta],Cu[Ta]=null,Ta--)}function it(e,t){Ta++,Cu[Ta]=e.current,e.current=t}var Mn={},es=An(Mn),ps=An(!1),ia=Mn;function ri(e,t){var r=e.type.contextTypes;if(!r)return Mn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ys(e){return e=e.childContextTypes,e!=null}function sc(){ut(ps),ut(es)}function _0(e,t,r){if(es.current!==Mn)throw Error(Z(168));it(es,t),it(ps,r)}function Hx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Z(108,vv(e)||"Unknown",a));return pt({},r,n)}function rc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Mn,ia=es.current,it(es,e),it(ps,ps.current),!0}function E0(e,t,r){var n=e.stateNode;if(!n)throw Error(Z(169));r?(e=Hx(e,t,ia),n.__reactInternalMemoizedMergedChildContext=e,ut(ps),ut(es),it(es,e)):ut(ps),it(ps,r)}var kr=null,Pc=!1,kd=!1;function Bx(e){kr===null?kr=[e]:kr.push(e)}function I2(e){Pc=!0,Bx(e)}function Rn(){if(!kd&&kr!==null){kd=!0;var e=0,t=st;try{var r=kr;for(st=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}kr=null,Pc=!1}catch(a){throw kr!==null&&(kr=kr.slice(e+1)),fx(Fm,Rn),a}finally{st=t,kd=!1}}return null}var Aa=[],Ra=0,nc=null,ac=0,Ls=[],Fs=0,la=null,Tr=1,Ar="";function zn(e,t){Aa[Ra++]=ac,Aa[Ra++]=nc,nc=e,ac=t}function qx(e,t,r){Ls[Fs++]=Tr,Ls[Fs++]=Ar,Ls[Fs++]=la,la=e;var n=Tr;e=Ar;var a=32-Ys(n)-1;n&=~(1<<a),r+=1;var i=32-Ys(t)+a;if(30<i){var l=a-a%5;i=(n&(1<<l)-1).toString(32),n>>=l,a-=l,Tr=1<<32-Ys(t)+a|r<<a|n,Ar=i+e}else Tr=1<<i|r<<a|n,Ar=e}function Wm(e){e.return!==null&&(zn(e,1),qx(e,1,0))}function Km(e){for(;e===nc;)nc=Aa[--Ra],Aa[Ra]=null,ac=Aa[--Ra],Aa[Ra]=null;for(;e===la;)la=Ls[--Fs],Ls[Fs]=null,Ar=Ls[--Fs],Ls[Fs]=null,Tr=Ls[--Fs],Ls[Fs]=null}var _s=null,Cs=null,ht=!1,Vs=null;function Wx(e,t){var r=Is(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function M0(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_s=e,Cs=vn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_s=e,Cs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=la!==null?{id:Tr,overflow:Ar}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Is(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,_s=e,Cs=null,!0):!1;default:return!1}}function _u(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eu(e){if(ht){var t=Cs;if(t){var r=t;if(!M0(e,t)){if(_u(e))throw Error(Z(418));t=vn(r.nextSibling);var n=_s;t&&M0(e,t)?Wx(n,r):(e.flags=e.flags&-4097|2,ht=!1,_s=e)}}else{if(_u(e))throw Error(Z(418));e.flags=e.flags&-4097|2,ht=!1,_s=e}}}function T0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_s=e}function ho(e){if(e!==_s)return!1;if(!ht)return T0(e),ht=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nu(e.type,e.memoizedProps)),t&&(t=Cs)){if(_u(e))throw Kx(),Error(Z(418));for(;t;)Wx(e,t),t=vn(t.nextSibling)}if(T0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Cs=vn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Cs=null}}else Cs=_s?vn(e.stateNode.nextSibling):null;return!0}function Kx(){for(var e=Cs;e;)e=vn(e.nextSibling)}function ni(){Cs=_s=null,ht=!1}function Qm(e){Vs===null?Vs=[e]:Vs.push(e)}var O2=Hr.ReactCurrentBatchConfig;function Ri(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Z(309));var n=r.stateNode}if(!n)throw Error(Z(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(Z(284));if(!r._owner)throw Error(Z(290,e))}return e}function fo(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function A0(e){var t=e._init;return t(e._payload)}function Qx(e){function t(b,x){if(e){var v=b.deletions;v===null?(b.deletions=[x],b.flags|=16):v.push(x)}}function r(b,x){if(!e)return null;for(;x!==null;)t(b,x),x=x.sibling;return null}function n(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function a(b,x){return b=kn(b,x),b.index=0,b.sibling=null,b}function i(b,x,v){return b.index=v,e?(v=b.alternate,v!==null?(v=v.index,v<x?(b.flags|=2,x):v):(b.flags|=2,x)):(b.flags|=1048576,x)}function l(b){return e&&b.alternate===null&&(b.flags|=2),b}function o(b,x,v,w){return x===null||x.tag!==6?(x=Ad(v,b.mode,w),x.return=b,x):(x=a(x,v),x.return=b,x)}function c(b,x,v,w){var N=v.type;return N===Sa?m(b,x,v.props.children,w,v.key):x!==null&&(x.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Jr&&A0(N)===x.type)?(w=a(x,v.props),w.ref=Ri(b,x,v),w.return=b,w):(w=Do(v.type,v.key,v.props,null,b.mode,w),w.ref=Ri(b,x,v),w.return=b,w)}function d(b,x,v,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=Rd(v,b.mode,w),x.return=b,x):(x=a(x,v.children||[]),x.return=b,x)}function m(b,x,v,w,N){return x===null||x.tag!==7?(x=na(v,b.mode,w,N),x.return=b,x):(x=a(x,v),x.return=b,x)}function h(b,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ad(""+x,b.mode,v),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case so:return v=Do(x.type,x.key,x.props,null,b.mode,v),v.ref=Ri(b,null,x),v.return=b,v;case ka:return x=Rd(x,b.mode,v),x.return=b,x;case Jr:var w=x._init;return h(b,w(x._payload),v)}if(Bi(x)||_i(x))return x=na(x,b.mode,v,null),x.return=b,x;fo(b,x)}return null}function p(b,x,v,w){var N=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return N!==null?null:o(b,x,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case so:return v.key===N?c(b,x,v,w):null;case ka:return v.key===N?d(b,x,v,w):null;case Jr:return N=v._init,p(b,x,N(v._payload),w)}if(Bi(v)||_i(v))return N!==null?null:m(b,x,v,w,null);fo(b,v)}return null}function j(b,x,v,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return b=b.get(v)||null,o(x,b,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case so:return b=b.get(w.key===null?v:w.key)||null,c(x,b,w,N);case ka:return b=b.get(w.key===null?v:w.key)||null,d(x,b,w,N);case Jr:var _=w._init;return j(b,x,v,_(w._payload),N)}if(Bi(w)||_i(w))return b=b.get(v)||null,m(x,b,w,N,null);fo(x,w)}return null}function f(b,x,v,w){for(var N=null,_=null,F=x,R=x=0,J=null;F!==null&&R<v.length;R++){F.index>R?(J=F,F=null):J=F.sibling;var q=p(b,F,v[R],w);if(q===null){F===null&&(F=J);break}e&&F&&q.alternate===null&&t(b,F),x=i(q,x,R),_===null?N=q:_.sibling=q,_=q,F=J}if(R===v.length)return r(b,F),ht&&zn(b,R),N;if(F===null){for(;R<v.length;R++)F=h(b,v[R],w),F!==null&&(x=i(F,x,R),_===null?N=F:_.sibling=F,_=F);return ht&&zn(b,R),N}for(F=n(b,F);R<v.length;R++)J=j(F,b,R,v[R],w),J!==null&&(e&&J.alternate!==null&&F.delete(J.key===null?R:J.key),x=i(J,x,R),_===null?N=J:_.sibling=J,_=J);return e&&F.forEach(function(K){return t(b,K)}),ht&&zn(b,R),N}function g(b,x,v,w){var N=_i(v);if(typeof N!="function")throw Error(Z(150));if(v=N.call(v),v==null)throw Error(Z(151));for(var _=N=null,F=x,R=x=0,J=null,q=v.next();F!==null&&!q.done;R++,q=v.next()){F.index>R?(J=F,F=null):J=F.sibling;var K=p(b,F,q.value,w);if(K===null){F===null&&(F=J);break}e&&F&&K.alternate===null&&t(b,F),x=i(K,x,R),_===null?N=K:_.sibling=K,_=K,F=J}if(q.done)return r(b,F),ht&&zn(b,R),N;if(F===null){for(;!q.done;R++,q=v.next())q=h(b,q.value,w),q!==null&&(x=i(q,x,R),_===null?N=q:_.sibling=q,_=q);return ht&&zn(b,R),N}for(F=n(b,F);!q.done;R++,q=v.next())q=j(F,b,R,q.value,w),q!==null&&(e&&q.alternate!==null&&F.delete(q.key===null?R:q.key),x=i(q,x,R),_===null?N=q:_.sibling=q,_=q);return e&&F.forEach(function(ne){return t(b,ne)}),ht&&zn(b,R),N}function y(b,x,v,w){if(typeof v=="object"&&v!==null&&v.type===Sa&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case so:e:{for(var N=v.key,_=x;_!==null;){if(_.key===N){if(N=v.type,N===Sa){if(_.tag===7){r(b,_.sibling),x=a(_,v.props.children),x.return=b,b=x;break e}}else if(_.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Jr&&A0(N)===_.type){r(b,_.sibling),x=a(_,v.props),x.ref=Ri(b,_,v),x.return=b,b=x;break e}r(b,_);break}else t(b,_);_=_.sibling}v.type===Sa?(x=na(v.props.children,b.mode,w,v.key),x.return=b,b=x):(w=Do(v.type,v.key,v.props,null,b.mode,w),w.ref=Ri(b,x,v),w.return=b,b=w)}return l(b);case ka:e:{for(_=v.key;x!==null;){if(x.key===_)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){r(b,x.sibling),x=a(x,v.children||[]),x.return=b,b=x;break e}else{r(b,x);break}else t(b,x);x=x.sibling}x=Rd(v,b.mode,w),x.return=b,b=x}return l(b);case Jr:return _=v._init,y(b,x,_(v._payload),w)}if(Bi(v))return f(b,x,v,w);if(_i(v))return g(b,x,v,w);fo(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(r(b,x.sibling),x=a(x,v),x.return=b,b=x):(r(b,x),x=Ad(v,b.mode,w),x.return=b,b=x),l(b)):r(b,x)}return y}var ai=Qx(!0),Vx=Qx(!1),ic=An(null),lc=null,Pa=null,Vm=null;function Gm(){Vm=Pa=lc=null}function Ym(e){var t=ic.current;ut(ic),e._currentValue=t}function Mu(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ua(e,t){lc=e,Vm=Pa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(xs=!0),e.firstContext=null)}function Ds(e){var t=e._currentValue;if(Vm!==e)if(e={context:e,memoizedValue:t,next:null},Pa===null){if(lc===null)throw Error(Z(308));Pa=e,lc.dependencies={lanes:0,firstContext:e}}else Pa=Pa.next=e;return t}var Bn=null;function Jm(e){Bn===null?Bn=[e]:Bn.push(e)}function Gx(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Jm(t)):(r.next=a.next,a.next=r),t.interleaved=r,Dr(e,n)}function Dr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Xr=!1;function Xm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function jn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ye&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Dr(e,r)}return a=n.interleaved,a===null?(t.next=t,Jm(n)):(t.next=a.next,a.next=t),n.interleaved=t,Dr(e,r)}function Po(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Im(e,r)}}function R0(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function oc(e,t,r,n){var a=e.updateQueue;Xr=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,d=c.next;c.next=null,l===null?i=d:l.next=d,l=c;var m=e.alternate;m!==null&&(m=m.updateQueue,o=m.lastBaseUpdate,o!==l&&(o===null?m.firstBaseUpdate=d:o.next=d,m.lastBaseUpdate=c))}if(i!==null){var h=a.baseState;l=0,m=d=c=null,o=i;do{var p=o.lane,j=o.eventTime;if((n&p)===p){m!==null&&(m=m.next={eventTime:j,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,g=o;switch(p=t,j=r,g.tag){case 1:if(f=g.payload,typeof f=="function"){h=f.call(j,h,p);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=g.payload,p=typeof f=="function"?f.call(j,h,p):f,p==null)break e;h=pt({},h,p);break e;case 2:Xr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else j={eventTime:j,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},m===null?(d=m=j,c=h):m=m.next=j,l|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(m===null&&(c=h),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=m,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);ca|=l,e.lanes=l,e.memoizedState=h}}function P0(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Z(191,a));a.call(n)}}}var Ul={},gr=An(Ul),vl=An(Ul),jl=An(Ul);function qn(e){if(e===Ul)throw Error(Z(174));return e}function Zm(e,t){switch(it(jl,t),it(vl,e),it(gr,Ul),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cu(t,e)}ut(gr),it(gr,t)}function ii(){ut(gr),ut(vl),ut(jl)}function Jx(e){qn(jl.current);var t=qn(gr.current),r=cu(t,e.type);t!==r&&(it(vl,e),it(gr,r))}function eh(e){vl.current===e&&(ut(gr),ut(vl))}var gt=An(0);function cc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Sd=[];function th(){for(var e=0;e<Sd.length;e++)Sd[e]._workInProgressVersionPrimary=null;Sd.length=0}var $o=Hr.ReactCurrentDispatcher,Cd=Hr.ReactCurrentBatchConfig,oa=0,xt=null,Tt=null,It=null,dc=!1,sl=!1,wl=0,D2=0;function Yt(){throw Error(Z(321))}function sh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Zs(e[r],t[r]))return!1;return!0}function rh(e,t,r,n,a,i){if(oa=i,xt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$o.current=e===null||e.memoizedState===null?B2:q2,e=r(n,a),sl){i=0;do{if(sl=!1,wl=0,25<=i)throw Error(Z(301));i+=1,It=Tt=null,t.updateQueue=null,$o.current=W2,e=r(n,a)}while(sl)}if($o.current=uc,t=Tt!==null&&Tt.next!==null,oa=0,It=Tt=xt=null,dc=!1,t)throw Error(Z(300));return e}function nh(){var e=wl!==0;return wl=0,e}function lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?xt.memoizedState=It=e:It=It.next=e,It}function zs(){if(Tt===null){var e=xt.alternate;e=e!==null?e.memoizedState:null}else e=Tt.next;var t=It===null?xt.memoizedState:It.next;if(t!==null)It=t,Tt=e;else{if(e===null)throw Error(Z(310));Tt=e,e={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},It===null?xt.memoizedState=It=e:It=It.next=e}return It}function Nl(e,t){return typeof t=="function"?t(e):t}function _d(e){var t=zs(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=Tt,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=l=null,c=null,d=i;do{var m=d.lane;if((oa&m)===m)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var h={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=h,l=n):c=c.next=h,xt.lanes|=m,ca|=m}d=d.next}while(d!==null&&d!==i);c===null?l=n:c.next=o,Zs(n,t.memoizedState)||(xs=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,xt.lanes|=i,ca|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ed(e){var t=zs(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);Zs(i,t.memoizedState)||(xs=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Xx(){}function Zx(e,t){var r=xt,n=zs(),a=t(),i=!Zs(n.memoizedState,a);if(i&&(n.memoizedState=a,xs=!0),n=n.queue,ah(sp.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||It!==null&&It.memoizedState.tag&1){if(r.flags|=2048,kl(9,tp.bind(null,r,n,a,t),void 0,null),zt===null)throw Error(Z(349));oa&30||ep(r,t,a)}return a}function ep(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function tp(e,t,r,n){t.value=r,t.getSnapshot=n,rp(t)&&np(e)}function sp(e,t,r){return r(function(){rp(t)&&np(e)})}function rp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Zs(e,r)}catch{return!0}}function np(e){var t=Dr(e,1);t!==null&&Js(t,e,1,-1)}function $0(e){var t=lr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nl,lastRenderedState:e},t.queue=e,e=e.dispatch=H2.bind(null,xt,e),[t.memoizedState,e]}function kl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=xt.updateQueue,t===null?(t={lastEffect:null,stores:null},xt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ap(){return zs().memoizedState}function Lo(e,t,r,n){var a=lr();xt.flags|=e,a.memoizedState=kl(1|t,r,void 0,n===void 0?null:n)}function $c(e,t,r,n){var a=zs();n=n===void 0?null:n;var i=void 0;if(Tt!==null){var l=Tt.memoizedState;if(i=l.destroy,n!==null&&sh(n,l.deps)){a.memoizedState=kl(t,r,i,n);return}}xt.flags|=e,a.memoizedState=kl(1|t,r,i,n)}function L0(e,t){return Lo(8390656,8,e,t)}function ah(e,t){return $c(2048,8,e,t)}function ip(e,t){return $c(4,2,e,t)}function lp(e,t){return $c(4,4,e,t)}function op(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cp(e,t,r){return r=r!=null?r.concat([e]):null,$c(4,4,op.bind(null,t,e),r)}function ih(){}function dp(e,t){var r=zs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&sh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function up(e,t){var r=zs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&sh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function mp(e,t,r){return oa&21?(Zs(r,t)||(r=px(),xt.lanes|=r,ca|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=r)}function z2(e,t){var r=st;st=r!==0&&4>r?r:4,e(!0);var n=Cd.transition;Cd.transition={};try{e(!1),t()}finally{st=r,Cd.transition=n}}function hp(){return zs().memoizedState}function U2(e,t,r){var n=Nn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},fp(e))gp(t,r);else if(r=Gx(e,t,r,n),r!==null){var a=os();Js(r,e,n,a),xp(r,t,n)}}function H2(e,t,r){var n=Nn(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(fp(e))gp(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(a.hasEagerState=!0,a.eagerState=o,Zs(o,l)){var c=t.interleaved;c===null?(a.next=a,Jm(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=Gx(e,t,a,n),r!==null&&(a=os(),Js(r,e,n,a),xp(r,t,n))}}function fp(e){var t=e.alternate;return e===xt||t!==null&&t===xt}function gp(e,t){sl=dc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function xp(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Im(e,r)}}var uc={readContext:Ds,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},B2={readContext:Ds,useCallback:function(e,t){return lr().memoizedState=[e,t===void 0?null:t],e},useContext:Ds,useEffect:L0,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Lo(4194308,4,op.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var r=lr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=lr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=U2.bind(null,xt,e),[n.memoizedState,e]},useRef:function(e){var t=lr();return e={current:e},t.memoizedState=e},useState:$0,useDebugValue:ih,useDeferredValue:function(e){return lr().memoizedState=e},useTransition:function(){var e=$0(!1),t=e[0];return e=z2.bind(null,e[1]),lr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=xt,a=lr();if(ht){if(r===void 0)throw Error(Z(407));r=r()}else{if(r=t(),zt===null)throw Error(Z(349));oa&30||ep(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,L0(sp.bind(null,n,i,e),[e]),n.flags|=2048,kl(9,tp.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=lr(),t=zt.identifierPrefix;if(ht){var r=Ar,n=Tr;r=(n&~(1<<32-Ys(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=wl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=D2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},q2={readContext:Ds,useCallback:dp,useContext:Ds,useEffect:ah,useImperativeHandle:cp,useInsertionEffect:ip,useLayoutEffect:lp,useMemo:up,useReducer:_d,useRef:ap,useState:function(){return _d(Nl)},useDebugValue:ih,useDeferredValue:function(e){var t=zs();return mp(t,Tt.memoizedState,e)},useTransition:function(){var e=_d(Nl)[0],t=zs().memoizedState;return[e,t]},useMutableSource:Xx,useSyncExternalStore:Zx,useId:hp,unstable_isNewReconciler:!1},W2={readContext:Ds,useCallback:dp,useContext:Ds,useEffect:ah,useImperativeHandle:cp,useInsertionEffect:ip,useLayoutEffect:lp,useMemo:up,useReducer:Ed,useRef:ap,useState:function(){return Ed(Nl)},useDebugValue:ih,useDeferredValue:function(e){var t=zs();return Tt===null?t.memoizedState=e:mp(t,Tt.memoizedState,e)},useTransition:function(){var e=Ed(Nl)[0],t=zs().memoizedState;return[e,t]},useMutableSource:Xx,useSyncExternalStore:Zx,useId:hp,unstable_isNewReconciler:!1};function Bs(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Tu(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:pt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Lc={isMounted:function(e){return(e=e._reactInternals)?ga(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=os(),a=Nn(e),i=Pr(n,a);i.payload=t,r!=null&&(i.callback=r),t=jn(e,i,a),t!==null&&(Js(t,e,a,n),Po(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=os(),a=Nn(e),i=Pr(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=jn(e,i,a),t!==null&&(Js(t,e,a,n),Po(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=os(),n=Nn(e),a=Pr(r,n);a.tag=2,t!=null&&(a.callback=t),t=jn(e,a,n),t!==null&&(Js(t,e,n,r),Po(t,e,n))}};function F0(e,t,r,n,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!xl(r,n)||!xl(a,i):!0}function pp(e,t,r){var n=!1,a=Mn,i=t.contextType;return typeof i=="object"&&i!==null?i=Ds(i):(a=ys(t)?ia:es.current,n=t.contextTypes,i=(n=n!=null)?ri(e,a):Mn),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Lc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function I0(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Lc.enqueueReplaceState(t,t.state,null)}function Au(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Xm(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Ds(i):(i=ys(t)?ia:es.current,a.context=ri(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Tu(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Lc.enqueueReplaceState(a,a.state,null),oc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function li(e,t){try{var r="",n=t;do r+=bv(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Md(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ru(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var K2=typeof WeakMap=="function"?WeakMap:Map;function yp(e,t,r){r=Pr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){hc||(hc=!0,Hu=n),Ru(e,t)},r}function bp(e,t,r){r=Pr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Ru(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ru(e,t),typeof n!="function"&&(wn===null?wn=new Set([this]):wn.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function O0(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new K2;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=ij.bind(null,e,t,r),t.then(e,e))}function D0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function z0(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Pr(-1,1),t.tag=2,jn(r,t,1))),r.lanes|=1),e)}var Q2=Hr.ReactCurrentOwner,xs=!1;function is(e,t,r,n){t.child=e===null?Vx(t,null,r,n):ai(t,e.child,r,n)}function U0(e,t,r,n,a){r=r.render;var i=t.ref;return Ua(t,a),n=rh(e,t,r,n,i,a),r=nh(),e!==null&&!xs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,zr(e,t,a)):(ht&&r&&Wm(t),t.flags|=1,is(e,t,n,a),t.child)}function H0(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!fh(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,vp(e,t,i,n,a)):(e=Do(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:xl,r(l,n)&&e.ref===t.ref)return zr(e,t,a)}return t.flags|=1,e=kn(i,n),e.ref=t.ref,e.return=t,t.child=e}function vp(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(xl(i,n)&&e.ref===t.ref)if(xs=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(xs=!0);else return t.lanes=e.lanes,zr(e,t,a)}return Pu(e,t,r,n,a)}function jp(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},it(La,Ss),Ss|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,it(La,Ss),Ss|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,it(La,Ss),Ss|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,it(La,Ss),Ss|=n;return is(e,t,a,r),t.child}function wp(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Pu(e,t,r,n,a){var i=ys(r)?ia:es.current;return i=ri(t,i),Ua(t,a),r=rh(e,t,r,n,i,a),n=nh(),e!==null&&!xs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,zr(e,t,a)):(ht&&n&&Wm(t),t.flags|=1,is(e,t,r,a),t.child)}function B0(e,t,r,n,a){if(ys(r)){var i=!0;rc(t)}else i=!1;if(Ua(t,a),t.stateNode===null)Fo(e,t),pp(t,r,n),Au(t,r,n,a),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,d=r.contextType;typeof d=="object"&&d!==null?d=Ds(d):(d=ys(r)?ia:es.current,d=ri(t,d));var m=r.getDerivedStateFromProps,h=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==d)&&I0(t,l,n,d),Xr=!1;var p=t.memoizedState;l.state=p,oc(t,n,l,a),c=t.memoizedState,o!==n||p!==c||ps.current||Xr?(typeof m=="function"&&(Tu(t,r,m,n),c=t.memoizedState),(o=Xr||F0(t,r,o,n,p,c,d))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),l.props=n,l.state=c,l.context=d,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Yx(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:Bs(t.type,o),l.props=d,h=t.pendingProps,p=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=Ds(c):(c=ys(r)?ia:es.current,c=ri(t,c));var j=r.getDerivedStateFromProps;(m=typeof j=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||p!==c)&&I0(t,l,n,c),Xr=!1,p=t.memoizedState,l.state=p,oc(t,n,l,a);var f=t.memoizedState;o!==h||p!==f||ps.current||Xr?(typeof j=="function"&&(Tu(t,r,j,n),f=t.memoizedState),(d=Xr||F0(t,r,d,n,p,f,c)||!1)?(m||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,f,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,f,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),l.props=n,l.state=f,l.context=c,n=d):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return $u(e,t,r,n,i,a)}function $u(e,t,r,n,a,i){wp(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return a&&E0(t,r,!1),zr(e,t,i);n=t.stateNode,Q2.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=ai(t,e.child,null,i),t.child=ai(t,null,o,i)):is(e,t,o,i),t.memoizedState=n.state,a&&E0(t,r,!0),t.child}function Np(e){var t=e.stateNode;t.pendingContext?_0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&_0(e,t.context,!1),Zm(e,t.containerInfo)}function q0(e,t,r,n,a){return ni(),Qm(a),t.flags|=256,is(e,t,r,n),t.child}var Lu={dehydrated:null,treeContext:null,retryLane:0};function Fu(e){return{baseLanes:e,cachePool:null,transitions:null}}function kp(e,t,r){var n=t.pendingProps,a=gt.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),it(gt,a&1),e===null)return Eu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Oc(l,n,0,null),e=na(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fu(r),t.memoizedState=Lu,e):lh(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return V2(e,t,l,n,o,a,r);if(i){i=n.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=kn(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=kn(o,i):(i=na(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?Fu(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=Lu,n}return i=e.child,e=i.sibling,n=kn(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function lh(e,t){return t=Oc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function go(e,t,r,n){return n!==null&&Qm(n),ai(t,e.child,null,r),e=lh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function V2(e,t,r,n,a,i,l){if(r)return t.flags&256?(t.flags&=-257,n=Md(Error(Z(422))),go(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Oc({mode:"visible",children:n.children},a,0,null),i=na(i,a,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&ai(t,e.child,null,l),t.child.memoizedState=Fu(l),t.memoizedState=Lu,i);if(!(t.mode&1))return go(e,t,l,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Z(419)),n=Md(i,n,void 0),go(e,t,l,n)}if(o=(l&e.childLanes)!==0,xs||o){if(n=zt,n!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Dr(e,a),Js(n,e,a,-1))}return hh(),n=Md(Error(Z(421))),go(e,t,l,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=lj.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Cs=vn(a.nextSibling),_s=t,ht=!0,Vs=null,e!==null&&(Ls[Fs++]=Tr,Ls[Fs++]=Ar,Ls[Fs++]=la,Tr=e.id,Ar=e.overflow,la=t),t=lh(t,n.children),t.flags|=4096,t)}function W0(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Mu(e.return,t,r)}function Td(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Sp(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(is(e,t,n.children,r),n=gt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&W0(e,r,t);else if(e.tag===19)W0(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(it(gt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&cc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Td(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&cc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Td(t,!0,r,null,i);break;case"together":Td(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ca|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,r=kn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=kn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function G2(e,t,r){switch(t.tag){case 3:Np(t),ni();break;case 5:Jx(t);break;case 1:ys(t.type)&&rc(t);break;case 4:Zm(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;it(ic,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(it(gt,gt.current&1),t.flags|=128,null):r&t.child.childLanes?kp(e,t,r):(it(gt,gt.current&1),e=zr(e,t,r),e!==null?e.sibling:null);it(gt,gt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Sp(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),it(gt,gt.current),n)break;return null;case 22:case 23:return t.lanes=0,jp(e,t,r)}return zr(e,t,r)}var Cp,Iu,_p,Ep;Cp=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Iu=function(){};_p=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,qn(gr.current);var i=null;switch(r){case"input":a=au(e,a),n=au(e,n),i=[];break;case"select":a=pt({},a,{value:void 0}),n=pt({},n,{value:void 0}),i=[];break;case"textarea":a=ou(e,a),n=ou(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=tc)}du(r,n);var l;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var o=a[d];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(cl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(cl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ct("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Ep=function(e,t,r,n){r!==n&&(t.flags|=4)};function Pi(e,t){if(!ht)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Y2(e,t,r){var n=t.pendingProps;switch(Km(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(t),null;case 1:return ys(t.type)&&sc(),Jt(t),null;case 3:return n=t.stateNode,ii(),ut(ps),ut(es),th(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ho(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Vs!==null&&(Wu(Vs),Vs=null))),Iu(e,t),Jt(t),null;case 5:eh(t);var a=qn(jl.current);if(r=t.type,e!==null&&t.stateNode!=null)_p(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Z(166));return Jt(t),null}if(e=qn(gr.current),ho(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[mr]=t,n[bl]=i,e=(t.mode&1)!==0,r){case"dialog":ct("cancel",n),ct("close",n);break;case"iframe":case"object":case"embed":ct("load",n);break;case"video":case"audio":for(a=0;a<Wi.length;a++)ct(Wi[a],n);break;case"source":ct("error",n);break;case"img":case"image":case"link":ct("error",n),ct("load",n);break;case"details":ct("toggle",n);break;case"input":e0(n,i),ct("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ct("invalid",n);break;case"textarea":s0(n,i),ct("invalid",n)}du(r,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&mo(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&mo(n.textContent,o,e),a=["children",""+o]):cl.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&ct("scroll",n)}switch(r){case"input":ro(n),t0(n,i,!0);break;case"textarea":ro(n),r0(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=tc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[mr]=t,e[bl]=n,Cp(e,t,!1,!1),t.stateNode=e;e:{switch(l=uu(r,n),r){case"dialog":ct("cancel",e),ct("close",e),a=n;break;case"iframe":case"object":case"embed":ct("load",e),a=n;break;case"video":case"audio":for(a=0;a<Wi.length;a++)ct(Wi[a],e);a=n;break;case"source":ct("error",e),a=n;break;case"img":case"image":case"link":ct("error",e),ct("load",e),a=n;break;case"details":ct("toggle",e),a=n;break;case"input":e0(e,n),a=au(e,n),ct("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=pt({},n,{value:void 0}),ct("invalid",e);break;case"textarea":s0(e,n),a=ou(e,n),ct("invalid",e);break;default:a=n}du(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?ax(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rx(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&dl(e,c):typeof c=="number"&&dl(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(cl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ct("scroll",e):c!=null&&Am(e,i,c,l))}switch(r){case"input":ro(e),t0(e,n,!1);break;case"textarea":ro(e),r0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+En(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ia(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ia(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=tc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Jt(t),null;case 6:if(e&&t.stateNode!=null)Ep(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Z(166));if(r=qn(jl.current),qn(gr.current),ho(t)){if(n=t.stateNode,r=t.memoizedProps,n[mr]=t,(i=n.nodeValue!==r)&&(e=_s,e!==null))switch(e.tag){case 3:mo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&mo(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[mr]=t,t.stateNode=n}return Jt(t),null;case 13:if(ut(gt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ht&&Cs!==null&&t.mode&1&&!(t.flags&128))Kx(),ni(),t.flags|=98560,i=!1;else if(i=ho(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Z(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Z(317));i[mr]=t}else ni(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Jt(t),i=!1}else Vs!==null&&(Wu(Vs),Vs=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||gt.current&1?Rt===0&&(Rt=3):hh())),t.updateQueue!==null&&(t.flags|=4),Jt(t),null);case 4:return ii(),Iu(e,t),e===null&&pl(t.stateNode.containerInfo),Jt(t),null;case 10:return Ym(t.type._context),Jt(t),null;case 17:return ys(t.type)&&sc(),Jt(t),null;case 19:if(ut(gt),i=t.memoizedState,i===null)return Jt(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)Pi(i,!1);else{if(Rt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=cc(e),l!==null){for(t.flags|=128,Pi(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return it(gt,gt.current&1|2),t.child}e=e.sibling}i.tail!==null&&jt()>oi&&(t.flags|=128,n=!0,Pi(i,!1),t.lanes=4194304)}else{if(!n)if(e=cc(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Pi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!ht)return Jt(t),null}else 2*jt()-i.renderingStartTime>oi&&r!==1073741824&&(t.flags|=128,n=!0,Pi(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=jt(),t.sibling=null,r=gt.current,it(gt,n?r&1|2:r&1),t):(Jt(t),null);case 22:case 23:return mh(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ss&1073741824&&(Jt(t),t.subtreeFlags&6&&(t.flags|=8192)):Jt(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function J2(e,t){switch(Km(t),t.tag){case 1:return ys(t.type)&&sc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ii(),ut(ps),ut(es),th(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return eh(t),null;case 13:if(ut(gt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));ni()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(gt),null;case 4:return ii(),null;case 10:return Ym(t.type._context),null;case 22:case 23:return mh(),null;case 24:return null;default:return null}}var xo=!1,Xt=!1,X2=typeof WeakSet=="function"?WeakSet:Set,fe=null;function $a(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){vt(e,t,n)}else r.current=null}function Ou(e,t,r){try{r()}catch(n){vt(e,t,n)}}var K0=!1;function Z2(e,t){if(ju=Xo,e=Px(),qm(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,d=0,m=0,h=e,p=null;t:for(;;){for(var j;h!==r||a!==0&&h.nodeType!==3||(o=l+a),h!==i||n!==0&&h.nodeType!==3||(c=l+n),h.nodeType===3&&(l+=h.nodeValue.length),(j=h.firstChild)!==null;)p=h,h=j;for(;;){if(h===e)break t;if(p===r&&++d===a&&(o=l),p===i&&++m===n&&(c=l),(j=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=j}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(wu={focusedElem:e,selectionRange:r},Xo=!1,fe=t;fe!==null;)if(t=fe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,fe=e;else for(;fe!==null;){t=fe;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,y=f.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:Bs(t.type,g),y);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(w){vt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,fe=e;break}fe=t.return}return f=K0,K0=!1,f}function rl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Ou(t,r,i)}a=a.next}while(a!==n)}}function Fc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Du(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Mp(e){var t=e.alternate;t!==null&&(e.alternate=null,Mp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[mr],delete t[bl],delete t[Su],delete t[L2],delete t[F2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tp(e){return e.tag===5||e.tag===3||e.tag===4}function Q0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function zu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=tc));else if(n!==4&&(e=e.child,e!==null))for(zu(e,t,r),e=e.sibling;e!==null;)zu(e,t,r),e=e.sibling}function Uu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Uu(e,t,r),e=e.sibling;e!==null;)Uu(e,t,r),e=e.sibling}var Bt=null,Qs=!1;function Wr(e,t,r){for(r=r.child;r!==null;)Ap(e,t,r),r=r.sibling}function Ap(e,t,r){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(Ec,r)}catch{}switch(r.tag){case 5:Xt||$a(r,t);case 6:var n=Bt,a=Qs;Bt=null,Wr(e,t,r),Bt=n,Qs=a,Bt!==null&&(Qs?(e=Bt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Bt.removeChild(r.stateNode));break;case 18:Bt!==null&&(Qs?(e=Bt,r=r.stateNode,e.nodeType===8?Nd(e.parentNode,r):e.nodeType===1&&Nd(e,r),fl(e)):Nd(Bt,r.stateNode));break;case 4:n=Bt,a=Qs,Bt=r.stateNode.containerInfo,Qs=!0,Wr(e,t,r),Bt=n,Qs=a;break;case 0:case 11:case 14:case 15:if(!Xt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Ou(r,t,l),a=a.next}while(a!==n)}Wr(e,t,r);break;case 1:if(!Xt&&($a(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){vt(r,t,o)}Wr(e,t,r);break;case 21:Wr(e,t,r);break;case 22:r.mode&1?(Xt=(n=Xt)||r.memoizedState!==null,Wr(e,t,r),Xt=n):Wr(e,t,r);break;default:Wr(e,t,r)}}function V0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new X2),t.forEach(function(n){var a=oj.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Hs(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Bt=o.stateNode,Qs=!1;break e;case 3:Bt=o.stateNode.containerInfo,Qs=!0;break e;case 4:Bt=o.stateNode.containerInfo,Qs=!0;break e}o=o.return}if(Bt===null)throw Error(Z(160));Ap(i,l,a),Bt=null,Qs=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){vt(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Rp(t,e),t=t.sibling}function Rp(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Hs(t,e),ar(e),n&4){try{rl(3,e,e.return),Fc(3,e)}catch(g){vt(e,e.return,g)}try{rl(5,e,e.return)}catch(g){vt(e,e.return,g)}}break;case 1:Hs(t,e),ar(e),n&512&&r!==null&&$a(r,r.return);break;case 5:if(Hs(t,e),ar(e),n&512&&r!==null&&$a(r,r.return),e.flags&32){var a=e.stateNode;try{dl(a,"")}catch(g){vt(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&ex(a,i),uu(o,l);var d=uu(o,i);for(l=0;l<c.length;l+=2){var m=c[l],h=c[l+1];m==="style"?ax(a,h):m==="dangerouslySetInnerHTML"?rx(a,h):m==="children"?dl(a,h):Am(a,m,h,d)}switch(o){case"input":iu(a,i);break;case"textarea":tx(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var j=i.value;j!=null?Ia(a,!!i.multiple,j,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ia(a,!!i.multiple,i.defaultValue,!0):Ia(a,!!i.multiple,i.multiple?[]:"",!1))}a[bl]=i}catch(g){vt(e,e.return,g)}}break;case 6:if(Hs(t,e),ar(e),n&4){if(e.stateNode===null)throw Error(Z(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){vt(e,e.return,g)}}break;case 3:if(Hs(t,e),ar(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{fl(t.containerInfo)}catch(g){vt(e,e.return,g)}break;case 4:Hs(t,e),ar(e);break;case 13:Hs(t,e),ar(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(dh=jt())),n&4&&V0(e);break;case 22:if(m=r!==null&&r.memoizedState!==null,e.mode&1?(Xt=(d=Xt)||m,Hs(t,e),Xt=d):Hs(t,e),ar(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!m&&e.mode&1)for(fe=e,m=e.child;m!==null;){for(h=fe=m;fe!==null;){switch(p=fe,j=p.child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:$a(p,p.return);var f=p.stateNode;if(typeof f.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){vt(n,r,g)}}break;case 5:$a(p,p.return);break;case 22:if(p.memoizedState!==null){Y0(h);continue}}j!==null?(j.return=p,fe=j):Y0(h)}m=m.sibling}e:for(m=null,h=e;;){if(h.tag===5){if(m===null){m=h;try{a=h.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,c=h.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=nx("display",l))}catch(g){vt(e,e.return,g)}}}else if(h.tag===6){if(m===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){vt(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;m===h&&(m=null),h=h.return}m===h&&(m=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Hs(t,e),ar(e),n&4&&V0(e);break;case 21:break;default:Hs(t,e),ar(e)}}function ar(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Tp(r)){var n=r;break e}r=r.return}throw Error(Z(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(dl(a,""),n.flags&=-33);var i=Q0(e);Uu(e,i,a);break;case 3:case 4:var l=n.stateNode.containerInfo,o=Q0(e);zu(e,o,l);break;default:throw Error(Z(161))}}catch(c){vt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ej(e,t,r){fe=e,Pp(e)}function Pp(e,t,r){for(var n=(e.mode&1)!==0;fe!==null;){var a=fe,i=a.child;if(a.tag===22&&n){var l=a.memoizedState!==null||xo;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Xt;o=xo;var d=Xt;if(xo=l,(Xt=c)&&!d)for(fe=a;fe!==null;)l=fe,c=l.child,l.tag===22&&l.memoizedState!==null?J0(a):c!==null?(c.return=l,fe=c):J0(a);for(;i!==null;)fe=i,Pp(i),i=i.sibling;fe=a,xo=o,Xt=d}G0(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,fe=i):G0(e)}}function G0(e){for(;fe!==null;){var t=fe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xt||Fc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Xt)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Bs(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&P0(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}P0(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var h=m.dehydrated;h!==null&&fl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Xt||t.flags&512&&Du(t)}catch(p){vt(t,t.return,p)}}if(t===e){fe=null;break}if(r=t.sibling,r!==null){r.return=t.return,fe=r;break}fe=t.return}}function Y0(e){for(;fe!==null;){var t=fe;if(t===e){fe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,fe=r;break}fe=t.return}}function J0(e){for(;fe!==null;){var t=fe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Fc(4,t)}catch(c){vt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){vt(t,a,c)}}var i=t.return;try{Du(t)}catch(c){vt(t,i,c)}break;case 5:var l=t.return;try{Du(t)}catch(c){vt(t,l,c)}}}catch(c){vt(t,t.return,c)}if(t===e){fe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,fe=o;break}fe=t.return}}var tj=Math.ceil,mc=Hr.ReactCurrentDispatcher,oh=Hr.ReactCurrentOwner,Os=Hr.ReactCurrentBatchConfig,Ye=0,zt=null,Ct=null,Kt=0,Ss=0,La=An(0),Rt=0,Sl=null,ca=0,Ic=0,ch=0,nl=null,gs=null,dh=0,oi=1/0,Nr=null,hc=!1,Hu=null,wn=null,po=!1,hn=null,fc=0,al=0,Bu=null,Io=-1,Oo=0;function os(){return Ye&6?jt():Io!==-1?Io:Io=jt()}function Nn(e){return e.mode&1?Ye&2&&Kt!==0?Kt&-Kt:O2.transition!==null?(Oo===0&&(Oo=px()),Oo):(e=st,e!==0||(e=window.event,e=e===void 0?16:kx(e.type)),e):1}function Js(e,t,r,n){if(50<al)throw al=0,Bu=null,Error(Z(185));Ol(e,r,n),(!(Ye&2)||e!==zt)&&(e===zt&&(!(Ye&2)&&(Ic|=r),Rt===4&&en(e,Kt)),bs(e,n),r===1&&Ye===0&&!(t.mode&1)&&(oi=jt()+500,Pc&&Rn()))}function bs(e,t){var r=e.callbackNode;Ov(e,t);var n=Jo(e,e===zt?Kt:0);if(n===0)r!==null&&i0(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&i0(r),t===1)e.tag===0?I2(X0.bind(null,e)):Bx(X0.bind(null,e)),P2(function(){!(Ye&6)&&Rn()}),r=null;else{switch(yx(n)){case 1:r=Fm;break;case 4:r=gx;break;case 16:r=Yo;break;case 536870912:r=xx;break;default:r=Yo}r=Up(r,$p.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function $p(e,t){if(Io=-1,Oo=0,Ye&6)throw Error(Z(327));var r=e.callbackNode;if(Ha()&&e.callbackNode!==r)return null;var n=Jo(e,e===zt?Kt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=gc(e,n);else{t=n;var a=Ye;Ye|=2;var i=Fp();(zt!==e||Kt!==t)&&(Nr=null,oi=jt()+500,ra(e,t));do try{nj();break}catch(o){Lp(e,o)}while(!0);Gm(),mc.current=i,Ye=a,Ct!==null?t=0:(zt=null,Kt=0,t=Rt)}if(t!==0){if(t===2&&(a=xu(e),a!==0&&(n=a,t=qu(e,a))),t===1)throw r=Sl,ra(e,0),en(e,n),bs(e,jt()),r;if(t===6)en(e,n);else{if(a=e.current.alternate,!(n&30)&&!sj(a)&&(t=gc(e,n),t===2&&(i=xu(e),i!==0&&(n=i,t=qu(e,i))),t===1))throw r=Sl,ra(e,0),en(e,n),bs(e,jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Z(345));case 2:Un(e,gs,Nr);break;case 3:if(en(e,n),(n&130023424)===n&&(t=dh+500-jt(),10<t)){if(Jo(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){os(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ku(Un.bind(null,e,gs,Nr),t);break}Un(e,gs,Nr);break;case 4:if(en(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var l=31-Ys(n);i=1<<l,l=t[l],l>a&&(a=l),n&=~i}if(n=a,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*tj(n/1960))-n,10<n){e.timeoutHandle=ku(Un.bind(null,e,gs,Nr),n);break}Un(e,gs,Nr);break;case 5:Un(e,gs,Nr);break;default:throw Error(Z(329))}}}return bs(e,jt()),e.callbackNode===r?$p.bind(null,e):null}function qu(e,t){var r=nl;return e.current.memoizedState.isDehydrated&&(ra(e,t).flags|=256),e=gc(e,t),e!==2&&(t=gs,gs=r,t!==null&&Wu(t)),e}function Wu(e){gs===null?gs=e:gs.push.apply(gs,e)}function sj(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Zs(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function en(e,t){for(t&=~ch,t&=~Ic,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ys(t),n=1<<r;e[r]=-1,t&=~n}}function X0(e){if(Ye&6)throw Error(Z(327));Ha();var t=Jo(e,0);if(!(t&1))return bs(e,jt()),null;var r=gc(e,t);if(e.tag!==0&&r===2){var n=xu(e);n!==0&&(t=n,r=qu(e,n))}if(r===1)throw r=Sl,ra(e,0),en(e,t),bs(e,jt()),r;if(r===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Un(e,gs,Nr),bs(e,jt()),null}function uh(e,t){var r=Ye;Ye|=1;try{return e(t)}finally{Ye=r,Ye===0&&(oi=jt()+500,Pc&&Rn())}}function da(e){hn!==null&&hn.tag===0&&!(Ye&6)&&Ha();var t=Ye;Ye|=1;var r=Os.transition,n=st;try{if(Os.transition=null,st=1,e)return e()}finally{st=n,Os.transition=r,Ye=t,!(Ye&6)&&Rn()}}function mh(){Ss=La.current,ut(La)}function ra(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,R2(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(Km(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&sc();break;case 3:ii(),ut(ps),ut(es),th();break;case 5:eh(n);break;case 4:ii();break;case 13:ut(gt);break;case 19:ut(gt);break;case 10:Ym(n.type._context);break;case 22:case 23:mh()}r=r.return}if(zt=e,Ct=e=kn(e.current,null),Kt=Ss=t,Rt=0,Sl=null,ch=Ic=ca=0,gs=nl=null,Bn!==null){for(t=0;t<Bn.length;t++)if(r=Bn[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=a,n.next=l}r.pending=n}Bn=null}return e}function Lp(e,t){do{var r=Ct;try{if(Gm(),$o.current=uc,dc){for(var n=xt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}dc=!1}if(oa=0,It=Tt=xt=null,sl=!1,wl=0,oh.current=null,r===null||r.return===null){Rt=1,Sl=t,Ct=null;break}e:{var i=e,l=r.return,o=r,c=t;if(t=Kt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,m=o,h=m.tag;if(!(m.mode&1)&&(h===0||h===11||h===15)){var p=m.alternate;p?(m.updateQueue=p.updateQueue,m.memoizedState=p.memoizedState,m.lanes=p.lanes):(m.updateQueue=null,m.memoizedState=null)}var j=D0(l);if(j!==null){j.flags&=-257,z0(j,l,o,i,t),j.mode&1&&O0(i,d,t),t=j,c=d;var f=t.updateQueue;if(f===null){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}else{if(!(t&1)){O0(i,d,t),hh();break e}c=Error(Z(426))}}else if(ht&&o.mode&1){var y=D0(l);if(y!==null){!(y.flags&65536)&&(y.flags|=256),z0(y,l,o,i,t),Qm(li(c,o));break e}}i=c=li(c,o),Rt!==4&&(Rt=2),nl===null?nl=[i]:nl.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var b=yp(i,c,t);R0(i,b);break e;case 1:o=c;var x=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(wn===null||!wn.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=bp(i,o,t);R0(i,w);break e}}i=i.return}while(i!==null)}Op(r)}catch(N){t=N,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function Fp(){var e=mc.current;return mc.current=uc,e===null?uc:e}function hh(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),zt===null||!(ca&268435455)&&!(Ic&268435455)||en(zt,Kt)}function gc(e,t){var r=Ye;Ye|=2;var n=Fp();(zt!==e||Kt!==t)&&(Nr=null,ra(e,t));do try{rj();break}catch(a){Lp(e,a)}while(!0);if(Gm(),Ye=r,mc.current=n,Ct!==null)throw Error(Z(261));return zt=null,Kt=0,Rt}function rj(){for(;Ct!==null;)Ip(Ct)}function nj(){for(;Ct!==null&&!Mv();)Ip(Ct)}function Ip(e){var t=zp(e.alternate,e,Ss);e.memoizedProps=e.pendingProps,t===null?Op(e):Ct=t,oh.current=null}function Op(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=J2(r,t),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rt=6,Ct=null;return}}else if(r=Y2(r,t,Ss),r!==null){Ct=r;return}if(t=t.sibling,t!==null){Ct=t;return}Ct=t=e}while(t!==null);Rt===0&&(Rt=5)}function Un(e,t,r){var n=st,a=Os.transition;try{Os.transition=null,st=1,aj(e,t,r,n)}finally{Os.transition=a,st=n}return null}function aj(e,t,r,n){do Ha();while(hn!==null);if(Ye&6)throw Error(Z(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Dv(e,i),e===zt&&(Ct=zt=null,Kt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||po||(po=!0,Up(Yo,function(){return Ha(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Os.transition,Os.transition=null;var l=st;st=1;var o=Ye;Ye|=4,oh.current=null,Z2(e,r),Rp(r,e),S2(wu),Xo=!!ju,wu=ju=null,e.current=r,ej(r),Tv(),Ye=o,st=l,Os.transition=i}else e.current=r;if(po&&(po=!1,hn=e,fc=a),i=e.pendingLanes,i===0&&(wn=null),Pv(r.stateNode),bs(e,jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(hc)throw hc=!1,e=Hu,Hu=null,e;return fc&1&&e.tag!==0&&Ha(),i=e.pendingLanes,i&1?e===Bu?al++:(al=0,Bu=e):al=0,Rn(),null}function Ha(){if(hn!==null){var e=yx(fc),t=Os.transition,r=st;try{if(Os.transition=null,st=16>e?16:e,hn===null)var n=!1;else{if(e=hn,hn=null,fc=0,Ye&6)throw Error(Z(331));var a=Ye;for(Ye|=4,fe=e.current;fe!==null;){var i=fe,l=i.child;if(fe.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(fe=d;fe!==null;){var m=fe;switch(m.tag){case 0:case 11:case 15:rl(8,m,i)}var h=m.child;if(h!==null)h.return=m,fe=h;else for(;fe!==null;){m=fe;var p=m.sibling,j=m.return;if(Mp(m),m===d){fe=null;break}if(p!==null){p.return=j,fe=p;break}fe=j}}}var f=i.alternate;if(f!==null){var g=f.child;if(g!==null){f.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}fe=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,fe=l;else e:for(;fe!==null;){if(i=fe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:rl(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,fe=b;break e}fe=i.return}}var x=e.current;for(fe=x;fe!==null;){l=fe;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,fe=v;else e:for(l=x;fe!==null;){if(o=fe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Fc(9,o)}}catch(N){vt(o,o.return,N)}if(o===l){fe=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,fe=w;break e}fe=o.return}}if(Ye=a,Rn(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(Ec,e)}catch{}n=!0}return n}finally{st=r,Os.transition=t}}return!1}function Z0(e,t,r){t=li(r,t),t=yp(e,t,1),e=jn(e,t,1),t=os(),e!==null&&(Ol(e,1,t),bs(e,t))}function vt(e,t,r){if(e.tag===3)Z0(e,e,r);else for(;t!==null;){if(t.tag===3){Z0(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(wn===null||!wn.has(n))){e=li(r,e),e=bp(t,e,1),t=jn(t,e,1),e=os(),t!==null&&(Ol(t,1,e),bs(t,e));break}}t=t.return}}function ij(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=os(),e.pingedLanes|=e.suspendedLanes&r,zt===e&&(Kt&r)===r&&(Rt===4||Rt===3&&(Kt&130023424)===Kt&&500>jt()-dh?ra(e,0):ch|=r),bs(e,t)}function Dp(e,t){t===0&&(e.mode&1?(t=io,io<<=1,!(io&130023424)&&(io=4194304)):t=1);var r=os();e=Dr(e,t),e!==null&&(Ol(e,t,r),bs(e,r))}function lj(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Dp(e,r)}function oj(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Z(314))}n!==null&&n.delete(t),Dp(e,r)}var zp;zp=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ps.current)xs=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return xs=!1,G2(e,t,r);xs=!!(e.flags&131072)}else xs=!1,ht&&t.flags&1048576&&qx(t,ac,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Fo(e,t),e=t.pendingProps;var a=ri(t,es.current);Ua(t,r),a=rh(null,t,n,e,a,r);var i=nh();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ys(n)?(i=!0,rc(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Xm(t),a.updater=Lc,t.stateNode=a,a._reactInternals=t,Au(t,n,e,r),t=$u(null,t,n,!0,i,r)):(t.tag=0,ht&&i&&Wm(t),is(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Fo(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=dj(n),e=Bs(n,e),a){case 0:t=Pu(null,t,n,e,r);break e;case 1:t=B0(null,t,n,e,r);break e;case 11:t=U0(null,t,n,e,r);break e;case 14:t=H0(null,t,n,Bs(n.type,e),r);break e}throw Error(Z(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Bs(n,a),Pu(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Bs(n,a),B0(e,t,n,a,r);case 3:e:{if(Np(t),e===null)throw Error(Z(387));n=t.pendingProps,i=t.memoizedState,a=i.element,Yx(e,t),oc(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=li(Error(Z(423)),t),t=q0(e,t,n,r,a);break e}else if(n!==a){a=li(Error(Z(424)),t),t=q0(e,t,n,r,a);break e}else for(Cs=vn(t.stateNode.containerInfo.firstChild),_s=t,ht=!0,Vs=null,r=Vx(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ni(),n===a){t=zr(e,t,r);break e}is(e,t,n,r)}t=t.child}return t;case 5:return Jx(t),e===null&&Eu(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Nu(n,a)?l=null:i!==null&&Nu(n,i)&&(t.flags|=32),wp(e,t),is(e,t,l,r),t.child;case 6:return e===null&&Eu(t),null;case 13:return kp(e,t,r);case 4:return Zm(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ai(t,null,n,r):is(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Bs(n,a),U0(e,t,n,a,r);case 7:return is(e,t,t.pendingProps,r),t.child;case 8:return is(e,t,t.pendingProps.children,r),t.child;case 12:return is(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,it(ic,n._currentValue),n._currentValue=l,i!==null)if(Zs(i.value,l)){if(i.children===a.children&&!ps.current){t=zr(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Pr(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?c.next=c:(c.next=m.next,m.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Mu(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(Z(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Mu(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}is(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ua(t,r),a=Ds(a),n=n(a),t.flags|=1,is(e,t,n,r),t.child;case 14:return n=t.type,a=Bs(n,t.pendingProps),a=Bs(n.type,a),H0(e,t,n,a,r);case 15:return vp(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Bs(n,a),Fo(e,t),t.tag=1,ys(n)?(e=!0,rc(t)):e=!1,Ua(t,r),pp(t,n,a),Au(t,n,a,r),$u(null,t,n,!0,e,r);case 19:return Sp(e,t,r);case 22:return jp(e,t,r)}throw Error(Z(156,t.tag))};function Up(e,t){return fx(e,t)}function cj(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Is(e,t,r,n){return new cj(e,t,r,n)}function fh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dj(e){if(typeof e=="function")return fh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Pm)return 11;if(e===$m)return 14}return 2}function kn(e,t){var r=e.alternate;return r===null?(r=Is(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Do(e,t,r,n,a,i){var l=2;if(n=e,typeof e=="function")fh(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Sa:return na(r.children,a,i,t);case Rm:l=8,a|=8;break;case tu:return e=Is(12,r,t,a|2),e.elementType=tu,e.lanes=i,e;case su:return e=Is(13,r,t,a),e.elementType=su,e.lanes=i,e;case ru:return e=Is(19,r,t,a),e.elementType=ru,e.lanes=i,e;case Jg:return Oc(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Gg:l=10;break e;case Yg:l=9;break e;case Pm:l=11;break e;case $m:l=14;break e;case Jr:l=16,n=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=Is(l,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function na(e,t,r,n){return e=Is(7,e,n,t),e.lanes=r,e}function Oc(e,t,r,n){return e=Is(22,e,n,t),e.elementType=Jg,e.lanes=r,e.stateNode={isHidden:!1},e}function Ad(e,t,r){return e=Is(6,e,null,t),e.lanes=r,e}function Rd(e,t,r){return t=Is(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uj(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=md(0),this.expirationTimes=md(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=md(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function gh(e,t,r,n,a,i,l,o,c){return e=new uj(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Is(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xm(i),e}function mj(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ka,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Hp(e){if(!e)return Mn;e=e._reactInternals;e:{if(ga(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ys(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var r=e.type;if(ys(r))return Hx(e,r,t)}return t}function Bp(e,t,r,n,a,i,l,o,c){return e=gh(r,n,!0,e,a,i,l,o,c),e.context=Hp(null),r=e.current,n=os(),a=Nn(r),i=Pr(n,a),i.callback=t??null,jn(r,i,a),e.current.lanes=a,Ol(e,a,n),bs(e,n),e}function Dc(e,t,r,n){var a=t.current,i=os(),l=Nn(a);return r=Hp(r),t.context===null?t.context=r:t.pendingContext=r,t=Pr(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=jn(a,t,l),e!==null&&(Js(e,a,l,i),Po(e,a,l)),l}function xc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ef(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xh(e,t){ef(e,t),(e=e.alternate)&&ef(e,t)}function hj(){return null}var qp=typeof reportError=="function"?reportError:function(e){console.error(e)};function ph(e){this._internalRoot=e}zc.prototype.render=ph.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));Dc(e,t,null,null)};zc.prototype.unmount=ph.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;da(function(){Dc(null,e,null,null)}),t[Or]=null}};function zc(e){this._internalRoot=e}zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=jx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Zr.length&&t!==0&&t<Zr[r].priority;r++);Zr.splice(r,0,e),r===0&&Nx(e)}};function yh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Uc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function tf(){}function fj(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=xc(l);i.call(d)}}var l=Bp(t,n,e,0,null,!1,!1,"",tf);return e._reactRootContainer=l,e[Or]=l.current,pl(e.nodeType===8?e.parentNode:e),da(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var d=xc(c);o.call(d)}}var c=gh(e,0,!1,null,null,!1,!1,"",tf);return e._reactRootContainer=c,e[Or]=c.current,pl(e.nodeType===8?e.parentNode:e),da(function(){Dc(t,c,r,n)}),c}function Hc(e,t,r,n,a){var i=r._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var c=xc(l);o.call(c)}}Dc(t,l,e,a)}else l=fj(r,t,e,a,n);return xc(l)}bx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=qi(t.pendingLanes);r!==0&&(Im(t,r|1),bs(t,jt()),!(Ye&6)&&(oi=jt()+500,Rn()))}break;case 13:da(function(){var n=Dr(e,1);if(n!==null){var a=os();Js(n,e,1,a)}}),xh(e,1)}};Om=function(e){if(e.tag===13){var t=Dr(e,134217728);if(t!==null){var r=os();Js(t,e,134217728,r)}xh(e,134217728)}};vx=function(e){if(e.tag===13){var t=Nn(e),r=Dr(e,t);if(r!==null){var n=os();Js(r,e,t,n)}xh(e,t)}};jx=function(){return st};wx=function(e,t){var r=st;try{return st=e,t()}finally{st=r}};hu=function(e,t,r){switch(t){case"input":if(iu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Rc(n);if(!a)throw Error(Z(90));Zg(n),iu(n,a)}}}break;case"textarea":tx(e,r);break;case"select":t=r.value,t!=null&&Ia(e,!!r.multiple,t,!1)}};ox=uh;cx=da;var gj={usingClientEntryPoint:!1,Events:[zl,Ma,Rc,ix,lx,uh]},$i={findFiberByHostInstance:Hn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xj={bundleType:$i.bundleType,version:$i.version,rendererPackageName:$i.rendererPackageName,rendererConfig:$i.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=mx(e),e===null?null:e.stateNode},findFiberByHostInstance:$i.findFiberByHostInstance||hj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yo.isDisabled&&yo.supportsFiber)try{Ec=yo.inject(xj),fr=yo}catch{}}Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gj;Ms.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yh(t))throw Error(Z(200));return mj(e,t,null,r)};Ms.createRoot=function(e,t){if(!yh(e))throw Error(Z(299));var r=!1,n="",a=qp;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=gh(e,1,!1,null,null,r,!1,n,a),e[Or]=t.current,pl(e.nodeType===8?e.parentNode:e),new ph(t)};Ms.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=mx(t),e=e===null?null:e.stateNode,e};Ms.flushSync=function(e){return da(e)};Ms.hydrate=function(e,t,r){if(!Uc(t))throw Error(Z(200));return Hc(null,e,t,!0,r)};Ms.hydrateRoot=function(e,t,r){if(!yh(e))throw Error(Z(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",l=qp;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Bp(t,null,e,1,r??null,a,!1,i,l),e[Or]=t.current,pl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new zc(t)};Ms.render=function(e,t,r){if(!Uc(t))throw Error(Z(200));return Hc(null,e,t,!1,r)};Ms.unmountComponentAtNode=function(e){if(!Uc(e))throw Error(Z(40));return e._reactRootContainer?(da(function(){Hc(null,null,e,!1,function(){e._reactRootContainer=null,e[Or]=null})}),!0):!1};Ms.unstable_batchedUpdates=uh;Ms.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Uc(r))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return Hc(e,t,r,!1,n)};Ms.version="18.3.1-next-f1338f8080-20240426";function Wp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Wp)}catch(e){console.error(e)}}Wp(),Wg.exports=Ms;var Kp=Wg.exports,sf=Kp;Zd.createRoot=sf.createRoot,Zd.hydrateRoot=sf.hydrateRoot;var bi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},pj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},sn,km,wg,yj=(wg=class{constructor(){Se(this,sn,pj);Se(this,km,!1)}setTimeoutProvider(e){ce(this,sn,e)}setTimeout(e,t){return C(this,sn).setTimeout(e,t)}clearTimeout(e){C(this,sn).clearTimeout(e)}setInterval(e,t){return C(this,sn).setInterval(e,t)}clearInterval(e){C(this,sn).clearInterval(e)}},sn=new WeakMap,km=new WeakMap,wg),Wn=new yj;function bj(e){setTimeout(e,0)}var ua=typeof window>"u"||"Deno"in globalThis;function ls(){}function vj(e,t){return typeof e=="function"?e(t):e}function Ku(e){return typeof e=="number"&&e>=0&&e!==1/0}function Qp(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Sn(e,t){return typeof e=="function"?e(t):e}function $s(e,t){return typeof e=="function"?e(t):e}function rf(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==bh(l,t.options))return!1}else if(!Cl(t.queryKey,l))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||i&&!i(t))}function nf(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(ma(t.options.mutationKey)!==ma(i))return!1}else if(!Cl(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function bh(e,t){return((t==null?void 0:t.queryKeyHashFn)||ma)(e)}function ma(e){return JSON.stringify(e,(t,r)=>Qu(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Cl(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Cl(e[r],t[r])):!1}var jj=Object.prototype.hasOwnProperty;function Vp(e,t){if(e===t)return e;const r=af(e)&&af(t);if(!r&&!(Qu(e)&&Qu(t)))return t;const a=(r?e:Object.keys(e)).length,i=r?t:Object.keys(t),l=i.length,o=r?new Array(l):{};let c=0;for(let d=0;d<l;d++){const m=r?d:i[d],h=e[m],p=t[m];if(h===p){o[m]=h,(r?d<a:jj.call(e,m))&&c++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){o[m]=p;continue}const j=Vp(h,p);o[m]=j,j===h&&c++}return a===l&&c===a?e:o}function pc(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function af(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Qu(e){if(!lf(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!lf(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function lf(e){return Object.prototype.toString.call(e)==="[object Object]"}function wj(e){return new Promise(t=>{Wn.setTimeout(t,e)})}function Vu(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Vp(e,t):t}function Nj(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function kj(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var vh=Symbol();function Gp(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===vh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Yp(e,t){return typeof e=="function"?e(...t):!!e}var Vn,rn,Ba,Ng,Sj=(Ng=class extends bi{constructor(){super();Se(this,Vn);Se(this,rn);Se(this,Ba);ce(this,Ba,t=>{if(!ua&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){C(this,rn)||this.setEventListener(C(this,Ba))}onUnsubscribe(){var t;this.hasListeners()||((t=C(this,rn))==null||t.call(this),ce(this,rn,void 0))}setEventListener(t){var r;ce(this,Ba,t),(r=C(this,rn))==null||r.call(this),ce(this,rn,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){C(this,Vn)!==t&&(ce(this,Vn,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof C(this,Vn)=="boolean"?C(this,Vn):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Vn=new WeakMap,rn=new WeakMap,Ba=new WeakMap,Ng),jh=new Sj;function Gu(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}var Cj=bj;function _j(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=Cj;const i=o=>{t?e.push(o):a(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var At=_j(),qa,nn,Wa,kg,Ej=(kg=class extends bi{constructor(){super();Se(this,qa,!0);Se(this,nn);Se(this,Wa);ce(this,Wa,t=>{if(!ua&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){C(this,nn)||this.setEventListener(C(this,Wa))}onUnsubscribe(){var t;this.hasListeners()||((t=C(this,nn))==null||t.call(this),ce(this,nn,void 0))}setEventListener(t){var r;ce(this,Wa,t),(r=C(this,nn))==null||r.call(this),ce(this,nn,t(this.setOnline.bind(this)))}setOnline(t){C(this,qa)!==t&&(ce(this,qa,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return C(this,qa)}},qa=new WeakMap,nn=new WeakMap,Wa=new WeakMap,kg),yc=new Ej;function Mj(e){return Math.min(1e3*2**e,3e4)}function Jp(e){return(e??"online")==="online"?yc.isOnline():!0}var Yu=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Xp(e){let t=!1,r=0,n;const a=Gu(),i=()=>a.status!=="pending",l=g=>{var y;if(!i()){const b=new Yu(g);p(b),(y=e.onCancel)==null||y.call(e,b)}},o=()=>{t=!0},c=()=>{t=!1},d=()=>jh.isFocused()&&(e.networkMode==="always"||yc.isOnline())&&e.canRun(),m=()=>Jp(e.networkMode)&&e.canRun(),h=g=>{i()||(n==null||n(),a.resolve(g))},p=g=>{i()||(n==null||n(),a.reject(g))},j=()=>new Promise(g=>{var y;n=b=>{(i()||d())&&g(b)},(y=e.onPause)==null||y.call(e)}).then(()=>{var g;n=void 0,i()||(g=e.onContinue)==null||g.call(e)}),f=()=>{if(i())return;let g;const y=r===0?e.initialPromise:void 0;try{g=y??e.fn()}catch(b){g=Promise.reject(b)}Promise.resolve(g).then(h).catch(b=>{var _;if(i())return;const x=e.retry??(ua?0:3),v=e.retryDelay??Mj,w=typeof v=="function"?v(r,b):v,N=x===!0||typeof x=="number"&&r<x||typeof x=="function"&&x(r,b);if(t||!N){p(b);return}r++,(_=e.onFail)==null||_.call(e,r,b),wj(w).then(()=>d()?void 0:j()).then(()=>{t?p(b):f()})})};return{promise:a,status:()=>a.status,cancel:l,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:c,canStart:m,start:()=>(m()?f():j().then(f),a)}}var Gn,Sg,Zp=(Sg=class{constructor(){Se(this,Gn)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ku(this.gcTime)&&ce(this,Gn,Wn.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ua?1/0:5*60*1e3))}clearGcTimeout(){C(this,Gn)&&(Wn.clearTimeout(C(this,Gn)),ce(this,Gn,void 0))}},Gn=new WeakMap,Sg),Yn,Ka,Ps,Jn,Lt,Rl,Xn,Ws,wr,Cg,Tj=(Cg=class extends Zp{constructor(t){super();Se(this,Ws);Se(this,Yn);Se(this,Ka);Se(this,Ps);Se(this,Jn);Se(this,Lt);Se(this,Rl);Se(this,Xn);ce(this,Xn,!1),ce(this,Rl,t.defaultOptions),this.setOptions(t.options),this.observers=[],ce(this,Jn,t.client),ce(this,Ps,C(this,Jn).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ce(this,Yn,cf(this.options)),this.state=t.state??C(this,Yn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=C(this,Lt))==null?void 0:t.promise}setOptions(t){if(this.options={...C(this,Rl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=cf(this.options);r.data!==void 0&&(this.setState(of(r.data,r.dataUpdatedAt)),ce(this,Yn,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&C(this,Ps).remove(this)}setData(t,r){const n=Vu(this.state.data,t,this.options);return Ue(this,Ws,wr).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Ue(this,Ws,wr).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=C(this,Lt))==null?void 0:n.promise;return(a=C(this,Lt))==null||a.cancel(t),r?r.then(ls).catch(ls):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(C(this,Yn))}isActive(){return this.observers.some(t=>$s(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===vh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Sn(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Qp(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=C(this,Lt))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=C(this,Lt))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),C(this,Ps).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(C(this,Lt)&&(C(this,Xn)?C(this,Lt).cancel({revert:!0}):C(this,Lt).cancelRetry()),this.scheduleGc()),C(this,Ps).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ue(this,Ws,wr).call(this,{type:"invalidate"})}async fetch(t,r){var c,d,m,h,p,j,f,g,y,b,x,v;if(this.state.fetchStatus!=="idle"&&((c=C(this,Lt))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(C(this,Lt))return C(this,Lt).continueRetry(),C(this,Lt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(N=>N.options.queryFn);w&&this.setOptions(w.options)}const n=new AbortController,a=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(ce(this,Xn,!0),n.signal)})},i=()=>{const w=Gp(this.options,r),_=(()=>{const F={client:C(this,Jn),queryKey:this.queryKey,meta:this.meta};return a(F),F})();return ce(this,Xn,!1),this.options.persister?this.options.persister(w,_,this):w(_)},o=(()=>{const w={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:C(this,Jn),state:this.state,fetchFn:i};return a(w),w})();(d=this.options.behavior)==null||d.onFetch(o,this),ce(this,Ka,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=o.fetchOptions)==null?void 0:m.meta))&&Ue(this,Ws,wr).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),ce(this,Lt,Xp({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:w=>{w instanceof Yu&&w.revert&&this.setState({...C(this,Ka),fetchStatus:"idle"}),n.abort()},onFail:(w,N)=>{Ue(this,Ws,wr).call(this,{type:"failed",failureCount:w,error:N})},onPause:()=>{Ue(this,Ws,wr).call(this,{type:"pause"})},onContinue:()=>{Ue(this,Ws,wr).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const w=await C(this,Lt).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(j=(p=C(this,Ps).config).onSuccess)==null||j.call(p,w,this),(g=(f=C(this,Ps).config).onSettled)==null||g.call(f,w,this.state.error,this),w}catch(w){if(w instanceof Yu){if(w.silent)return C(this,Lt).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw Ue(this,Ws,wr).call(this,{type:"error",error:w}),(b=(y=C(this,Ps).config).onError)==null||b.call(y,w,this),(v=(x=C(this,Ps).config).onSettled)==null||v.call(x,this.state.data,w,this),w}finally{this.scheduleGc()}}},Yn=new WeakMap,Ka=new WeakMap,Ps=new WeakMap,Jn=new WeakMap,Lt=new WeakMap,Rl=new WeakMap,Xn=new WeakMap,Ws=new WeakSet,wr=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...ey(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,...of(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ce(this,Ka,t.manual?a:void 0),a;case"error":const i=t.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),At.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),C(this,Ps).notify({query:this,type:"updated",action:t})})},Cg);function ey(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Jp(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function of(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function cf(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var hs,Ve,Pl,ns,Zn,Qa,Sr,an,$l,Va,Ga,ea,ta,ln,Ya,Ze,Ki,Ju,Xu,Zu,em,tm,sm,rm,ty,_g,Aj=(_g=class extends bi{constructor(t,r){super();Se(this,Ze);Se(this,hs);Se(this,Ve);Se(this,Pl);Se(this,ns);Se(this,Zn);Se(this,Qa);Se(this,Sr);Se(this,an);Se(this,$l);Se(this,Va);Se(this,Ga);Se(this,ea);Se(this,ta);Se(this,ln);Se(this,Ya,new Set);this.options=r,ce(this,hs,t),ce(this,an,null),ce(this,Sr,Gu()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(C(this,Ve).addObserver(this),df(C(this,Ve),this.options)?Ue(this,Ze,Ki).call(this):this.updateResult(),Ue(this,Ze,em).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return nm(C(this,Ve),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return nm(C(this,Ve),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ue(this,Ze,tm).call(this),Ue(this,Ze,sm).call(this),C(this,Ve).removeObserver(this)}setOptions(t){const r=this.options,n=C(this,Ve);if(this.options=C(this,hs).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof $s(this.options.enabled,C(this,Ve))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ue(this,Ze,rm).call(this),C(this,Ve).setOptions(this.options),r._defaulted&&!pc(this.options,r)&&C(this,hs).getQueryCache().notify({type:"observerOptionsUpdated",query:C(this,Ve),observer:this});const a=this.hasListeners();a&&uf(C(this,Ve),n,this.options,r)&&Ue(this,Ze,Ki).call(this),this.updateResult(),a&&(C(this,Ve)!==n||$s(this.options.enabled,C(this,Ve))!==$s(r.enabled,C(this,Ve))||Sn(this.options.staleTime,C(this,Ve))!==Sn(r.staleTime,C(this,Ve)))&&Ue(this,Ze,Ju).call(this);const i=Ue(this,Ze,Xu).call(this);a&&(C(this,Ve)!==n||$s(this.options.enabled,C(this,Ve))!==$s(r.enabled,C(this,Ve))||i!==C(this,ln))&&Ue(this,Ze,Zu).call(this,i)}getOptimisticResult(t){const r=C(this,hs).getQueryCache().build(C(this,hs),t),n=this.createResult(r,t);return Pj(this,n)&&(ce(this,ns,n),ce(this,Qa,this.options),ce(this,Zn,C(this,Ve).state)),n}getCurrentResult(){return C(this,ns)}trackResult(t,r){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&C(this,Sr).status==="pending"&&C(this,Sr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(t){C(this,Ya).add(t)}getCurrentQuery(){return C(this,Ve)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=C(this,hs).defaultQueryOptions(t),n=C(this,hs).getQueryCache().build(C(this,hs),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Ue(this,Ze,Ki).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),C(this,ns)))}createResult(t,r){var J;const n=C(this,Ve),a=this.options,i=C(this,ns),l=C(this,Zn),o=C(this,Qa),d=t!==n?t.state:C(this,Pl),{state:m}=t;let h={...m},p=!1,j;if(r._optimisticResults){const q=this.hasListeners(),K=!q&&df(t,r),ne=q&&uf(t,n,r,a);(K||ne)&&(h={...h,...ey(m.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:f,errorUpdatedAt:g,status:y}=h;j=h.data;let b=!1;if(r.placeholderData!==void 0&&j===void 0&&y==="pending"){let q;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(q=i.data,b=!0):q=typeof r.placeholderData=="function"?r.placeholderData((J=C(this,Ga))==null?void 0:J.state.data,C(this,Ga)):r.placeholderData,q!==void 0&&(y="success",j=Vu(i==null?void 0:i.data,q,r),p=!0)}if(r.select&&j!==void 0&&!b)if(i&&j===(l==null?void 0:l.data)&&r.select===C(this,$l))j=C(this,Va);else try{ce(this,$l,r.select),j=r.select(j),j=Vu(i==null?void 0:i.data,j,r),ce(this,Va,j),ce(this,an,null)}catch(q){ce(this,an,q)}C(this,an)&&(f=C(this,an),j=C(this,Va),g=Date.now(),y="error");const x=h.fetchStatus==="fetching",v=y==="pending",w=y==="error",N=v&&x,_=j!==void 0,R={status:y,fetchStatus:h.fetchStatus,isPending:v,isSuccess:y==="success",isError:w,isInitialLoading:N,isLoading:N,data:j,dataUpdatedAt:h.dataUpdatedAt,error:f,errorUpdatedAt:g,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:x,isRefetching:x&&!v,isLoadingError:w&&!_,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&_,isStale:wh(t,r),refetch:this.refetch,promise:C(this,Sr),isEnabled:$s(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const q=re=>{R.status==="error"?re.reject(R.error):R.data!==void 0&&re.resolve(R.data)},K=()=>{const re=ce(this,Sr,R.promise=Gu());q(re)},ne=C(this,Sr);switch(ne.status){case"pending":t.queryHash===n.queryHash&&q(ne);break;case"fulfilled":(R.status==="error"||R.data!==ne.value)&&K();break;case"rejected":(R.status!=="error"||R.error!==ne.reason)&&K();break}}return R}updateResult(){const t=C(this,ns),r=this.createResult(C(this,Ve),this.options);if(ce(this,Zn,C(this,Ve).state),ce(this,Qa,this.options),C(this,Zn).data!==void 0&&ce(this,Ga,C(this,Ve)),pc(r,t))return;ce(this,ns,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!C(this,Ya).size)return!0;const l=new Set(i??C(this,Ya));return this.options.throwOnError&&l.add("error"),Object.keys(C(this,ns)).some(o=>{const c=o;return C(this,ns)[c]!==t[c]&&l.has(c)})};Ue(this,Ze,ty).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ue(this,Ze,em).call(this)}},hs=new WeakMap,Ve=new WeakMap,Pl=new WeakMap,ns=new WeakMap,Zn=new WeakMap,Qa=new WeakMap,Sr=new WeakMap,an=new WeakMap,$l=new WeakMap,Va=new WeakMap,Ga=new WeakMap,ea=new WeakMap,ta=new WeakMap,ln=new WeakMap,Ya=new WeakMap,Ze=new WeakSet,Ki=function(t){Ue(this,Ze,rm).call(this);let r=C(this,Ve).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(ls)),r},Ju=function(){Ue(this,Ze,tm).call(this);const t=Sn(this.options.staleTime,C(this,Ve));if(ua||C(this,ns).isStale||!Ku(t))return;const n=Qp(C(this,ns).dataUpdatedAt,t)+1;ce(this,ea,Wn.setTimeout(()=>{C(this,ns).isStale||this.updateResult()},n))},Xu=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(C(this,Ve)):this.options.refetchInterval)??!1},Zu=function(t){Ue(this,Ze,sm).call(this),ce(this,ln,t),!(ua||$s(this.options.enabled,C(this,Ve))===!1||!Ku(C(this,ln))||C(this,ln)===0)&&ce(this,ta,Wn.setInterval(()=>{(this.options.refetchIntervalInBackground||jh.isFocused())&&Ue(this,Ze,Ki).call(this)},C(this,ln)))},em=function(){Ue(this,Ze,Ju).call(this),Ue(this,Ze,Zu).call(this,Ue(this,Ze,Xu).call(this))},tm=function(){C(this,ea)&&(Wn.clearTimeout(C(this,ea)),ce(this,ea,void 0))},sm=function(){C(this,ta)&&(Wn.clearInterval(C(this,ta)),ce(this,ta,void 0))},rm=function(){const t=C(this,hs).getQueryCache().build(C(this,hs),this.options);if(t===C(this,Ve))return;const r=C(this,Ve);ce(this,Ve,t),ce(this,Pl,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},ty=function(t){At.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(C(this,ns))}),C(this,hs).getQueryCache().notify({query:C(this,Ve),type:"observerResultsUpdated"})})},_g);function Rj(e,t){return $s(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function df(e,t){return Rj(e,t)||e.state.data!==void 0&&nm(e,t,t.refetchOnMount)}function nm(e,t,r){if($s(t.enabled,e)!==!1&&Sn(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&wh(e,t)}return!1}function uf(e,t,r,n){return(e!==t||$s(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&wh(e,r)}function wh(e,t){return $s(t.enabled,e)!==!1&&e.isStaleByTime(Sn(t.staleTime,e))}function Pj(e,t){return!pc(e.getCurrentResult(),t)}function mf(e){return{onFetch:(t,r)=>{var m,h,p,j,f;const n=t.options,a=(p=(h=(m=t.fetchOptions)==null?void 0:m.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,i=((j=t.state.data)==null?void 0:j.pages)||[],l=((f=t.state.data)==null?void 0:f.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const d=async()=>{let g=!1;const y=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},b=Gp(t.options,t.fetchOptions),x=async(v,w,N)=>{if(g)return Promise.reject();if(w==null&&v.pages.length)return Promise.resolve(v);const F=(()=>{const K={client:t.client,queryKey:t.queryKey,pageParam:w,direction:N?"backward":"forward",meta:t.options.meta};return y(K),K})(),R=await b(F),{maxPages:J}=t.options,q=N?kj:Nj;return{pages:q(v.pages,R,J),pageParams:q(v.pageParams,w,J)}};if(a&&i.length){const v=a==="backward",w=v?$j:hf,N={pages:i,pageParams:l},_=w(n,N);o=await x(N,_,v)}else{const v=e??i.length;do{const w=c===0?l[0]??n.initialPageParam:hf(n,o);if(c>0&&w==null)break;o=await x(o,w),c++}while(c<v)}return o};t.options.persister?t.fetchFn=()=>{var g,y;return(y=(g=t.options).persister)==null?void 0:y.call(g,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function hf(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function $j(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Ll,cr,as,sa,dr,Yr,Eg,Lj=(Eg=class extends Zp{constructor(t){super();Se(this,dr);Se(this,Ll);Se(this,cr);Se(this,as);Se(this,sa);ce(this,Ll,t.client),this.mutationId=t.mutationId,ce(this,as,t.mutationCache),ce(this,cr,[]),this.state=t.state||sy(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){C(this,cr).includes(t)||(C(this,cr).push(t),this.clearGcTimeout(),C(this,as).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ce(this,cr,C(this,cr).filter(r=>r!==t)),this.scheduleGc(),C(this,as).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){C(this,cr).length||(this.state.status==="pending"?this.scheduleGc():C(this,as).remove(this))}continue(){var t;return((t=C(this,sa))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,c,d,m,h,p,j,f,g,y,b,x,v,w,N,_,F,R,J;const r=()=>{Ue(this,dr,Yr).call(this,{type:"continue"})},n={client:C(this,Ll),meta:this.options.meta,mutationKey:this.options.mutationKey};ce(this,sa,Xp({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(q,K)=>{Ue(this,dr,Yr).call(this,{type:"failed",failureCount:q,error:K})},onPause:()=>{Ue(this,dr,Yr).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>C(this,as).canRun(this)}));const a=this.state.status==="pending",i=!C(this,sa).canStart();try{if(a)r();else{Ue(this,dr,Yr).call(this,{type:"pending",variables:t,isPaused:i}),await((o=(l=C(this,as).config).onMutate)==null?void 0:o.call(l,t,this,n));const K=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,n));K!==this.state.context&&Ue(this,dr,Yr).call(this,{type:"pending",context:K,variables:t,isPaused:i})}const q=await C(this,sa).start();return await((h=(m=C(this,as).config).onSuccess)==null?void 0:h.call(m,q,t,this.state.context,this,n)),await((j=(p=this.options).onSuccess)==null?void 0:j.call(p,q,t,this.state.context,n)),await((g=(f=C(this,as).config).onSettled)==null?void 0:g.call(f,q,null,this.state.variables,this.state.context,this,n)),await((b=(y=this.options).onSettled)==null?void 0:b.call(y,q,null,t,this.state.context,n)),Ue(this,dr,Yr).call(this,{type:"success",data:q}),q}catch(q){try{throw await((v=(x=C(this,as).config).onError)==null?void 0:v.call(x,q,t,this.state.context,this,n)),await((N=(w=this.options).onError)==null?void 0:N.call(w,q,t,this.state.context,n)),await((F=(_=C(this,as).config).onSettled)==null?void 0:F.call(_,void 0,q,this.state.variables,this.state.context,this,n)),await((J=(R=this.options).onSettled)==null?void 0:J.call(R,void 0,q,t,this.state.context,n)),q}finally{Ue(this,dr,Yr).call(this,{type:"error",error:q})}}finally{C(this,as).runNext(this)}}},Ll=new WeakMap,cr=new WeakMap,as=new WeakMap,sa=new WeakMap,dr=new WeakSet,Yr=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),At.batch(()=>{C(this,cr).forEach(n=>{n.onMutationUpdate(t)}),C(this,as).notify({mutation:this,type:"updated",action:t})})},Eg);function sy(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Cr,Ks,Fl,Mg,Fj=(Mg=class extends bi{constructor(t={}){super();Se(this,Cr);Se(this,Ks);Se(this,Fl);this.config=t,ce(this,Cr,new Set),ce(this,Ks,new Map),ce(this,Fl,0)}build(t,r,n){const a=new Lj({client:t,mutationCache:this,mutationId:++eo(this,Fl)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){C(this,Cr).add(t);const r=bo(t);if(typeof r=="string"){const n=C(this,Ks).get(r);n?n.push(t):C(this,Ks).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(C(this,Cr).delete(t)){const r=bo(t);if(typeof r=="string"){const n=C(this,Ks).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&C(this,Ks).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=bo(t);if(typeof r=="string"){const n=C(this,Ks).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=bo(t);if(typeof r=="string"){const a=(n=C(this,Ks).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){At.batch(()=>{C(this,Cr).forEach(t=>{this.notify({type:"removed",mutation:t})}),C(this,Cr).clear(),C(this,Ks).clear()})}getAll(){return Array.from(C(this,Cr))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>nf(r,n))}findAll(t={}){return this.getAll().filter(r=>nf(t,r))}notify(t){At.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return At.batch(()=>Promise.all(t.map(r=>r.continue().catch(ls))))}},Cr=new WeakMap,Ks=new WeakMap,Fl=new WeakMap,Mg);function bo(e){var t;return(t=e.options.scope)==null?void 0:t.id}var _r,on,fs,Er,Fr,zo,am,Tg,Ij=(Tg=class extends bi{constructor(r,n){super();Se(this,Fr);Se(this,_r);Se(this,on);Se(this,fs);Se(this,Er);ce(this,_r,r),this.setOptions(n),this.bindMethods(),Ue(this,Fr,zo).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=C(this,_r).defaultMutationOptions(r),pc(this.options,n)||C(this,_r).getMutationCache().notify({type:"observerOptionsUpdated",mutation:C(this,fs),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&ma(n.mutationKey)!==ma(this.options.mutationKey)?this.reset():((a=C(this,fs))==null?void 0:a.state.status)==="pending"&&C(this,fs).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=C(this,fs))==null||r.removeObserver(this)}onMutationUpdate(r){Ue(this,Fr,zo).call(this),Ue(this,Fr,am).call(this,r)}getCurrentResult(){return C(this,on)}reset(){var r;(r=C(this,fs))==null||r.removeObserver(this),ce(this,fs,void 0),Ue(this,Fr,zo).call(this),Ue(this,Fr,am).call(this)}mutate(r,n){var a;return ce(this,Er,n),(a=C(this,fs))==null||a.removeObserver(this),ce(this,fs,C(this,_r).getMutationCache().build(C(this,_r),this.options)),C(this,fs).addObserver(this),C(this,fs).execute(r)}},_r=new WeakMap,on=new WeakMap,fs=new WeakMap,Er=new WeakMap,Fr=new WeakSet,zo=function(){var n;const r=((n=C(this,fs))==null?void 0:n.state)??sy();ce(this,on,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},am=function(r){At.batch(()=>{var n,a,i,l,o,c,d,m;if(C(this,Er)&&this.hasListeners()){const h=C(this,on).variables,p=C(this,on).context,j={client:C(this,_r),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((a=(n=C(this,Er)).onSuccess)==null||a.call(n,r.data,h,p,j),(l=(i=C(this,Er)).onSettled)==null||l.call(i,r.data,null,h,p,j)):(r==null?void 0:r.type)==="error"&&((c=(o=C(this,Er)).onError)==null||c.call(o,r.error,h,p,j),(m=(d=C(this,Er)).onSettled)==null||m.call(d,void 0,r.error,h,p,j))}this.listeners.forEach(h=>{h(C(this,on))})})},Tg),ur,Ag,Oj=(Ag=class extends bi{constructor(t={}){super();Se(this,ur);this.config=t,ce(this,ur,new Map)}build(t,r,n){const a=r.queryKey,i=r.queryHash??bh(a,r);let l=this.get(i);return l||(l=new Tj({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(l)),l}add(t){C(this,ur).has(t.queryHash)||(C(this,ur).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=C(this,ur).get(t.queryHash);r&&(t.destroy(),r===t&&C(this,ur).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){At.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return C(this,ur).get(t)}getAll(){return[...C(this,ur).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>rf(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>rf(t,n)):r}notify(t){At.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){At.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){At.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ur=new WeakMap,Ag),bt,cn,dn,Ja,Xa,un,Za,ei,Rg,Dj=(Rg=class{constructor(e={}){Se(this,bt);Se(this,cn);Se(this,dn);Se(this,Ja);Se(this,Xa);Se(this,un);Se(this,Za);Se(this,ei);ce(this,bt,e.queryCache||new Oj),ce(this,cn,e.mutationCache||new Fj),ce(this,dn,e.defaultOptions||{}),ce(this,Ja,new Map),ce(this,Xa,new Map),ce(this,un,0)}mount(){eo(this,un)._++,C(this,un)===1&&(ce(this,Za,jh.subscribe(async e=>{e&&(await this.resumePausedMutations(),C(this,bt).onFocus())})),ce(this,ei,yc.subscribe(async e=>{e&&(await this.resumePausedMutations(),C(this,bt).onOnline())})))}unmount(){var e,t;eo(this,un)._--,C(this,un)===0&&((e=C(this,Za))==null||e.call(this),ce(this,Za,void 0),(t=C(this,ei))==null||t.call(this),ce(this,ei,void 0))}isFetching(e){return C(this,bt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return C(this,cn).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=C(this,bt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=C(this,bt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Sn(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return C(this,bt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=C(this,bt).get(n.queryHash),i=a==null?void 0:a.state.data,l=vj(t,i);if(l!==void 0)return C(this,bt).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return At.batch(()=>C(this,bt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=C(this,bt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=C(this,bt);At.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=C(this,bt);return At.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=At.batch(()=>C(this,bt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(ls).catch(ls)}invalidateQueries(e,t={}){return At.batch(()=>(C(this,bt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=At.batch(()=>C(this,bt).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(ls)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(ls)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=C(this,bt).build(this,t);return r.isStaleByTime(Sn(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ls).catch(ls)}fetchInfiniteQuery(e){return e.behavior=mf(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ls).catch(ls)}ensureInfiniteQueryData(e){return e.behavior=mf(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return yc.isOnline()?C(this,cn).resumePausedMutations():Promise.resolve()}getQueryCache(){return C(this,bt)}getMutationCache(){return C(this,cn)}getDefaultOptions(){return C(this,dn)}setDefaultOptions(e){ce(this,dn,e)}setQueryDefaults(e,t){C(this,Ja).set(ma(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...C(this,Ja).values()],r={};return t.forEach(n=>{Cl(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){C(this,Xa).set(ma(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...C(this,Xa).values()],r={};return t.forEach(n=>{Cl(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...C(this,dn).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=bh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===vh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...C(this,dn).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){C(this,bt).clear(),C(this,cn).clear()}},bt=new WeakMap,cn=new WeakMap,dn=new WeakMap,Ja=new WeakMap,Xa=new WeakMap,un=new WeakMap,Za=new WeakMap,ei=new WeakMap,Rg),ry=u.createContext(void 0),mt=e=>{const t=u.useContext(ry);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},zj=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(ry.Provider,{value:e,children:t})),ny=u.createContext(!1),Uj=()=>u.useContext(ny);ny.Provider;function Hj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Bj=u.createContext(Hj()),qj=()=>u.useContext(Bj),Wj=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Kj=e=>{u.useEffect(()=>{e.clearReset()},[e])},Qj=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||Yp(r,[e.error,n])),Vj=e=>{if(e.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Gj=(e,t)=>e.isLoading&&e.isFetching&&!t,Yj=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,ff=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function Jj(e,t,r){var h,p,j,f,g;const n=Uj(),a=qj(),i=mt(),l=i.defaultQueryOptions(e);(p=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,l),l._optimisticResults=n?"isRestoring":"optimistic",Vj(l),Wj(l,a),Kj(a);const o=!i.getQueryCache().get(l.queryHash),[c]=u.useState(()=>new t(i,l)),d=c.getOptimisticResult(l),m=!n&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(y=>{const b=m?c.subscribe(At.batchCalls(y)):ls;return c.updateResult(),b},[c,m]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(l)},[l,c]),Yj(l,d))throw ff(l,c,a);if(Qj({result:d,errorResetBoundary:a,throwOnError:l.throwOnError,query:i.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw d.error;if((f=(j=i.getDefaultOptions().queries)==null?void 0:j._experimental_afterQuery)==null||f.call(j,l,d),l.experimental_prefetchInRender&&!ua&&Gj(d,n)){const y=o?ff(l,c,a):(g=i.getQueryCache().get(l.queryHash))==null?void 0:g.promise;y==null||y.catch(ls).finally(()=>{c.updateResult()})}return l.notifyOnChangeProps?d:c.trackResult(d)}function he(e,t){return Jj(e,Aj)}function Ce(e,t){const r=mt(),[n]=u.useState(()=>new Ij(r,e));u.useEffect(()=>{n.setOptions(e)},[n,e]);const a=u.useSyncExternalStore(u.useCallback(l=>n.subscribe(At.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=u.useCallback((l,o)=>{n.mutate(l,o).catch(ls)},[n]);if(a.error&&Yp(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _l(){return _l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_l.apply(this,arguments)}var fn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(fn||(fn={}));const gf="popstate";function Xj(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:l,hash:o}=n.location;return im("",{pathname:i,search:l,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:bc(a)}return e1(t,r,null,e)}function wt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Nh(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Zj(){return Math.random().toString(36).substr(2,8)}function xf(e,t){return{usr:e.state,key:e.key,idx:t}}function im(e,t,r,n){return r===void 0&&(r=null),_l({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?vi(t):t,{state:r,key:t&&t.key||n||Zj()})}function bc(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function vi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function e1(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,l=a.history,o=fn.Pop,c=null,d=m();d==null&&(d=0,l.replaceState(_l({},l.state,{idx:d}),""));function m(){return(l.state||{idx:null}).idx}function h(){o=fn.Pop;let y=m(),b=y==null?null:y-d;d=y,c&&c({action:o,location:g.location,delta:b})}function p(y,b){o=fn.Push;let x=im(g.location,y,b);d=m()+1;let v=xf(x,d),w=g.createHref(x);try{l.pushState(v,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;a.location.assign(w)}i&&c&&c({action:o,location:g.location,delta:1})}function j(y,b){o=fn.Replace;let x=im(g.location,y,b);d=m();let v=xf(x,d),w=g.createHref(x);l.replaceState(v,"",w),i&&c&&c({action:o,location:g.location,delta:0})}function f(y){let b=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof y=="string"?y:bc(y);return x=x.replace(/ $/,"%20"),wt(b,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,b)}let g={get action(){return o},get location(){return e(a,l)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(gf,h),c=y,()=>{a.removeEventListener(gf,h),c=null}},createHref(y){return t(a,y)},createURL:f,encodeLocation(y){let b=f(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:j,go(y){return l.go(y)}};return g}var pf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(pf||(pf={}));function t1(e,t,r){return r===void 0&&(r="/"),s1(e,t,r)}function s1(e,t,r,n){let a=typeof t=="string"?vi(t):t,i=kh(a.pathname||"/",r);if(i==null)return null;let l=ay(e);r1(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=g1(i);o=m1(l[c],d)}return o}function ay(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(wt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Cn([n,c.relativePath]),m=r.concat(c);i.children&&i.children.length>0&&(wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),ay(i.children,t,m,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:d1(d,i.index),routesMeta:m})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,l);else for(let c of iy(i.path))a(i,l,c)}),t}function iy(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let l=iy(n.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function r1(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:u1(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const n1=/^:[\w-]+$/,a1=3,i1=2,l1=1,o1=10,c1=-2,yf=e=>e==="*";function d1(e,t){let r=e.split("/"),n=r.length;return r.some(yf)&&(n+=c1),t&&(n+=i1),r.filter(a=>!yf(a)).reduce((a,i)=>a+(n1.test(i)?a1:i===""?l1:o1),n)}function u1(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function m1(e,t,r){let{routesMeta:n}=e,a={},i="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,m=i==="/"?t:t.slice(i.length)||"/",h=h1({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},m),p=c.route;if(!h)return null;Object.assign(a,h.params),l.push({params:a,pathname:Cn([i,h.pathname]),pathnameBase:v1(Cn([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=Cn([i,h.pathnameBase]))}return l}function h1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=f1(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((d,m,h)=>{let{paramName:p,isOptional:j}=m;if(p==="*"){let g=o[h]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const f=o[h];return j&&!f?d[p]=void 0:d[p]=(f||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function f1(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Nh(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function g1(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Nh(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function kh(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const x1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,p1=e=>x1.test(e);function y1(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?vi(e):e,i;if(r)if(p1(r))i=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),Nh(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?i=bf(r.substring(1),"/"):i=bf(r,t)}else i=t;return{pathname:i,search:j1(n),hash:w1(a)}}function bf(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Pd(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function b1(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Sh(e,t){let r=b1(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Ch(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=vi(e):(a=_l({},e),wt(!a.pathname||!a.pathname.includes("?"),Pd("?","pathname","search",a)),wt(!a.pathname||!a.pathname.includes("#"),Pd("#","pathname","hash",a)),wt(!a.search||!a.search.includes("#"),Pd("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!n&&l.startsWith("..")){let p=l.split("/");for(;p[0]==="..";)p.shift(),h-=1;a.pathname=p.join("/")}o=h>=0?t[h]:"/"}let c=y1(a,o),d=l&&l!=="/"&&l.endsWith("/"),m=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||m)&&(c.pathname+="/"),c}const Cn=e=>e.join("/").replace(/\/\/+/g,"/"),v1=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),j1=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,w1=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function N1(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ly=["post","put","patch","delete"];new Set(ly);const k1=["get",...ly];new Set(k1);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function El(){return El=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},El.apply(this,arguments)}const _h=u.createContext(null),S1=u.createContext(null),Pn=u.createContext(null),Bc=u.createContext(null),pr=u.createContext({outlet:null,matches:[],isDataRoute:!1}),oy=u.createContext(null);function C1(e,t){let{relative:r}=t===void 0?{}:t;ji()||wt(!1);let{basename:n,navigator:a}=u.useContext(Pn),{hash:i,pathname:l,search:o}=uy(e,{relative:r}),c=l;return n!=="/"&&(c=l==="/"?n:Cn([n,l])),a.createHref({pathname:c,search:o,hash:i})}function ji(){return u.useContext(Bc)!=null}function $n(){return ji()||wt(!1),u.useContext(Bc).location}function cy(e){u.useContext(Pn).static||u.useLayoutEffect(e)}function yr(){let{isDataRoute:e}=u.useContext(pr);return e?U1():_1()}function _1(){ji()||wt(!1);let e=u.useContext(_h),{basename:t,future:r,navigator:n}=u.useContext(Pn),{matches:a}=u.useContext(pr),{pathname:i}=$n(),l=JSON.stringify(Sh(a,r.v7_relativeSplatPath)),o=u.useRef(!1);return cy(()=>{o.current=!0}),u.useCallback(function(d,m){if(m===void 0&&(m={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let h=Ch(d,JSON.parse(l),i,m.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Cn([t,h.pathname])),(m.replace?n.replace:n.push)(h,m.state,m)},[t,n,l,i,e])}const E1=u.createContext(null);function M1(e){let t=u.useContext(pr).outlet;return t&&u.createElement(E1.Provider,{value:e},t)}function dy(){let{matches:e}=u.useContext(pr),t=e[e.length-1];return t?t.params:{}}function uy(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=u.useContext(Pn),{matches:a}=u.useContext(pr),{pathname:i}=$n(),l=JSON.stringify(Sh(a,n.v7_relativeSplatPath));return u.useMemo(()=>Ch(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function T1(e,t){return A1(e,t)}function A1(e,t,r,n){ji()||wt(!1);let{navigator:a}=u.useContext(Pn),{matches:i}=u.useContext(pr),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=$n(),m;if(t){var h;let y=typeof t=="string"?vi(t):t;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||wt(!1),m=y}else m=d;let p=m.pathname||"/",j=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");j="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let f=t1(e,{pathname:j}),g=F1(f&&f.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Cn([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Cn([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return t&&g?u.createElement(Bc.Provider,{value:{location:El({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:fn.Pop}},g):g}function R1(){let e=z1(),t=N1(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},t),r?u.createElement("pre",{style:a},r):null,null)}const P1=u.createElement(R1,null);class $1 extends u.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?u.createElement(pr.Provider,{value:this.props.routeContext},u.createElement(oy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function L1(e){let{routeContext:t,match:r,children:n}=e,a=u.useContext(_h);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),u.createElement(pr.Provider,{value:t},n)}function F1(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let m=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);m>=0||wt(!1),l=l.slice(0,Math.min(l.length,m+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let m=0;m<l.length;m++){let h=l[m];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=m),h.route.id){let{loaderData:p,errors:j}=r,f=h.route.loader&&p[h.route.id]===void 0&&(!j||j[h.route.id]===void 0);if(h.route.lazy||f){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((m,h,p)=>{let j,f=!1,g=null,y=null;r&&(j=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||P1,c&&(d<0&&p===0?(H1("route-fallback"),f=!0,y=null):d===p&&(f=!0,y=h.route.hydrateFallbackElement||null)));let b=t.concat(l.slice(0,p+1)),x=()=>{let v;return j?v=g:f?v=y:h.route.Component?v=u.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=m,u.createElement(L1,{match:h,routeContext:{outlet:m,matches:b,isDataRoute:r!=null},children:v})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?u.createElement($1,{location:r.location,revalidation:r.revalidation,component:g,error:j,children:x(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):x()},null)}var my=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(my||{}),hy=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(hy||{});function I1(e){let t=u.useContext(_h);return t||wt(!1),t}function O1(e){let t=u.useContext(S1);return t||wt(!1),t}function D1(e){let t=u.useContext(pr);return t||wt(!1),t}function fy(e){let t=D1(),r=t.matches[t.matches.length-1];return r.route.id||wt(!1),r.route.id}function z1(){var e;let t=u.useContext(oy),r=O1(),n=fy();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function U1(){let{router:e}=I1(my.UseNavigateStable),t=fy(hy.UseNavigateStable),r=u.useRef(!1);return cy(()=>{r.current=!0}),u.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,El({fromRouteId:t},i)))},[e,t])}const vf={};function H1(e,t,r){vf[e]||(vf[e]=!0)}function B1(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function gy(e){let{to:t,replace:r,state:n,relative:a}=e;ji()||wt(!1);let{future:i,static:l}=u.useContext(Pn),{matches:o}=u.useContext(pr),{pathname:c}=$n(),d=yr(),m=Ch(t,Sh(o,i.v7_relativeSplatPath),c,a==="path"),h=JSON.stringify(m);return u.useEffect(()=>d(JSON.parse(h),{replace:r,state:n,relative:a}),[d,h,a,r,n]),null}function q1(e){return M1(e.context)}function Xe(e){wt(!1)}function W1(e){let{basename:t="/",children:r=null,location:n,navigationType:a=fn.Pop,navigator:i,static:l=!1,future:o}=e;ji()&&wt(!1);let c=t.replace(/^\/*/,"/"),d=u.useMemo(()=>({basename:c,navigator:i,static:l,future:El({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof n=="string"&&(n=vi(n));let{pathname:m="/",search:h="",hash:p="",state:j=null,key:f="default"}=n,g=u.useMemo(()=>{let y=kh(m,c);return y==null?null:{location:{pathname:y,search:h,hash:p,state:j,key:f},navigationType:a}},[c,m,h,p,j,f,a]);return g==null?null:u.createElement(Pn.Provider,{value:d},u.createElement(Bc.Provider,{children:r,value:g}))}function K1(e){let{children:t,location:r}=e;return T1(lm(t),r)}new Promise(()=>{});function lm(e,t){t===void 0&&(t=[]);let r=[];return u.Children.forEach(e,(n,a)=>{if(!u.isValidElement(n))return;let i=[...t,a];if(n.type===u.Fragment){r.push.apply(r,lm(n.props.children,i));return}n.type!==Xe&&wt(!1),!n.props.index||!n.props.children||wt(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=lm(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function om(){return om=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},om.apply(this,arguments)}function Q1(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function V1(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function G1(e,t){return e.button===0&&(!t||t==="_self")&&!V1(e)}function cm(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function Y1(e,t){let r=cm(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const J1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],X1="6";try{window.__reactRouterVersion=X1}catch{}const Z1="startTransition",jf=ti[Z1];function ew(e){let{basename:t,children:r,future:n,window:a}=e,i=u.useRef();i.current==null&&(i.current=Xj({window:a,v5Compat:!0}));let l=i.current,[o,c]=u.useState({action:l.action,location:l.location}),{v7_startTransition:d}=n||{},m=u.useCallback(h=>{d&&jf?jf(()=>c(h)):c(h)},[c,d]);return u.useLayoutEffect(()=>l.listen(m),[l,m]),u.useEffect(()=>B1(n),[n]),u.createElement(W1,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const tw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",sw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lt=u.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:m,viewTransition:h}=t,p=Q1(t,J1),{basename:j}=u.useContext(Pn),f,g=!1;if(typeof d=="string"&&sw.test(d)&&(f=d,tw))try{let v=new URL(window.location.href),w=d.startsWith("//")?new URL(v.protocol+d):new URL(d),N=kh(w.pathname,j);w.origin===v.origin&&N!=null?d=N+w.search+w.hash:g=!0}catch{}let y=C1(d,{relative:a}),b=rw(d,{replace:l,state:o,target:c,preventScrollReset:m,relative:a,viewTransition:h});function x(v){n&&n(v),v.defaultPrevented||b(v)}return u.createElement("a",om({},p,{href:f||y,onClick:g||i?n:x,ref:r,target:c}))});var wf;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(wf||(wf={}));var Nf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Nf||(Nf={}));function rw(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,c=yr(),d=$n(),m=uy(e,{relative:l});return u.useCallback(h=>{if(G1(h,r)){h.preventDefault();let p=n!==void 0?n:bc(d)===bc(m);c(e,{replace:p,state:a,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,m,n,a,r,e,i,l,o])}function Hl(e){let t=u.useRef(cm(e)),r=u.useRef(!1),n=$n(),a=u.useMemo(()=>Y1(n.search,r.current?null:t.current),[n.search]),i=yr(),l=u.useCallback((o,c)=>{const d=cm(typeof o=="function"?o(a):o);r.current=!0,i("?"+d,c)},[i,a]);return[a,l]}const nw={},kf=e=>{let t;const r=new Set,n=(m,h)=>{const p=typeof m=="function"?m(t):m;if(!Object.is(p,t)){const j=t;t=h??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(f=>f(t,j))}},a=()=>t,c={setState:n,getState:a,getInitialState:()=>d,subscribe:m=>(r.add(m),()=>r.delete(m)),destroy:()=>{(nw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=t=e(n,a,c);return c},aw=e=>e?kf(e):kf;var xy={exports:{}},py={},yy={exports:{}},by={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ci=u;function iw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var lw=typeof Object.is=="function"?Object.is:iw,ow=ci.useState,cw=ci.useEffect,dw=ci.useLayoutEffect,uw=ci.useDebugValue;function mw(e,t){var r=t(),n=ow({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return dw(function(){a.value=r,a.getSnapshot=t,$d(a)&&i({inst:a})},[e,r,t]),cw(function(){return $d(a)&&i({inst:a}),e(function(){$d(a)&&i({inst:a})})},[e]),uw(r),r}function $d(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!lw(e,r)}catch{return!0}}function hw(e,t){return t()}var fw=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?hw:mw;by.useSyncExternalStore=ci.useSyncExternalStore!==void 0?ci.useSyncExternalStore:fw;yy.exports=by;var gw=yy.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qc=u,xw=gw;function pw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yw=typeof Object.is=="function"?Object.is:pw,bw=xw.useSyncExternalStore,vw=qc.useRef,jw=qc.useEffect,ww=qc.useMemo,Nw=qc.useDebugValue;py.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=vw(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=ww(function(){function c(j){if(!d){if(d=!0,m=j,j=n(j),a!==void 0&&l.hasValue){var f=l.value;if(a(f,j))return h=f}return h=j}if(f=h,yw(m,j))return f;var g=n(j);return a!==void 0&&a(f,g)?(m=j,f):(m=j,h=g)}var d=!1,m,h,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,a]);var o=bw(e,i[0],i[1]);return jw(function(){l.hasValue=!0,l.value=o},[o]),Nw(o),o};xy.exports=py;var kw=xy.exports;const Sw=Pg(kw),vy={},{useDebugValue:Cw}=Le,{useSyncExternalStoreWithSelector:_w}=Sw;let Sf=!1;const Ew=e=>e;function Mw(e,t=Ew,r){(vy?"production":void 0)!=="production"&&r&&!Sf&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Sf=!0);const n=_w(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return Cw(n),n}const Tw=e=>{(vy?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?aw(e):e,r=(n,a)=>Mw(t,n,a);return Object.assign(r,t),r},Aw=e=>Tw,Rw={};function Pw(e,t){let r;try{r=e()}catch{return}return{getItem:a=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=r.getItem(a))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(a,i)=>r.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>r.removeItem(a)}}const Ml=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return Ml(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Ml(n)(r)}}}},$w=(e,t)=>(r,n,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,b)=>({...b,...y}),...t},l=!1;const o=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...y)},n,a);const m=Ml(i.serialize),h=()=>{const y=i.partialize({...n()});let b;const x=m({state:y,version:i.version}).then(v=>d.setItem(i.name,v)).catch(v=>{b=v});if(b)throw b;return x},p=a.setState;a.setState=(y,b)=>{p(y,b),h()};const j=e((...y)=>{r(...y),h()},n,a);let f;const g=()=>{var y;if(!d)return;l=!1,o.forEach(x=>x(n()));const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,n()))||void 0;return Ml(d.getItem.bind(d))(i.name).then(x=>{if(x)return i.deserialize(x)}).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==i.version){if(i.migrate)return i.migrate(x.state,x.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return x.state}).then(x=>{var v;return f=i.merge(x,(v=n())!=null?v:j),r(f,!0),h()}).then(()=>{b==null||b(f,void 0),l=!0,c.forEach(x=>x(f))}).catch(x=>{b==null||b(void 0,x)})};return a.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(d=y.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>l,onHydrate:y=>(o.add(y),()=>{o.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},g(),f||j},Lw=(e,t)=>(r,n,a)=>{let i={storage:Pw(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...t},l=!1;const o=new Set,c=new Set;let d=i.storage;if(!d)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...g)},n,a);const m=()=>{const g=i.partialize({...n()});return d.setItem(i.name,{state:g,version:i.version})},h=a.setState;a.setState=(g,y)=>{h(g,y),m()};const p=e((...g)=>{r(...g),m()},n,a);a.getInitialState=()=>p;let j;const f=()=>{var g,y;if(!d)return;l=!1,o.forEach(x=>{var v;return x((v=n())!=null?v:p)});const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(g=n())!=null?g:p))||void 0;return Ml(d.getItem.bind(d))(i.name).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==i.version){if(i.migrate)return[!0,i.migrate(x.state,x.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,x.state];return[!1,void 0]}).then(x=>{var v;const[w,N]=x;if(j=i.merge(N,(v=n())!=null?v:p),r(j,!0),w)return m()}).then(()=>{b==null||b(j,void 0),j=n(),l=!0,c.forEach(x=>x(j))}).catch(x=>{b==null||b(void 0,x)})};return a.persist={setOptions:g=>{i={...i,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>f(),hasHydrated:()=>l,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||f(),j||p},Fw=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Rw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),$w(e,t)):Lw(e,t),Iw=Fw,Ow={"tickets:view":["admin","manager","customer_service"],"tickets:create":["admin","manager","customer_service"],"tickets:edit":["admin","manager","customer_service"],"tickets:delete":["admin"],"tickets:assign":["admin","manager"],"tickets:bulk_assign":["admin","manager"],"chat:view":["admin","manager","customer_service"],"chat:respond":["admin","manager","customer_service"],"chat:takeover":["admin","manager","customer_service"],"group_chat:view":["admin","manager","customer_service","general"],"group_chat:send":["admin","manager","customer_service","general"],"customers:view":["admin","manager","customer_service","general"],"customers:edit":["admin","manager","customer_service"],"staff:view":["admin","manager"],"staff:create":["admin"],"staff:edit":["admin"],"staff:delete":["admin"],"analytics:view":["admin","manager"],"settings:view":["admin"],"settings:edit":["admin"],"ai_agent:view":["admin","manager"],"ai_agent:edit":["admin"]};function Dw(e,t){return e?Ow[t].includes(e):!1}const ws=Aw()(Iw((e,t)=>({token:null,user:null,setAuth:(r,n)=>{const a={...n,role:n.role==="agent"?"customer_service":n.role};e({token:r,user:a})},logout:()=>e({token:null,user:null}),hasPermission:r=>{const n=t().user;return Dw(n==null?void 0:n.role,r)}}),{name:"auth-storage"}));function jy(e,t){return function(){return e.apply(t,arguments)}}const{toString:zw}=Object.prototype,{getPrototypeOf:Eh}=Object,{iterator:Wc,toStringTag:wy}=Symbol,Kc=(e=>t=>{const r=zw.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),sr=e=>(e=e.toLowerCase(),t=>Kc(t)===e),Qc=e=>t=>typeof t===e,{isArray:wi}=Array,di=Qc("undefined");function Bl(e){return e!==null&&!di(e)&&e.constructor!==null&&!di(e.constructor)&&vs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ny=sr("ArrayBuffer");function Uw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Ny(e.buffer),t}const Hw=Qc("string"),vs=Qc("function"),ky=Qc("number"),ql=e=>e!==null&&typeof e=="object",Bw=e=>e===!0||e===!1,Uo=e=>{if(Kc(e)!=="object")return!1;const t=Eh(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(wy in e)&&!(Wc in e)},qw=e=>{if(!ql(e)||Bl(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Ww=sr("Date"),Kw=sr("File"),Qw=sr("Blob"),Vw=sr("FileList"),Gw=e=>ql(e)&&vs(e.pipe),Yw=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||vs(e.append)&&((t=Kc(e))==="formdata"||t==="object"&&vs(e.toString)&&e.toString()==="[object FormData]"))},Jw=sr("URLSearchParams"),[Xw,Zw,eN,tN]=["ReadableStream","Request","Response","Headers"].map(sr),sN=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wl(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),wi(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(Bl(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(n=0;n<l;n++)o=i[n],t.call(null,e[o],o,e)}}function Sy(e,t){if(Bl(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Kn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Cy=e=>!di(e)&&e!==Kn;function dm(){const{caseless:e,skipUndefined:t}=Cy(this)&&this||{},r={},n=(a,i)=>{const l=e&&Sy(r,i)||i;Uo(r[l])&&Uo(a)?r[l]=dm(r[l],a):Uo(a)?r[l]=dm({},a):wi(a)?r[l]=a.slice():(!t||!di(a))&&(r[l]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&Wl(arguments[a],n);return r}const rN=(e,t,r,{allOwnKeys:n}={})=>(Wl(t,(a,i)=>{r&&vs(a)?e[i]=jy(a,r):e[i]=a},{allOwnKeys:n}),e),nN=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),aN=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},iN=(e,t,r,n)=>{let a,i,l;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)l=a[i],(!n||n(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=r!==!1&&Eh(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},lN=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},oN=e=>{if(!e)return null;if(wi(e))return e;let t=e.length;if(!ky(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},cN=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Eh(Uint8Array)),dN=(e,t)=>{const n=(e&&e[Wc]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},uN=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},mN=sr("HTMLFormElement"),hN=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Cf=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),fN=sr("RegExp"),_y=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Wl(r,(a,i)=>{let l;(l=t(a,i,e))!==!1&&(n[i]=l||a)}),Object.defineProperties(e,n)},gN=e=>{_y(e,(t,r)=>{if(vs(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(vs(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},xN=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return wi(e)?n(e):n(String(e).split(t)),r},pN=()=>{},yN=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function bN(e){return!!(e&&vs(e.append)&&e[wy]==="FormData"&&e[Wc])}const vN=e=>{const t=new Array(10),r=(n,a)=>{if(ql(n)){if(t.indexOf(n)>=0)return;if(Bl(n))return n;if(!("toJSON"in n)){t[a]=n;const i=wi(n)?[]:{};return Wl(n,(l,o)=>{const c=r(l,a+1);!di(c)&&(i[o]=c)}),t[a]=void 0,i}}return n};return r(e,0)},jN=sr("AsyncFunction"),wN=e=>e&&(ql(e)||vs(e))&&vs(e.then)&&vs(e.catch),Ey=((e,t)=>e?setImmediate:t?((r,n)=>(Kn.addEventListener("message",({source:a,data:i})=>{a===Kn&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Kn.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",vs(Kn.postMessage)),NN=typeof queueMicrotask<"u"?queueMicrotask.bind(Kn):typeof process<"u"&&process.nextTick||Ey,kN=e=>e!=null&&vs(e[Wc]),z={isArray:wi,isArrayBuffer:Ny,isBuffer:Bl,isFormData:Yw,isArrayBufferView:Uw,isString:Hw,isNumber:ky,isBoolean:Bw,isObject:ql,isPlainObject:Uo,isEmptyObject:qw,isReadableStream:Xw,isRequest:Zw,isResponse:eN,isHeaders:tN,isUndefined:di,isDate:Ww,isFile:Kw,isBlob:Qw,isRegExp:fN,isFunction:vs,isStream:Gw,isURLSearchParams:Jw,isTypedArray:cN,isFileList:Vw,forEach:Wl,merge:dm,extend:rN,trim:sN,stripBOM:nN,inherits:aN,toFlatObject:iN,kindOf:Kc,kindOfTest:sr,endsWith:lN,toArray:oN,forEachEntry:dN,matchAll:uN,isHTMLForm:mN,hasOwnProperty:Cf,hasOwnProp:Cf,reduceDescriptors:_y,freezeMethods:gN,toObjectSet:xN,toCamelCase:hN,noop:pN,toFiniteNumber:yN,findKey:Sy,global:Kn,isContextDefined:Cy,isSpecCompliantForm:bN,toJSONObject:vN,isAsyncFn:jN,isThenable:wN,setImmediate:Ey,asap:NN,isIterable:kN};function Oe(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}z.inherits(Oe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:z.toJSONObject(this.config),code:this.code,status:this.status}}});const My=Oe.prototype,Ty={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ty[e]={value:e}});Object.defineProperties(Oe,Ty);Object.defineProperty(My,"isAxiosError",{value:!0});Oe.from=(e,t,r,n,a,i)=>{const l=Object.create(My);z.toFlatObject(e,l,function(m){return m!==Error.prototype},d=>d!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Oe.call(l,o,c,r,n,a),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const SN=null;function um(e){return z.isPlainObject(e)||z.isArray(e)}function Ay(e){return z.endsWith(e,"[]")?e.slice(0,-2):e}function _f(e,t,r){return e?e.concat(t).map(function(a,i){return a=Ay(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function CN(e){return z.isArray(e)&&!e.some(um)}const _N=z.toFlatObject(z,{},null,function(t){return/^is[A-Z]/.test(t)});function Vc(e,t,r){if(!z.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=z.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!z.isUndefined(y[g])});const n=r.metaTokens,a=r.visitor||m,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&z.isSpecCompliantForm(t);if(!z.isFunction(a))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(z.isDate(f))return f.toISOString();if(z.isBoolean(f))return f.toString();if(!c&&z.isBlob(f))throw new Oe("Blob is not supported. Use a Buffer instead.");return z.isArrayBuffer(f)||z.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function m(f,g,y){let b=f;if(f&&!y&&typeof f=="object"){if(z.endsWith(g,"{}"))g=n?g:g.slice(0,-2),f=JSON.stringify(f);else if(z.isArray(f)&&CN(f)||(z.isFileList(f)||z.endsWith(g,"[]"))&&(b=z.toArray(f)))return g=Ay(g),b.forEach(function(v,w){!(z.isUndefined(v)||v===null)&&t.append(l===!0?_f([g],w,i):l===null?g:g+"[]",d(v))}),!1}return um(f)?!0:(t.append(_f(y,g,i),d(f)),!1)}const h=[],p=Object.assign(_N,{defaultVisitor:m,convertValue:d,isVisitable:um});function j(f,g){if(!z.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(f),z.forEach(f,function(b,x){(!(z.isUndefined(b)||b===null)&&a.call(t,b,z.isString(x)?x.trim():x,g,p))===!0&&j(b,g?g.concat(x):[x])}),h.pop()}}if(!z.isObject(e))throw new TypeError("data must be an object");return j(e),t}function Ef(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Mh(e,t){this._pairs=[],e&&Vc(e,this,t)}const Ry=Mh.prototype;Ry.append=function(t,r){this._pairs.push([t,r])};Ry.toString=function(t){const r=t?function(n){return t.call(this,n,Ef)}:Ef;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function EN(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Py(e,t,r){if(!t)return e;const n=r&&r.encode||EN;z.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=z.isURLSearchParams(t)?t.toString():new Mh(t,r).toString(n),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Mf{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){z.forEach(this.handlers,function(n){n!==null&&t(n)})}}const $y={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},MN=typeof URLSearchParams<"u"?URLSearchParams:Mh,TN=typeof FormData<"u"?FormData:null,AN=typeof Blob<"u"?Blob:null,RN={isBrowser:!0,classes:{URLSearchParams:MN,FormData:TN,Blob:AN},protocols:["http","https","file","blob","url","data"]},Th=typeof window<"u"&&typeof document<"u",mm=typeof navigator=="object"&&navigator||void 0,PN=Th&&(!mm||["ReactNative","NativeScript","NS"].indexOf(mm.product)<0),$N=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",LN=Th&&window.location.href||"http://localhost",FN=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Th,hasStandardBrowserEnv:PN,hasStandardBrowserWebWorkerEnv:$N,navigator:mm,origin:LN},Symbol.toStringTag,{value:"Module"})),Zt={...FN,...RN};function IN(e,t){return Vc(e,new Zt.classes.URLSearchParams,{visitor:function(r,n,a,i){return Zt.isNode&&z.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function ON(e){return z.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function DN(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function Ly(e){function t(r,n,a,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&z.isArray(a)?a.length:l,c?(z.hasOwnProp(a,l)?a[l]=[a[l],n]:a[l]=n,!o):((!a[l]||!z.isObject(a[l]))&&(a[l]=[]),t(r,n,a[l],i)&&z.isArray(a[l])&&(a[l]=DN(a[l])),!o)}if(z.isFormData(e)&&z.isFunction(e.entries)){const r={};return z.forEachEntry(e,(n,a)=>{t(ON(n),a,r,0)}),r}return null}function zN(e,t,r){if(z.isString(e))try{return(t||JSON.parse)(e),z.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Kl={transitional:$y,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=z.isObject(t);if(i&&z.isHTMLForm(t)&&(t=new FormData(t)),z.isFormData(t))return a?JSON.stringify(Ly(t)):t;if(z.isArrayBuffer(t)||z.isBuffer(t)||z.isStream(t)||z.isFile(t)||z.isBlob(t)||z.isReadableStream(t))return t;if(z.isArrayBufferView(t))return t.buffer;if(z.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return IN(t,this.formSerializer).toString();if((o=z.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Vc(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),zN(t)):t}],transformResponse:[function(t){const r=this.transitional||Kl.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(z.isResponse(t)||z.isReadableStream(t))return t;if(t&&z.isString(t)&&(n&&!this.responseType||a)){const l=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?Oe.from(o,Oe.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zt.classes.FormData,Blob:Zt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};z.forEach(["delete","get","head","post","put","patch"],e=>{Kl.headers[e]={}});const UN=z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),HN=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),r=l.substring(0,a).trim().toLowerCase(),n=l.substring(a+1).trim(),!(!r||t[r]&&UN[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Tf=Symbol("internals");function Li(e){return e&&String(e).trim().toLowerCase()}function Ho(e){return e===!1||e==null?e:z.isArray(e)?e.map(Ho):String(e)}function BN(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const qN=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ld(e,t,r,n,a){if(z.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!z.isString(t)){if(z.isString(n))return t.indexOf(n)!==-1;if(z.isRegExp(n))return n.test(t)}}function WN(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function KN(e,t){const r=z.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,l){return this[n].call(this,t,a,i,l)},configurable:!0})})}let js=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(o,c,d){const m=Li(c);if(!m)throw new Error("header name must be a non-empty string");const h=z.findKey(a,m);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||c]=Ho(o))}const l=(o,c)=>z.forEach(o,(d,m)=>i(d,m,c));if(z.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(z.isString(t)&&(t=t.trim())&&!qN(t))l(HN(t),r);else if(z.isObject(t)&&z.isIterable(t)){let o={},c,d;for(const m of t){if(!z.isArray(m))throw TypeError("Object iterator must return a key-value pair");o[d=m[0]]=(c=o[d])?z.isArray(c)?[...c,m[1]]:[c,m[1]]:m[1]}l(o,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=Li(t),t){const n=z.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return BN(a);if(z.isFunction(r))return r.call(this,a,n);if(z.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Li(t),t){const n=z.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Ld(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(l){if(l=Li(l),l){const o=z.findKey(n,l);o&&(!r||Ld(n,n[o],o,r))&&(delete n[o],a=!0)}}return z.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||Ld(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return z.forEach(this,(a,i)=>{const l=z.findKey(n,i);if(l){r[l]=Ho(a),delete r[i];return}const o=t?WN(i):String(i).trim();o!==i&&delete r[i],r[o]=Ho(a),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return z.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&z.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[Tf]=this[Tf]={accessors:{}}).accessors,a=this.prototype;function i(l){const o=Li(l);n[o]||(KN(a,l),n[o]=!0)}return z.isArray(t)?t.forEach(i):i(t),this}};js.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);z.reduceDescriptors(js.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});z.freezeMethods(js);function Fd(e,t){const r=this||Kl,n=t||r,a=js.from(n.headers);let i=n.data;return z.forEach(e,function(o){i=o.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function Fy(e){return!!(e&&e.__CANCEL__)}function Ni(e,t,r){Oe.call(this,e??"canceled",Oe.ERR_CANCELED,t,r),this.name="CanceledError"}z.inherits(Ni,Oe,{__CANCEL__:!0});function Iy(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Oe("Request failed with status code "+r.status,[Oe.ERR_BAD_REQUEST,Oe.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function QN(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function VN(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),m=n[i];l||(l=d),r[a]=c,n[a]=d;let h=i,p=0;for(;h!==a;)p+=r[h++],h=h%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),d-l<t)return;const j=m&&d-m;return j?Math.round(p*1e3/j):void 0}}function GN(e,t){let r=0,n=1e3/t,a,i;const l=(d,m=Date.now())=>{r=m,a=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const m=Date.now(),h=m-r;h>=n?l(d,m):(a=d,i||(i=setTimeout(()=>{i=null,l(a)},n-h)))},()=>a&&l(a)]}const vc=(e,t,r=3)=>{let n=0;const a=VN(50,250);return GN(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-n,d=a(c),m=l<=o;n=l;const h={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&m?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},r)},Af=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Rf=e=>(...t)=>z.asap(()=>e(...t)),YN=Zt.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Zt.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Zt.origin),Zt.navigator&&/(msie|trident)/i.test(Zt.navigator.userAgent)):()=>!0,JN=Zt.hasStandardBrowserEnv?{write(e,t,r,n,a,i,l){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];z.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),z.isString(n)&&o.push(`path=${n}`),z.isString(a)&&o.push(`domain=${a}`),i===!0&&o.push("secure"),z.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function XN(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ZN(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Oy(e,t,r){let n=!XN(t);return e&&(n||r==!1)?ZN(e,t):t}const Pf=e=>e instanceof js?{...e}:e;function ha(e,t){t=t||{};const r={};function n(d,m,h,p){return z.isPlainObject(d)&&z.isPlainObject(m)?z.merge.call({caseless:p},d,m):z.isPlainObject(m)?z.merge({},m):z.isArray(m)?m.slice():m}function a(d,m,h,p){if(z.isUndefined(m)){if(!z.isUndefined(d))return n(void 0,d,h,p)}else return n(d,m,h,p)}function i(d,m){if(!z.isUndefined(m))return n(void 0,m)}function l(d,m){if(z.isUndefined(m)){if(!z.isUndefined(d))return n(void 0,d)}else return n(void 0,m)}function o(d,m,h){if(h in t)return n(d,m);if(h in e)return n(void 0,d)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,m,h)=>a(Pf(d),Pf(m),h,!0)};return z.forEach(Object.keys({...e,...t}),function(m){const h=c[m]||a,p=h(e[m],t[m],m);z.isUndefined(p)&&h!==o||(r[m]=p)}),r}const Dy=e=>{const t=ha({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=js.from(l),t.url=Py(Oy(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),z.isFormData(r)){if(Zt.hasStandardBrowserEnv||Zt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(z.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([m,h])=>{d.includes(m.toLowerCase())&&l.set(m,h)})}}if(Zt.hasStandardBrowserEnv&&(n&&z.isFunction(n)&&(n=n(t)),n||n!==!1&&YN(t.url))){const c=a&&i&&JN.read(i);c&&l.set(a,c)}return t},ek=typeof XMLHttpRequest<"u",tk=ek&&function(e){return new Promise(function(r,n){const a=Dy(e);let i=a.data;const l=js.from(a.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=a,m,h,p,j,f;function g(){j&&j(),f&&f(),a.cancelToken&&a.cancelToken.unsubscribe(m),a.signal&&a.signal.removeEventListener("abort",m)}let y=new XMLHttpRequest;y.open(a.method.toUpperCase(),a.url,!0),y.timeout=a.timeout;function b(){if(!y)return;const v=js.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),N={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:v,config:e,request:y};Iy(function(F){r(F),g()},function(F){n(F),g()},N),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new Oe("Request aborted",Oe.ECONNABORTED,e,y)),y=null)},y.onerror=function(w){const N=w&&w.message?w.message:"Network Error",_=new Oe(N,Oe.ERR_NETWORK,e,y);_.event=w||null,n(_),y=null},y.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const N=a.transitional||$y;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),n(new Oe(w,N.clarifyTimeoutError?Oe.ETIMEDOUT:Oe.ECONNABORTED,e,y)),y=null},i===void 0&&l.setContentType(null),"setRequestHeader"in y&&z.forEach(l.toJSON(),function(w,N){y.setRequestHeader(N,w)}),z.isUndefined(a.withCredentials)||(y.withCredentials=!!a.withCredentials),o&&o!=="json"&&(y.responseType=a.responseType),d&&([p,f]=vc(d,!0),y.addEventListener("progress",p)),c&&y.upload&&([h,j]=vc(c),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",j)),(a.cancelToken||a.signal)&&(m=v=>{y&&(n(!v||v.type?new Ni(null,e,y):v),y.abort(),y=null)},a.cancelToken&&a.cancelToken.subscribe(m),a.signal&&(a.signal.aborted?m():a.signal.addEventListener("abort",m)));const x=QN(a.url);if(x&&Zt.protocols.indexOf(x)===-1){n(new Oe("Unsupported protocol "+x+":",Oe.ERR_BAD_REQUEST,e));return}y.send(i||null)})},sk=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,o();const m=d instanceof Error?d:this.reason;n.abort(m instanceof Oe?m:new Ni(m instanceof Error?m.message:m))}};let l=t&&setTimeout(()=>{l=null,i(new Oe(`timeout ${t} of ms exceeded`,Oe.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>z.asap(o),c}},rk=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},nk=async function*(e,t){for await(const r of ak(e))yield*rk(r,t)},ak=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},$f=(e,t,r,n)=>{const a=nk(e,t);let i=0,l,o=c=>{l||(l=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:m}=await a.next();if(d){o(),c.close();return}let h=m.byteLength;if(r){let p=i+=h;r(p)}c.enqueue(new Uint8Array(m))}catch(d){throw o(d),d}},cancel(c){return o(c),a.return()}},{highWaterMark:2})},Lf=64*1024,{isFunction:vo}=z,ik=(({Request:e,Response:t})=>({Request:e,Response:t}))(z.global),{ReadableStream:Ff,TextEncoder:If}=z.global,Of=(e,...t)=>{try{return!!e(...t)}catch{return!1}},lk=e=>{e=z.merge.call({skipUndefined:!0},ik,e);const{fetch:t,Request:r,Response:n}=e,a=t?vo(t):typeof fetch=="function",i=vo(r),l=vo(n);if(!a)return!1;const o=a&&vo(Ff),c=a&&(typeof If=="function"?(f=>g=>f.encode(g))(new If):async f=>new Uint8Array(await new r(f).arrayBuffer())),d=i&&o&&Of(()=>{let f=!1;const g=new r(Zt.origin,{body:new Ff,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!g}),m=l&&o&&Of(()=>z.isReadableStream(new n("").body)),h={stream:m&&(f=>f.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!h[f]&&(h[f]=(g,y)=>{let b=g&&g[f];if(b)return b.call(g);throw new Oe(`Response type '${f}' is not supported`,Oe.ERR_NOT_SUPPORT,y)})});const p=async f=>{if(f==null)return 0;if(z.isBlob(f))return f.size;if(z.isSpecCompliantForm(f))return(await new r(Zt.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(z.isArrayBufferView(f)||z.isArrayBuffer(f))return f.byteLength;if(z.isURLSearchParams(f)&&(f=f+""),z.isString(f))return(await c(f)).byteLength},j=async(f,g)=>{const y=z.toFiniteNumber(f.getContentLength());return y??p(g)};return async f=>{let{url:g,method:y,data:b,signal:x,cancelToken:v,timeout:w,onDownloadProgress:N,onUploadProgress:_,responseType:F,headers:R,withCredentials:J="same-origin",fetchOptions:q}=Dy(f),K=t||fetch;F=F?(F+"").toLowerCase():"text";let ne=sk([x,v&&v.toAbortSignal()],w),re=null;const pe=ne&&ne.unsubscribe&&(()=>{ne.unsubscribe()});let ke;try{if(_&&d&&y!=="get"&&y!=="head"&&(ke=await j(R,b))!==0){let X=new r(g,{method:"POST",body:b,duplex:"half"}),ie;if(z.isFormData(b)&&(ie=X.headers.get("content-type"))&&R.setContentType(ie),X.body){const[se,xe]=Af(ke,vc(Rf(_)));b=$f(X.body,Lf,se,xe)}}z.isString(J)||(J=J?"include":"omit");const we=i&&"credentials"in r.prototype,H={...q,signal:ne,method:y.toUpperCase(),headers:R.normalize().toJSON(),body:b,duplex:"half",credentials:we?J:void 0};re=i&&new r(g,H);let T=await(i?K(re,q):K(g,H));const Y=m&&(F==="stream"||F==="response");if(m&&(N||Y&&pe)){const X={};["status","statusText","headers"].forEach($e=>{X[$e]=T[$e]});const ie=z.toFiniteNumber(T.headers.get("content-length")),[se,xe]=N&&Af(ie,vc(Rf(N),!0))||[];T=new n($f(T.body,Lf,se,()=>{xe&&xe(),pe&&pe()}),X)}F=F||"text";let G=await h[z.findKey(h,F)||"text"](T,f);return!Y&&pe&&pe(),await new Promise((X,ie)=>{Iy(X,ie,{data:G,headers:js.from(T.headers),status:T.status,statusText:T.statusText,config:f,request:re})})}catch(we){throw pe&&pe(),we&&we.name==="TypeError"&&/Load failed|fetch/i.test(we.message)?Object.assign(new Oe("Network Error",Oe.ERR_NETWORK,f,re),{cause:we.cause||we}):Oe.from(we,we&&we.code,f,re)}}},ok=new Map,zy=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:a}=t,i=[n,a,r];let l=i.length,o=l,c,d,m=ok;for(;o--;)c=i[o],d=m.get(c),d===void 0&&m.set(c,d=o?new Map:lk(t)),m=d;return d};zy();const Ah={http:SN,xhr:tk,fetch:{get:zy}};z.forEach(Ah,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Df=e=>`- ${e}`,ck=e=>z.isFunction(e)||e===null||e===!1;function dk(e,t){e=z.isArray(e)?e:[e];const{length:r}=e;let n,a;const i={};for(let l=0;l<r;l++){n=e[l];let o;if(a=n,!ck(n)&&(a=Ah[(o=String(n)).toLowerCase()],a===void 0))throw new Oe(`Unknown adapter '${o}'`);if(a&&(z.isFunction(a)||(a=a.get(t))))break;i[o||"#"+l]=a}if(!a){const l=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(Df).join(`
`):" "+Df(l[0]):"as no adapter specified";throw new Oe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a}const Uy={getAdapter:dk,adapters:Ah};function Id(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ni(null,e)}function zf(e){return Id(e),e.headers=js.from(e.headers),e.data=Fd.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Uy.getAdapter(e.adapter||Kl.adapter,e)(e).then(function(n){return Id(e),n.data=Fd.call(e,e.transformResponse,n),n.headers=js.from(n.headers),n},function(n){return Fy(n)||(Id(e),n&&n.response&&(n.response.data=Fd.call(e,e.transformResponse,n.response),n.response.headers=js.from(n.response.headers))),Promise.reject(n)})}const Hy="1.13.2",Gc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Gc[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Uf={};Gc.transitional=function(t,r,n){function a(i,l){return"[Axios v"+Hy+"] Transitional option '"+i+"'"+l+(n?". "+n:"")}return(i,l,o)=>{if(t===!1)throw new Oe(a(l," has been removed"+(r?" in "+r:"")),Oe.ERR_DEPRECATED);return r&&!Uf[l]&&(Uf[l]=!0,console.warn(a(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};Gc.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function uk(e,t,r){if(typeof e!="object")throw new Oe("options must be an object",Oe.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],l=t[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new Oe("option "+i+" must be "+c,Oe.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Oe("Unknown option "+i,Oe.ERR_BAD_OPTION)}}const Bo={assertOptions:uk,validators:Gc},ir=Bo.validators;let aa=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Mf,response:new Mf}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ha(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Bo.assertOptions(n,{silentJSONParsing:ir.transitional(ir.boolean),forcedJSONParsing:ir.transitional(ir.boolean),clarifyTimeoutError:ir.transitional(ir.boolean)},!1),a!=null&&(z.isFunction(a)?r.paramsSerializer={serialize:a}:Bo.assertOptions(a,{encode:ir.function,serialize:ir.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Bo.assertOptions(r,{baseUrl:ir.spelling("baseURL"),withXsrfToken:ir.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&z.merge(i.common,i[r.method]);i&&z.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),r.headers=js.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let m,h=0,p;if(!c){const f=[zf.bind(this),void 0];for(f.unshift(...o),f.push(...d),p=f.length,m=Promise.resolve(r);h<p;)m=m.then(f[h++],f[h++]);return m}p=o.length;let j=r;for(;h<p;){const f=o[h++],g=o[h++];try{j=f(j)}catch(y){g.call(this,y);break}}try{m=zf.call(this,j)}catch(f){return Promise.reject(f)}for(h=0,p=d.length;h<p;)m=m.then(d[h++],d[h++]);return m}getUri(t){t=ha(this.defaults,t);const r=Oy(t.baseURL,t.url,t.allowAbsoluteUrls);return Py(r,t.params,t.paramsSerializer)}};z.forEach(["delete","get","head","options"],function(t){aa.prototype[t]=function(r,n){return this.request(ha(n||{},{method:t,url:r,data:(n||{}).data}))}});z.forEach(["post","put","patch"],function(t){function r(n){return function(i,l,o){return this.request(ha(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}aa.prototype[t]=r(),aa.prototype[t+"Form"]=r(!0)});let mk=class By{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const l=new Promise(o=>{n.subscribe(o),i=o}).then(a);return l.cancel=function(){n.unsubscribe(i)},l},t(function(i,l,o){n.reason||(n.reason=new Ni(i,l,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new By(function(a){t=a}),cancel:t}}};function hk(e){return function(r){return e.apply(null,r)}}function fk(e){return z.isObject(e)&&e.isAxiosError===!0}const hm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(hm).forEach(([e,t])=>{hm[t]=e});function qy(e){const t=new aa(e),r=jy(aa.prototype.request,t);return z.extend(r,aa.prototype,t,{allOwnKeys:!0}),z.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return qy(ha(e,a))},r}const Nt=qy(Kl);Nt.Axios=aa;Nt.CanceledError=Ni;Nt.CancelToken=mk;Nt.isCancel=Fy;Nt.VERSION=Hy;Nt.toFormData=Vc;Nt.AxiosError=Oe;Nt.Cancel=Nt.CanceledError;Nt.all=function(t){return Promise.all(t)};Nt.spread=hk;Nt.isAxiosError=fk;Nt.mergeConfig=ha;Nt.AxiosHeaders=js;Nt.formToJSON=e=>Ly(z.isHTMLForm(e)?new FormData(e):e);Nt.getAdapter=Uy.getAdapter;Nt.HttpStatusCode=hm;Nt.default=Nt;const{Axios:B6,AxiosError:q6,CanceledError:W6,isCancel:K6,CancelToken:Q6,VERSION:V6,all:G6,Cancel:Y6,isAxiosError:J6,spread:X6,toFormData:Z6,AxiosHeaders:e_,HttpStatusCode:t_,formToJSON:s_,getAdapter:r_,mergeConfig:n_}=Nt,gk="https://dartmouth-os-worker.dartmouth.workers.dev",O=Nt.create({baseURL:gk,headers:{"Content-Type":"application/json"}});O.interceptors.request.use(e=>{const t=localStorage.getItem("auth-storage");if(t)try{const{state:r}=JSON.parse(t);r!=null&&r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}catch(r){console.error("Error parsing auth token:",r)}return e});O.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("auth-storage"),window.location.href="/login"),Promise.reject(e)});const xk={login:(e,t)=>O.post("/api/auth/login",{email:e,password:t}),me:()=>O.get("/api/auth/me"),logout:()=>O.post("/api/auth/logout")},Ie={list:e=>O.get("/api/tickets",{params:e}),get:e=>O.get(`/api/tickets/${e}`),getById:e=>O.get(`/api/tickets/${e}`),getMessages:e=>O.get(`/api/tickets/${e}/messages`),assign:(e,t)=>O.put(`/api/tickets/${e}/assign`,{assignedTo:t}),updateStatus:(e,t)=>O.put(`/api/tickets/${e}/status`,{status:t}),reply:(e,t,r)=>O.post(`/api/tickets/${e}/reply`,{content:t,attachments:r}),addNote:(e,t,r,n)=>O.post(`/api/tickets/${e}/notes`,{content:t,noteType:r,attachments:n}),editNote:(e,t,r)=>O.put(`/api/tickets/${e}/notes/${t}`,{content:r}),deleteNote:(e,t)=>O.delete(`/api/tickets/${e}/notes/${t}`),snooze:(e,t,r)=>O.post(`/api/tickets/${e}/snooze`,{snoozedUntil:t,reason:r}),unsnooze:e=>O.post(`/api/tickets/${e}/unsnooze`),escalate:(e,t,r)=>O.post(`/api/tickets/${e}/escalate`,{staffIds:t,reason:r}),resolveEscalation:(e,t)=>O.post(`/api/tickets/${e}/resolve-escalation`,{escalationId:t}),scheduleReply:(e,t,r)=>O.post(`/api/tickets/${e}/schedule-reply`,{content:t,scheduledFor:r}),getScheduledMessages:e=>O.get(`/api/tickets/${e}/scheduled-messages`),updateScheduledMessage:(e,t,r)=>O.put(`/api/scheduled-messages/${e}`,{content:t,scheduledFor:r}),deleteScheduledMessage:e=>O.delete(`/api/scheduled-messages/${e}`),getAIDraft:e=>O.get(`/api/tickets/${e}/ai-draft`),approveAIDraft:e=>O.post(`/api/tickets/${e}/ai-draft/approve`),editAIDraft:(e,t)=>O.post(`/api/tickets/${e}/ai-draft/edit`,{editedContent:t}),rejectAIDraft:(e,t)=>O.post(`/api/tickets/${e}/ai-draft/reject`,{reason:t}),submitAIDraftFeedback:(e,t)=>O.post(`/api/tickets/${e}/ai-draft/feedback`,t),delete:e=>O.delete(`/api/tickets/${e}`),merge:(e,t)=>O.post(`/api/tickets/${e}/merge`,{secondaryTicketIds:t}),bulkAssign:(e,t)=>O.post("/api/tickets/bulk-assign",{ticketIds:e,assignedTo:t}),createManual:e=>O.post("/api/tickets/create-manual",e)},tt={list:()=>O.get("/api/staff"),get:e=>O.get(`/api/staff/${e}`),me:()=>O.get("/api/staff/me"),onlineCount:()=>O.get("/api/staff/online-count"),create:e=>O.post("/api/staff",e),update:(e,t)=>O.put(`/api/staff/${e}`,t),updatePresence:(e,t)=>O.put(`/api/staff/${e}/presence`,{isAvailable:t}),updateAvailability:(e,t)=>O.put(`/api/staff/${e}/availability`,{status:t}),uploadAvatar:(e,t)=>{const r=new FormData;return r.append("avatar",t),O.post(`/api/staff/${e}/avatar`,r,{headers:{"Content-Type":"multipart/form-data"}})},deleteAvatar:e=>O.delete(`/api/staff/${e}/avatar`),getAvatarUrl:e=>e?e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev${e}`:null},Rr={getSettings:()=>O.get("/api/chat/settings"),updateSettings:e=>O.put("/api/chat/settings",e),getBusinessHours:()=>O.get("/api/chat/business-hours"),updateBusinessHours:e=>O.put("/api/chat/business-hours",{hours:e}),getStatus:()=>O.get("/api/chat/status"),getEmbedCode:()=>O.get("/api/chat/embed-code")},jo={listDocuments:()=>O.get("/api/ai-agent/knowledge"),uploadDocument:(e,t)=>{const r=new FormData;return r.append("file",e),r.append("category",t),O.post("/api/ai-agent/knowledge/upload",r,{headers:{"Content-Type":"multipart/form-data"}})},deleteDocument:e=>O.delete(`/api/ai-agent/knowledge/${e}`),reprocessDocuments:()=>O.post("/api/ai-agent/knowledge/reprocess")},Od={getConfig:()=>O.get("/api/ai-agent/system-message"),updateConfig:e=>O.put("/api/ai-agent/system-message",e),resetToDefault:()=>O.post("/api/ai-agent/system-message/reset")},Hf={getAIAgentStats:(e="7d")=>O.get("/api/analytics/ai-agent",{params:{timeRange:e}}),getLearningExamples:(e=10)=>O.get("/api/analytics/ai-agent/learning-examples",{params:{limit:e}})},wo={getConfig:()=>O.get("/api/auto-assignment/config"),updateConfig:e=>O.put("/api/auto-assignment/config",e),runNow:()=>O.post("/api/auto-assignment/run"),getHistory:e=>O.get("/api/auto-assignment/history",{params:{limit:e}}),getStaffSettings:e=>O.get(`/api/auto-assignment/staff/${e}`),updateStaffSettings:(e,t)=>O.put(`/api/auto-assignment/staff/${e}`,t)},pk={getTicketData:e=>O.get("/api/shopify/ticket-data",{params:{email:e}}),getCustomer:e=>O.get("/api/shopify/customer",{params:{email:e}}),getCustomerOrders:(e,t)=>O.get(`/api/shopify/customer/${e}/orders`,{params:{limit:t}}),getOrdersByEmail:(e,t)=>O.get("/api/shopify/orders",{params:{email:e,limit:t}}),searchOrder:e=>O.get("/api/shopify/order",{params:{number:e}}),getOrder:e=>O.get(`/api/shopify/order/${e}`)},ft={listChannels:()=>O.get("/api/group-chat/channels"),createChannel:e=>O.post("/api/group-chat/channels",e),getChannel:e=>O.get(`/api/group-chat/channels/${e}`),updateChannel:(e,t)=>O.patch(`/api/group-chat/channels/${e}`,t),archiveChannel:e=>O.delete(`/api/group-chat/channels/${e}`),getMessages:(e,t)=>O.get(`/api/group-chat/channels/${e}/messages`,{params:t}),sendMessage:(e,t)=>O.post(`/api/group-chat/channels/${e}/messages`,t),pollMessages:(e,t)=>O.get(`/api/group-chat/channels/${e}/poll`,{params:{after:t}}),editMessage:(e,t,r)=>O.patch(`/api/group-chat/messages/${e}`,{content:t,deleteAttachment:r}),deleteMessage:e=>O.delete(`/api/group-chat/messages/${e}`),addReaction:(e,t)=>O.post(`/api/group-chat/messages/${e}/react`,{emoji:t}),getMembers:e=>O.get(`/api/group-chat/channels/${e}/members`),addMember:(e,t)=>O.post(`/api/group-chat/channels/${e}/members`,{staffId:t}),removeMember:(e,t)=>O.delete(`/api/group-chat/channels/${e}/members/${t}`),markAsRead:(e,t)=>O.post(`/api/group-chat/channels/${e}/read`,{messageId:t}),getUnreadCounts:()=>O.get("/api/group-chat/unread"),getTimeLimit:()=>O.get("/api/group-chat/settings/time-limit"),setTimeLimit:e=>O.put("/api/group-chat/settings/time-limit",{timeLimit:e}),getAutoArchiveHours:()=>O.get("/api/group-chat/settings/auto-archive"),setAutoArchiveHours:e=>O.put("/api/group-chat/settings/auto-archive",{hours:e})},Qi={getMemos:e=>O.get("/api/memos",{params:e}),createMemo:e=>O.post("/api/memos",e),editMemo:(e,t)=>O.patch(`/api/memos/${e}`,t),deleteMemo:e=>O.delete(`/api/memos/${e}`)},Bf={getAllTags:e=>O.get("/api/tags",{params:e?{search:e}:{}}),searchTags:e=>O.get("/api/tags/search",{params:{search:e}})},No={getGlobal:()=>O.get("/api/signatures/global"),setGlobal:e=>O.put("/api/signatures/global",{signatureHtml:e}),getPreview:()=>O.get("/api/signatures/preview"),getPlainText:()=>O.get("/api/signatures/plain-text"),uploadLogo:e=>O.post("/api/signatures/upload-logo",{attachment:e}),getSettings:()=>O.get("/api/signatures/settings"),saveSettings:e=>O.put("/api/signatures/settings",e),getPreviewFromSettings:e=>O.post("/api/signatures/preview-from-settings",e)},Dn={getMentions:e=>O.get("/api/mentions",{params:e}),getMention:e=>O.get(`/api/mentions/${e}`),markAsRead:e=>O.patch(`/api/mentions/${e}/read`),markAsUnread:e=>O.patch(`/api/mentions/${e}/unread`),archiveMention:e=>O.patch(`/api/mentions/${e}/archive`),getUnreadCount:()=>O.get("/api/mentions/unread-count"),updateMention:(e,t)=>O.patch(`/api/mentions/${e}`,t),deleteMention:e=>O.delete(`/api/mentions/${e}`)};function yk(){const[e,t]=u.useState("john@dtf.com.au"),[r,n]=u.useState("changeme123"),[a,i]=u.useState(""),[l,o]=u.useState(!1),c=yr(),d=ws(h=>h.setAuth),m=async h=>{var p,j;h.preventDefault(),i(""),o(!0);try{const f=await xk.login(e,r);d(f.data.token,f.data.user),c("/tickets")}catch(f){i(((j=(p=f.response)==null?void 0:p.data)==null?void 0:j.error)||"Login failed")}finally{o(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Customer Service Dashboard"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your account"})]}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:m,children:[a&&s.jsx("div",{className:"rounded-md bg-red-50 p-4",children:s.jsx("div",{className:"text-sm text-red-800",children:a})}),s.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:h=>t(h.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",value:r,onChange:h=>n(h.target.value)})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:l?"Signing in...":"Sign in"})}),s.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[s.jsx("p",{children:"Test credentials:"}),s.jsx("p",{children:"Admin: john@dtf.com.au / changeme123"}),s.jsx("p",{children:"Agent: john+ted@dtf.com.au / changeme123"})]})]})]})})}var bk=Object.defineProperty,vk=(e,t,r)=>t in e?bk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Dd=(e,t,r)=>(vk(e,typeof t!="symbol"?t+"":t,r),r);let jk=class{constructor(){Dd(this,"current",this.detect()),Dd(this,"handoffState","pending"),Dd(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},$r=new jk,Ut=(e,t)=>{$r.isServer?u.useEffect(e,t):u.useLayoutEffect(e,t)};function Lr(e){let t=u.useRef(e);return Ut(()=>{t.current=e},[e]),t}let Be=function(e){let t=Lr(e);return Le.useCallback((...r)=>t.current(...r),[t])};function Yc(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function er(){let e=[],t={addEventListener(r,n,a,i){return r.addEventListener(n,a,i),t.add(()=>r.removeEventListener(n,a,i))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return t.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return t.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return Yc(()=>{n.current&&r[0]()}),t.add(()=>{n.current=!1})},style(r,n,a){let i=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:a}),this.add(()=>{Object.assign(r.style,{[n]:i})})},group(r){let n=er();return r(n),this.add(()=>n.dispose())},add(r){return e.push(r),()=>{let n=e.indexOf(r);if(n>=0)for(let a of e.splice(n,1))a()}},dispose(){for(let r of e.splice(0))r()}};return t}function Ql(){let[e]=u.useState(er);return u.useEffect(()=>()=>e.dispose(),[e]),e}function wk(){let e=typeof document>"u";return"useSyncExternalStore"in ti?(t=>t.useSyncExternalStore)(ti)(()=>()=>{},()=>!1,()=>!e):!1}function ki(){let e=wk(),[t,r]=u.useState($r.isHandoffComplete);return t&&$r.isHandoffComplete===!1&&r(!1),u.useEffect(()=>{t!==!0&&r(!0)},[t]),u.useEffect(()=>$r.handoff(),[]),e?!1:t}var qf;let Br=(qf=Le.useId)!=null?qf:function(){let e=ki(),[t,r]=Le.useState(e?()=>$r.nextId():null);return Ut(()=>{t===null&&r($r.nextId())},[t]),t!=null?""+t:void 0};function Dt(e,t,...r){if(e in t){let a=t[e];return typeof a=="function"?a(...r):a}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Dt),n}function Jc(e){return $r.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let fm=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var Mr=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(Mr||{}),Wy=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Wy||{}),Nk=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Nk||{});function Ky(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(fm)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Rh=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Rh||{});function Ph(e,t=0){var r;return e===((r=Jc(e))==null?void 0:r.body)?!1:Dt(t,{0(){return e.matches(fm)},1(){let n=e;for(;n!==null;){if(n.matches(fm))return!0;n=n.parentElement}return!1}})}function Qy(e){let t=Jc(e);er().nextFrame(()=>{t&&!Ph(t.activeElement,0)&&_n(e)})}var kk=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(kk||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function _n(e){e==null||e.focus({preventScroll:!0})}let Sk=["textarea","input"].join(",");function Ck(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Sk))!=null?r:!1}function Vy(e,t=r=>r){return e.slice().sort((r,n)=>{let a=t(r),i=t(n);if(a===null||i===null)return 0;let l=a.compareDocumentPosition(i);return l&Node.DOCUMENT_POSITION_FOLLOWING?-1:l&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function _k(e,t){return il(Ky(),t,{relativeTo:e})}function il(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:a=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,l=Array.isArray(e)?r?Vy(e):e:Ky(e);a.length>0&&l.length>1&&(l=l.filter(j=>!a.includes(j))),n=n??i.activeElement;let o=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,l.indexOf(n))-1;if(t&4)return Math.max(0,l.indexOf(n))+1;if(t&8)return l.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=t&32?{preventScroll:!0}:{},m=0,h=l.length,p;do{if(m>=h||m+h<=0)return 0;let j=c+m;if(t&16)j=(j+h)%h;else{if(j<0)return 3;if(j>=h)return 1}p=l[j],p==null||p.focus(d),m+=o}while(p!==i.activeElement);return t&6&&Ck(p)&&p.select(),2}function Gy(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Ek(){return/Android/gi.test(window.navigator.userAgent)}function Mk(){return Gy()||Ek()}function ko(e,t,r){let n=Lr(t);u.useEffect(()=>{function a(i){n.current(i)}return document.addEventListener(e,a,r),()=>document.removeEventListener(e,a,r)},[e,r])}function Yy(e,t,r){let n=Lr(t);u.useEffect(()=>{function a(i){n.current(i)}return window.addEventListener(e,a,r),()=>window.removeEventListener(e,a,r)},[e,r])}function Jy(e,t,r=!0){let n=u.useRef(!1);u.useEffect(()=>{requestAnimationFrame(()=>{n.current=r})},[r]);function a(l,o){if(!n.current||l.defaultPrevented)return;let c=o(l);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let d=function m(h){return typeof h=="function"?m(h()):Array.isArray(h)||h instanceof Set?h:[h]}(e);for(let m of d){if(m===null)continue;let h=m instanceof HTMLElement?m:m.current;if(h!=null&&h.contains(c)||l.composed&&l.composedPath().includes(h))return}return!Ph(c,Rh.Loose)&&c.tabIndex!==-1&&l.preventDefault(),t(l,c)}let i=u.useRef(null);ko("pointerdown",l=>{var o,c;n.current&&(i.current=((c=(o=l.composedPath)==null?void 0:o.call(l))==null?void 0:c[0])||l.target)},!0),ko("mousedown",l=>{var o,c;n.current&&(i.current=((c=(o=l.composedPath)==null?void 0:o.call(l))==null?void 0:c[0])||l.target)},!0),ko("click",l=>{Mk()||i.current&&(a(l,()=>i.current),i.current=null)},!0),ko("touchend",l=>a(l,()=>l.target instanceof HTMLElement?l.target:null),!0),Yy("blur",l=>a(l,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Si(...e){return u.useMemo(()=>Jc(...e),[...e])}function Wf(e){var t;if(e.type)return e.type;let r=(t=e.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function Tk(e,t){let[r,n]=u.useState(()=>Wf(e));return Ut(()=>{n(Wf(e))},[e.type,e.as]),Ut(()=>{r||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&n("button")},[r,t]),r}let Xy=Symbol();function Ak(e,t=!0){return Object.assign(e,{[Xy]:t})}function us(...e){let t=u.useRef(e);u.useEffect(()=>{t.current=e},[e]);let r=Be(n=>{for(let a of t.current)a!=null&&(typeof a=="function"?a(n):a.current=n)});return e.every(n=>n==null||(n==null?void 0:n[Xy]))?void 0:r}function Kf(e){return[e.screenX,e.screenY]}function Rk(){let e=u.useRef([-1,-1]);return{wasMoved(t){let r=Kf(t);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(t){e.current=Kf(t)}}}function Pk({container:e,accept:t,walk:r,enabled:n=!0}){let a=u.useRef(t),i=u.useRef(r);u.useEffect(()=>{a.current=t,i.current=r},[t,r]),Ut(()=>{if(!e||!n)return;let l=Jc(e);if(!l)return;let o=a.current,c=i.current,d=Object.assign(h=>o(h),{acceptNode:o}),m=l.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,d,!1);for(;m.nextNode();)c(m.currentNode)},[e,n,a,i])}function $h(e,t){let r=u.useRef([]),n=Be(e);u.useEffect(()=>{let a=[...r.current];for(let[i,l]of t.entries())if(r.current[i]!==l){let o=n(t,a);return r.current=t,o}},[n,...t])}function jc(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}var ui=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(ui||{}),gn=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(gn||{});function ts({ourProps:e,theirProps:t,slot:r,defaultTag:n,features:a,visible:i=!0,name:l,mergeRefs:o}){o=o??$k;let c=Zy(t,e);if(i)return So(c,r,n,l,o);let d=a??0;if(d&2){let{static:m=!1,...h}=c;if(m)return So(h,r,n,l,o)}if(d&1){let{unmount:m=!0,...h}=c;return Dt(m?0:1,{0(){return null},1(){return So({...h,hidden:!0,style:{display:"none"}},r,n,l,o)}})}return So(c,r,n,l,o)}function So(e,t={},r,n,a){let{as:i=r,children:l,refName:o="ref",...c}=zd(e,["unmount","static"]),d=e.ref!==void 0?{[o]:e.ref}:{},m=typeof l=="function"?l(t):l;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(t));let h={};if(t){let p=!1,j=[];for(let[f,g]of Object.entries(t))typeof g=="boolean"&&(p=!0),g===!0&&j.push(f);p&&(h["data-headlessui-state"]=j.join(" "))}if(i===u.Fragment&&Object.keys(Qf(c)).length>0){if(!u.isValidElement(m)||Array.isArray(m)&&m.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(c).map(g=>`  - ${g}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(g=>`  - ${g}`).join(`
`)].join(`
`));let p=m.props,j=typeof(p==null?void 0:p.className)=="function"?(...g)=>jc(p==null?void 0:p.className(...g),c.className):jc(p==null?void 0:p.className,c.className),f=j?{className:j}:{};return u.cloneElement(m,Object.assign({},Zy(m.props,Qf(zd(c,["ref"]))),h,d,{ref:a(m.ref,d.ref)},f))}return u.createElement(i,Object.assign({},zd(c,["ref"]),i!==u.Fragment&&d,i!==u.Fragment&&h),m)}function $k(...e){return e.every(t=>t==null)?void 0:t=>{for(let r of e)r!=null&&(typeof r=="function"?r(t):r.current=t)}}function Zy(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},r={};for(let n of e)for(let a in n)a.startsWith("on")&&typeof n[a]=="function"?(r[a]!=null||(r[a]=[]),r[a].push(n[a])):t[a]=n[a];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(r).map(n=>[n,void 0])));for(let n in r)Object.assign(t,{[n](a,...i){let l=r[n];for(let o of l){if((a instanceof Event||(a==null?void 0:a.nativeEvent)instanceof Event)&&a.defaultPrevented)return;o(a,...i)}}});return t}function Vt(e){var t;return Object.assign(u.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function Qf(e){let t=Object.assign({},e);for(let r in t)t[r]===void 0&&delete t[r];return t}function zd(e,t=[]){let r=Object.assign({},e);for(let n of t)n in r&&delete r[n];return r}let Lk="div";var wc=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(wc||{});function Fk(e,t){var r;let{features:n=1,...a}=e,i={ref:t,"aria-hidden":(n&2)===2?!0:(r=a["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return ts({ourProps:i,theirProps:a,slot:{},defaultTag:Lk,name:"Hidden"})}let gm=Vt(Fk),Lh=u.createContext(null);Lh.displayName="OpenClosedContext";var qt=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(qt||{});function Xc(){return u.useContext(Lh)}function eb({value:e,children:t}){return Le.createElement(Lh.Provider,{value:e},t)}function Ik(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let tn=[];Ik(()=>{function e(t){t.target instanceof HTMLElement&&t.target!==document.body&&tn[0]!==t.target&&(tn.unshift(t.target),tn=tn.filter(r=>r!=null&&r.isConnected),tn.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function tb(e){let t=e.parentElement,r=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(r=t),t=t.parentElement;let n=(t==null?void 0:t.getAttribute("disabled"))==="";return n&&Ok(r)?!1:n}function Ok(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}function Dk(e){throw new Error("Unexpected object: "+e)}var Gs=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Gs||{});function zk(e,t){let r=t.resolveItems();if(r.length<=0)return null;let n=t.resolveActiveIndex(),a=n??-1;switch(e.focus){case 0:{for(let i=0;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 1:{for(let i=a-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 2:{for(let i=a+1;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 3:{for(let i=r.length-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 4:{for(let i=0;i<r.length;++i)if(t.resolveId(r[i],i,r)===e.id)return i;return n}case 5:return null;default:Dk(e)}}var Ft=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Ft||{});function sb(e,t,r,n){let a=Lr(r);u.useEffect(()=>{e=e??window;function i(l){a.current(l)}return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i,n)},[e,t,n])}function Vl(){let e=u.useRef(!1);return Ut(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function rb(e){let t=Be(e),r=u.useRef(!1);u.useEffect(()=>(r.current=!1,()=>{r.current=!0,Yc(()=>{r.current&&t()})}),[t])}var Vi=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Vi||{});function Uk(){let e=u.useRef(0);return Yy("keydown",t=>{t.key==="Tab"&&(e.current=t.shiftKey?1:0)},!0),e}function nb(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let r of e.current)r.current instanceof HTMLElement&&t.add(r.current);return t}let Hk="div";var ab=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(ab||{});function Bk(e,t){let r=u.useRef(null),n=us(r,t),{initialFocus:a,containers:i,features:l=30,...o}=e;ki()||(l=1);let c=Si(r);Kk({ownerDocument:c},!!(l&16));let d=Qk({ownerDocument:c,container:r,initialFocus:a},!!(l&2));Vk({ownerDocument:c,container:r,containers:i,previousActiveElement:d},!!(l&8));let m=Uk(),h=Be(g=>{let y=r.current;y&&(b=>b())(()=>{Dt(m.current,{[Vi.Forwards]:()=>{il(y,Mr.First,{skipElements:[g.relatedTarget]})},[Vi.Backwards]:()=>{il(y,Mr.Last,{skipElements:[g.relatedTarget]})}})})}),p=Ql(),j=u.useRef(!1),f={ref:n,onKeyDown(g){g.key=="Tab"&&(j.current=!0,p.requestAnimationFrame(()=>{j.current=!1}))},onBlur(g){let y=nb(i);r.current instanceof HTMLElement&&y.add(r.current);let b=g.relatedTarget;b instanceof HTMLElement&&b.dataset.headlessuiFocusGuard!=="true"&&(ib(y,b)||(j.current?il(r.current,Dt(m.current,{[Vi.Forwards]:()=>Mr.Next,[Vi.Backwards]:()=>Mr.Previous})|Mr.WrapAround,{relativeTo:g.target}):g.target instanceof HTMLElement&&_n(g.target)))}};return Le.createElement(Le.Fragment,null,!!(l&4)&&Le.createElement(gm,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:wc.Focusable}),ts({ourProps:f,theirProps:o,defaultTag:Hk,name:"FocusTrap"}),!!(l&4)&&Le.createElement(gm,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:wc.Focusable}))}let qk=Vt(Bk),Fi=Object.assign(qk,{features:ab});function Wk(e=!0){let t=u.useRef(tn.slice());return $h(([r],[n])=>{n===!0&&r===!1&&Yc(()=>{t.current.splice(0)}),n===!1&&r===!0&&(t.current=tn.slice())},[e,tn,t]),Be(()=>{var r;return(r=t.current.find(n=>n!=null&&n.isConnected))!=null?r:null})}function Kk({ownerDocument:e},t){let r=Wk(t);$h(()=>{t||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&_n(r())},[t]),rb(()=>{t&&_n(r())})}function Qk({ownerDocument:e,container:t,initialFocus:r},n){let a=u.useRef(null),i=Vl();return $h(()=>{if(!n)return;let l=t.current;l&&Yc(()=>{if(!i.current)return;let o=e==null?void 0:e.activeElement;if(r!=null&&r.current){if((r==null?void 0:r.current)===o){a.current=o;return}}else if(l.contains(o)){a.current=o;return}r!=null&&r.current?_n(r.current):il(l,Mr.First)===Wy.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),a.current=e==null?void 0:e.activeElement})},[n]),a}function Vk({ownerDocument:e,container:t,containers:r,previousActiveElement:n},a){let i=Vl();sb(e==null?void 0:e.defaultView,"focus",l=>{if(!a||!i.current)return;let o=nb(r);t.current instanceof HTMLElement&&o.add(t.current);let c=n.current;if(!c)return;let d=l.target;d&&d instanceof HTMLElement?ib(o,d)?(n.current=d,_n(d)):(l.preventDefault(),l.stopPropagation(),_n(c)):_n(n.current)},!0)}function ib(e,t){for(let r of e)if(r.contains(t))return!0;return!1}let lb=u.createContext(!1);function Gk(){return u.useContext(lb)}function xm(e){return Le.createElement(lb.Provider,{value:e.force},e.children)}function Yk(e){let t=Gk(),r=u.useContext(ob),n=Si(e),[a,i]=u.useState(()=>{if(!t&&r!==null||$r.isServer)return null;let l=n==null?void 0:n.getElementById("headlessui-portal-root");if(l)return l;if(n===null)return null;let o=n.createElement("div");return o.setAttribute("id","headlessui-portal-root"),n.body.appendChild(o)});return u.useEffect(()=>{a!==null&&(n!=null&&n.body.contains(a)||n==null||n.body.appendChild(a))},[a,n]),u.useEffect(()=>{t||r!==null&&i(r.current)},[r,i,t]),a}let Jk=u.Fragment;function Xk(e,t){let r=e,n=u.useRef(null),a=us(Ak(m=>{n.current=m}),t),i=Si(n),l=Yk(n),[o]=u.useState(()=>{var m;return $r.isServer?null:(m=i==null?void 0:i.createElement("div"))!=null?m:null}),c=u.useContext(pm),d=ki();return Ut(()=>{!l||!o||l.contains(o)||(o.setAttribute("data-headlessui-portal",""),l.appendChild(o))},[l,o]),Ut(()=>{if(o&&c)return c.register(o)},[c,o]),rb(()=>{var m;!l||!o||(o instanceof Node&&l.contains(o)&&l.removeChild(o),l.childNodes.length<=0&&((m=l.parentElement)==null||m.removeChild(l)))}),d?!l||!o?null:Kp.createPortal(ts({ourProps:{ref:a},theirProps:r,defaultTag:Jk,name:"Portal"}),o):null}let Zk=u.Fragment,ob=u.createContext(null);function e5(e,t){let{target:r,...n}=e,a={ref:us(t)};return Le.createElement(ob.Provider,{value:r},ts({ourProps:a,theirProps:n,defaultTag:Zk,name:"Popover.Group"}))}let pm=u.createContext(null);function t5(){let e=u.useContext(pm),t=u.useRef([]),r=Be(i=>(t.current.push(i),e&&e.register(i),()=>n(i))),n=Be(i=>{let l=t.current.indexOf(i);l!==-1&&t.current.splice(l,1),e&&e.unregister(i)}),a=u.useMemo(()=>({register:r,unregister:n,portals:t}),[r,n,t]);return[t,u.useMemo(()=>function({children:i}){return Le.createElement(pm.Provider,{value:a},i)},[a])]}let s5=Vt(Xk),r5=Vt(e5),ym=Object.assign(s5,{Group:r5});function n5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const a5=typeof Object.is=="function"?Object.is:n5,{useState:i5,useEffect:l5,useLayoutEffect:o5,useDebugValue:c5}=ti;function d5(e,t,r){const n=t(),[{inst:a},i]=i5({inst:{value:n,getSnapshot:t}});return o5(()=>{a.value=n,a.getSnapshot=t,Ud(a)&&i({inst:a})},[e,n,t]),l5(()=>(Ud(a)&&i({inst:a}),e(()=>{Ud(a)&&i({inst:a})})),[e]),c5(n),n}function Ud(e){const t=e.getSnapshot,r=e.value;try{const n=t();return!a5(r,n)}catch{return!0}}function u5(e,t,r){return t()}const m5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",h5=!m5,f5=h5?u5:d5,g5="useSyncExternalStore"in ti?(e=>e.useSyncExternalStore)(ti):f5;function x5(e){return g5(e.subscribe,e.getSnapshot,e.getSnapshot)}function p5(e,t){let r=e(),n=new Set;return{getSnapshot(){return r},subscribe(a){return n.add(a),()=>n.delete(a)},dispatch(a,...i){let l=t[a].call(r,...i);l&&(r=l,n.forEach(o=>o()))}}}function y5(){let e;return{before({doc:t}){var r;let n=t.documentElement;e=((r=t.defaultView)!=null?r:window).innerWidth-n.clientWidth},after({doc:t,d:r}){let n=t.documentElement,a=n.clientWidth-n.offsetWidth,i=e-a;r.style(n,"paddingRight",`${i}px`)}}}function b5(){return Gy()?{before({doc:e,d:t,meta:r}){function n(a){return r.containers.flatMap(i=>i()).some(i=>i.contains(a))}t.microTask(()=>{var a;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let o=er();o.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>o.dispose()))}let i=(a=window.scrollY)!=null?a:window.pageYOffset,l=null;t.addEventListener(e,"click",o=>{if(o.target instanceof HTMLElement)try{let c=o.target.closest("a");if(!c)return;let{hash:d}=new URL(c.href),m=e.querySelector(d);m&&!n(m)&&(l=m)}catch{}},!0),t.addEventListener(e,"touchstart",o=>{if(o.target instanceof HTMLElement)if(n(o.target)){let c=o.target;for(;c.parentElement&&n(c.parentElement);)c=c.parentElement;t.style(c,"overscrollBehavior","contain")}else t.style(o.target,"touchAction","none")}),t.addEventListener(e,"touchmove",o=>{if(o.target instanceof HTMLElement)if(n(o.target)){let c=o.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&o.preventDefault()}else o.preventDefault()},{passive:!1}),t.add(()=>{var o;let c=(o=window.scrollY)!=null?o:window.pageYOffset;i!==c&&window.scrollTo(0,i),l&&l.isConnected&&(l.scrollIntoView({block:"nearest"}),l=null)})})}}:{}}function v5(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function j5(e){let t={};for(let r of e)Object.assign(t,r(t));return t}let Qn=p5(()=>new Map,{PUSH(e,t){var r;let n=(r=this.get(e))!=null?r:{doc:e,count:0,d:er(),meta:new Set};return n.count++,n.meta.add(t),this.set(e,n),this},POP(e,t){let r=this.get(e);return r&&(r.count--,r.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:r}){let n={doc:e,d:t,meta:j5(r)},a=[b5(),y5(),v5()];a.forEach(({before:i})=>i==null?void 0:i(n)),a.forEach(({after:i})=>i==null?void 0:i(n))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});Qn.subscribe(()=>{let e=Qn.getSnapshot(),t=new Map;for(let[r]of e)t.set(r,r.documentElement.style.overflow);for(let r of e.values()){let n=t.get(r.doc)==="hidden",a=r.count!==0;(a&&!n||!a&&n)&&Qn.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&Qn.dispatch("TEARDOWN",r)}});function w5(e,t,r){let n=x5(Qn),a=e?n.get(e):void 0,i=a?a.count>0:!1;return Ut(()=>{if(!(!e||!t))return Qn.dispatch("PUSH",e,r),()=>Qn.dispatch("POP",e,r)},[t,e]),i}let Hd=new Map,Ii=new Map;function Vf(e,t=!0){Ut(()=>{var r;if(!t)return;let n=typeof e=="function"?e():e.current;if(!n)return;function a(){var l;if(!n)return;let o=(l=Ii.get(n))!=null?l:1;if(o===1?Ii.delete(n):Ii.set(n,o-1),o!==1)return;let c=Hd.get(n);c&&(c["aria-hidden"]===null?n.removeAttribute("aria-hidden"):n.setAttribute("aria-hidden",c["aria-hidden"]),n.inert=c.inert,Hd.delete(n))}let i=(r=Ii.get(n))!=null?r:0;return Ii.set(n,i+1),i!==0||(Hd.set(n,{"aria-hidden":n.getAttribute("aria-hidden"),inert:n.inert}),n.setAttribute("aria-hidden","true"),n.inert=!0),a},[e,t])}function N5({defaultContainers:e=[],portals:t,mainTreeNodeRef:r}={}){var n;let a=u.useRef((n=r==null?void 0:r.current)!=null?n:null),i=Si(a),l=Be(()=>{var o,c,d;let m=[];for(let h of e)h!==null&&(h instanceof HTMLElement?m.push(h):"current"in h&&h.current instanceof HTMLElement&&m.push(h.current));if(t!=null&&t.current)for(let h of t.current)m.push(h);for(let h of(o=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?o:[])h!==document.body&&h!==document.head&&h instanceof HTMLElement&&h.id!=="headlessui-portal-root"&&(h.contains(a.current)||h.contains((d=(c=a.current)==null?void 0:c.getRootNode())==null?void 0:d.host)||m.some(p=>h.contains(p))||m.push(h));return m});return{resolveContainers:l,contains:Be(o=>l().some(c=>c.contains(o))),mainTreeNodeRef:a,MainTreeNode:u.useMemo(()=>function(){return r!=null?null:Le.createElement(gm,{features:wc.Hidden,ref:a})},[a,r])}}let Fh=u.createContext(()=>{});Fh.displayName="StackContext";var bm=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(bm||{});function k5(){return u.useContext(Fh)}function S5({children:e,onUpdate:t,type:r,element:n,enabled:a}){let i=k5(),l=Be((...o)=>{t==null||t(...o),i(...o)});return Ut(()=>{let o=a===void 0||a===!0;return o&&l(0,r,n),()=>{o&&l(1,r,n)}},[l,r,n,a]),Le.createElement(Fh.Provider,{value:l},e)}let cb=u.createContext(null);function db(){let e=u.useContext(cb);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,db),t}return e}function C5(){let[e,t]=u.useState([]);return[e.length>0?e.join(" "):void 0,u.useMemo(()=>function(r){let n=Be(i=>(t(l=>[...l,i]),()=>t(l=>{let o=l.slice(),c=o.indexOf(i);return c!==-1&&o.splice(c,1),o}))),a=u.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props}),[n,r.slot,r.name,r.props]);return Le.createElement(cb.Provider,{value:a},r.children)},[t])]}let _5="p";function E5(e,t){let r=Br(),{id:n=`headlessui-description-${r}`,...a}=e,i=db(),l=us(t);Ut(()=>i.register(n),[n,i.register]);let o={ref:l,...i.props,id:n};return ts({ourProps:o,theirProps:a,slot:i.slot||{},defaultTag:_5,name:i.name||"Description"})}let M5=Vt(E5),T5=Object.assign(M5,{});var A5=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(A5||{}),R5=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(R5||{});let P5={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},Nc=u.createContext(null);Nc.displayName="DialogContext";function Gl(e){let t=u.useContext(Nc);if(t===null){let r=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Gl),r}return t}function $5(e,t,r=()=>[document.body]){w5(e,t,n=>{var a;return{containers:[...(a=n.containers)!=null?a:[],r]}})}function L5(e,t){return Dt(t.type,P5,e,t)}let F5="div",I5=ui.RenderStrategy|ui.Static;function O5(e,t){let r=Br(),{id:n=`headlessui-dialog-${r}`,open:a,onClose:i,initialFocus:l,role:o="dialog",__demoMode:c=!1,...d}=e,[m,h]=u.useState(0),p=u.useRef(!1);o=function(){return o==="dialog"||o==="alertdialog"?o:(p.current||(p.current=!0,console.warn(`Invalid role [${o}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let j=Xc();a===void 0&&j!==null&&(a=(j&qt.Open)===qt.Open);let f=u.useRef(null),g=us(f,t),y=Si(f),b=e.hasOwnProperty("open")||j!==null,x=e.hasOwnProperty("onClose");if(!b&&!x)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!b)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!x)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof a!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${a}`);if(typeof i!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${i}`);let v=a?0:1,[w,N]=u.useReducer(L5,{titleId:null,descriptionId:null,panelRef:u.createRef()}),_=Be(()=>i(!1)),F=Be(B=>N({type:0,id:B})),R=ki()?c?!1:v===0:!1,J=m>1,q=u.useContext(Nc)!==null,[K,ne]=t5(),re={get current(){var B;return(B=w.panelRef.current)!=null?B:f.current}},{resolveContainers:pe,mainTreeNodeRef:ke,MainTreeNode:we}=N5({portals:K,defaultContainers:[re]}),H=J?"parent":"leaf",T=j!==null?(j&qt.Closing)===qt.Closing:!1,Y=q||T?!1:R,G=u.useCallback(()=>{var B,Q;return(Q=Array.from((B=y==null?void 0:y.querySelectorAll("body > *"))!=null?B:[]).find(U=>U.id==="headlessui-portal-root"?!1:U.contains(ke.current)&&U instanceof HTMLElement))!=null?Q:null},[ke]);Vf(G,Y);let X=J?!0:R,ie=u.useCallback(()=>{var B,Q;return(Q=Array.from((B=y==null?void 0:y.querySelectorAll("[data-headlessui-portal]"))!=null?B:[]).find(U=>U.contains(ke.current)&&U instanceof HTMLElement))!=null?Q:null},[ke]);Vf(ie,X),Jy(pe,B=>{B.preventDefault(),_()},!(!R||J));let xe=!(J||v!==0);sb(y==null?void 0:y.defaultView,"keydown",B=>{xe&&(B.defaultPrevented||B.key===Ft.Escape&&(B.preventDefault(),B.stopPropagation(),_()))}),$5(y,!(T||v!==0||q),pe),u.useEffect(()=>{if(v!==0||!f.current)return;let B=new ResizeObserver(Q=>{for(let U of Q){let me=U.target.getBoundingClientRect();me.x===0&&me.y===0&&me.width===0&&me.height===0&&_()}});return B.observe(f.current),()=>B.disconnect()},[v,f,_]);let[P,ae]=C5(),je=u.useMemo(()=>[{dialogState:v,close:_,setTitleId:F},w],[v,w,_,F]),E=u.useMemo(()=>({open:v===0}),[v]),V={ref:g,id:n,role:o,"aria-modal":v===0?!0:void 0,"aria-labelledby":w.titleId,"aria-describedby":P};return Le.createElement(S5,{type:"Dialog",enabled:v===0,element:f,onUpdate:Be((B,Q)=>{Q==="Dialog"&&Dt(B,{[bm.Add]:()=>h(U=>U+1),[bm.Remove]:()=>h(U=>U-1)})})},Le.createElement(xm,{force:!0},Le.createElement(ym,null,Le.createElement(Nc.Provider,{value:je},Le.createElement(ym.Group,{target:f},Le.createElement(xm,{force:!1},Le.createElement(ae,{slot:E,name:"Dialog.Description"},Le.createElement(Fi,{initialFocus:l,containers:pe,features:R?Dt(H,{parent:Fi.features.RestoreFocus,leaf:Fi.features.All&~Fi.features.FocusLock}):Fi.features.None},Le.createElement(ne,null,ts({ourProps:V,theirProps:d,slot:E,defaultTag:F5,features:I5,visible:v===0,name:"Dialog"}))))))))),Le.createElement(we,null))}let D5="div";function z5(e,t){let r=Br(),{id:n=`headlessui-dialog-overlay-${r}`,...a}=e,[{dialogState:i,close:l}]=Gl("Dialog.Overlay"),o=us(t),c=Be(m=>{if(m.target===m.currentTarget){if(tb(m.currentTarget))return m.preventDefault();m.preventDefault(),m.stopPropagation(),l()}}),d=u.useMemo(()=>({open:i===0}),[i]);return ts({ourProps:{ref:o,id:n,"aria-hidden":!0,onClick:c},theirProps:a,slot:d,defaultTag:D5,name:"Dialog.Overlay"})}let U5="div";function H5(e,t){let r=Br(),{id:n=`headlessui-dialog-backdrop-${r}`,...a}=e,[{dialogState:i},l]=Gl("Dialog.Backdrop"),o=us(t);u.useEffect(()=>{if(l.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[l.panelRef]);let c=u.useMemo(()=>({open:i===0}),[i]);return Le.createElement(xm,{force:!0},Le.createElement(ym,null,ts({ourProps:{ref:o,id:n,"aria-hidden":!0},theirProps:a,slot:c,defaultTag:U5,name:"Dialog.Backdrop"})))}let B5="div";function q5(e,t){let r=Br(),{id:n=`headlessui-dialog-panel-${r}`,...a}=e,[{dialogState:i},l]=Gl("Dialog.Panel"),o=us(t,l.panelRef),c=u.useMemo(()=>({open:i===0}),[i]),d=Be(m=>{m.stopPropagation()});return ts({ourProps:{ref:o,id:n,onClick:d},theirProps:a,slot:c,defaultTag:B5,name:"Dialog.Panel"})}let W5="h2";function K5(e,t){let r=Br(),{id:n=`headlessui-dialog-title-${r}`,...a}=e,[{dialogState:i,setTitleId:l}]=Gl("Dialog.Title"),o=us(t);u.useEffect(()=>(l(n),()=>l(null)),[n,l]);let c=u.useMemo(()=>({open:i===0}),[i]);return ts({ourProps:{ref:o,id:n},theirProps:a,slot:c,defaultTag:W5,name:"Dialog.Title"})}let Q5=Vt(O5),V5=Vt(H5),G5=Vt(q5),Y5=Vt(z5),J5=Vt(K5),Gf=Object.assign(Q5,{Backdrop:V5,Panel:G5,Overlay:Y5,Title:J5,Description:T5}),Yf=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Jf(e){var t,r;let n=(t=e.innerText)!=null?t:"",a=e.cloneNode(!0);if(!(a instanceof HTMLElement))return n;let i=!1;for(let o of a.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),i=!0;let l=i?(r=a.innerText)!=null?r:"":n;return Yf.test(l)&&(l=l.replace(Yf,"")),l}function X5(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let r=e.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(a=>{let i=document.getElementById(a);if(i){let l=i.getAttribute("aria-label");return typeof l=="string"?l.trim():Jf(i).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return Jf(e).trim()}function Z5(e){let t=u.useRef(""),r=u.useRef("");return Be(()=>{let n=e.current;if(!n)return"";let a=n.innerText;if(t.current===a)return r.current;let i=X5(n).trim().toLowerCase();return t.current=a,r.current=i,i})}var e4=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(e4||{}),t4=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(t4||{}),s4=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(s4||{});function Bd(e,t=r=>r){let r=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=Vy(t(e.items.slice()),i=>i.dataRef.current.domRef.current),a=r?n.indexOf(r):null;return a===-1&&(a=null),{items:n,activeItemIndex:a}}let r4={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var r;let n=Bd(e),a=zk(t,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeItemIndex:a,activationTrigger:(r=t.trigger)!=null?r:1}},3:(e,t)=>{let r=e.searchQuery!==""?0:1,n=e.searchQuery+t.value.toLowerCase(),a=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(l=>{var o;return((o=l.dataRef.current.textValue)==null?void 0:o.startsWith(n))&&!l.dataRef.current.disabled}),i=a?e.items.indexOf(a):-1;return i===-1||i===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:i,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let r=Bd(e,n=>[...n,{id:t.id,dataRef:t.dataRef}]);return{...e,...r}},6:(e,t)=>{let r=Bd(e,n=>{let a=n.findIndex(i=>i.id===t.id);return a!==-1&&n.splice(a,1),n});return{...e,...r,activationTrigger:1}}},Ih=u.createContext(null);Ih.displayName="MenuContext";function Zc(e){let t=u.useContext(Ih);if(t===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Zc),r}return t}function n4(e,t){return Dt(t.type,r4,e,t)}let a4=u.Fragment;function i4(e,t){let{__demoMode:r=!1,...n}=e,a=u.useReducer(n4,{__demoMode:r,menuState:r?0:1,buttonRef:u.createRef(),itemsRef:u.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:i,itemsRef:l,buttonRef:o},c]=a,d=us(t);Jy([o,l],(j,f)=>{var g;c({type:1}),Ph(f,Rh.Loose)||(j.preventDefault(),(g=o.current)==null||g.focus())},i===0);let m=Be(()=>{c({type:1})}),h=u.useMemo(()=>({open:i===0,close:m}),[i,m]),p={ref:d};return Le.createElement(Ih.Provider,{value:a},Le.createElement(eb,{value:Dt(i,{0:qt.Open,1:qt.Closed})},ts({ourProps:p,theirProps:n,slot:h,defaultTag:a4,name:"Menu"})))}let l4="button";function o4(e,t){var r;let n=Br(),{id:a=`headlessui-menu-button-${n}`,...i}=e,[l,o]=Zc("Menu.Button"),c=us(l.buttonRef,t),d=Ql(),m=Be(g=>{switch(g.key){case Ft.Space:case Ft.Enter:case Ft.ArrowDown:g.preventDefault(),g.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Gs.First}));break;case Ft.ArrowUp:g.preventDefault(),g.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Gs.Last}));break}}),h=Be(g=>{switch(g.key){case Ft.Space:g.preventDefault();break}}),p=Be(g=>{if(tb(g.currentTarget))return g.preventDefault();e.disabled||(l.menuState===0?(o({type:1}),d.nextFrame(()=>{var y;return(y=l.buttonRef.current)==null?void 0:y.focus({preventScroll:!0})})):(g.preventDefault(),o({type:0})))}),j=u.useMemo(()=>({open:l.menuState===0}),[l]),f={ref:c,id:a,type:Tk(e,l.buttonRef),"aria-haspopup":"menu","aria-controls":(r=l.itemsRef.current)==null?void 0:r.id,"aria-expanded":l.menuState===0,onKeyDown:m,onKeyUp:h,onClick:p};return ts({ourProps:f,theirProps:i,slot:j,defaultTag:l4,name:"Menu.Button"})}let c4="div",d4=ui.RenderStrategy|ui.Static;function u4(e,t){var r,n;let a=Br(),{id:i=`headlessui-menu-items-${a}`,...l}=e,[o,c]=Zc("Menu.Items"),d=us(o.itemsRef,t),m=Si(o.itemsRef),h=Ql(),p=Xc(),j=p!==null?(p&qt.Open)===qt.Open:o.menuState===0;u.useEffect(()=>{let x=o.itemsRef.current;x&&o.menuState===0&&x!==(m==null?void 0:m.activeElement)&&x.focus({preventScroll:!0})},[o.menuState,o.itemsRef,m]),Pk({container:o.itemsRef.current,enabled:o.menuState===0,accept(x){return x.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:x.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(x){x.setAttribute("role","none")}});let f=Be(x=>{var v,w;switch(h.dispose(),x.key){case Ft.Space:if(o.searchQuery!=="")return x.preventDefault(),x.stopPropagation(),c({type:3,value:x.key});case Ft.Enter:if(x.preventDefault(),x.stopPropagation(),c({type:1}),o.activeItemIndex!==null){let{dataRef:N}=o.items[o.activeItemIndex];(w=(v=N.current)==null?void 0:v.domRef.current)==null||w.click()}Qy(o.buttonRef.current);break;case Ft.ArrowDown:return x.preventDefault(),x.stopPropagation(),c({type:2,focus:Gs.Next});case Ft.ArrowUp:return x.preventDefault(),x.stopPropagation(),c({type:2,focus:Gs.Previous});case Ft.Home:case Ft.PageUp:return x.preventDefault(),x.stopPropagation(),c({type:2,focus:Gs.First});case Ft.End:case Ft.PageDown:return x.preventDefault(),x.stopPropagation(),c({type:2,focus:Gs.Last});case Ft.Escape:x.preventDefault(),x.stopPropagation(),c({type:1}),er().nextFrame(()=>{var N;return(N=o.buttonRef.current)==null?void 0:N.focus({preventScroll:!0})});break;case Ft.Tab:x.preventDefault(),x.stopPropagation(),c({type:1}),er().nextFrame(()=>{_k(o.buttonRef.current,x.shiftKey?Mr.Previous:Mr.Next)});break;default:x.key.length===1&&(c({type:3,value:x.key}),h.setTimeout(()=>c({type:4}),350));break}}),g=Be(x=>{switch(x.key){case Ft.Space:x.preventDefault();break}}),y=u.useMemo(()=>({open:o.menuState===0}),[o]),b={"aria-activedescendant":o.activeItemIndex===null||(r=o.items[o.activeItemIndex])==null?void 0:r.id,"aria-labelledby":(n=o.buttonRef.current)==null?void 0:n.id,id:i,onKeyDown:f,onKeyUp:g,role:"menu",tabIndex:0,ref:d};return ts({ourProps:b,theirProps:l,slot:y,defaultTag:c4,features:d4,visible:j,name:"Menu.Items"})}let m4=u.Fragment;function h4(e,t){let r=Br(),{id:n=`headlessui-menu-item-${r}`,disabled:a=!1,...i}=e,[l,o]=Zc("Menu.Item"),c=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===n:!1,d=u.useRef(null),m=us(t,d);Ut(()=>{if(l.__demoMode||l.menuState!==0||!c||l.activationTrigger===0)return;let N=er();return N.requestAnimationFrame(()=>{var _,F;(F=(_=d.current)==null?void 0:_.scrollIntoView)==null||F.call(_,{block:"nearest"})}),N.dispose},[l.__demoMode,d,c,l.menuState,l.activationTrigger,l.activeItemIndex]);let h=Z5(d),p=u.useRef({disabled:a,domRef:d,get textValue(){return h()}});Ut(()=>{p.current.disabled=a},[p,a]),Ut(()=>(o({type:5,id:n,dataRef:p}),()=>o({type:6,id:n})),[p,n]);let j=Be(()=>{o({type:1})}),f=Be(N=>{if(a)return N.preventDefault();o({type:1}),Qy(l.buttonRef.current)}),g=Be(()=>{if(a)return o({type:2,focus:Gs.Nothing});o({type:2,focus:Gs.Specific,id:n})}),y=Rk(),b=Be(N=>y.update(N)),x=Be(N=>{y.wasMoved(N)&&(a||c||o({type:2,focus:Gs.Specific,id:n,trigger:0}))}),v=Be(N=>{y.wasMoved(N)&&(a||c&&o({type:2,focus:Gs.Nothing}))}),w=u.useMemo(()=>({active:c,disabled:a,close:j}),[c,a,j]);return ts({ourProps:{id:n,ref:m,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,disabled:void 0,onClick:f,onFocus:g,onPointerEnter:b,onMouseEnter:b,onPointerMove:x,onMouseMove:x,onPointerLeave:v,onMouseLeave:v},theirProps:i,slot:w,defaultTag:m4,name:"Menu.Item"})}let f4=Vt(i4),g4=Vt(o4),x4=Vt(u4),p4=Vt(h4),Oi=Object.assign(f4,{Button:g4,Items:x4,Item:p4});function y4(e=0){let[t,r]=u.useState(e),n=Vl(),a=u.useCallback(c=>{n.current&&r(d=>d|c)},[t,n]),i=u.useCallback(c=>!!(t&c),[t]),l=u.useCallback(c=>{n.current&&r(d=>d&~c)},[r,n]),o=u.useCallback(c=>{n.current&&r(d=>d^c)},[r]);return{flags:t,addFlag:a,hasFlag:i,removeFlag:l,toggleFlag:o}}function b4(e){let t={called:!1};return(...r)=>{if(!t.called)return t.called=!0,e(...r)}}function qd(e,...t){e&&t.length>0&&e.classList.add(...t)}function Wd(e,...t){e&&t.length>0&&e.classList.remove(...t)}function v4(e,t){let r=er();if(!e)return r.dispose;let{transitionDuration:n,transitionDelay:a}=getComputedStyle(e),[i,l]=[n,a].map(c=>{let[d=0]=c.split(",").filter(Boolean).map(m=>m.includes("ms")?parseFloat(m):parseFloat(m)*1e3).sort((m,h)=>h-m);return d}),o=i+l;if(o!==0){r.group(d=>{d.setTimeout(()=>{t(),d.dispose()},o),d.addEventListener(e,"transitionrun",m=>{m.target===m.currentTarget&&d.dispose()})});let c=r.addEventListener(e,"transitionend",d=>{d.target===d.currentTarget&&(t(),c())})}else t();return r.add(()=>t()),r.dispose}function j4(e,t,r,n){let a=r?"enter":"leave",i=er(),l=n!==void 0?b4(n):()=>{};a==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let o=Dt(a,{enter:()=>t.enter,leave:()=>t.leave}),c=Dt(a,{enter:()=>t.enterTo,leave:()=>t.leaveTo}),d=Dt(a,{enter:()=>t.enterFrom,leave:()=>t.leaveFrom});return Wd(e,...t.base,...t.enter,...t.enterTo,...t.enterFrom,...t.leave,...t.leaveFrom,...t.leaveTo,...t.entered),qd(e,...t.base,...o,...d),i.nextFrame(()=>{Wd(e,...t.base,...o,...d),qd(e,...t.base,...o,...c),v4(e,()=>(Wd(e,...t.base,...o),qd(e,...t.base,...t.entered),l()))}),i.dispose}function w4({immediate:e,container:t,direction:r,classes:n,onStart:a,onStop:i}){let l=Vl(),o=Ql(),c=Lr(r);Ut(()=>{e&&(c.current="enter")},[e]),Ut(()=>{let d=er();o.add(d.dispose);let m=t.current;if(m&&c.current!=="idle"&&l.current)return d.dispose(),a.current(c.current),d.add(j4(m,n.current,c.current==="enter",()=>{d.dispose(),i.current(c.current)})),d.dispose},[r])}function Kr(e=""){return e.split(/\s+/).filter(t=>t.length>1)}let ed=u.createContext(null);ed.displayName="TransitionContext";var N4=(e=>(e.Visible="visible",e.Hidden="hidden",e))(N4||{});function k4(){let e=u.useContext(ed);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function S4(){let e=u.useContext(td);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let td=u.createContext(null);td.displayName="NestingContext";function sd(e){return"children"in e?sd(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function ub(e,t){let r=Lr(e),n=u.useRef([]),a=Vl(),i=Ql(),l=Be((j,f=gn.Hidden)=>{let g=n.current.findIndex(({el:y})=>y===j);g!==-1&&(Dt(f,{[gn.Unmount](){n.current.splice(g,1)},[gn.Hidden](){n.current[g].state="hidden"}}),i.microTask(()=>{var y;!sd(n)&&a.current&&((y=r.current)==null||y.call(r))}))}),o=Be(j=>{let f=n.current.find(({el:g})=>g===j);return f?f.state!=="visible"&&(f.state="visible"):n.current.push({el:j,state:"visible"}),()=>l(j,gn.Unmount)}),c=u.useRef([]),d=u.useRef(Promise.resolve()),m=u.useRef({enter:[],leave:[],idle:[]}),h=Be((j,f,g)=>{c.current.splice(0),t&&(t.chains.current[f]=t.chains.current[f].filter(([y])=>y!==j)),t==null||t.chains.current[f].push([j,new Promise(y=>{c.current.push(y)})]),t==null||t.chains.current[f].push([j,new Promise(y=>{Promise.all(m.current[f].map(([b,x])=>x)).then(()=>y())})]),f==="enter"?d.current=d.current.then(()=>t==null?void 0:t.wait.current).then(()=>g(f)):g(f)}),p=Be((j,f,g)=>{Promise.all(m.current[f].splice(0).map(([y,b])=>b)).then(()=>{var y;(y=c.current.shift())==null||y()}).then(()=>g(f))});return u.useMemo(()=>({children:n,register:o,unregister:l,onStart:h,onStop:p,wait:d,chains:m}),[o,l,n,h,p,m,d])}function C4(){}let _4=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Xf(e){var t;let r={};for(let n of _4)r[n]=(t=e[n])!=null?t:C4;return r}function E4(e){let t=u.useRef(Xf(e));return u.useEffect(()=>{t.current=Xf(e)},[e]),t}let M4="div",mb=ui.RenderStrategy;function T4(e,t){var r,n;let{beforeEnter:a,afterEnter:i,beforeLeave:l,afterLeave:o,enter:c,enterFrom:d,enterTo:m,entered:h,leave:p,leaveFrom:j,leaveTo:f,...g}=e,y=u.useRef(null),b=us(y,t),x=(r=g.unmount)==null||r?gn.Unmount:gn.Hidden,{show:v,appear:w,initial:N}=k4(),[_,F]=u.useState(v?"visible":"hidden"),R=S4(),{register:J,unregister:q}=R;u.useEffect(()=>J(y),[J,y]),u.useEffect(()=>{if(x===gn.Hidden&&y.current){if(v&&_!=="visible"){F("visible");return}return Dt(_,{hidden:()=>q(y),visible:()=>J(y)})}},[_,y,J,q,v,x]);let K=Lr({base:Kr(g.className),enter:Kr(c),enterFrom:Kr(d),enterTo:Kr(m),entered:Kr(h),leave:Kr(p),leaveFrom:Kr(j),leaveTo:Kr(f)}),ne=E4({beforeEnter:a,afterEnter:i,beforeLeave:l,afterLeave:o}),re=ki();u.useEffect(()=>{if(re&&_==="visible"&&y.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[y,_,re]);let pe=N&&!w,ke=w&&v&&N,we=!re||pe?"idle":v?"enter":"leave",H=y4(0),T=Be(xe=>Dt(xe,{enter:()=>{H.addFlag(qt.Opening),ne.current.beforeEnter()},leave:()=>{H.addFlag(qt.Closing),ne.current.beforeLeave()},idle:()=>{}})),Y=Be(xe=>Dt(xe,{enter:()=>{H.removeFlag(qt.Opening),ne.current.afterEnter()},leave:()=>{H.removeFlag(qt.Closing),ne.current.afterLeave()},idle:()=>{}})),G=ub(()=>{F("hidden"),q(y)},R),X=u.useRef(!1);w4({immediate:ke,container:y,classes:K,direction:we,onStart:Lr(xe=>{X.current=!0,G.onStart(y,xe,T)}),onStop:Lr(xe=>{X.current=!1,G.onStop(y,xe,Y),xe==="leave"&&!sd(G)&&(F("hidden"),q(y))})});let ie=g,se={ref:b};return ke?ie={...ie,className:jc(g.className,...K.current.enter,...K.current.enterFrom)}:X.current&&(ie.className=jc(g.className,(n=y.current)==null?void 0:n.className),ie.className===""&&delete ie.className),Le.createElement(td.Provider,{value:G},Le.createElement(eb,{value:Dt(_,{visible:qt.Open,hidden:qt.Closed})|H.flags},ts({ourProps:se,theirProps:ie,defaultTag:M4,features:mb,visible:_==="visible",name:"Transition.Child"})))}function A4(e,t){let{show:r,appear:n=!1,unmount:a=!0,...i}=e,l=u.useRef(null),o=us(l,t);ki();let c=Xc();if(r===void 0&&c!==null&&(r=(c&qt.Open)===qt.Open),![!0,!1].includes(r))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,m]=u.useState(r?"visible":"hidden"),h=ub(()=>{m("hidden")}),[p,j]=u.useState(!0),f=u.useRef([r]);Ut(()=>{p!==!1&&f.current[f.current.length-1]!==r&&(f.current.push(r),j(!1))},[f,r]);let g=u.useMemo(()=>({show:r,appear:n,initial:p}),[r,n,p]);u.useEffect(()=>{if(r)m("visible");else if(!sd(h))m("hidden");else{let v=l.current;if(!v)return;let w=v.getBoundingClientRect();w.x===0&&w.y===0&&w.width===0&&w.height===0&&m("hidden")}},[r,h]);let y={unmount:a},b=Be(()=>{var v;p&&j(!1),(v=e.beforeEnter)==null||v.call(e)}),x=Be(()=>{var v;p&&j(!1),(v=e.beforeLeave)==null||v.call(e)});return Le.createElement(td.Provider,{value:h},Le.createElement(ed.Provider,{value:g},ts({ourProps:{...y,as:u.Fragment,children:Le.createElement(hb,{ref:o,...y,...i,beforeEnter:b,beforeLeave:x})},theirProps:{},defaultTag:u.Fragment,features:mb,visible:d==="visible",name:"Transition"})))}function R4(e,t){let r=u.useContext(ed)!==null,n=Xc()!==null;return Le.createElement(Le.Fragment,null,!r&&n?Le.createElement(vm,{ref:t,...e}):Le.createElement(hb,{ref:t,...e}))}let vm=Vt(A4),hb=Vt(T4),P4=Vt(R4),Gi=Object.assign(vm,{Child:P4,Root:vm});/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),L4=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),Zf=e=>{const t=L4(e);return t.charAt(0).toUpperCase()+t.slice(1)},fb=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),F4=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var I4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=u.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...o},c)=>u.createElement("svg",{ref:c,...I4,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:fb("lucide",a),...!i&&!F4(o)&&{"aria-hidden":"true"},...o},[...l.map(([d,m])=>u.createElement(d,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=(e,t)=>{const r=u.forwardRef(({className:n,...a},i)=>u.createElement(O4,{ref:i,iconNode:t,className:fb(`lucide-${$4(Zf(e))}`,`lucide-${e}`,n),...a}));return r.displayName=Zf(e),r};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],gb=ue("archive",D4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],U4=ue("arrow-down",z4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],B4=ue("arrow-left",H4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]],Di=ue("at-sign",q4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],K4=ue("book-open",W4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],V4=ue("bot",Q4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],xb=ue("building-2",G4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y4=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],J4=ue("building",Y4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X4=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],pb=ue("calendar",X4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],e3=ue("camera",Z4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],jm=ue("check",t3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],qs=ue("chevron-down",s3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Yl=ue("chevron-right",r3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],mi=ue("chevron-left",n3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],or=ue("chevron-up",a3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rd=ue("circle-alert",i3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],dt=ue("circle-check-big",l3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],xr=ue("circle-x",o3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],Fa=ue("clipboard",c3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Tl=ue("clock",d3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],m3=ue("cloud",u3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],yb=ue("code",h3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],bb=ue("copy",f3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],x3=ue("dollar-sign",g3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],kc=ue("download",p3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ll=ue("external-link",y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],Oh=ue("facebook",b3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],j3=ue("eye",v3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],eg=ue("file-text",w3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],qo=ue("file",N3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],S3=ue("funnel",k3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],tg=ue("git-merge",C3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Dh=ue("globe",_3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ot=ue("hash",E3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Sc=ue("image",M3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],vb=ue("inbox",T3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],wm=ue("info",A3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],zh=ue("instagram",R3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],$3=ue("languages",P3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],jb=ue("loader-circle",L3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],tr=ue("mail",F3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],O3=ue("message-circle",I3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Ur=ue("message-square",D3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],wb=ue("package",z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],St=ue("paperclip",U3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Uh=ue("pen",H3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Nb=ue("pencil",B3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],xa=ue("phone",q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],nd=ue("plus",W3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Yi=ue("refresh-cw",K3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],kb=ue("rotate-ccw",Q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],G3=ue("ruler",V3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Jl=ue("save",Y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],hi=ue("search",J3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ad=ue("send",X3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],fi=ue("settings",Z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],tS=ue("shield",eS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],ol=ue("shopping-bag",sS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],nS=ue("smile",rS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Xs=ue("sparkles",aS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],lS=ue("star",iS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],Cc=ue("sticky-note",oS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],Sb=ue("store",cS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],sg=ue("tag",dS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],mS=ue("ticket",uS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],gi=ue("trash-2",hS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],gS=ue("triangle-alert",fS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Cb=ue("upload",xS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Al=ue("user-plus",pS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],xn=ue("user",yS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Xl=ue("users",bS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],_t=ue("x",vS);function jS({ticketCounts:e={all:0,myTickets:0,pending:0,unassigned:0,snoozed:0,resolved:0,escalated:0,escalatedToMe:0,vip:0,allAssigned:0,staffCounts:{}},isCollapsed:t,onToggle:r}){var P;const{data:n}=he({queryKey:["staff-list-sidebar"],queryFn:async()=>(await O.get("/api/staff")).data,staleTime:6e4}),a=(n==null?void 0:n.staff)||[],i=$n(),l=yr(),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,p]=u.useState(!1),[j,f]=u.useState(!1),[g,y]=u.useState(!1),[b,x]=u.useState(!1),[v,w]=u.useState(!1),[N,_]=u.useState(!1),[F,R]=u.useState(!1),[J,q]=u.useState(!1),[K,ne]=u.useState(!1),[re,pe]=u.useState(!1),ke=ae=>i.pathname===ae,we=({title:ae,icon:je,isExpanded:E,onToggle:V,children:B,hasSubmenu:Q=!0})=>s.jsxs("div",{className:"mb-2",children:[s.jsxs("button",{onClick:V,className:"w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsxs("span",{className:"flex items-center text-gray-700 font-medium",children:[je,s.jsx("span",{className:je?"ml-2":"",children:ae})]}),Q&&(E?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"}))]}),E&&B&&s.jsx("div",{className:"ml-6 mt-1 space-y-1",children:B})]}),H=({to:ae,children:je,count:E})=>{const V=()=>{const[B,Q]=ae.split("?"),U=i.pathname,me=i.search;return Q?U===B&&me.includes(Q):U===B&&!me};return s.jsxs(lt,{to:ae,preventScrollReset:!0,className:`flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${V()?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:je}),E!==void 0&&s.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-200 text-gray-700",children:E})]})},T=({to:ae,children:je})=>s.jsx(lt,{to:ae,preventScrollReset:!0,className:`block px-3 py-1.5 text-sm rounded-lg transition-colors ${ke(ae)?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-500 hover:bg-gray-50 hover:text-gray-700"}`,children:je}),Y=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),G=()=>s.jsxs("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),X=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),ie=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),se=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),xe=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),$e=()=>s.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});return s.jsxs("div",{className:`bg-white border-r border-gray-200 h-screen flex flex-col transition-all duration-300 ${t?"w-16":"w-64"}`,children:[s.jsx("div",{className:"flex-shrink-0 h-14 flex items-center px-4 border-b border-gray-200",children:s.jsx("button",{onClick:r,className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:t?"Expand Navigation":"Collapse Navigation",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),t?s.jsxs("div",{className:"flex flex-col items-center py-4 space-y-3",children:[s.jsx("button",{onClick:()=>{r(),l("/tickets"),c(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname==="/tickets"||i.pathname.startsWith("/tickets/")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Tickets",children:s.jsx(Y,{})}),s.jsx("button",{onClick:()=>{r(),l("/chat")},className:`p-2 rounded-lg transition-colors ${i.pathname==="/chat"?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"AI Chat",children:s.jsx(G,{})}),s.jsx("button",{onClick:()=>{r(),l("/group-chat"),f(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/group-chat")||i.pathname==="/notifications"||i.pathname==="/mentions"?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Group Chat",children:s.jsx(X,{})}),s.jsx("button",{onClick:()=>{r(),l("/staff"),p(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/staff")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Staff",children:s.jsx(ie,{})}),s.jsx("button",{onClick:()=>{r(),l("/customers"),m(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/customers")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Customers",children:s.jsx(se,{})}),s.jsx("button",{onClick:()=>{r(),l("/analytics/ai-agent")},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/analytics")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Analytics",children:s.jsx(xe,{})}),s.jsx("button",{onClick:()=>{r(),l("/settings"),y(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/settings")||i.pathname.startsWith("/ai-agent")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Settings",children:s.jsx($e,{})})]}):s.jsxs("div",{className:"overflow-y-auto flex-1 p-3",children:[s.jsxs(we,{title:"Tickets",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),isExpanded:o,onToggle:()=>c(!o),children:[s.jsx(H,{to:"/tickets",count:e.all,children:"All Tickets"}),s.jsx(H,{to:"/tickets?filter=my",count:e.myTickets,children:"My Tickets"}),s.jsx(H,{to:"/tickets?status=open",count:e.pending,children:"Open (in-progress)"}),s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>x(!b),className:"w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx("span",{className:"text-gray-600",children:"Assigned"}),b?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),b&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(H,{to:"/tickets?filter=all-assigned",count:e.allAssigned,children:"All"}),a.filter(ae=>ae.id!=="ai-agent-001").map(ae=>{var je;return s.jsx(H,{to:`/tickets?assigned=${ae.id}`,count:((je=e.staffCounts)==null?void 0:je[ae.id])||0,children:ae.first_name},ae.id)}),s.jsx(H,{to:"/tickets?assigned=ai-agent-001",count:((P=e.staffCounts)==null?void 0:P["ai-agent-001"])||0,children:"McCarthy AI"})]})]}),s.jsx(H,{to:"/tickets?filter=unassigned",count:e.unassigned,children:"Unassigned"}),s.jsx(H,{to:"/tickets?status=snoozed",count:e.snoozed,children:"Snoozed"}),s.jsx(H,{to:"/tickets?filter=vip",count:e.vip,children:"VIP"}),s.jsx(H,{to:"/tickets?status=resolved",count:e.resolved,children:"Resolved"})]}),s.jsxs(lt,{to:"/chat",className:`flex items-center px-3 py-2 mb-2 text-sm rounded-lg transition-colors ${ke("/chat")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[s.jsxs("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),"AI Chat"]}),s.jsxs(we,{title:"Group Chat",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),isExpanded:j,onToggle:()=>f(!j),children:[s.jsx(T,{to:"/group-chat",children:"All Chats"}),s.jsx(T,{to:"/mentions",children:"@Mentions"}),s.jsx(T,{to:"/memo",children:"@Memos"}),s.jsx(T,{to:"/tags",children:"Tags"})]}),s.jsx(we,{title:"Staff",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),isExpanded:h,onToggle:()=>p(!h),children:s.jsx(T,{to:"/staff",children:"List"})}),s.jsxs(we,{title:"Customers",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),isExpanded:d,onToggle:()=>m(!d),children:[s.jsx(T,{to:"/customers",children:"All Customers"}),s.jsx(T,{to:"/customers/vip",children:"VIP Customers"})]}),s.jsxs(lt,{to:"/analytics/ai-agent",className:`flex items-center px-3 py-2 mb-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/analytics")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics"]}),s.jsxs(we,{title:"Settings",icon:s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),isExpanded:g,onToggle:()=>y(!g),children:[s.jsx(T,{to:"/settings/dartmouth-os",children:"Dartmouth OS"}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>ne(!K),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/business")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Business"}),K?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),K&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(T,{to:"/settings/business-hours",children:"Operational Hours"}),s.jsx(T,{to:"/settings/auto-assignment",children:"Auto-Assignment"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>pe(!re),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/ai-agent")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"AI Agent"}),re?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),re&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(T,{to:"/ai-agent/widget",children:"Widget & Embed"}),s.jsx(T,{to:"/ai-agent/knowledge",children:"RAG Knowledge"}),s.jsx(T,{to:"/ai-agent/system-message",children:"System Message"}),s.jsx(T,{to:"/ai-agent/regional-overrides",children:"Regional Overrides"})]})]}),s.jsx(T,{to:"/settings/group-chat",children:"Group Chat"}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>w(!v),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/integrations")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Integrations"}),v?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),v&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(T,{to:"/settings/integrations/perp",children:"Print ERP"}),s.jsx(T,{to:"/settings/integrations/shopify",children:"Shopify"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>_(!N),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/meta")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Meta"}),N?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),N&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(T,{to:"/settings/meta/facebook",children:"Facebook"}),s.jsx(T,{to:"/settings/meta/instagram",children:"Instagram"}),s.jsx(T,{to:"/settings/meta/messenger",children:"Messenger"}),s.jsx(T,{to:"/settings/meta/whatsapp",children:"WhatsApp"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>R(!F),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/general")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"General"}),F?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),F&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(T,{to:"/settings/general/auth",children:"Auth & Security"}),s.jsx(T,{to:"/settings/email",children:"Email"}),s.jsx(T,{to:"/settings/general/templates",children:"Templates"}),s.jsx(T,{to:"/settings/tags",children:"Tags"})]})]}),s.jsxs("div",{className:"mb-1",children:[s.jsxs("button",{onClick:()=>q(!J),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/billing")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[s.jsx("span",{children:"Billing"}),J?s.jsx(or,{className:"w-4 h-4 text-gray-400"}):s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),J&&s.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[s.jsx(T,{to:"/settings/billing/subscription",children:"Subscription"}),s.jsx(T,{to:"/settings/billing/transactions",children:"Transactions"})]})]})]})]})]})}function wS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const rg=u.forwardRef(wS);function NS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const kS=u.forwardRef(NS);function SS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const CS=u.forwardRef(SS);function _S({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const ES=u.forwardRef(_S);function MS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const TS=u.forwardRef(MS);function AS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const RS=u.forwardRef(AS);function PS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Nm=u.forwardRef(PS);function $S({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ng=u.forwardRef($S);function LS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Wo=u.forwardRef(LS);function FS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const IS=u.forwardRef(FS);function OS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const DS=u.forwardRef(OS);function zS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"}))}const US=u.forwardRef(zS);function HS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const BS=u.forwardRef(HS);function qS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const WS=u.forwardRef(qS);function KS({title:e,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?u.createElement("title",{id:t},e):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const QS=u.forwardRef(KS),Kd={online:{color:"bg-green-500",ringColor:"ring-green-400",label:"Online"},away:{color:"bg-yellow-500",ringColor:"ring-yellow-400",label:"Away"},offline:{color:"bg-gray-400",ringColor:"ring-gray-400",label:"Offline"}};function VS(){var d,m,h,p,j,f;const e=yr(),{user:t,logout:r}=ws(),n=mt(),{data:a}=he({queryKey:["currentStaff"],queryFn:()=>tt.me().then(g=>g.data.staff),enabled:!!t,refetchInterval:3e4}),i=Ce({mutationFn:g=>tt.updateAvailability((t==null?void 0:t.id)||"",g),onSuccess:()=>{n.invalidateQueries({queryKey:["currentStaff"]})}}),l=(a==null?void 0:a.availability_status)||"offline",o=Kd[l],c=()=>{r(),e("/login")};return s.jsxs(Oi,{as:"div",className:"relative",children:[s.jsxs(Oi.Button,{className:"flex items-center gap-2 rounded-lg p-1.5 hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${o.color}`}),l==="online"&&s.jsx("div",{className:`absolute inset-0 w-2.5 h-2.5 rounded-full ${o.color} animate-ping opacity-50`})]}),s.jsx("div",{className:"relative",children:a!=null&&a.avatar_url?s.jsx("img",{src:tt.getAvatarUrl(a.avatar_url)||"",alt:`${a.first_name} ${a.last_name}`,className:"w-8 h-8 rounded-full object-cover"}):s.jsxs("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-sm font-semibold",children:[((d=a==null?void 0:a.first_name)==null?void 0:d[0])||((m=t==null?void 0:t.firstName)==null?void 0:m[0])||"U",((h=a==null?void 0:a.last_name)==null?void 0:h[0])||((p=t==null?void 0:t.lastName)==null?void 0:p[0])||""]})})]}),s.jsx(Gi,{as:u.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:s.jsxs(Oi.Items,{className:"absolute right-0 mt-2 w-64 origin-top-right rounded-xl bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:[s.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center gap-3",children:[a!=null&&a.avatar_url?s.jsx("img",{src:tt.getAvatarUrl(a.avatar_url)||"",alt:`${a.first_name} ${a.last_name}`,className:"w-10 h-10 rounded-full object-cover"}):s.jsxs("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:[(j=a==null?void 0:a.first_name)==null?void 0:j[0],(f=a==null?void 0:a.last_name)==null?void 0:f[0]]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:a==null?void 0:a.email})]})]})}),s.jsxs("div",{className:"px-2 py-2 border-b border-gray-100",children:[s.jsx("p",{className:"px-2 py-1 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),Object.keys(Kd).map(g=>{const y=Kd[g],b=g===l;return s.jsxs("button",{onClick:()=>i.mutate(g),disabled:i.isPending,className:`w-full flex items-center gap-3 px-2 py-2 rounded-lg text-left transition-colors ${b?"bg-indigo-50 text-indigo-700":"hover:bg-gray-50 text-gray-700"}`,children:[s.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${y.color}`}),s.jsx("span",{className:"text-sm font-medium flex-1",children:y.label}),b&&s.jsx(Nm,{className:"w-4 h-4 text-indigo-600"})]},g)})]}),s.jsx("div",{className:"px-2 py-2",children:s.jsx(Oi.Item,{children:({active:g})=>s.jsxs("button",{onClick:()=>e("/account"),className:`${g?"bg-gray-50":""} flex items-center gap-3 w-full px-2 py-2 text-sm text-gray-700 rounded-lg`,children:[s.jsx(WS,{className:"w-5 h-5 text-gray-400"}),"My Account"]})})}),s.jsx("div",{className:"px-2 py-2 border-t border-gray-100",children:s.jsx(Oi.Item,{children:({active:g})=>s.jsxs("button",{onClick:c,className:`${g?"bg-red-50":""} flex items-center gap-3 w-full px-2 py-2 text-sm text-red-600 rounded-lg`,children:[s.jsx(kS,{className:"w-5 h-5"}),"Sign Out"]})})})]})})]})}const GS=[{name:"Tickets",href:"/tickets",icon:US},{name:"Mentions",href:"/mentions",icon:ES},{name:"Settings",href:"/settings",icon:Wo}];function YS(){const[e,t]=u.useState(!1),[r,n]=u.useState(!0),a=$n(),{user:i}=ws(),{data:l}=he({queryKey:["tickets-all"],queryFn:async()=>(await Ie.list({limit:1e3})).data.tickets,refetchInterval:3e4}),o=l||[];console.log("DashboardLayout - All tickets:",o.map(d=>({id:d.ticket_number,assigned:d.assigned_to,status:d.status,channel:d.channel})));const c={all:o.filter(d=>d.status!=="resolved"&&d.status!=="closed").length,myTickets:o.filter(d=>(d.assigned_to===(i==null?void 0:i.id)||d.is_escalated_to_me===1)&&d.status!=="resolved"&&d.status!=="closed").length,pending:o.filter(d=>(d.status==="open"||d.status==="in-progress")&&d.assigned_to&&d.assigned_to!==null&&d.status!=="resolved"&&d.status!=="closed").length,unassigned:o.filter(d=>(!d.assigned_to||d.assigned_to===null)&&d.status!=="resolved"&&d.status!=="closed").length,snoozed:o.filter(d=>d.status==="snoozed").length,resolved:o.filter(d=>d.status==="resolved"||d.status==="closed").length,escalated:o.filter(d=>d.has_escalation===1).length,escalatedToMe:o.filter(d=>d.is_escalated_to_me===1).length,vip:o.filter(d=>d.vip===1&&d.status!=="resolved"&&d.status!=="closed").length,allAssigned:o.filter(d=>d.assigned_to&&d.assigned_to!==null&&d.status!=="resolved"&&d.status!=="closed").length,staffCounts:o.filter(d=>d.assigned_to&&d.status!=="resolved"&&d.status!=="closed").reduce((d,m)=>(d[m.assigned_to]=(d[m.assigned_to]||0)+1,d),{})};return console.log("DashboardLayout - Staff counts:",c.staffCounts),console.log("DashboardLayout - McCarthy AI count:",c.staffCounts["ai-agent-001"]),u.useEffect(()=>{const d=m=>{(m.ctrlKey||m.metaKey)&&m.key==="b"&&(m.preventDefault(),n(h=>!h))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[]),s.jsxs("div",{children:[s.jsx(Gi.Root,{show:e,as:u.Fragment,children:s.jsxs(Gf,{as:"div",className:"relative z-50 lg:hidden",onClose:t,children:[s.jsx(Gi.Child,{as:u.Fragment,enter:"transition-opacity ease-linear duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity ease-linear duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"fixed inset-0 bg-gray-900/80"})}),s.jsx("div",{className:"fixed inset-0 flex",children:s.jsx(Gi.Child,{as:u.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"-translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",children:s.jsxs(Gf.Panel,{className:"relative mr-16 flex w-full max-w-xs flex-1",children:[s.jsx(Gi.Child,{as:u.Fragment,enter:"ease-in-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:s.jsx("div",{className:"absolute left-full top-0 flex w-16 justify-center pt-5",children:s.jsxs("button",{type:"button",className:"-m-2.5 p-2.5",onClick:()=>t(!1),children:[s.jsx("span",{className:"sr-only",children:"Close sidebar"}),s.jsx(QS,{className:"h-6 w-6 text-white","aria-hidden":"true"})]})})}),s.jsxs("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-white px-6 pb-2",children:[s.jsx("div",{className:"flex h-16 shrink-0 items-center",children:s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"CS Dashboard"})}),s.jsx("nav",{className:"flex flex-1 flex-col",children:s.jsx("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:s.jsx("li",{children:s.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:GS.map(d=>{const m=a.pathname.startsWith(d.href);return s.jsx("li",{children:s.jsxs(lt,{to:d.href,className:ag(m?"bg-gray-50 text-primary-600":"text-gray-700 hover:text-primary-600 hover:bg-gray-50","group flex gap-x-3 rounded-md p-2 text-sm leading-6 font-semibold"),children:[s.jsx(d.icon,{className:ag(m?"text-primary-600":"text-gray-400 group-hover:text-primary-600","h-6 w-6 shrink-0"),"aria-hidden":"true"}),d.name]})},d.name)})})})})})]})]})})})]})}),s.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:flex-col",children:s.jsx(jS,{ticketCounts:c,isCollapsed:r,onToggle:()=>n(!r)})}),s.jsx("div",{className:`fixed top-0 right-0 z-40 transition-all duration-300 ${r?"lg:left-16":"lg:left-64"} left-0`,children:s.jsxs("div",{className:"flex items-center justify-between h-14 px-4 bg-white border-b border-gray-200 shadow-sm",children:[s.jsxs("button",{type:"button",className:"-m-2.5 p-2.5 text-gray-700 lg:hidden",onClick:()=>t(!0),children:[s.jsx("span",{className:"sr-only",children:"Open sidebar"}),s.jsx(CS,{className:"h-6 w-6","aria-hidden":"true"})]}),s.jsx("div",{className:"hidden lg:block"}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsx(VS,{})})]})}),s.jsx("main",{className:`transition-all duration-300 pt-14 ${r?"lg:pl-16":"lg:pl-64"}`,children:s.jsx(q1,{})})]})}function ag(...e){return e.filter(Boolean).join(" ")}function Wt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function JS(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const Co=43200,ig=1440;let XS={};function ZS(){return XS}function lg(e){const t=Wt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Ko(e,t){const r=Wt(e),n=Wt(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function eC(e){return JS(e,Date.now())}function tC(e,t){const r=Wt(e),n=Wt(t),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}function sC(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function rC(e,t){return+Wt(e)-+Wt(t)}function nC(e){const t=Wt(e);return t.setHours(23,59,59,999),t}function aC(e){const t=Wt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function iC(e){const t=Wt(e);return+nC(t)==+aC(t)}function lC(e,t){const r=Wt(e),n=Wt(t),a=Ko(r,n),i=Math.abs(tC(r,n));let l;if(i<1)l=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let o=Ko(r,n)===-a;iC(Wt(e))&&i===1&&Ko(e,n)===1&&(o=!1),l=a*(i-Number(o))}return l===0?0:l}function oC(e,t,r){const n=rC(e,t)/1e3;return sC(r==null?void 0:r.roundingMethod)(n)}const cC={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},dC=(e,t,r)=>{let n;const a=cC[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Qd(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const uC={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mC={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hC={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fC={date:Qd({formats:uC,defaultWidth:"full"}),time:Qd({formats:mC,defaultWidth:"full"}),dateTime:Qd({formats:hC,defaultWidth:"full"})},gC={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},xC=(e,t,r,n)=>gC[e];function zi(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;a=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[l]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const pC={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},yC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},bC={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},vC={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},NC=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},kC={ordinalNumber:NC,era:zi({values:pC,defaultWidth:"wide"}),quarter:zi({values:yC,defaultWidth:"wide",argumentCallback:e=>e-1}),month:zi({values:bC,defaultWidth:"wide"}),day:zi({values:vC,defaultWidth:"wide"}),dayPeriod:zi({values:jC,defaultWidth:"wide",formattingValues:wC,defaultFormattingWidth:"wide"})};function Ui(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const l=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?CC(o,h=>h.test(l)):SC(o,h=>h.test(l));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const m=t.slice(l.length);return{value:d,rest:m}}}function SC(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function CC(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function _C(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let l=e.valueCallback?e.valueCallback(i[0]):i[0];l=r.valueCallback?r.valueCallback(l):l;const o=t.slice(a.length);return{value:l,rest:o}}}const EC=/^(\d+)(th|st|nd|rd)?/i,MC=/\d+/i,TC={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},AC={any:[/^b/i,/^(a|c)/i]},RC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},PC={any:[/1/i,/2/i,/3/i,/4/i]},$C={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},LC={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},FC={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},IC={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},OC={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},DC={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},zC={ordinalNumber:_C({matchPattern:EC,parsePattern:MC,valueCallback:e=>parseInt(e,10)}),era:Ui({matchPatterns:TC,defaultMatchWidth:"wide",parsePatterns:AC,defaultParseWidth:"any"}),quarter:Ui({matchPatterns:RC,defaultMatchWidth:"wide",parsePatterns:PC,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ui({matchPatterns:$C,defaultMatchWidth:"wide",parsePatterns:LC,defaultParseWidth:"any"}),day:Ui({matchPatterns:FC,defaultMatchWidth:"wide",parsePatterns:IC,defaultParseWidth:"any"}),dayPeriod:Ui({matchPatterns:OC,defaultMatchWidth:"any",parsePatterns:DC,defaultParseWidth:"any"})},UC={code:"en-US",formatDistance:dC,formatLong:fC,formatRelative:xC,localize:kC,match:zC,options:{weekStartsOn:0,firstWeekContainsDate:1}};function HC(e,t,r){const n=ZS(),a=(r==null?void 0:r.locale)??n.locale??UC,i=2520,l=Ko(e,t);if(isNaN(l))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:l});let c,d;l>0?(c=Wt(t),d=Wt(e)):(c=Wt(e),d=Wt(t));const m=oC(d,c),h=(lg(d)-lg(c))/1e3,p=Math.round((m-h)/60);let j;if(p<2)return r!=null&&r.includeSeconds?m<5?a.formatDistance("lessThanXSeconds",5,o):m<10?a.formatDistance("lessThanXSeconds",10,o):m<20?a.formatDistance("lessThanXSeconds",20,o):m<40?a.formatDistance("halfAMinute",0,o):m<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):p===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",p,o);if(p<45)return a.formatDistance("xMinutes",p,o);if(p<90)return a.formatDistance("aboutXHours",1,o);if(p<ig){const f=Math.round(p/60);return a.formatDistance("aboutXHours",f,o)}else{if(p<i)return a.formatDistance("xDays",1,o);if(p<Co){const f=Math.round(p/ig);return a.formatDistance("xDays",f,o)}else if(p<Co*2)return j=Math.round(p/Co),a.formatDistance("aboutXMonths",j,o)}if(j=lC(d,c),j<12){const f=Math.round(p/Co);return a.formatDistance("xMonths",f,o)}else{const f=j%12,g=Math.trunc(j/12);return f<3?a.formatDistance("aboutXYears",g,o):f<9?a.formatDistance("overXYears",g,o):a.formatDistance("almostXYears",g+1,o)}}function hr(e,t){return HC(e,eC(e),t)}function _b({isOpen:e,onClose:t,onReassign:r,currentAssignment:n,bulkMode:a,selectedTickets:i}){const[l,o]=u.useState(""),[c,d]=u.useState(""),[m,h]=u.useState([]),{data:p}=he({queryKey:["staff-list"],queryFn:async()=>{var v;return((v=(await O.get("/api/staff")).data)==null?void 0:v.staff)||[]},enabled:e}),{data:j}=he({queryKey:["tickets-for-reassign"],queryFn:async()=>{var v;return((v=(await Ie.list({limit:1e3})).data)==null?void 0:v.tickets)||[]},enabled:e});if(u.useEffect(()=>{if(p&&j){const x=p.map(v=>{const w=j.filter(N=>N.assigned_to===v.id&&(N.status==="open"||N.status==="in-progress")).length;return{id:v.id,name:`${v.first_name} ${v.last_name}`,role:v.title||"Staff",online:v.availability_status==="online",availability_status:v.availability_status||"offline",openTickets:w}});h(x)}},[p,j]),u.useEffect(()=>{e&&(o(""),d(""))},[e]),!e)return null;const g=m.filter(x=>x.online).length===1,y=()=>{if(l){if(l==="unassigned")r(null,"Unassigned",c||void 0);else{const x=m.find(v=>v.id===l);x&&r(x.id,x.name,c||void 0)}t()}},b=a&&i?i.length:1;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a?`Reassign ${b} Ticket${b>1?"s":""}`:"Reassign Ticket"})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[a&&i&&i.length>0?s.jsxs("div",{className:"mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Reassign the following ticket",b>1?"s":""," to another staff member:"]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 max-h-32 overflow-y-auto",children:s.jsx("ul",{className:"space-y-1",children:i.map(x=>s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"font-medium text-gray-900",children:x.ticket_number}),s.jsxs("span",{className:"text-gray-500 truncate",children:["- ",x.subject]})]},x.ticket_id))})})]}):s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reassign ticket #",n||"Unassigned"," to another staff member:"]}),g&&s.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),s.jsxs("div",{className:"space-y-2",children:[m.filter(x=>x.id==="ai-agent-001").map(x=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l===x.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:x.id,checked:l===x.id,onChange:v=>o(v.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-green-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[s.jsx(Xs,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Return to AI handling"})]}),s.jsx("div",{className:"text-right min-w-[60px]",children:s.jsxs("p",{className:"text-xs text-gray-500",children:[x.openTickets," open"]})})]},x.id)),m.filter(x=>x.id!=="ai-agent-001").map(x=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l===x.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:x.id,checked:l===x.id,onChange:v=>o(v.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${x.availability_status==="online"?"bg-green-500":x.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:x.name}),s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:x.availability_status||"Offline"})]}),s.jsx("div",{className:"text-right min-w-[60px]",children:s.jsxs("p",{className:"text-xs text-gray-500",children:[x.openTickets," open"]})})]},x.id))]}),s.jsx("div",{className:"mt-2",children:s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l==="unassigned"?"border-amber-500 bg-amber-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:"unassigned",checked:l==="unassigned",onChange:x=>o(x.target.value),className:"h-4 w-4 text-amber-600 focus:ring-amber-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-gray-400"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Remove Assignment"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Ticket will be unassigned"})]})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),s.jsx("textarea",{value:c,onChange:x=>d(x.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:y,disabled:!l,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:a?`Reassign ${b} Ticket${b>1?"s":""}`:"Reassign Ticket"})]})]})})}function Eb({isOpen:e,onClose:t,parentTaskId:r,parentTaskNumber:n}){const a=mt(),{user:i}=ws(),[l,o]=u.useState("email"),[c,d]=u.useState(""),[m,h]=u.useState(""),[p,j]=u.useState(""),[f,g]=u.useState(""),[y,b]=u.useState(""),[x,v]=u.useState(""),[w,N]=u.useState("normal"),[_,F]=u.useState(""),[R,J]=u.useState(""),[q,K]=u.useState("17"),[ne,re]=u.useState("00");u.useEffect(()=>{i!=null&&i.id&&F(i.id)},[i==null?void 0:i.id,l]);const{data:pe}=he({queryKey:["staff-users"],queryFn:async()=>(await tt.list()).data}),ke=(pe==null?void 0:pe.staff)||[],we=Ce({mutationFn:async se=>(await Ie.createManual(se)).data,onSuccess:()=>{a.invalidateQueries({queryKey:["tickets"]}),t(),H()}}),H=()=>{d(""),h(""),j(""),g(""),b(""),v(""),N("normal"),J(""),K("17"),re("00"),i!=null&&i.id&&F(i.id)},T=se=>{se.preventDefault();let xe=null;G==="task"&&R&&(xe=`${R}T${q}:${ne}:00`);let $e=(f==null?void 0:f.trim())||null;$e&&$e.startsWith("@")&&($e=`TKT-${$e.substring(1)}`),we.mutate({customer_name:c||(G==="task"?"Internal Task":""),customer_email:m||(G==="task"?"task@internal":""),customer_phone:p,subject:y,message:x,channel:G,priority:w,assign_to:_==="auto"?null:_,related_ticket:$e,deadline:xe,parent_task_id:r||null})};if(!e)return null;const Y=!!r,G=Y?"task":l,X=Array.from({length:24},(se,xe)=>xe.toString().padStart(2,"0")),ie=["00","15","30","45"];return s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),s.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:s.jsxs("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:Y?`Create Sub-Task for ${n}`:G==="email"?"Create Email Ticket":"Create Task"}),s.jsx("button",{onClick:t,className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",children:s.jsx(_t,{className:"h-6 w-6"})})]}),!Y&&s.jsxs("div",{className:"flex border-b border-gray-200 mb-4",children:[s.jsxs("button",{type:"button",onClick:()=>o("email"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors ${l==="email"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(tr,{className:"w-4 h-4 text-gray-500"}),"Email"]}),s.jsxs("button",{type:"button",onClick:()=>o("task"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors ${l==="task"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(Fa,{className:"w-4 h-4 text-gray-500"}),"Task"]})]}),s.jsxs("form",{onSubmit:T,className:"space-y-4",children:[G==="email"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700",children:"Customer Name *"}),s.jsx("input",{type:"text",id:"customerName",required:!0,value:c,onChange:se=>d(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"John Smith"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerEmail",className:"block text-sm font-medium text-gray-700",children:"Customer Email *"}),s.jsx("input",{type:"email",id:"customerEmail",required:!0,value:m,onChange:se=>h(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"john@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerPhone",className:"block text-sm font-medium text-gray-700",children:"Customer Phone"}),s.jsx("input",{type:"tel",id:"customerPhone",value:p,onChange:se=>j(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"0412 345 678"})]})]})]}),G==="task"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700",children:"Customer (optional)"}),s.jsx("input",{type:"text",id:"customerName",value:c,onChange:se=>d(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"Customer name"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"relatedTicket",className:"block text-sm font-medium text-gray-700",children:"Ticket Number (optional)"}),s.jsx("input",{type:"text",id:"relatedTicket",value:f,onChange:se=>g(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"TKT-123 or @123"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deadline (optional)"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",value:R,onChange:se=>J(se.target.value),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("select",{value:q,onChange:se=>K(se.target.value),className:"w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-2 py-2 border",children:X.map(se=>s.jsx("option",{value:se,children:se},se))}),s.jsx("span",{className:"text-gray-500 font-medium",children:":"}),s.jsx("select",{value:ne,onChange:se=>re(se.target.value),className:"w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-2 py-2 border",children:ie.map(se=>s.jsx("option",{value:se,children:se},se))})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700",children:"Priority *"}),s.jsxs("select",{id:"priority",value:w,onChange:se=>N(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",children:[s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"normal",children:"Normal"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"urgent",children:"Urgent"}),s.jsx("option",{value:"critical",children:"Critical"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"assignTo",className:"block text-sm font-medium text-gray-700",children:"Assign To"}),s.jsxs("select",{id:"assignTo",value:_,onChange:se=>F(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",children:[ke.filter(se=>se.id!=="ai-agent-001").map(se=>s.jsxs("option",{value:se.id,children:[se.first_name," ",se.last_name]},se.id)),s.jsx("option",{value:"ai-agent-001",children:"McCarthy AI"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700",children:G==="email"?"Subject *":"Task Subject Title *"}),s.jsx("input",{type:"text",id:"subject",required:!0,value:y,onChange:se=>b(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:G==="email"?"Order status inquiry":"Update shipping info for order #12345"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:G==="email"?"Email Message *":"Task Description *"}),s.jsx("textarea",{id:"message",required:!0,rows:6,value:x,onChange:se=>v(se.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:G==="email"?"Your email message to the customer...":"Describe what needs to be done..."})]}),G==="email"&&s.jsxs("div",{className:"rounded-md bg-blue-50 p-3 flex items-center gap-2",children:[s.jsx(tr,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),s.jsx("p",{className:"text-sm text-blue-800",children:"This will send an email to the customer and create a ticket."})]}),we.isError&&s.jsx("div",{className:"rounded-md bg-red-50 p-4",children:s.jsxs("p",{className:"text-sm text-red-800",children:["Failed to create ",G==="email"?"ticket":"task",". Please try again."]})}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:we.isPending,className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",children:we.isPending?"Creating...":G==="email"?"Send Email & Create Ticket":"Create Task"})]})]})]})})]})})}const Vd=[{value:"all",label:"All Platforms",icon:null},{value:"email",label:"Email",icon:tr},{value:"chat",label:"Live Chat",icon:Ur},{value:"phone",label:"Phone",icon:xa},{value:"whatsapp",label:"WhatsApp",icon:Ur},{value:"instagram",label:"Instagram",icon:zh},{value:"facebook",label:"Messenger",icon:Oh}];function BC({value:e,onChange:t}){const[r,n]=u.useState(!1),a=u.useRef(null),i=Vd.find(o=>o.value===e)||Vd[0],l=i.icon;return u.useEffect(()=>{function o(c){a.current&&!a.current.contains(c.target)&&n(!1)}return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]),s.jsxs("div",{className:"relative",ref:a,children:[s.jsxs("button",{type:"button",onClick:()=>n(!r),className:"w-full flex items-center justify-between gap-2 rounded-lg border-2 border-gray-300 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[l&&s.jsx(l,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{children:i.label})]}),s.jsx(qs,{className:"w-4 h-4 text-gray-400"})]}),r&&s.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-lg border border-gray-200 bg-white shadow-lg",children:Vd.map(o=>{const c=o.icon;return s.jsxs("button",{type:"button",onClick:()=>{t(o.value),n(!1)},className:`w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${o.value===e?"bg-indigo-50 text-indigo-700":"text-gray-700"}`,children:[c&&s.jsx(c,{className:"w-4 h-4"}),s.jsx("span",{children:o.label})]},o.value)})})]})}const og={open:"bg-green-50 text-green-700 ring-green-600/20",pending:"bg-yellow-50 text-yellow-700 ring-yellow-600/20","in-progress":"bg-blue-50 text-blue-700 ring-blue-600/20",resolved:"bg-gray-50 text-gray-700 ring-gray-600/20",closed:"bg-gray-50 text-gray-700 ring-gray-600/20",snoozed:"bg-purple-50 text-purple-700 ring-purple-600/20"},qC=({platform:e,className:t="w-4 h-4"})=>{switch(e){case"task":return s.jsx(Fa,{className:`${t} text-amber-600`});case"chat":return s.jsx(Ur,{className:`${t} text-indigo-500`});case"phone":return s.jsx(xa,{className:`${t} text-red-500`});case"whatsapp":return s.jsx(Ur,{className:`${t} text-green-600`});case"facebook":return s.jsx(Oh,{className:`${t} text-blue-600`});case"instagram":return s.jsx(zh,{className:`${t} text-pink-500`});case"email":default:return s.jsx(tr,{className:`${t} text-gray-500`})}},cg={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},dg={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},WC={positive:"",neutral:"",negative:"",angry:""},Gd={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson","00000000-0000-0000-0000-000000000004":"Gaille Hutchison","ai-agent-001":"McCarthy AI"},KC=e=>{const t=e.match(/^([A-Z]+)-?/),r=e.match(/\d+/);if(!r)return e;const n=t?t[1]:"TKT",a=parseInt(r[0],10);return`${n}-${a}`};function QC(){const[e]=Hl(),{user:t}=ws(),[r,n]=u.useState("all"),[a,i]=u.useState("all"),[l,o]=u.useState("created_at"),[c,d]=u.useState("desc"),[m,h]=u.useState("all"),[p,j]=u.useState("all"),[f,g]=u.useState("all"),[y,b]=u.useState("all"),[x,v]=u.useState(!1),[w,N]=u.useState(!1),[_,F]=u.useState(""),[R,J]=u.useState([]),[q,K]=u.useState(!1),[ne,re]=u.useState(!1),[pe,ke]=u.useState(!1),[we,H]=u.useState(!1),[T,Y]=u.useState(!1),[G,X]=u.useState(!1);u.useEffect(()=>{const E=e.get("filter"),V=e.get("assigned"),B=e.get("status"),Q=()=>{n("all"),b("all"),i("all"),h("all"),j("all"),g("all"),v(!1)};B==="open"?(Q(),n("open-in-progress")):B==="resolved"?(Q(),n("resolved")):B==="snoozed"?(Q(),n("snoozed")):E==="my"?(Q(),b((t==null?void 0:t.id)||"00000000-0000-0000-0000-000000000001")):E==="vip"?(Q(),v(!0)):E==="unassigned"?(Q(),b("unassigned")):E==="all-escalated"?(Q(),b("all-escalated")):E==="all-assigned"?(Q(),b("all-assigned")):V==="ted"?(Q(),b("00000000-0000-0000-0000-000000000002")):V==="sam"?(Q(),b("00000000-0000-0000-0000-000000000003")):V?(Q(),b(V)):!E&&!B&&!V&&Q()},[e,t==null?void 0:t.id]),u.useEffect(()=>{const E=e.get("search");E&&(F(E),N(!0))},[e]);const{data:ie,isLoading:se}=he({queryKey:["tickets-all"],queryFn:async()=>{const E={limit:1e3};return(await Ie.list(E)).data.tickets},refetchInterval:3e4});u.useEffect(()=>{if(_.trim()&&ie&&ie.length>0){const E=_.trim();let V=ie.filter(B=>{if(!B.ticket_number)return!1;const Q=B.ticket_number.toLowerCase(),U=E.toLowerCase();if(Q===U)return!0;const me=B.ticket_number.replace(/\D/g,"").replace(/^0+/,""),ze=E.replace(/\D/g,"").replace(/^0+/,"");return!!(me===ze&&ze.length>0||Q.includes(U))});if(V.length===1&&V[0].id){const B=V[0];console.log("[TicketsPage] Auto-navigating to ticket:",B.ticket_number,B.id),setTimeout(()=>{window.location.href=`/tickets/${B.id}`},1e3)}else V.length===0?console.log("[TicketsPage] No tickets found for search:",E):V.length>1&&console.log("[TicketsPage] Multiple tickets found:",V.length,"- showing list")}},[_,ie]);const{data:xe}=he({queryKey:["staff-list"],queryFn:async()=>(await O.get("/api/staff")).data,staleTime:6e4}),$e=(xe==null?void 0:xe.staff)||[];if(se)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading tickets..."})});let P=ie||[];if(r==="open-in-progress"?P=P.filter(E=>E.status==="open"||E.status==="in-progress"||E.status==="pending"):r==="snoozed"?P=P.filter(E=>E.status==="snoozed"):r==="resolved"?P=P.filter(E=>E.status==="resolved"||E.status==="closed"):P=P.filter(E=>E.status!=="resolved"&&E.status!=="closed"),y!=="all"&&(y==="unassigned"?P=P.filter(E=>!E.assigned_to||E.assigned_to===null):y==="all-assigned"?P=P.filter(E=>E.assigned_to&&E.assigned_to!==null):y==="all-escalated"?P=P.filter(E=>E.has_escalation===1):y==="resolved"?P=(ie||[]).filter(E=>E.status==="resolved"||E.status==="closed"):P=P.filter(E=>E.assigned_to===y||E.is_escalated_to_me===1)),x&&(P=P.filter(E=>E.vip===1)),a!=="all"&&(P=P.filter(E=>E.priority===a)),m!=="all"&&(P=P.filter(E=>E.sentiment===m)),p!=="all"&&(P=P.filter(E=>E.channel===p)),f!=="all"){const E=new Date;let V;f==="today"?V=new Date(E.getFullYear(),E.getMonth(),E.getDate()):f==="week"?V=new Date(E.getTime()-7*24*60*60*1e3):f==="month"?V=new Date(E.getTime()-30*24*60*60*1e3):V=new Date(0),P=P.filter(B=>new Date(B.created_at)>=V)}if(_.trim()){const E=_.trim();if(/^(TKT-|TSK-)?[\d,\s-]+$/.test(E)){const B=E.replace(/TKT-/gi,"").replace(/TSK-/gi,"").split(",").map(Q=>Q.trim().replace(/\D/g,"")).filter(Q=>Q.length>0);P=P.filter(Q=>{var me;const U=((me=Q.ticket_number)==null?void 0:me.replace(/\D/g,"").replace(/^0+/,""))||"";return B.some(ze=>{var le;const be=ze.replace(/^0+/,"");return U===be||U.endsWith(be)||((le=Q.ticket_number)==null?void 0:le.toLowerCase().includes(ze.toLowerCase()))})})}else{const B=E.toLowerCase();P=P.filter(Q=>{var U,me,ze,be,le;return((U=Q.ticket_number)==null?void 0:U.toLowerCase().includes(B))||((me=Q.customer_name)==null?void 0:me.toLowerCase().includes(B))||((ze=Q.customer_email)==null?void 0:ze.toLowerCase().includes(B))||((be=Q.subject)==null?void 0:be.toLowerCase().includes(B))||((le=Q.description)==null?void 0:le.toLowerCase().includes(B))})}}const ae=E=>{l===E?d(c==="asc"?"desc":"asc"):(o(E),d("asc"))};P=P.sort((E,V)=>{var U,me,ze,be;let B=E[l],Q=V[l];return l==="created_at"?(B=new Date(E.created_at).getTime(),Q=new Date(V.created_at).getTime()):l==="customer_name"?(B=((U=E.customer_name)==null?void 0:U.toLowerCase())||"",Q=((me=V.customer_name)==null?void 0:me.toLowerCase())||""):l==="subject"?(B=((ze=E.subject)==null?void 0:ze.toLowerCase())||"",Q=((be=V.subject)==null?void 0:be.toLowerCase())||""):l==="assigned_to"&&(B=Gd[E.assigned_to]||"Unassigned",Q=Gd[V.assigned_to]||"Unassigned"),c==="asc"?B>Q?1:B<Q?-1:0:B<Q?1:B>Q?-1:0});const je=()=>{if(y===(t==null?void 0:t.id))return"My Tickets";if(y==="unassigned")return"Unassigned";if(y==="all-escalated")return" All Escalated Tickets";if(y==="all-assigned")return"All Assigned";if(y==="ai-agent-001")return"McCarthy AI";const E=$e.find(V=>V.id===y);return E?`${E.first_name} ${E.last_name}`:r==="snoozed"?"Snoozed":r==="resolved"?"Resolved":r==="open-in-progress"?"Open (in-progress)":x?"VIP":"All Tickets"};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"sticky top-0 z-10 bg-white pb-4 -mx-6 px-6 -mt-6 pt-6 border-b border-gray-200 mb-4",children:[s.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[s.jsxs("div",{className:"sm:flex-auto",children:[s.jsxs("h1",{className:"text-2xl font-semibold leading-6 text-gray-900 flex items-center gap-3",children:[je(),s.jsx("span",{className:"inline-flex items-center rounded-full bg-indigo-100 px-3 py-1 text-sm font-semibold text-indigo-700 ring-1 ring-inset ring-indigo-600/20",children:P.length}),s.jsx("button",{onClick:()=>N(!w),className:`p-1.5 rounded-lg transition-colors ${w?"bg-indigo-100 text-indigo-600":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,title:"Search tickets",children:s.jsx(hi,{className:"w-5 h-5"})})]}),s.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"A list of all customer service tickets including their status, priority, and assignment."})]}),s.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:s.jsxs("button",{type:"button",onClick:()=>H(!0),className:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:[s.jsx(nd,{className:"w-4 h-4"}),"Create Ticket"]})})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[s.jsxs("select",{value:y,onChange:E=>{const V=E.target.value;b(V),v(V==="vip")},className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Tickets"}),s.jsx("option",{value:(t==null?void 0:t.id)||"",children:"My Tickets"}),$e.filter(E=>E.id!=="ai-agent-001"&&E.id!==(t==null?void 0:t.id)).map(E=>s.jsxs("option",{value:E.id,children:[E.first_name," ",E.last_name]},E.id)),s.jsx("option",{value:"ai-agent-001",children:"McCarthy AI"}),s.jsx("option",{value:"all-assigned",children:"Assigned All"}),s.jsx("option",{value:"unassigned",children:"Unassigned"}),s.jsx("option",{value:"resolved",children:"Resolved"})]}),s.jsx(BC,{value:p,onChange:j}),s.jsxs("select",{value:r,onChange:E=>n(E.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"open-in-progress",children:"Open (in-progress)"}),s.jsx("option",{value:"snoozed",children:"Snoozed"}),s.jsx("option",{value:"resolved",children:"Resolved"})]}),s.jsxs("select",{value:a,onChange:E=>i(E.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Priorities"}),s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"normal",children:"Normal"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"urgent",children:"Urgent"}),s.jsx("option",{value:"critical",children:"Critical"})]}),s.jsxs("select",{value:m,onChange:E=>h(E.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Sentiments"}),s.jsx("option",{value:"positive",children:" Positive"}),s.jsx("option",{value:"neutral",children:" Neutral"}),s.jsx("option",{value:"negative",children:" Negative"}),s.jsx("option",{value:"angry",children:" Angry"})]}),s.jsxs("select",{value:f,onChange:E=>g(E.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[s.jsx("option",{value:"all",children:"All Time"}),s.jsx("option",{value:"today",children:"Today"}),s.jsx("option",{value:"week",children:"This Week"}),s.jsx("option",{value:"month",children:"This Month"})]})]}),w&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsxs("div",{className:"relative flex-1 max-w-lg",children:[s.jsx(hi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:_,onChange:E=>F(E.target.value),placeholder:"Search by ticket #, name, email, description... or enter ticket numbers: 112, 119, 122",className:"w-full pl-10 pr-10 py-2 rounded-lg border-2 border-indigo-300 text-sm focus:border-indigo-500 focus:ring-indigo-500 bg-white",autoFocus:!0}),_&&s.jsx("button",{onClick:()=>F(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-4 h-4"})})]}),s.jsx("button",{onClick:()=>{N(!1),F("")},className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Close"})]}),R.length>0&&(()=>{const E=R.map(Q=>P.find(U=>U.ticket_id===Q)).filter(Boolean),V=new Set(E.map(Q=>Q==null?void 0:Q.customer_email)),B=R.length>=2&&V.size===1;return s.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-indigo-50 border border-indigo-200 rounded-lg px-4 py-2",children:[s.jsxs("span",{className:"text-sm font-medium text-indigo-700 mr-2",children:[R.length," ticket",R.length>1?"s":""," selected"]}),R.length>=2&&s.jsxs("button",{onClick:()=>B?K(!0):alert("Can only merge tickets from the same customer email address"),className:`flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg ${B?"text-white bg-indigo-600 hover:bg-indigo-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,title:B?"Merge selected tickets":"Can only merge tickets from the same customer email",children:[s.jsx(tg,{className:"w-4 h-4"}),s.jsx("span",{children:"Merge"}),!B&&s.jsx("span",{className:"text-xs",children:"(different emails)"})]}),s.jsxs("button",{onClick:()=>ke(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),s.jsx("span",{children:"Reassign"})]}),(t==null?void 0:t.role)==="admin"&&s.jsxs("button",{onClick:()=>Y(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg",children:[s.jsx(gi,{className:"w-4 h-4"}),s.jsx("span",{children:"Delete"})]}),s.jsx("button",{onClick:()=>J([]),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-white rounded-lg border border-gray-300",children:"Clear"})]})})()]})]}),s.jsx("div",{className:"mt-4",children:s.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg",children:s.jsxs("table",{className:"w-full divide-y divide-gray-300",style:{tableLayout:"fixed"},children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"py-3.5 w-14 text-center",children:s.jsx("input",{type:"checkbox",checked:R.length>0&&R.length===P.length,onChange:E=>{E.target.checked?J(P.map(V=>V.ticket_id)):J([])},className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"})}),s.jsx("th",{scope:"col",className:"py-3.5 pl-2 pr-2 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100 whitespace-nowrap",onClick:()=>ae("ticket_number"),style:{width:"9%",minWidth:"90px"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Ticket #",l==="ticket_number"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("created_at"),style:{width:"10%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Created",l==="created_at"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("customer_name"),style:{width:"14%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Customer",l==="customer_name"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("subject"),style:{width:"22%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Subject",l==="subject"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("priority"),style:{width:"8%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Priority",l==="priority"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("status"),style:{width:"9%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Status",l==="status"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("assigned_to"),style:{width:"10%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Assignment",l==="assigned_to"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),s.jsx("th",{scope:"col",className:"px-2 py-3.5 pr-2 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ae("sentiment"),style:{width:"10%"},children:s.jsxs("div",{className:"flex items-center gap-1",children:["Sentiment",l==="sentiment"&&s.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:P.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:10,className:"py-8 text-center text-sm text-gray-500",children:"No tickets found"})}):P.map(E=>{let V;if(E.channel==="chat")V=`/chat-ticket/${E.ticket_id}`;else{const me=new URLSearchParams;x?me.set("filter","vip"):y!=="all"&&y!=="vip"&&me.set("from",y),V=me.toString()?`/tickets/${E.ticket_id}?${me.toString()}`:`/tickets/${E.ticket_id}`}const B=E.has_escalation===1?"bg-orange-50":E.status==="snoozed"?"bg-purple-100":E.merged_from?"bg-cyan-50":"",Q=R.includes(E.ticket_id),U=R.indexOf(E.ticket_id);return s.jsxs("tr",{className:`${B} ${Q?"bg-indigo-50":""}`,children:[s.jsxs("td",{className:"py-3 w-14 text-center relative",children:[s.jsx("input",{type:"checkbox",checked:Q,onChange:me=>{me.target.checked?J([...R,E.ticket_id]):J(R.filter(ze=>ze!==E.ticket_id))},className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),Q&&U===0&&s.jsx("span",{className:"absolute -right-1 top-1/2 -translate-y-1/2 text-xs font-bold text-indigo-600",title:"Primary ticket (will be kept)",children:""})]}),s.jsx("td",{className:"py-3 pl-2 pr-2 text-sm font-medium",children:s.jsxs(lt,{to:V,className:"text-indigo-600 hover:text-indigo-900 font-medium flex items-center gap-1.5",children:[s.jsx(qC,{platform:E.channel||"email",className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{className:"text-xs whitespace-nowrap",children:KC(E.ticket_number)})]})}),s.jsxs("td",{className:"px-2 py-3 text-sm text-gray-500",children:[s.jsx("div",{className:"text-xs truncate",children:new Date(E.created_at).toLocaleString()}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:hr(new Date(E.created_at),{addSuffix:!0})})]}),s.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:s.jsx(lt,{to:`/tickets?customer=${encodeURIComponent(E.customer_email)}`,className:"block hover:bg-gray-50 -m-1 p-1 rounded transition-colors",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-900 hover:text-indigo-600 font-medium text-xs truncate",children:E.customer_name}),E.vip===1&&s.jsx("span",{className:"text-yellow-500 text-xs flex-shrink-0",title:"VIP Customer",children:""})]}),s.jsx("div",{className:"text-gray-500 hover:text-indigo-500 text-xs truncate",children:E.customer_email})]})})}),s.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:s.jsx("div",{className:"truncate text-xs",children:E.subject||E.description||"No subject"})}),s.jsx("td",{className:"px-2 py-3 text-sm",children:s.jsx("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${cg[E.priority]||cg.normal}`,children:E.priority})}),s.jsx("td",{className:"px-2 py-3 text-sm",children:s.jsxs("div",{className:"relative inline-block",children:[s.jsx("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${og[E.status]||og.open}`,children:E.status}),E.is_escalated_to_me===1&&s.jsx("span",{className:"absolute -top-1 -right-1 text-xs leading-none",title:"Escalated - You've been asked for help",children:""})]})}),s.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:E.assigned_to?s.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-1.5 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 truncate",children:Gd[E.assigned_to]||E.assigned_staff_name||E.assigned_to}):s.jsx("span",{className:"inline-flex items-center rounded-md bg-gray-50 px-1.5 py-0.5 text-xs font-medium text-gray-500 ring-1 ring-inset ring-gray-300",children:"Unassigned"})}),s.jsx("td",{className:"px-2 py-3 pr-2 text-sm",children:s.jsxs("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${dg[E.sentiment]||dg.neutral}`,children:[WC[E.sentiment]||""," ",E.sentiment||"neutral"]})})]},E.ticket_id)})})]})})}),q&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:s.jsx(tg,{className:"w-6 h-6 text-indigo-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Merge Tickets"})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["You are about to merge ",s.jsxs("span",{className:"font-semibold",children:[R.length," tickets"]})," into one."]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Tickets to merge:"}),s.jsx("ul",{className:"space-y-1",children:R.map((E,V)=>{const B=P.find(Q=>Q.ticket_id===E);return s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[V===0?s.jsx("span",{className:"text-xs font-bold text-indigo-600 bg-indigo-100 px-1.5 py-0.5 rounded",children:"PRIMARY"}):s.jsx("span",{className:"text-xs text-gray-400 bg-gray-200 px-1.5 py-0.5 rounded",children:"merge"}),s.jsx("span",{className:"font-medium",children:B==null?void 0:B.ticket_number}),s.jsxs("span",{className:"text-gray-500 truncate",children:["- ",B==null?void 0:B.subject]})]},E)})})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:s.jsxs("p",{className:"text-xs text-yellow-800",children:[s.jsx("strong",{children:"What will happen:"}),s.jsx("br",{})," All messages will be merged into the PRIMARY ticket in chronological order",s.jsx("br",{})," Secondary tickets will be closed with a note",s.jsx("br",{})," This action cannot be undone"]})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>K(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:ne,children:"Cancel"}),s.jsx("button",{onClick:async()=>{var E,V;re(!0);try{const[B,...Q]=R;await Ie.merge(B,Q),K(!1),J([]),window.location.reload()}catch(B){console.error("Failed to merge tickets:",B),alert(`Failed to merge tickets: ${((V=(E=B.response)==null?void 0:E.data)==null?void 0:V.error)||B.message||"Unknown error"}`)}finally{re(!1)}},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",disabled:ne,children:ne?"Merging...":"Merge Tickets"})]})]})}),s.jsx(_b,{isOpen:pe,onClose:()=>ke(!1),onReassign:async(E,V,B)=>{var Q,U;try{await Ie.bulkAssign(R,E),B&&console.log("Bulk reassignment reason:",B),ke(!1),J([]),window.location.reload()}catch(me){console.error("Failed to reassign tickets:",me),alert(`Failed to reassign tickets: ${((U=(Q=me.response)==null?void 0:Q.data)==null?void 0:U.error)||me.message||"Unknown error"}`)}},bulkMode:!0,selectedTickets:R.map(E=>{const V=P.find(B=>B.ticket_id===E);return{ticket_id:E,ticket_number:(V==null?void 0:V.ticket_number)||"",subject:(V==null?void 0:V.subject)||""}})}),T&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:s.jsx(gi,{className:"w-6 h-6 text-red-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Tickets"})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Are you sure you want to delete ",s.jsxs("span",{className:"font-semibold",children:[R.length," ticket",R.length>1?"s":""]}),"?"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 max-h-48 overflow-y-auto",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Tickets to delete:"}),s.jsx("ul",{className:"space-y-1",children:R.map(E=>{const V=P.find(B=>B.ticket_id===E);return s.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[s.jsx("span",{className:"font-medium text-red-600",children:V==null?void 0:V.ticket_number}),s.jsxs("span",{className:"text-gray-500 truncate",children:["- ",V==null?void 0:V.subject]})]},E)})})]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsxs("p",{className:"text-xs text-red-800",children:[s.jsx("strong",{children:" Warning:"})," This action cannot be undone. All selected tickets and their messages will be permanently deleted."]})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>Y(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:G,children:"Cancel"}),s.jsx("button",{onClick:async()=>{var E,V;X(!0);try{for(const B of R)await Ie.delete(B);Y(!1),J([]),window.location.reload()}catch(B){console.error("Failed to delete tickets:",B),alert(`Failed to delete tickets: ${((V=(E=B.response)==null?void 0:E.data)==null?void 0:V.error)||B.message||"Unknown error"}`)}finally{X(!1)}},className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50",disabled:G,children:G?"Deleting...":`Delete ${R.length} Ticket${R.length>1?"s":""}`})]})]})}),s.jsx(Eb,{isOpen:we,onClose:()=>H(!1)})]})}const VC=["open","pending","in-progress","resolved","closed","escalated"];function GC({currentStatus:e,onClose:t,onSave:r}){const[n,a]=u.useState(e),[i,l]=u.useState(!1),o=async()=>{l(!0);try{await r(n),t()}catch(c){console.error("Failed to update status:",c),alert("Failed to update status")}finally{l(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Change Status"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"space-y-2",children:VC.map(c=>s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"radio",value:c,checked:n===c,onChange:d=>a(d.target.value),className:"text-indigo-600"}),s.jsx("span",{className:"capitalize",children:c})]},c))}),s.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:o,disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:i?"Saving...":"Save"})]})]})})}const ug=[{id:"00000000-0000-0000-0000-000000000001",name:"John Hutchison",role:"Admin",online:!0},{id:"00000000-0000-0000-0000-000000000002",name:"Ted Smith",role:"Team Lead",online:!1},{id:"00000000-0000-0000-0000-000000000003",name:"Sam Johnson",role:"Manager",online:!1}];function YC({isOpen:e,onClose:t,onConfirm:r,ticketNumber:n}){const[a,i]=u.useState(""),[l,o]=u.useState("");if(!e)return null;const c=h=>{const p=ug.find(j=>j.id===h);if(p){i(h);const j=p.name.split(" ")[0];o(f=>{const g=f.replace(/@\w+\s*/g,"").trim();return g?`@${j} ${g}`:`@${j} `})}},d=()=>{!a||!l.trim()||(r("escalation",[a],l),i(""),o(""),t())},m=()=>{i(""),o(""),t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Escalate Ticket #",n]})]})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Request assistance from other staff members to help resolve this ticket."}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Notify Staff Members: ",s.jsx("span",{className:"text-gray-500 font-normal",children:"(Select one or more)"})]}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3",children:ug.map(h=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${a===h.id?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"escalate-staff",value:h.id,checked:a===h.id,onChange:()=>c(h.id),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${h.online?"bg-green-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:h.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[h.role,"  ",h.online?"Online":"Offline"]})]})]},h.id))}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[a?"1":"0"," staff member selected"]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Your Message: ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:l,onChange:h=>o(h.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"@mention message asking for help or advice on this ticket..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will be sent as an @mention linked to this ticket"})]}),s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex",children:[s.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Note:"}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Selected staff will receive an alert notification and this will appear in their @mentions with higher priority (at the top, in a different color)."})]})]})})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:d,disabled:!a||!l.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send Escalation"})]})]})})}const mg=[{id:"30-mins",title:"30 Minutes",description:"Quick snooze - resume in 30 mins",value:"30m"},{id:"later-today",title:"Later Today",description:"Resume in 3 hours",value:"3h"},{id:"tomorrow",title:"Tomorrow",description:"Next business day at 9:00 AM",value:"1d"},{id:"this-week",title:"This Week",description:"Friday at 9:00 AM",value:"friday"},{id:"next-week",title:"Next Week",description:"Following Monday at 9:00 AM",value:"1w"},{id:"custom",title:"Custom Date & Time",description:"Pick specific date and time",value:"custom"}];function JC({isOpen:e,onClose:t,onConfirm:r,onRemoveSnooze:n,ticketNumber:a,isSnoozed:i}){const[l,o]=u.useState(""),[c,d]=u.useState("");if(!e)return null;const m=()=>{if(!l)return;if(l==="custom"&&!c){alert("Please select a custom date and time");return}const p=mg.find(j=>j.id===l);p&&r(p.value,l==="custom"?c:void 0),o(""),d(""),t()},h=()=>{o(""),d(""),t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Snooze Ticket #",a]})]})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Temporarily hide this ticket and automatically resume it later."}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Snooze until:"}),s.jsx("div",{className:"space-y-2",children:mg.map(p=>s.jsxs("div",{children:[s.jsxs("label",{className:`flex items-start p-4 border rounded-lg cursor-pointer transition-colors ${l===p.id?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"snooze",value:p.id,checked:l===p.id,onChange:j=>o(j.target.value),className:"mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),s.jsxs("div",{className:"ml-3 flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:p.title}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:p.description})]})]}),p.id==="custom"&&l==="custom"&&s.jsxs("div",{className:"mt-2 ml-7 p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Select Date & Time:"}),s.jsx("input",{type:"datetime-local",value:c,onChange:j=>d(j.target.value),min:new Date().toISOString().slice(0,16),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]},p.id))})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-between gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:m,disabled:!l||l==="custom"&&!c,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Snooze Ticket"}),i&&n&&s.jsx("button",{onClick:()=>{n(),h()},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:"Remove Snooze"})]})]})]})})}function XC({isOpen:e,onClose:t,onConfirm:r}){const[n,a]=u.useState(""),[i,l]=u.useState("09"),[o,c]=u.useState("00"),d=()=>{const f=new Date,g=f.getFullYear(),y=(f.getMonth()+1).toString().padStart(2,"0"),b=f.getDate().toString().padStart(2,"0");return`${g}-${y}-${b}`},m=()=>{const g=new Date().getHours()+1;return g>=24?"09":g.toString().padStart(2,"0")};if(u.useEffect(()=>{e&&(a(d()),l(m()),c("00"))},[e]),!e)return null;const h=()=>{if(!n||!i||!o){alert("Please select date and time");return}const f=`${i}:${o}`;r(n,f),t()},p=()=>{t()},j=d();return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Reply"})]}),s.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Schedule when this message will be sent to the customer. Scheduled messages are only visible to staff until the scheduled time."}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),s.jsx("input",{type:"date",value:n,onChange:f=>a(f.target.value),min:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("select",{value:i,onChange:f=>l(f.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:24},(f,g)=>{const y=g.toString().padStart(2,"0");return s.jsx("option",{value:y,children:y},y)})}),s.jsx("span",{className:"flex items-center text-gray-500 font-semibold",children:":"}),s.jsx("select",{value:o,onChange:f=>c(f.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:60},(f,g)=>{const y=g.toString().padStart(2,"0");return s.jsx("option",{value:y,children:y},y)})})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Note:"})," This message will be sent automatically at the scheduled time during business hours (9 AM - 6 PM)."]})})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200",children:[s.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:h,disabled:!n,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Schedule Reply"})]})]})})}function ZC({isOpen:e,onClose:t,onConfirm:r,onRemove:n,message:a}){const[i,l]=u.useState(""),[o,c]=u.useState(""),[d,m]=u.useState("09"),[h,p]=u.useState("00");if(u.useEffect(()=>{if(e&&a){l(a.content);const y=new Date(a.scheduled_for);c(y.toISOString().split("T")[0]),m(y.getHours().toString().padStart(2,"0")),p(y.getMinutes().toString().padStart(2,"0"))}},[e,a]),!e)return null;const j=()=>{if(!i.trim()){alert("Message content cannot be empty");return}if(!o){alert("Please select a date");return}const y=`${d}:${h}`;r(i,o,y),t()},f=()=>{l(""),c(""),m("09"),p("00"),t()},g=new Date().toISOString().split("T")[0];return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:s.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Scheduled Message"})]}),s.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Edit the message content and scheduled time for this reply."}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Content"}),s.jsx("textarea",{value:i,onChange:y=>l(y.target.value),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none",placeholder:"Enter your message..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Date"}),s.jsx("input",{type:"date",value:o,onChange:y=>c(y.target.value),min:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Time"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("select",{value:d,onChange:y=>m(y.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:24},(y,b)=>{const x=b.toString().padStart(2,"0");return s.jsx("option",{value:x,children:x},x)})}),s.jsx("span",{className:"flex items-center text-gray-500 font-semibold",children:":"}),s.jsx("select",{value:h,onChange:y=>p(y.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:60},(y,b)=>{const x=b.toString().padStart(2,"0");return s.jsx("option",{value:x,children:x},x)})})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Note:"})," This message will be sent automatically at the scheduled time."]})})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-between gap-3 border-t border-gray-200",children:[s.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:j,disabled:!i.trim()||!o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Changes"}),n&&s.jsx("button",{onClick:()=>{confirm("Are you sure you want to remove this scheduled message? It will not be sent.")&&(n(),f())},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:"Remove"})]})]})]})})}const e6=({draft:e,loading:t,onApprove:r,onEdit:n,onReject:a})=>{const[i,l]=u.useState(!1),[o,c]=u.useState(""),[d,m]=u.useState(""),[h,p]=u.useState(!1),[j,f]=u.useState(!1);if(t)return s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Xs,{className:"w-5 h-5 text-blue-500 animate-pulse"}),s.jsx("span",{className:"text-gray-600",children:"AI is analyzing this ticket..."})]})});if(!e)return null;const g=Math.round(e.confidence_score*100),y=g>=85?"text-green-600 bg-green-50":g>=70?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",b=async()=>{f(!0);try{await r()}finally{f(!1)}},x=async()=>{if(!i){c(e.draft_content),l(!0);return}f(!0);try{await n(o),l(!1)}finally{f(!1)}},v=async()=>{f(!0);try{await a(d),p(!1),m("")}finally{f(!1)}};return s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg shadow-lg p-6 border-2 border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Xs,{className:"w-6 h-6 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Draft Response"}),s.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y}`,children:[g,"% Confidence"]})]}),e.processing_time_ms&&e.processing_time_ms>0&&s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx(Tl,{className:"w-4 h-4"}),s.jsxs("span",{children:[e.processing_time_ms,"ms"]})]})]}),e.should_escalate===!0&&s.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(gS,{className:"w-5 h-5 text-yellow-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Escalation Recommended"}),s.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:e.escalation_reason})]})]})}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Draft Response:"}),i?s.jsx("textarea",{value:o,onChange:w=>c(w.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:8}):s.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 whitespace-pre-wrap",children:e.draft_content})]}),s.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"AI Reasoning:"}),s.jsx("p",{className:"text-sm text-gray-600",children:e.reasoning}),s.jsx("div",{className:"mt-3",children:s.jsxs("p",{className:"text-xs text-gray-500",children:["Intent: ",s.jsx("span",{className:"font-medium",children:e.intent})," | Handler: ",s.jsx("span",{className:"font-medium",children:e.handler_used})]})})]}),e.suggested_actions&&e.suggested_actions.length>0&&s.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Suggested Actions:"}),s.jsx("ul",{className:"space-y-1",children:e.suggested_actions.map((w,N)=>s.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[s.jsx("span",{className:"text-blue-500 mr-2",children:""}),w]},N))})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:b,disabled:j||i,className:"flex-1 flex items-center justify-center px-4 py-2 bg-green-50 text-green-700 border border-green-200 rounded-lg hover:bg-green-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[s.jsx(dt,{className:"w-4 h-4 mr-2"}),j?"Sending...":"Approve & Send"]}),s.jsxs("button",{onClick:x,disabled:j,className:"flex-1 flex items-center justify-center px-4 py-2 bg-yellow-50 text-yellow-700 border border-yellow-200 rounded-lg hover:bg-yellow-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[s.jsx(Uh,{className:"w-4 h-4 mr-2"}),i?j?"Sending...":"Send Edited":"Edit & Send"]}),s.jsxs("button",{onClick:()=>p(!0),disabled:j||i,className:"flex-1 flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[s.jsx(xr,{className:"w-4 h-4 mr-2"}),"Reject"]})]}),i&&s.jsx("button",{onClick:()=>{l(!1),c("")},className:"mt-2 w-full px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel Editing"}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject AI Draft"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this draft (optional):"}),s.jsx("textarea",{value:d,onChange:w=>m(w.target.value),placeholder:"e.g., Incorrect information, wrong tone, missing details...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",rows:3}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>{p(!1),m("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:v,disabled:j,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:j?"Rejecting...":"Reject Draft"})]})]})})]})};function t6({isOpen:e,onClose:t,onSubmit:r}){const[n,a]=u.useState(0),[i,l]=u.useState(null),[o,c]=u.useState(""),[d,m]=u.useState(!1),[h,p]=u.useState(0);if(!e)return null;const j=async()=>{if(n===0||i===null){alert("Please rate the draft and indicate if it was helpful");return}m(!0);try{await r({qualityScore:n,wasHelpful:i,improvementNotes:o}),t()}catch(g){console.error("Failed to submit feedback:",g),alert("Failed to submit feedback. Please try again.")}finally{m(!1)}},f=()=>{t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" Help Improve the AI"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"How good was the AI draft?"}),s.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(g=>s.jsx("button",{onClick:()=>a(g),onMouseEnter:()=>p(g),onMouseLeave:()=>p(0),className:"transition-transform hover:scale-110",children:s.jsx(lS,{className:`w-8 h-8 ${g<=(h||n)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},g)),s.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:[n===0&&"Click to rate",n===1&&"Poor",n===2&&"Fair",n===3&&"Good",n===4&&"Very Good",n===5&&"Excellent"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Did the AI draft save you time?"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>l(!0),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${i===!0?"border-green-500 bg-green-50 text-green-700":"border-gray-300 text-gray-700 hover:border-green-300"}`,children:" Yes"}),s.jsx("button",{onClick:()=>l(!1),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${i===!1?"border-red-500 bg-red-50 text-red-700":"border-gray-300 text-gray-700 hover:border-red-300"}`,children:" No"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What could be improved? (Optional)"}),s.jsx("textarea",{value:o,onChange:g=>c(g.target.value),placeholder:"e.g., Too formal, missing product details, wrong tone...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-xs text-blue-800",children:[" ",s.jsx("strong",{children:"Your feedback helps the AI learn!"})," Every rating makes the AI smarter and more helpful for future tickets."]})})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{onClick:f,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",disabled:d,children:"Skip for now"}),s.jsx("button",{onClick:j,disabled:d||n===0||i===null,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium",children:d?"Submitting...":"Submit Feedback"})]})]})})}function Zl(e){return e?e.split(",").map(t=>t.trim()).filter(t=>t.length>0):[]}const Mb="Use #keyword to add tags (e.g., #james-scott, #artwork-issue)",hg={open:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200","in-progress":"bg-blue-100 text-blue-800 border-blue-200",resolved:"bg-gray-100 text-gray-800 border-gray-200",closed:"bg-gray-100 text-gray-800 border-gray-200",snoozed:"bg-purple-100 text-purple-800 border-purple-200"},fg={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},gg={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},s6={positive:"",neutral:"",negative:"",angry:""},xg={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson"},wa=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"",jr=e=>{const t=e.match(/^([A-Z]+)-?/),r=e.match(/\d+/);if(!r)return e;const n=t?t[1]:"TKT",a=parseInt(r[0],10);return`${n}-${a}`};function r6(){var Hh,Bh,qh,Wh;const{id:e}=dy(),t=yr(),[r]=Hl(),n=mt(),{user:a}=ws(),[i,l]=u.useState(!1),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,p]=u.useState(0),[j,f]=u.useState(null),[g,y]=u.useState(""),[b,x]=u.useState(!1),[v,w]=u.useState([]),N=u.useRef(null),_=u.useRef(null),F=u.useRef(null),[R,J]=u.useState(!1),[q,K]=u.useState(!1),[ne,re]=u.useState(!1),[pe,ke]=u.useState(!1),[we,H]=u.useState(!1),[T,Y]=u.useState(!1),[G,X]=u.useState(!1),[ie,se]=u.useState(null),[xe,$e]=u.useState(!1),[P,ae]=u.useState(!1),[je,E]=u.useState(!1),[V,B]=u.useState(!1),[Q,U]=u.useState(null),[me,ze]=u.useState(!1),[be,le]=u.useState(!1),[D,Me]=u.useState("approve"),[Te,$]=u.useState(""),[ee,oe]=u.useState(250),[_e,Ee]=u.useState(250),[We,Je]=u.useState(!1),[nt,kt]=u.useState(!1),[Gt,ss]=u.useState([]),[Et,rs]=u.useState(null),[Us,Ns]=u.useState(""),[br,As]=u.useState(null),[de,vr]=u.useState(null),[ms,Rs]=u.useState(!1),[rr,ks]=u.useState(null),{data:at,isLoading:L,refetch:ge}=he({queryKey:["ticket",e],queryFn:async()=>(await Ie.get(e)).data,enabled:!!e}),{data:Fe}=he({queryKey:["tickets"],queryFn:async()=>(await Ie.list()).data}),{data:De,refetch:rt}=he({queryKey:["scheduledMessages",e],queryFn:async()=>(await Ie.getScheduledMessages(e)).data,enabled:!!e}),{data:Pt,isLoading:Ln,refetch:M}=he({queryKey:["aiDraft",e],queryFn:async()=>{var k;try{return(await Ie.getAIDraft(e)).data}catch(W){if(((k=W.response)==null?void 0:k.status)===404)return null;throw W}},enabled:!!e,retry:!1}),A=at==null?void 0:at.ticket,Ae=(at==null?void 0:at.messages)||[],Re=(at==null?void 0:at.notes)||[],Ge=(De==null?void 0:De.scheduledMessages)||[];let yt=(Fe==null?void 0:Fe.tickets)||[];const Ci=r.get("filter"),Fn=r.get("from");Ci==="my"||Fn==="my"?yt=yt.filter(k=>k.assigned_to==="00000000-0000-0000-0000-000000000001"):Ci==="vip"||Fn==="vip"?yt=yt.filter(k=>k.vip===1):Fn&&(yt=yt.filter(k=>k.assigned_to===Fn));const qr=yt.findIndex(k=>k.ticket_id===e),S=qr>0,ve=qr>=0&&qr<yt.length-1,ye=()=>{if(S){const k=yt[qr-1],W=new URLSearchParams(r);k.channel==="chat"?t(`/chat-ticket/${k.ticket_id}?${W.toString()}`):t(`/tickets/${k.ticket_id}?${W.toString()}`)}},Pe=()=>{if(ve){const k=yt[qr+1],W=new URLSearchParams(r);k.channel==="chat"?t(`/chat-ticket/${k.ticket_id}?${W.toString()}`):t(`/tickets/${k.ticket_id}?${W.toString()}`)}};u.useEffect(()=>{if(A&&A.channel==="chat"){const k=new URLSearchParams(r);t(`/chat-ticket/${A.ticket_id}?${k.toString()}`,{replace:!0})}},[A,t,r]),u.useEffect(()=>{p(0)},[e,d]),u.useEffect(()=>{A&&F.current&&setTimeout(()=>{var k;(k=F.current)==null||k.scrollIntoView({behavior:"smooth"})},100)},[A==null?void 0:A.ticket_id]),u.useEffect(()=>{d&&(A!=null&&A.customer_email)&&!de&&(Rs(!0),ks(null),pk.getTicketData(A.customer_email).then(k=>{vr(k.data)}).catch(k=>{var W,I;console.error("Failed to fetch Shopify data:",k),ks(((I=(W=k.response)==null?void 0:W.data)==null?void 0:I.error)||"Failed to load Shopify data")}).finally(()=>{Rs(!1)}))},[d,A==null?void 0:A.customer_email,de]);const He=k=>{const W=k.target.files;W&&(Array.from(W).forEach(I=>{if(I.size>10*1024*1024){alert(`File ${I.name} is too large. Maximum size is 10MB.`);return}const te=new FileReader;te.onload=Ne=>{var Ht;const Qe=(Ht=Ne.target)==null?void 0:Ht.result;w(In=>[...In,{name:I.name,content:Qe,type:I.type,size:I.size}])},te.readAsDataURL(I)}),N.current&&(N.current.value=""))},et=k=>{w(W=>W.filter((I,te)=>te!==k))},ot=k=>new Promise((W,I)=>{const te=new FileReader;te.readAsDataURL(k),te.onload=()=>W(te.result),te.onerror=Ne=>I(Ne)}),$t=async k=>{const W=Array.from(k.target.files||[]);for(const I of W)if(I.size>10*1024*1024){alert(`File ${I.name} is too large. Maximum size is 10MB.`),k.target.value="";return}ss(I=>[...I,...W]),k.target.value=""},nr=k=>{ss(W=>W.filter((I,te)=>te!==k))},Ke=async()=>{var k,W,I;if(!(!g.trim()&&v.length===0||!A)){x(!0);try{console.log("Sending reply to ticket:",A.ticket_id,"with",v.length,"attachments");const te=await Ie.reply(A.ticket_id,g,v);console.log("Reply sent successfully:",te),y(""),w([]),ge()}catch(te){console.error("Failed to send reply:",te),console.error("Error details:",((k=te.response)==null?void 0:k.data)||te.message),alert(`Failed to send reply: ${((I=(W=te.response)==null?void 0:W.data)==null?void 0:I.error)||te.message||"Unknown error"}`)}finally{x(!1)}}},Mt=async()=>{var k,W;if(A)try{await Ie.delete(A.ticket_id),console.log("Ticket deleted successfully"),E(!1),t("/tickets")}catch(I){console.error("Failed to delete ticket:",I),alert(`Failed to delete ticket: ${((W=(k=I.response)==null?void 0:k.data)==null?void 0:W.error)||I.message||"Unknown error"}`)}},pa=async k=>{A&&(await Ie.updateStatus(A.ticket_id,k),ge())},Tb=async(k,W,I)=>{var te,Ne;if(A)try{await Ie.assign(A.ticket_id,k||""),I&&console.log("Reassignment reason:",I),K(!1),ge()}catch(Qe){console.error("Failed to reassign ticket:",Qe),alert(`Failed to reassign ticket: ${((Ne=(te=Qe.response)==null?void 0:te.data)==null?void 0:Ne.error)||Qe.message||"Unknown error"}`)}},Ab=async(k,W,I)=>{var te,Ne;if(A){console.log("Escalating ticket:",{level:k,staffIds:W,reason:I});try{await Ie.escalate(A.ticket_id,W,I),console.log("Ticket escalated successfully"),re(!1),ge()}catch(Qe){console.error("Failed to escalate ticket:",Qe),alert(`Failed to escalate ticket: ${((Ne=(te=Qe.response)==null?void 0:te.data)==null?void 0:Ne.error)||Qe.message||"Unknown error"}`)}}},Rb=async(k,W)=>{var Ne,Qe;if(!A)return;console.log("Snoozing ticket:",{duration:k,customDate:W});let I;const te=new Date;switch(k){case"30m":I=new Date(te.getTime()+30*60*1e3);break;case"3h":I=new Date(te.getTime()+3*60*60*1e3);break;case"1d":I=new Date(te.getTime()+24*60*60*1e3),I.setHours(9,0,0,0);break;case"friday":I=new Date(te);const Ht=(5-te.getDay()+7)%7||7;I.setDate(te.getDate()+Ht),I.setHours(9,0,0,0);break;case"1w":I=new Date(te.getTime()+7*24*60*60*1e3),I.setHours(9,0,0,0);break;case"custom":if(!W)return;I=new Date(W);break;default:return}try{await Ie.snooze(A.ticket_id,I.toISOString(),`Snoozed until ${I.toLocaleString()}`),console.log("Ticket snoozed successfully"),ke(!1),ge()}catch(Ht){console.error("Failed to snooze ticket:",Ht),alert(`Failed to snooze ticket: ${((Qe=(Ne=Ht.response)==null?void 0:Ne.data)==null?void 0:Qe.error)||Ht.message||"Unknown error"}`)}},Pb=async()=>{var k,W;if(A)try{await Ie.unsnooze(A.ticket_id),console.log("Snooze removed successfully"),ke(!1),ge()}catch(I){console.error("Failed to remove snooze:",I),alert(`Failed to remove snooze: ${((W=(k=I.response)==null?void 0:k.data)==null?void 0:W.error)||I.message||"Unknown error"}`)}},ya=((Fe==null?void 0:Fe.tickets)||[]).filter(k=>k.customer_email===(A==null?void 0:A.customer_email)&&k.ticket_id!==(A==null?void 0:A.ticket_id)&&(k.status==="open"||k.status==="in-progress"||k.status==="snoozed")),$b=async()=>{var k,W;if(!(!A||!Q)){ze(!0);try{await Ie.merge(A.ticket_id,[Q]),console.log("Tickets merged successfully"),B(!1),U(null),ge()}catch(I){console.error("Failed to merge tickets:",I),alert(`Failed to merge tickets: ${((W=(k=I.response)==null?void 0:k.data)==null?void 0:W.error)||I.message||"Unknown error"}`)}finally{ze(!1)}}},Lb=async()=>{var k,W;if(A&&confirm("Mark this ticket as resolved and close it?"))try{await Ie.updateStatus(A.ticket_id,"resolved"),t("/tickets")}catch(I){console.error("Failed to resolve ticket:",I),alert(`Failed to resolve ticket: ${((W=(k=I.response)==null?void 0:k.data)==null?void 0:W.error)||I.message||"Unknown error"}`)}},Fb=()=>{if(!g.trim()||!A){alert("Please write a response first");return}H(!0)},Ib=async(k,W)=>{var I,te;if(A)try{const Ne=`${k}T${W}:00`,Qe=new Date(Ne),Ht=Qe.toISOString();console.log("Scheduling reply:",{input:Ne,localDate:Qe.toString(),utcDate:Ht,serverNow:new Date().toISOString()}),await Ie.scheduleReply(A.ticket_id,g,Ht),y(""),H(!1),ge(),rt()}catch(Ne){console.error("Failed to schedule reply:",Ne),alert(`Failed to schedule reply: ${((te=(I=Ne.response)==null?void 0:I.data)==null?void 0:te.error)||Ne.message||"Unknown error"}`)}},Ob=k=>{se(k),Y(!0)},Db=async()=>{var k,W;if(ie)try{await Ie.deleteScheduledMessage(ie.id),console.log("[handleRemoveScheduledMessage] Deleted successfully"),Y(!1),se(null),ge()}catch(I){console.error("[handleRemoveScheduledMessage] Error:",I),alert(`Failed to remove scheduled message: ${((W=(k=I.response)==null?void 0:k.data)==null?void 0:W.error)||I.message||"Unknown error"}`)}},zb=async()=>{var k,W;if(e)try{await Ie.approveAIDraft(e),ge(),M(),Me("approve"),le(!0)}catch(I){console.error("Failed to approve AI draft:",I),alert(`Failed to approve AI draft: ${((W=(k=I.response)==null?void 0:k.data)==null?void 0:W.error)||I.message||"Unknown error"}`)}},Ub=async k=>{var W,I;if(e)try{await Ie.editAIDraft(e,k),ge(),M(),Me("edit"),le(!0)}catch(te){console.error("Failed to edit AI draft:",te),alert(`Failed to edit AI draft: ${((I=(W=te.response)==null?void 0:W.data)==null?void 0:I.error)||te.message||"Unknown error"}`)}},Hb=async k=>{var W,I;if(e)try{await Ie.rejectAIDraft(e,k),M()}catch(te){console.error("Failed to reject AI draft:",te),alert(`Failed to reject AI draft: ${((I=(W=te.response)==null?void 0:W.data)==null?void 0:I.error)||te.message||"Unknown error"}`)}},Bb=async k=>{if(e)try{await Ie.submitAIDraftFeedback(e,{...k,action:D}),console.log("Feedback submitted successfully")}catch(W){console.error("Failed to submit feedback:",W)}},qb=async(k,W,I)=>{var te,Ne;if(console.log("[handleEditScheduledMessageConfirm] Called with:",{newContent:k,scheduledDate:W,scheduledTime:I,messageToEdit:ie}),!ie){console.error("[handleEditScheduledMessageConfirm] No message to edit!");return}try{const Qe=`${W}T${I}:00`,Ht=new Date(Qe),In=Ht.toISOString();console.log("[handleEditScheduledMessageConfirm] Updating:",{messageId:ie.id,input:Qe,localDate:Ht.toString(),utcDate:In,serverNow:new Date().toISOString()});const On=await Ie.updateScheduledMessage(ie.id,k,In);console.log("[handleEditScheduledMessageConfirm] Response:",On),Y(!1),se(null),ge(),rt()}catch(Qe){console.error("[handleEditScheduledMessageConfirm] Error:",Qe),alert(`Failed to update message: ${((Ne=(te=Qe.response)==null?void 0:te.data)==null?void 0:Ne.error)||Qe.message||"Unknown error"}`)}},ba=k=>{var Ne,Qe,Ht,In;if(!A)return;let W="";const I=de==null?void 0:de.latestOrder,te=de==null?void 0:de.customer;switch(k){case"order-status":if(I){const On=((Ne=I.lineItems)==null?void 0:Ne.slice(0,3).map(va=>`- ${va.quantity}x ${va.title}`).join(`
`))||"";W=`Hi ${A.customer_name||"there"},

I can see your order details:

Order #${I.orderNumber}
Status: ${I.fulfillmentStatus||"Unfulfilled"}
Payment: ${I.financialStatus||"Pending"}
Total: $${(Qe=I.totalPrice)==null?void 0:Qe.toFixed(2)} ${I.currency||"AUD"}
Ordered: ${new Date(I.createdAt).toLocaleDateString()}

Items:
${On}

Is there anything else I can help you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else W=`Hi ${A.customer_name||"there"},

I'm checking on your order status now. Let me look that up for you.

Order #: [ORDER_NUMBER]
Status: [STATUS]

Is there anything else I can help you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"tracking":I!=null&&I.trackingNumber?W=`Hi ${A.customer_name||"there"},

Here's your tracking information:

Order #${I.orderNumber}
Tracking #: ${I.trackingNumber}
${I.trackingCompany?`Carrier: ${I.trackingCompany}
`:""}${I.trackingUrl?`
Track your package: ${I.trackingUrl}`:""}

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`:I?W=`Hi ${A.customer_name||"there"},

I can see your order #${I.orderNumber} is currently ${I.fulfillmentStatus||"unfulfilled"}. Once it ships, I'll send you the tracking information right away.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`:W=`Hi ${A.customer_name||"there"},

Let me look up your tracking information for you.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"vip-wallet":if(te){const On=te.totalSpent>=1e3?"Platinum":te.totalSpent>=500?"Gold":te.totalSpent>=100?"Silver":"Bronze";W=`Hi ${A.customer_name||"there"},

Thank you for being a valued customer!

Customer Stats:
- Total Orders: ${te.ordersCount||0}
- Total Spent: $${((Ht=te.totalSpent)==null?void 0:Ht.toFixed(2))||"0.00"}
- VIP Tier: ${On}
- Member Since: ${te.createdAt?new Date(te.createdAt).toLocaleDateString():"N/A"}

Is there anything else I can assist you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else W=`Hi ${A.customer_name||"there"},

Let me check your customer account details.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"artwork":W=`Hi ${A.customer_name||"there"},

I've reviewed your artwork file. Here's what I found:

 Resolution: [DPI]
 Color mode: [COLOR_MODE]
 File format: [FORMAT]

Recommendations:
[RECOMMENDATIONS]

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"quote":W=`Hi ${A.customer_name||"there"},

Thank you for your quote request. Here are the details:

Product: [PRODUCT]
Quantity: [QUANTITY]
Price per unit: $[PRICE]
Total: $[TOTAL]

This quote is valid for 30 days. Would you like to proceed with the order?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"products":if(I!=null&&I.lineItems&&I.lineItems.length>0){const On=I.lineItems.map(va=>{var Kh;return`- ${va.title}
  Quantity: ${va.quantity}
  Price: $${((Kh=va.price)==null?void 0:Kh.toFixed(2))||"0.00"} each`}).join(`

`);W=`Hi ${A.customer_name||"there"},

Here are the products from your order #${I.orderNumber}:

${On}

Total: $${(In=I.totalPrice)==null?void 0:In.toFixed(2)} ${I.currency||"AUD"}

Is there anything else you'd like to know about these products?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else W=`Hi ${A.customer_name||"there"},

Let me look up your product details for you.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;default:return}y(W)};return u.useEffect(()=>{const k=W=>{(W.ctrlKey||W.metaKey)&&W.key==="y"&&(W.preventDefault(),$e(I=>(I||ae(!1),!I))),(W.ctrlKey||W.metaKey)&&W.key==="r"&&(W.preventDefault(),ae(I=>(I||$e(!1),!I)))};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[]),u.useEffect(()=>{const k=I=>{if(!We)return;const te=ee+(window.innerHeight-I.clientY-ee),Ne=150,Qe=window.innerHeight*.6;te>=Ne&&te<=Qe&&oe(te)},W=()=>{Je(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return We&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",k),window.addEventListener("mouseup",W)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",W)}},[We,ee]),u.useEffect(()=>{const k=I=>{if(!nt)return;const te=_e+(window.innerHeight-I.clientY-_e),Ne=150,Qe=window.innerHeight*.6;te>=Ne&&te<=Qe&&Ee(te)},W=()=>{kt(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return nt&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",k),window.addEventListener("mouseup",W)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",W)}},[nt,_e]),L?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading ticket..."})}):A?s.jsxs("div",{className:"flex h-[calc(100vh-4rem)] bg-gray-50",children:[s.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(lt,{to:"/tickets",className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[A.channel==="task"?s.jsx(Fa,{className:"w-4 h-4 text-amber-600"}):A.channel==="phone"||(Hh=A.subject)!=null&&Hh.toLowerCase().includes("callback request")?s.jsx(xa,{className:"w-4 h-4 text-red-600"}):A.channel==="chat"?s.jsx(Ur,{className:"w-4 h-4 text-indigo-500"}):A.channel==="whatsapp"?s.jsx(Ur,{className:"w-4 h-4 text-green-600"}):A.channel==="facebook"?s.jsx(Oh,{className:"w-4 h-4 text-blue-600"}):A.channel==="instagram"?s.jsx(zh,{className:"w-4 h-4 text-pink-500"}):s.jsx(tr,{className:"w-4 h-4 text-gray-500"}),s.jsx("h1",{className:"text-base font-semibold text-gray-900",children:jr(A.ticket_number)})]}),A.vip===1&&s.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 rounded-lg text-xs border border-yellow-200 font-medium",children:" VIP"}),s.jsx("button",{onClick:()=>J(!0),className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium hover:opacity-80 ${hg[A.status]||hg.open}`,children:A.status}),s.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${fg[A.priority]||fg.normal}`,children:A.priority}),s.jsxs("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${gg[A.sentiment]||gg.neutral}`,children:[s6[A.sentiment]||""," ",A.sentiment||"neutral"]}),A.channel==="task"&&A.sla_due_at&&s.jsxs("span",{className:`inline-flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${new Date(A.sla_due_at)<new Date?"bg-red-50 text-red-700 ring-red-600/20":"bg-amber-50 text-amber-700 ring-amber-600/20"}`,children:[s.jsx(Tl,{className:"w-3 h-3"}),new Date(A.sla_due_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]}),A.related_ticket_id&&(()=>{let k=A.related_ticket_id,W=A.related_ticket_id;if(k.startsWith("@"))W=`TKT-${k.substring(1)}`;else if(!k.includes("-"))W=`TKT-${k}`,k=`@${k}`;else{const I=k.match(/^[A-Z]+-(\d+)$/);I&&(k=`@${I[1]}`)}return s.jsx(lt,{to:`/tickets?search=${W}`,className:"inline-flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-indigo-50 text-indigo-700 ring-indigo-600/20 hover:bg-indigo-100",children:k})})()]}),s.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:A.assigned_to?xg[A.assigned_to]||A.assigned_to:"Unassigned"})]}),s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:A.customer_name||A.customer_email}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(A.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[s.jsx("span",{className:"font-medium",children:"Subject:"})," ",A.subject]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[A.channel==="task"&&s.jsxs("button",{onClick:()=>X(!0),className:"text-xs px-2 py-1 bg-amber-50 border border-amber-300 rounded-lg hover:bg-amber-100 flex items-center gap-1 text-amber-900",children:[s.jsx(Fa,{className:"w-3 h-3"}),s.jsx("span",{children:"Create Sub-Task"})]}),s.jsxs("button",{onClick:()=>K(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:"Reassign"})]}),s.jsxs("button",{onClick:()=>re(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),s.jsx("span",{children:"Escalate"})]}),s.jsxs("button",{onClick:()=>ke(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{children:"Snooze"})]}),s.jsxs("button",{onClick:()=>B(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",title:ya.length===0?"No other tickets from this customer":`${ya.length} other ticket(s) from this customer`,children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),s.jsx("span",{children:"Merge"}),ya.length>0&&s.jsx("span",{className:"bg-indigo-100 text-indigo-700 px-1 rounded text-xs",children:ya.length})]}),(a==null?void 0:a.role)==="admin"&&s.jsxs("button",{onClick:()=>E(!0),className:"text-xs px-2 py-1 bg-white border border-red-300 text-red-600 rounded-lg hover:bg-red-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{children:"Delete"})]})]})]})]}),s.jsxs("div",{className:"p-4 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>l(!i),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(xn,{className:"w-3 h-3"}),s.jsx("span",{children:"Customer Info"})]}),s.jsxs("button",{onClick:()=>c(!o),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(wb,{className:"w-3 h-3"}),s.jsx("span",{children:"Order History"})]}),s.jsxs("button",{onClick:()=>m(!d),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${d?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[s.jsx(ol,{className:"w-3 h-3"}),s.jsx("span",{children:"Shopify"})]}),A.merged_from&&s.jsxs("div",{className:"h-7 text-xs px-2 py-1 bg-indigo-50 border border-indigo-200 rounded-lg flex items-center gap-1.5 text-indigo-900",children:[s.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),s.jsxs("span",{children:[s.jsx("strong",{children:"Merged:"})," ",jr(A.ticket_number)," and ",jr(A.merged_from||"")]})]}),(at==null?void 0:at.relatedTasks)&&at.relatedTasks.length>0&&s.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:at.relatedTasks.map(k=>s.jsxs(lt,{to:`/tickets?search=${k.ticket_number}`,className:"h-7 text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[s.jsx(Fa,{className:"w-3 h-3 text-amber-600"}),s.jsxs("span",{children:[jr(k.ticket_number),": ",k.subject]})]},k.ticket_number))}),(at==null?void 0:at.subTasks)&&at.subTasks.length>0&&s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Sub-Tasks:"}),s.jsx("div",{className:"flex flex-col gap-1",children:at.subTasks.map(k=>s.jsxs(lt,{to:`/tickets?search=${k.ticket_number}`,className:"text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[s.jsx(Fa,{className:"w-3 h-3 text-amber-600"}),s.jsx("span",{className:"font-medium",children:jr(k.ticket_number)}),s.jsx("span",{className:"text-gray-600",children:"-"}),s.jsx("span",{children:k.subject}),s.jsx("span",{className:`ml-auto px-2 py-0.5 rounded text-xs ${k.status==="completed"?"bg-green-100 text-green-800":k.status==="in-progress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:k.status})]},k.ticket_number))})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[Ge.length>0&&s.jsxs("div",{className:"h-7 text-xs px-2 py-1 bg-yellow-100 border border-yellow-300 rounded-lg flex items-center gap-1.5 font-medium text-yellow-900",title:`${Ge.length} scheduled message${Ge.length>1?"s":""}`,children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("span",{children:[Ge.length," Scheduled"]})]}),s.jsx("button",{onClick:ye,disabled:!S,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(mi,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:Pe,disabled:!ve,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Yl,{className:"w-3.5 h-3.5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[i&&s.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"}),s.jsx("span",{className:"ml-2 font-medium",children:A.customer_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"VIP:"}),s.jsx("span",{className:"ml-2 font-medium text-amber-600",children:A.vip?"Yes":"No"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"Email:"}),s.jsx("span",{className:"ml-2 font-medium",children:A.customer_email})]})]})]})}),o&&s.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),s.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[s.jsxs("div",{className:"p-4 rounded-lg bg-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-gray-300",children:s.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:A.customer_name}),s.jsx("span",{className:"text-xs text-gray-400",children:A.created_at&&typeof A.created_at=="string"?hr(new Date(A.created_at.includes("Z")?A.created_at:A.created_at+"Z"),{addSuffix:!0}):""})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:A.description})]}),Ae.map(k=>{var Ne;const W=k.sender_type==="customer",I=k.sender_id==="ai-agent-001",te=k.was_scheduled===!0||k.was_scheduled===1;return s.jsxs("div",{className:`p-4 rounded-lg ${W?"bg-gray-100":I?"bg-purple-50":"bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${W?"bg-gray-300":I?"bg-purple-200":"bg-blue-200"}`,children:W?s.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}):I?s.jsx(Xs,{className:"w-3 h-3 text-purple-600"}):s.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:W?k.sender_name||"Customer":I?"McCarthy AI":k.sender_name?k.sender_name.split(" ")[0]:"Staff"}),s.jsx("span",{className:"text-xs text-gray-400",children:k.created_at&&typeof k.created_at=="string"?hr(new Date(k.created_at.includes("Z")?k.created_at:k.created_at+"Z"),{addSuffix:!0}):""}),te&&!W&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-blue-100 text-blue-600 text-xs rounded",title:"This message was scheduled",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Scheduled"]})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:k.content}),k.attachment_url&&s.jsx("div",{className:"mt-2 ml-8",children:(Ne=k.attachment_type)!=null&&Ne.startsWith("image/")?s.jsxs("a",{href:wa(k.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:wa(k.attachment_url),alt:k.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:k.attachment_name})]}):s.jsxs("a",{href:wa(k.attachment_url),download:k.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:k.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(k.attachment_size/1024).toFixed(1)," KB)"]})]})})]},k.id)}),Ge.map(k=>s.jsxs("div",{className:"p-4 rounded-lg bg-yellow-50 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-yellow-200",children:s.jsx("svg",{className:"w-3 h-3 text-yellow-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:k.first_name}),s.jsxs("button",{onClick:()=>Ob(k),className:"inline-flex items-center gap-1 px-2 py-0.5 bg-yellow-100 border border-yellow-300 text-yellow-800 text-xs font-medium rounded hover:bg-yellow-200 transition-colors",title:"Click to edit message and scheduled time",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Scheduled: ",new Date(k.scheduled_for).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:k.content})]},k.id)),Pt!=null&&Pt.draft?s.jsx("div",{className:"mt-4",children:s.jsx(e6,{ticketId:e,draft:Pt.draft,loading:Ln,onApprove:zb,onEdit:Ub,onReject:Hb})}):null,s.jsx("div",{ref:F})]})]}),s.jsxs("div",{className:"flex-shrink-0",children:[s.jsxs("div",{className:"border-t border-gray-200 bg-white",children:[P&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-purple-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>Je(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-purple-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-purple-50 to-purple-100 border-b border-purple-200 flex items-center gap-2 cursor-pointer hover:from-purple-100 hover:to-purple-150 transition-colors",onClick:()=>{ae(k=>(k||$e(!1),!k))},children:[s.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Response Area"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+R"})]}),P&&s.jsxs("div",{className:"p-4 flex flex-col",style:{height:`${ee}px`},children:[v.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:v.map((k,W)=>s.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-gray-100 rounded-lg text-xs",children:[s.jsx(St,{className:"w-3 h-3 text-gray-500"}),s.jsx("span",{className:"max-w-[150px] truncate",children:k.name}),s.jsx("button",{onClick:()=>et(W),className:"text-gray-400 hover:text-red-500",children:s.jsx(_t,{className:"w-3 h-3"})})]},W))}),s.jsx("div",{className:"flex-1 mb-2 min-h-0",children:s.jsx("textarea",{value:g,onChange:k=>y(k.target.value),placeholder:"Type your response...",className:"w-full h-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500 resize-none min-h-0"})}),s.jsxs("div",{className:"space-y-3 flex-shrink-0",children:[s.jsx("input",{type:"file",ref:N,onChange:He,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>{var k;return(k=N.current)==null?void 0:k.click()},className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]}),s.jsx("button",{className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" All Templates"}),s.jsx("button",{onClick:()=>ba("order-status"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @order-status"}),s.jsx("button",{onClick:()=>ba("tracking"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @tracking"}),s.jsx("button",{onClick:()=>ba("vip-wallet"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @vip-wallet"}),s.jsx("button",{onClick:()=>ba("artwork"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @artwork"}),s.jsx("button",{onClick:()=>ba("quote"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @quote"}),s.jsx("button",{onClick:()=>ba("products"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" Products"}),s.jsx("button",{className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" Generate Invoice"})]}),s.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[s.jsxs("button",{onClick:Ke,disabled:!g.trim()&&v.length===0||b,className:"px-4 py-2 text-sm bg-purple-200 text-purple-800 border border-purple-300 rounded-lg hover:bg-purple-300 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),b?"Sending...":`Send Reply${v.length>0?` (${v.length})`:""}`]}),s.jsxs("button",{onClick:Fb,className:"px-4 py-2 text-sm bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 font-medium flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Schedule Reply"]}),s.jsxs("button",{onClick:Lb,className:"px-4 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 font-medium flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Resolve & Close"]})]})]})]})]}),s.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[xe&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>kt(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>{$e(k=>(k||ae(!1),!k))},children:[s.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),xe&&s.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${_e}px`},children:[Re&&Re.length>0&&s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:Re.map(k=>{var W;return s.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:k.first_name||"Staff"}),s.jsx("span",{className:"text-xs text-gray-500",children:k.created_at&&typeof k.created_at=="string"?hr(new Date(k.created_at.includes("Z")?k.created_at:k.created_at+"Z"),{addSuffix:!0}):""}),k.edited_at&&s.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[(k.staff_id===(a==null?void 0:a.id)||(a==null?void 0:a.role)==="admin")&&Et!==k.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{rs(k.id),Ns(k.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),s.jsx("button",{onClick:()=>As(k.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]}),k.note_type==="escalation"&&k.escalated_to===(a==null?void 0:a.id)&&(k.escalation_status==="pending"?s.jsx("button",{type:"button",onClick:async()=>{var I,te;if(!(!A||!k.escalation_id))try{await Ie.resolveEscalation(A.ticket_id,k.escalation_id),ge()}catch(Ne){console.error("Failed to resolve escalation:",Ne),alert(`Failed to resolve escalation: ${((te=(I=Ne.response)==null?void 0:I.data)==null?void 0:te.error)||Ne.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Resolve"}):k.escalation_status==="resolved"&&k.resolved_at?s.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["Resolved: ",new Date(k.resolved_at).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})]}):null)]})]}),Et===k.id?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:Us,onChange:I=>Ns(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:async()=>{var I,te;if(!(!A||!Us.trim()))try{await Ie.editNote(A.ticket_id,k.id,Us),rs(null),Ns(""),n.invalidateQueries({queryKey:["ticket",e]})}catch(Ne){console.error("Failed to edit note:",Ne),alert(`Failed to edit note: ${((te=(I=Ne.response)==null?void 0:I.data)==null?void 0:te.error)||Ne.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{rs(null),Ns("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:(()=>{let I=k.content||"";return I.includes("MERGE_TIMESTAMP:")&&(I=I.replace(/MERGE_TIMESTAMP:([^\n]+)\n?/g,(te,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})+`
`}catch{return""}})),I.includes("SCHEDULE_TIME:")&&(I=I.replace(/SCHEDULE_TIME:([^\s]+)/g,(te,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Ne}})),I.includes("SNOOZE_TIME:")&&(I=I.replace(/SNOOZE_TIME:(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?)/g,(te,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Ne}})),I.includes("BULK_REASSIGN_TIME:")&&(I=I.replace(/BULK_REASSIGN_TIME:(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?)/g,(te,Ne)=>{try{return new Date(Ne.trim()).toLocaleString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Ne}})),I})()}),k.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Zl(k.tags).map((I,te)=>s.jsxs(lt,{to:`/tags?search=${encodeURIComponent(I)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[s.jsx(Ot,{className:"w-3 h-3 mr-1"}),I]},te))}),k.attachment_url&&s.jsx("div",{className:"mt-2",children:(W=k.attachment_type)!=null&&W.startsWith("image/")?s.jsxs("a",{href:wa(k.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:wa(k.attachment_url),alt:k.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:k.attachment_name})]}):s.jsxs("a",{href:wa(k.attachment_url),download:k.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:k.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(k.attachment_size/1024).toFixed(1)," KB)"]})]})})]},k.id)})}),br&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),s.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[s.jsx("button",{onClick:()=>As(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:async()=>{var k,W;if(A)try{await Ie.deleteNote(A.ticket_id,br),As(null),n.invalidateQueries({queryKey:["ticket",e]})}catch(I){console.error("Failed to delete note:",I),alert(`Failed to delete note: ${((W=(k=I.response)==null?void 0:k.data)==null?void 0:W.error)||I.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[Gt.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:Gt.map((k,W)=>s.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"max-w-[150px] truncate",children:k.name}),s.jsx("button",{onClick:()=>nr(W),className:"text-red-500 hover:text-red-700",children:s.jsx(_t,{className:"w-3 h-3"})})]},W))}),s.jsx("textarea",{value:Te,onChange:k=>$(k.target.value),onKeyDown:async k=>{var W,I;if(k.key==="Enter"&&!k.shiftKey&&Te.trim()&&A){k.preventDefault(),console.log("[Staff Notes] Submitting note");try{const te=await Promise.all(Gt.map(async Ne=>({name:Ne.name,content:await ot(Ne),type:Ne.type,size:Ne.size})));await Ie.addNote(A.ticket_id,Te,void 0,te.length>0?te:void 0),$(""),ss([]),ge()}catch(te){console.error("Failed to add note:",te),alert(`Failed to add note: ${((I=(W=te.response)==null?void 0:W.data)==null?void 0:I.error)||te.message||"Unknown error"}`)}}},placeholder:"Add internal notes... Use @to mention staff, #keyword to add tags (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),s.jsx("input",{type:"file",ref:_,onChange:$t,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("button",{onClick:()=>{var k;return(k=_.current)==null?void 0:k.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]})]}),s.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${d?"w-96":"w-0"}`,children:d&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ol,{className:"w-5 h-5 text-green-600"}),s.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),s.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),ms&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}),rr&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:[s.jsx("p",{className:"text-sm text-red-600",children:rr}),s.jsx("button",{onClick:()=>{vr(null),ks(null)},className:"text-xs text-red-700 underline mt-2",children:"Try again"})]}),de&&!de.configured&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:s.jsx("p",{className:"text-sm text-yellow-700",children:de.message})}),de&&de.configured&&!de.customer&&s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:s.jsx("p",{className:"text-sm text-gray-600",children:de.message||"Customer not found in Shopify"})}),de&&de.customer&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[de.customer.firstName," ",de.customer.lastName]}),s.jsx("p",{className:"text-xs text-gray-500",children:de.customer.email}),de.customer.phone&&s.jsx("p",{className:"text-xs text-gray-500",children:de.customer.phone}),de.customer.isVIP&&s.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[s.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),s.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((Bh=de.customer.totalSpent)==null?void 0:Bh.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),s.jsx("span",{className:"font-semibold text-gray-900",children:de.customer.ordersCount||0})]}),de.customer.lastOrderDate&&s.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[s.jsx("span",{className:"text-gray-500",children:"Last Order:"}),s.jsx("span",{className:"text-gray-900",children:new Date(de.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),de.orders&&de.orders.length>0?s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",h+1," OF ",de.orders.length]}),de.orders.length>1&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>p(Math.max(0,h-1)),disabled:h===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>p(Math.min(de.orders.length-1,h+1)),disabled:h===de.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",de.orders[h].orderNumber]}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${de.orders[h].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":de.orders[h].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:de.orders[h].fulfillmentStatus||"Unfulfilled"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",s.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(qh=de.orders[h].totalPrice)==null?void 0:qh.toFixed(2)," ",de.orders[h].currency]})]})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Created:"}),s.jsx("span",{className:"text-gray-900",children:new Date(de.orders[h].createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Payment:"}),s.jsx("span",{className:`font-medium ${de.orders[h].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:de.orders[h].financialStatus||"Pending"})]})]}),de.orders[h].lineItems&&de.orders[h].lineItems.length>0&&s.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),s.jsx("div",{className:"space-y-2",children:de.orders[h].lineItems.map((k,W)=>{var I;return s.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[s.jsxs("button",{onClick:()=>f(j===k.id?null:k.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:k.title}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["x",k.quantity]}),s.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${j===k.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),j===k.id&&s.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Price:"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(I=k.price)==null?void 0:I.toFixed(2)]})]}),k.sku&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"SKU:"}),s.jsx("span",{className:"text-gray-900 font-mono",children:k.sku})]}),k.variantTitle&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Variant:"}),s.jsx("span",{className:"text-gray-900",children:k.variantTitle})]}),k.customAttributes&&k.customAttributes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),k.customAttributes.map((te,Ne)=>s.jsxs("div",{className:"flex justify-between py-0.5",children:[s.jsxs("span",{className:"text-gray-500",children:[te.key.replace("_",""),":"]}),te.key.includes("Link")||te.key.includes("link")?s.jsx("a",{href:te.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:Qe=>Qe.stopPropagation(),children:"View "}):s.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:te.value})]},Ne))]})]})]},k.id||W)})})]})]})]}):s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),de.orders&&((Wh=de.orders[h])==null?void 0:Wh.trackingNumber)&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),s.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:de.orders[h].trackingNumber}),de.orders[h].trackingCompany&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",s.jsx("span",{className:"text-gray-900",children:de.orders[h].trackingCompany})]})]}),de.orders[h].trackingUrl&&s.jsx("a",{href:de.orders[h].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]}),!ms&&!rr&&!de&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ol,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})]})]})}),R&&s.jsx(GC,{currentStatus:A.status,onClose:()=>J(!1),onSave:pa}),s.jsx(_b,{isOpen:q,onClose:()=>K(!1),onReassign:Tb,currentAssignment:A.assigned_to?xg[A.assigned_to]:void 0}),s.jsx(YC,{isOpen:ne,onClose:()=>re(!1),onConfirm:Ab,ticketNumber:A.ticket_number}),s.jsx(JC,{isOpen:pe,onClose:()=>ke(!1),onConfirm:Rb,onRemoveSnooze:Pb,ticketNumber:A.ticket_number,isSnoozed:A.status==="snoozed"}),s.jsx(XC,{isOpen:we,onClose:()=>H(!1),onConfirm:Ib}),s.jsx(ZC,{isOpen:T,onClose:()=>{Y(!1),se(null)},onConfirm:qb,onRemove:Db,message:ie}),je&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Ticket"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Are you sure you want to delete ticket ",s.jsx("span",{className:"font-medium",children:jr(A.ticket_number)}),"? This action cannot be undone."]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:Mt,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Delete Ticket"})]})]})}),s.jsx(t6,{isOpen:be,onClose:()=>le(!1),onSubmit:Bb}),V&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Merge Tickets"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Select a ticket to merge into ",s.jsx("span",{className:"font-medium",children:jr(A.ticket_number)})," (primary).",s.jsx("br",{}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Only showing tickets from: ",A.customer_email]})]}),ya.length===0?s.jsxs("div",{className:"py-8 text-center text-gray-500",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("p",{className:"text-sm",children:"No other open tickets from this customer"})]}):s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 mb-4",children:ya.map(k=>s.jsxs("label",{className:`flex items-start p-3 rounded-lg border cursor-pointer transition-colors ${Q===k.ticket_id?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"}`,children:[s.jsx("input",{type:"radio",name:"mergeTicket",value:k.ticket_id,checked:Q===k.ticket_id,onChange:()=>U(k.ticket_id),className:"mt-1 mr-3 text-purple-600 focus:ring-purple-500"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-medium text-sm text-gray-900",children:jr(k.ticket_number)}),s.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${k.status==="snoozed"?"bg-purple-100 text-purple-700":k.status==="in-progress"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:k.status}),s.jsx("span",{className:"text-xs text-gray-400",children:hr(new Date(k.created_at),{addSuffix:!0})})]}),s.jsx("p",{className:"text-sm text-gray-600 truncate",children:k.subject})]})]},k.ticket_id))}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[s.jsx("button",{onClick:()=>{B(!1),U(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:$b,disabled:!Q||me,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:me?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Merging..."]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Merge into ",jr(A.ticket_number)]})})]})]})}),s.jsx(Eb,{isOpen:G,onClose:()=>{X(!1),ge()},parentTaskId:A==null?void 0:A.ticket_id,parentTaskNumber:A==null?void 0:A.ticket_number})]}):s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Ticket not found"})})}function n6(){var D,Me,Te;const e=yr(),t=mt(),r=ws($=>$.user),[n,a]=u.useState(null),[i,l]=u.useState(!1),[o,c]=u.useState([]),[d,m]=u.useState(null),h=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager",[p,j]=u.useState("my-mentions"),[f,g]=u.useState(""),[y,b]=u.useState(""),[x,v]=u.useState(""),[w,N]=u.useState(""),[_,F]=u.useState("all"),[R,J]=u.useState("active"),[q,K]=u.useState(""),[ne,re]=u.useState(""),[pe,ke]=u.useState(""),{data:we}=he({queryKey:["staff-users"],queryFn:async()=>(await tt.list()).data}),H=Le.useMemo(()=>[...(we==null?void 0:we.staff)||[],{id:"ai-agent-001",firstName:"McCarthy",lastName:"AI",email:"mccarthy@dartmouth.ai"}],[we]),{data:T,isLoading:Y}=he({queryKey:["mentions",p,f,y,x,w,_,R,q,ne],queryFn:async()=>{const $={};return p==="my-mentions"||(p==="all-mentions"&&h?$.view_all=!0:p==="by-staff"&&f?$.mentioned_staff_id=f:p==="by-ticket"&&y&&($.ticket_number=y)),x&&($.channel_id=x),w&&w!=="all"&&($.time_filter=w),_==="unread"&&($.is_read=!1),_==="read"&&($.is_read=!0),R==="archived"&&($.is_archived=!0),R==="active"&&($.is_archived=!1),q&&($.start_date=q),ne&&($.end_date=ne),(await Dn.getMentions($)).data},refetchInterval:3e4,refetchOnWindowFocus:!1}),G=(T==null?void 0:T.mentions)||[],X=Le.useMemo(()=>{if(!pe.trim())return G;const $=pe.toLowerCase().trim();return G.filter(ee=>{var Ee,We,Je,nt;const oe=(Ee=$.match(/\d+/))==null?void 0:Ee[0];if(oe&&ee.message_content){const kt=ee.message_content.toLowerCase();if([`@${oe}`,`#${oe}`,`*${oe}`,`ticket ${oe}`,`tkt-${oe}`,`tkt-000${oe}`,`tsk-${oe}`,`tsk-000${oe}`].some(ss=>kt.includes(ss))||kt.includes(oe))return!0}return!!(oe&&ee.ticket_number&&((We=ee.ticket_number.match(/\d+/))==null?void 0:We[0])===oe||`${ee.mentioning_first_name} ${ee.mentioning_last_name}`.toLowerCase().includes($)||(Je=ee.message_content)!=null&&Je.toLowerCase().includes($)||(nt=ee.channel_name)!=null&&nt.toLowerCase().includes($))})},[G,pe]);Le.useEffect(()=>{X.length>0&&!n&&a(X[0])},[X]),Le.useEffect(()=>{n&&X.find($=>$.id===n.id)},[n]);const ie=()=>{if(!n||X.length===0)return;const $=X.findIndex(ee=>ee.id===n.id);if($>0){const ee=X[$-1];a(ee)}},se=()=>{if(!n||X.length===0)return;const $=X.findIndex(ee=>ee.id===n.id);if($<X.length-1){const ee=X[$+1];a(ee)}},xe=n?X.findIndex($=>$.id===n.id):-1,{data:$e}=he({queryKey:["mentions-unread-count"],queryFn:async()=>(await Dn.getUnreadCount()).data,refetchInterval:5e3}),P=($e==null?void 0:$e.count)||0,{data:ae}=he({queryKey:["group-chat-channels"],queryFn:async()=>(await ft.listChannels()).data}),je=(ae==null?void 0:ae.channels)||[],E=Ce({mutationFn:async $=>{console.log("[Mentions] Marking as read:",$);const ee=await Dn.markAsRead($);return console.log("[Mentions] Mark as read response:",ee),ee},onMutate:async $=>{console.log("[Mentions] onMutate - marking as read:",$);const ee=["mentions",p,f,y,x,w,_,R,q,ne];await t.cancelQueries({queryKey:ee});const oe=t.getQueryData(ee);return t.setQueryData(ee,_e=>_e!=null&&_e.mentions?{..._e,mentions:_e.mentions.map(Ee=>Ee.id===$?{...Ee,is_read:1,read_at:new Date().toISOString()}:Ee)}:_e),n&&n.id===$&&a({...n,is_read:1,read_at:new Date().toISOString()}),{previousMentions:oe,currentQueryKey:ee}},onError:($,ee,oe)=>{console.error("[Mentions] Error marking as read:",$),t.setQueryData(oe.currentQueryKey,oe.previousMentions),t.invalidateQueries({queryKey:oe.currentQueryKey}),t.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{console.log("[Mentions] Successfully marked as read"),t.invalidateQueries({queryKey:["mentions-unread-count"]})}}),V=Ce({mutationFn:async $=>{console.log("[Mentions] Marking as unread:",$);const ee=await Dn.markAsUnread($);return console.log("[Mentions] Mark as unread response:",ee),ee},onMutate:async $=>{const ee=["mentions",p,f,y,x,w,_,R,q,ne];await t.cancelQueries({queryKey:ee});const oe=t.getQueryData(ee);return t.setQueryData(ee,_e=>_e!=null&&_e.mentions?{..._e,mentions:_e.mentions.map(Ee=>Ee.id===$?{...Ee,is_read:0,read_at:null}:Ee)}:_e),n&&n.id===$&&a({...n,is_read:0,read_at:null}),{previousMentions:oe,currentQueryKey:ee}},onError:($,ee,oe)=>{t.setQueryData(oe.currentQueryKey,oe.previousMentions),t.invalidateQueries({queryKey:oe.currentQueryKey}),t.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{t.invalidateQueries({queryKey:["mentions-unread-count"]})}}),B=Ce({mutationFn:async $=>{const ee=$.mentionIds.map(oe=>$.isRead?Dn.markAsRead(oe):Dn.markAsUnread(oe));return Promise.all(ee)},onMutate:async $=>{const ee=["mentions",p,f,y,x,w,_,R,q,ne];await t.cancelQueries({queryKey:ee});const oe=t.getQueryData(ee);return t.setQueryData(ee,_e=>_e!=null&&_e.mentions?{..._e,mentions:_e.mentions.map(Ee=>$.mentionIds.includes(Ee.id)?{...Ee,is_read:$.isRead?1:0,read_at:$.isRead?new Date().toISOString():null}:Ee)}:_e),{previousMentions:oe,currentQueryKey:ee}},onError:($,ee,oe)=>{t.setQueryData(oe.currentQueryKey,oe.previousMentions),t.invalidateQueries({queryKey:oe.currentQueryKey}),t.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{c([]),t.invalidateQueries({queryKey:["mentions-unread-count"]})}}),Q=Ce({mutationFn:async()=>{const ee=G.filter(oe=>oe.is_read===1&&oe.is_archived===0).map(oe=>Dn.archiveMention(oe.id));return Promise.all(ee)},onSuccess:()=>{t.invalidateQueries({queryKey:["mentions"]})}}),U=($,ee)=>{if(console.log("[MentionsPage] Clicking mention:",$.id),ee!=null&&ee.shiftKey&&d!==null){const oe=X.findIndex(Je=>Je.id===$.id),_e=Math.min(d,oe),Ee=Math.max(d,oe),We=X.slice(_e,Ee+1).map(Je=>Je.id);c(We)}else ee!=null&&ee.ctrlKey||ee!=null&&ee.metaKey?(c(oe=>oe.includes($.id)?oe.filter(_e=>_e!==$.id):[...oe,$.id]),m(X.findIndex(oe=>oe.id===$.id))):(c([]),m(X.findIndex(oe=>oe.id===$.id)),a($))},me=()=>{n&&(n.context_type==="group_chat"?e(`/group-chat?channel=${n.context_id}&message=${n.message_id}`):n.ticket_id&&e(`/tickets/${n.ticket_id}`))},ze=$=>{if(!$)return"";const ee=$.match(/\d+/);return ee?`@${parseInt(ee[0],10)}`:$},be=($,ee="w-3 h-3")=>{switch($){case"email":return s.jsx(tr,{className:ee});case"phone":case"callback":return s.jsx(xa,{className:`${ee} text-red-600`});case"chat":return s.jsx(Ur,{className:ee});case"whatsapp":case"facebook":case"instagram":return s.jsx(O3,{className:ee});default:return s.jsx(Ur,{className:ee})}},le=$=>{if(!$)return null;const ee=/(@(\d+)|TKT-(\d+)|ticket\s+(\d+)|#(\d+)|\*(\d+)(?:-(\d+))?|TSK-(\d+)(?:-(\d+))?)/gi,oe=[];let _e=0,Ee;for(;(Ee=ee.exec($))!==null;){Ee.index>_e&&oe.push({text:$.substring(_e,Ee.index),isTicket:!1});const We=Ee[2]||Ee[3]||Ee[4]||Ee[5],Je=Ee[6]||Ee[8],nt=Ee[7]||Ee[9],kt=Je!==void 0,Gt=kt?Je:We;oe.push({text:Ee[0],isTicket:!kt,ticketNumber:Gt,isTask:kt,subTaskNumber:nt}),_e=Ee.index+Ee[0].length}return _e<$.length&&oe.push({text:$.substring(_e),isTicket:!1}),oe.length===0?s.jsx("span",{children:$}):s.jsx("span",{children:oe.map((We,Je)=>We.isTicket||We.isTask?s.jsx("a",{href:We.isTask?`/tickets?search=${We.subTaskNumber?`TSK-${We.ticketNumber}-${We.subTaskNumber}`:`TSK-${We.ticketNumber}`}`:`/tickets?search=TKT-${We.ticketNumber}`,target:"_blank",rel:"noopener noreferrer",className:We.isTask?"text-amber-600 hover:text-amber-800 hover:underline font-medium cursor-pointer":"text-blue-600 hover:text-blue-800 hover:underline font-medium cursor-pointer",onClick:nt=>{nt.stopPropagation()},children:We.text},Je):s.jsx("span",{children:We.text},Je))})};return s.jsxs("div",{className:"flex h-full",children:[s.jsxs("div",{className:"w-96 bg-white flex flex-col h-full border-r border-gray-200",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h1",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Di,{className:"w-6 h-6"}),"Mentions",p==="all-mentions"&&h&&s.jsx("span",{title:"Admin View",children:s.jsx(tS,{className:"w-5 h-5 text-blue-600"})})]}),P>0&&p==="my-mentions"&&s.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:P})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[p==="my-mentions"&&"Messages where you were mentioned",p==="all-mentions"&&h&&"All mentions (Admin view)",p==="by-staff"&&f&&`Mentions for ${((D=H.find($=>$.id===f))==null?void 0:D.firstName)||"staff member"}`,p==="by-staff"&&!f&&"Select a staff member to view their mentions",p==="by-ticket"&&y&&`Mentions in ${y}`,p==="by-ticket"&&!y&&"Enter a ticket number to view mentions"]}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[pe?`${X.length} of ${G.length}`:`${G.length}`," mention",G.length!==1?"s":""," ",pe?"matching":"found"]})]}),s.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-white",children:s.jsxs("div",{className:"relative",children:[s.jsx(hi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:pe,onChange:$=>ke($.target.value),placeholder:"Search by ticket (@261), task (*123), staff name, or message...",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),pe&&s.jsx("button",{onClick:()=>ke(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:"Clear search",children:s.jsx(_t,{className:"w-4 h-4"})})]})}),s.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 text-sm font-semibold text-gray-700 hover:text-gray-900",children:[s.jsx(S3,{className:"w-4 h-4"}),"Filters ",i?"":""]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsxs("button",{onClick:()=>{o.length>0?B.mutate({mentionIds:o,isRead:!1}):F("unread")},className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors ${_==="unread"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:o.length>0?`Mark ${o.length} as unread`:"Show unread only",children:["Unread (",G.filter($=>$.is_read===0&&$.is_archived===0).length,")"]}),s.jsxs("button",{onClick:()=>{o.length>0?B.mutate({mentionIds:o,isRead:!0}):F("read")},className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors ${_==="read"?"bg-gray-100 text-gray-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:o.length>0?`Mark ${o.length} as read`:"Show read only",children:["Read (",G.filter($=>$.is_read===1&&$.is_archived===0).length,")"]}),s.jsx("button",{onClick:()=>{R==="archived"?J("active"):Q.mutate()},disabled:Q.isPending,className:"px-2 py-0.5 text-xs font-medium rounded-full transition-colors bg-pink-100 text-pink-700 hover:bg-pink-200 disabled:opacity-50",title:"Archive all Read mentions",children:"Archive"})]})]}),o.length>0?s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[" ",o.length," selected  Click pill to toggle read/unread"]}):s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:" Shift+Click: Select range  Ctrl/Cmd+Click: Toggle selection"}),!i&&s.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[p!==(h?"all-mentions":"my-mentions")&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:[p==="my-mentions"&&"My Mentions",p==="all-mentions"&&"All Mentions",p==="by-staff"&&f&&`Staff: ${(Me=H.find($=>$.id===f))==null?void 0:Me.firstName}`,p==="by-ticket"&&y&&`Ticket: ${y}`]}),x&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full",children:["#",((Te=je.find($=>$.id===x))==null?void 0:Te.name)||"Channel"]}),_!=="all"&&s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${_==="unread"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:_==="unread"?"Unread":"Read"}),w&&w!==""&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded-full",children:[w==="hour"&&"Last hour",w==="12hours"&&"Last 12h",w==="24hours"&&"Last 24h",w==="custom"&&"Custom dates"]}),!x&&_==="all"&&!w&&p===(h?"all-mentions":"my-mentions")&&s.jsx("span",{className:"text-xs text-gray-500 italic",children:"No filters applied"})]}),i&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"View"}),s.jsxs("select",{value:p,onChange:$=>{j($.target.value),g(""),b("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"my-mentions",children:"My Mentions"}),h&&s.jsx("option",{value:"all-mentions",children:"All Mentions (Admin)"}),s.jsx("option",{value:"by-staff",children:"By Staff Member"}),s.jsx("option",{value:"by-ticket",children:"By Ticket Number"})]})]}),p==="by-staff"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Staff Member"}),s.jsxs("select",{value:f,onChange:$=>g($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select staff member..."}),H.map($=>s.jsxs("option",{value:$.id,children:[$.firstName," ",$.lastName]},$.id))]})]}),p==="by-ticket"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Ticket Number"}),s.jsx("input",{type:"text",value:y,onChange:$=>b($.target.value),placeholder:"e.g., TKT-000261",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Channel"}),s.jsxs("select",{value:x,onChange:$=>v($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"All channels"}),je.map($=>s.jsxs("option",{value:$.id,children:["#",$.name]},$.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:_,onChange:$=>F($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"All"}),s.jsx("option",{value:"unread",children:"Unread only"}),s.jsx("option",{value:"read",children:"Read only"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Archive"}),s.jsxs("select",{value:R,onChange:$=>J($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"active",children:"Active mentions"}),s.jsx("option",{value:"archived",children:"All Archived"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Time Range"}),s.jsxs("select",{value:w,onChange:$=>N($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"All time"}),s.jsx("option",{value:"hour",children:"Last hour"}),s.jsx("option",{value:"12hours",children:"Last 12 hours"}),s.jsx("option",{value:"24hours",children:"Last 24 hours"}),s.jsx("option",{value:"custom",children:"Custom date range"})]})]}),w==="custom"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"From"}),s.jsx("input",{type:"date",value:q,onChange:$=>K($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"To"}),s.jsx("input",{type:"date",value:ne,onChange:$=>re($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s.jsx("button",{onClick:()=>{j(h?"all-mentions":"my-mentions"),g(""),b(""),v(""),N(""),F("all"),K(""),re("")},className:"w-full px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg border border-gray-300",children:"Clear All Filters"})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:Y?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("div",{className:"text-gray-500",children:"Loading mentions..."})}):X.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[s.jsx(Di,{className:"w-16 h-16 text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"No mentions yet"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"When someone mentions you with @yourname, it will appear here"})]}):s.jsx("div",{className:"divide-y divide-gray-200",children:X.map($=>{const ee=(n==null?void 0:n.id)===$.id,oe=o.includes($.id),_e=$.is_read===0;let Ee="",We="";return oe?(Ee="bg-indigo-100",We="border-indigo-500"):ee?(Ee=_e?"bg-blue-100":"bg-gray-100",We=_e?"border-blue-500":"border-gray-500",console.log("[MentionsPage] Selected mention:",$.id,"border:",We)):(Ee=_e?"bg-blue-50":"bg-white",We="border-transparent"),s.jsxs("button",{onClick:Je=>U($,Je),style:{borderLeft:oe?"6px solid #6366f1":ee?_e?"6px solid #3b82f6":"6px solid #6b7280":"6px solid transparent"},className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${Ee} relative`,children:[oe&&s.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-indigo-600 rounded flex items-center justify-center",children:s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[$.context_type==="group_chat"?s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-indigo-100 text-indigo-700 rounded-full",children:[s.jsx(Ot,{className:"w-3 h-3"}),$.channel_name]}):s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-purple-100 text-purple-700 rounded-full",children:[be($.ticket_channel),ze($.ticket_number)]}),s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-orange-50 text-orange-600 rounded-full",children:[s.jsx(Di,{className:"w-3 h-3"}),"Mention by ",$.mentioning_first_name]}),s.jsx("span",{className:"text-xs text-gray-600",children:new Date($.created_at).toLocaleString()}),$.is_read===0?s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-semibold bg-blue-100 text-blue-700 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Unread"]}):s.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-emerald-100 text-emerald-700 rounded-full",children:" Read"})]}),$.message_content&&s.jsx("div",{className:`text-sm line-clamp-2 ${$.is_read===0?"text-gray-900 font-medium":"text-gray-600"}`,children:le($.message_content)}),$.attachment_url&&s.jsxs("div",{onClick:Je=>{Je.stopPropagation(),$.context_type==="group_chat"&&e(`/group-chat?channel=${$.context_id}&message=${$.message_id}`)},className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 mt-1 cursor-pointer",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"hover:underline",children:$.attachment_name||"Attachment"})]})]})]},$.id)})})})]}),s.jsx("div",{className:"flex-1 bg-white flex flex-col h-full",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.context_type==="group_chat"?s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-700 rounded-full",children:[s.jsx(Ot,{className:"w-3.5 h-3.5"}),n.channel_name]}):s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-purple-100 text-purple-700 rounded-full",children:[be(n.ticket_channel,"w-3.5 h-3.5"),ze(n.ticket_number)]}),s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-orange-50 text-orange-600 rounded-full",children:[s.jsx(Di,{className:"w-3.5 h-3.5"}),"Mention by ",n.mentioning_first_name]}),s.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-medium bg-slate-100 text-slate-700 rounded-full",children:[s.jsx(pb,{className:"w-3.5 h-3.5"}),new Date(n.created_at).toLocaleString()]}),n.is_read===0?s.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-semibold bg-blue-100 text-blue-700 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Unread"]}):s.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-medium bg-emerald-100 text-emerald-700 rounded-full",children:" Read"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:ie,disabled:xe===0,className:"p-1.5 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",title:"Previous mention",children:s.jsx(mi,{className:"w-4 h-4"})}),s.jsx("button",{onClick:se,disabled:xe===X.length-1,className:"p-1.5 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",title:"Next mention",children:s.jsx(Yl,{className:"w-4 h-4"})}),n.is_read===1?s.jsx("button",{onClick:()=>V.mutate(n.id),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg border border-gray-300",children:"Mark as Unread"}):s.jsx("button",{onClick:()=>E.mutate(n.id),className:"px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded-lg border border-blue-300",children:"Mark as Read"}),s.jsxs("button",{onClick:me,className:"px-3 py-1.5 text-sm bg-blue-600 text-white hover:bg-blue-700 rounded-lg flex items-center gap-1",children:[s.jsx(ll,{className:"w-4 h-4"}),"Go to Chat"]})]})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"max-w-3xl",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Message"}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-gray-900 whitespace-pre-wrap text-base leading-relaxed",children:n.message_content?le(n.message_content):"No message content available"}),n.attachment_url&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>{n.context_type==="group_chat"&&e(`/group-chat?channel=${n.context_id}&message=${n.message_id}`)},className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 hover:underline",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:n.attachment_name||"Attachment"}),n.attachment_size&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(n.attachment_size/1024).toFixed(1)," KB)"]})]}),s.jsx("p",{className:"text-xs text-gray-400 mt-1 ml-6",children:"Click to view in Group Chat"})]})]})]})})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Di,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 font-medium",children:"Select a mention to view details"})]})})})]})}function a6(){const e=mt(),t=u.useRef(null),r=u.useRef(null),[n,a]=u.useState(""),[i,l]=u.useState(null),[o,c]=u.useState(null),[d,m]=u.useState(""),[h,p]=u.useState(!1),[j,f]=u.useState(null),[g,y]=u.useState(""),[b,x]=u.useState([]),[v,w]=u.useState(0),[N,_]=u.useState(!1),[F,R]=u.useState(null),{data:J}=he({queryKey:["memos"],queryFn:async()=>(await Qi.getMemos()).data,refetchInterval:1e4}),q=(J==null?void 0:J.memos)||[];u.useEffect(()=>{r.current&&r.current.scrollIntoView({behavior:"smooth",block:"end"})},[q]),u.useEffect(()=>{const P=setTimeout(()=>{r.current&&r.current.scrollIntoView({behavior:"auto",block:"end"})},100);return()=>clearTimeout(P)},[]);const K=Ce({mutationFn:async P=>Qi.createMemo(P),onSuccess:()=>{a(""),l(null),e.invalidateQueries({queryKey:["memos"]})}}),ne=Ce({mutationFn:({memoId:P,content:ae,deleteAttachment:je})=>Qi.editMemo(P,{content:ae,deleteAttachment:je}),onSuccess:()=>{c(null),p(!1),m(""),e.invalidateQueries({queryKey:["memos"]})}}),re=Ce({mutationFn:P=>Qi.deleteMemo(P),onSuccess:()=>{f(null),e.invalidateQueries({queryKey:["memos"]})}}),pe=P=>{if(y(P),!P.trim()||!q.length){x([]),w(0);return}const ae=P.toLowerCase(),je=[];[...q].reverse().forEach(E=>{let V=!1;E.content.toLowerCase().includes(ae)&&(V=!0),E.tags&&E.tags.split(",").map(Q=>Q.trim().toLowerCase()).some(Q=>Q.includes(ae))&&(V=!0),V&&je.push(E.id)}),x(je),w(0),je.length>0&&ke(je[0])},ke=P=>{R(P),setTimeout(()=>{const ae=document.getElementById(`memo-${P}`);ae&&ae.scrollIntoView({behavior:"smooth",block:"center"})},100),setTimeout(()=>{R(null)},5e3)},we=()=>{if(b.length===0)return;const P=(v+1)%b.length;w(P),ke(b[P])},H=()=>{if(b.length===0)return;const P=v===0?b.length-1:v-1;w(P),ke(b[P])},T=P=>{var je;const ae=(je=P.target.files)==null?void 0:je[0];ae&&l(ae)},Y=P=>new Promise((ae,je)=>{const E=new FileReader;E.readAsDataURL(P),E.onload=()=>ae(E.result),E.onerror=V=>je(V)}),G=async()=>{if(!n.trim()&&!i||K.isPending)return;let P=null;i&&(P={data:await Y(i),name:i.name,type:i.type,size:i.size}),K.mutate({content:n.trim()||"(Attachment)",attachment:P})},X=P=>{c(P.id),m(P.content),p(!1)},ie=()=>{!o||!d.trim()||ne.mutate({memoId:o,content:d,deleteAttachment:h})},se=async(P,ae)=>{try{const E=await(await fetch(P)).blob(),V=URL.createObjectURL(E),B=document.createElement("a");B.href=V,B.download=ae,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(V)}catch(je){console.error("Error downloading file:",je)}},xe=P=>P.split(/(@\w+|@\d+|#\d+|TKT-\d+|ticket\s+\d+|\*\d+(?:-\d+)?|TSK-\d+(?:-\d+)?)/gi).map((je,E)=>{if(je.match(/^@\w+$/)&&!je.match(/^@\d+$/))return s.jsx("span",{className:"bg-blue-100 text-blue-700 font-semibold px-1 rounded",children:je},E);const V=je.match(/^@(\d+)$|^#(\d+)$|^TKT-(\d+)$|^ticket\s+(\d+)$/i);if(V){const Q=V[1]||V[2]||V[3]||V[4];return s.jsx(lt,{to:`/tickets?search=TKT-${Q}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",onClick:U=>{U.stopPropagation()},children:je},E)}const B=je.match(/^\*(\d+)(?:-(\d+))?$|^TSK-(\d+)(?:-(\d+))?$/i);if(B){const Q=B[1]||B[3],U=B[2]||B[4],me=U?`TSK-${Q}-${U}`:`TSK-${Q}`;return s.jsx(lt,{to:`/tickets?search=${me}`,target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800 hover:underline font-medium",onClick:ze=>{ze.stopPropagation()},children:je},E)}return je}),$e=P=>P.startsWith("http")?P:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${P}`;return s.jsxs("div",{className:"flex flex-col overflow-hidden bg-gray-50",style:{height:"calc(100vh - 3.5rem)"},children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Cc,{className:"w-6 h-6 text-yellow-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"@Memos"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Personal notes to yourself"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:()=>_(!N),className:`p-2 rounded-lg ${N?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Search memos",children:s.jsx(hi,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-sm text-gray-500",children:[q.length," memo",q.length!==1?"s":""]})]})]}),N&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{type:"text",value:g,onChange:P=>pe(P.target.value),placeholder:"Search memos and tags... (e.g., James Scott, #james-scott)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),b.length>0&&s.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2 bg-white px-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[v+1," / ",b.length]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:H,className:"p-1 hover:bg-gray-100 rounded",title:"Previous result",children:s.jsx(or,{className:"w-4 h-4"})}),s.jsx("button",{onClick:we,className:"p-1 hover:bg-gray-100 rounded",title:"Next result",children:s.jsx(qs,{className:"w-4 h-4"})})]})]})]}),s.jsx("button",{onClick:()=>{_(!1),y(""),x([]),w(0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Close search",children:s.jsx(_t,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[q.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Cc,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500",children:"No @Memos yet. Create your first note below!"})]}):q.map(P=>{var je;const ae=F===P.id;return s.jsx("div",{id:`memo-${P.id}`,className:`bg-white rounded-lg shadow-sm border border-gray-200 p-4 transition-colors duration-500 ${ae?"bg-yellow-100 border-yellow-400":""}`,children:o===P.id?s.jsxs("div",{className:"space-y-3",children:[s.jsx("textarea",{value:d,onChange:E=>m(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3}),P.attachment_url&&!h&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:P.attachment_name}),s.jsx("button",{onClick:()=>p(!0),className:"text-red-600 hover:text-red-700 text-xs",children:"Remove"})]}),h&&s.jsx("div",{className:"text-sm text-red-600",children:"Attachment will be removed when you save"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:ie,disabled:!d.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:"Save"}),s.jsx("button",{onClick:()=>{c(null),p(!1)},className:"px-3 py-1.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm",children:"Cancel"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap break-words",children:xe(P.content)}),P.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Zl(P.tags).map((E,V)=>s.jsxs(lt,{to:`/tags?tag=${encodeURIComponent(E)}`,className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-sm rounded hover:bg-blue-200 transition-colors",children:[s.jsx(Ot,{className:"w-3 h-3"}),E]},V))}),P.attachment_url&&s.jsx("div",{className:"mt-3",children:(je=P.attachment_type)!=null&&je.startsWith("image/")?s.jsxs("div",{className:"relative group inline-block",children:[s.jsx("img",{src:$e(P.attachment_url),alt:P.attachment_name||"Attachment",className:"max-w-md max-h-64 rounded-lg border border-gray-200"}),s.jsx("div",{className:"absolute top-2 right-2 bg-white rounded-full shadow-md p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx("button",{onClick:()=>se($e(P.attachment_url),P.attachment_name||"download"),className:"text-gray-500 hover:text-blue-600",title:"Download image",children:s.jsx(kc,{className:"w-4 h-4"})})})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("a",{href:$e(P.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:P.attachment_name}),P.attachment_size&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(P.attachment_size/1024).toFixed(1)," KB)"]})]}),s.jsx("button",{onClick:()=>se($e(P.attachment_url),P.attachment_name||"download"),className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Download file",children:s.jsx(kc,{className:"w-4 h-4"})})]})})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>X(P),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Edit memo",children:s.jsx(Uh,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>f(P.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete memo",children:s.jsx(gi,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-500",children:[s.jsx("span",{children:new Date(P.created_at).toLocaleString()}),P.edited_at&&s.jsxs("span",{className:"italic",children:["(edited ",new Date(P.edited_at).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),")"]})]})]})},P.id)}),s.jsx("div",{ref:r})]}),s.jsxs("div",{className:"bg-white p-4 flex-shrink-0",children:[i&&s.jsxs("div",{className:"mb-3 flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-2",children:[i.type.startsWith("image/")?s.jsx(Sc,{className:"w-4 h-4 text-gray-600"}):s.jsx(qo,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm text-gray-700",children:i.name}),s.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600 ml-auto",children:s.jsx(_t,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"file",ref:t,onChange:T,className:"hidden"}),s.jsx("button",{onClick:()=>{var P;return(P=t.current)==null?void 0:P.click()},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(St,{className:"w-5 h-5"})}),s.jsx("input",{value:n,onChange:P=>a(P.target.value),onKeyDown:P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),G())},placeholder:"Write a note... Use #keyword to add tags (e.g., #james-scott, #artwork-issue)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"absolute -top-6 left-0 text-xs text-gray-500",children:Mb}),s.jsx("button",{onClick:G,disabled:!n.trim()&&!i||K.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:K.isPending?s.jsxs(s.Fragment,{children:[s.jsx(jb,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ad,{className:"w-4 h-4"}),"Add"]})})]})]}),j&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Memo?"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this memo? This action cannot be undone."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>f(null),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>j&&re.mutate(j),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})})]})}function pg({rating:e,size:t="sm"}){const r={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return s.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(n=>s.jsx("svg",{className:`${r[t]} ${n<=e?"text-yellow-400 fill-yellow-400":"text-gray-300"}`,viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},n))})}function _o({title:e,value:t,subtitle:r,trend:n,icon:a,color:i="indigo"}){const l={indigo:"bg-indigo-50 text-indigo-600",green:"bg-green-50 text-green-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600",blue:"bg-blue-50 text-blue-600"};return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:`p-2 rounded-lg ${l[i]}`,children:a}),n&&s.jsxs("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${n.positive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[n.positive?"":""," ",n.value]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500",children:e}),s.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:t}),r&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:r})]})]})}function i6(){var c,d;const[e,t]=u.useState("7d"),{data:r,isLoading:n}=he({queryKey:["ai-agent-analytics",e],queryFn:async()=>(await Hf.getAIAgentStats(e)).data.data}),{data:a}=he({queryKey:["ai-learning-examples"],queryFn:async()=>(await Hf.getLearningExamples(10)).data.data}),i=(r==null?void 0:r.stats)||{totalDrafts:0,avgQualityScore:0,helpfulRate:0,approvalRate:0,editRate:0,rejectRate:0},l=(r==null?void 0:r.qualityDistribution)||[],o=(r==null?void 0:r.intentPerformance)||[];return n?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(m=>s.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},m))})]})}):s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"AI Agent Analytics"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor AI performance, quality scores, and learning progress"})]}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("select",{value:e,onChange:m=>t(m.target.value),className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[s.jsx("option",{value:"24h",children:"Last 24 hours"}),s.jsx("option",{value:"7d",children:"Last 7 days"}),s.jsx("option",{value:"30d",children:"Last 30 days"}),s.jsx("option",{value:"all",children:"All time"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(_o,{title:"Total AI Drafts",value:i.totalDrafts,subtitle:"Responses generated",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),color:"indigo"}),s.jsx(_o,{title:"Average Quality",value:`${i.avgQualityScore.toFixed(1)}/5`,subtitle:"Staff rating",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),color:"yellow"}),s.jsx(_o,{title:"Helpful Rate",value:`${i.helpfulRate.toFixed(0)}%`,subtitle:"Saved staff time",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),color:"green"}),s.jsx(_o,{title:"Approval Rate",value:`${i.approvalRate.toFixed(0)}%`,subtitle:"Sent without edits",icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"blue"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quality Score Distribution"}),s.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(m=>{const h=l.find(p=>p.score===m)||{count:0,percentage:0};return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-1 w-20",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:m}),s.jsx("svg",{className:"w-4 h-4 text-yellow-400 fill-yellow-400",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})]}),s.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-4 overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${m>=4?"bg-green-500":m===3?"bg-yellow-500":"bg-red-500"}`,style:{width:`${h.percentage}%`}})}),s.jsxs("span",{className:"text-sm text-gray-600 w-16 text-right",children:[h.count," (",h.percentage.toFixed(0),"%)"]})]},m)})})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Response Actions"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Approved (No Edits)"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Sent exactly as AI generated"})]})]}),s.jsxs("span",{className:"text-lg font-semibold text-green-700",children:[i.approvalRate.toFixed(0),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Edited Before Sending"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Modified by staff"})]})]}),s.jsxs("span",{className:"text-lg font-semibold text-yellow-700",children:[i.editRate.toFixed(0),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Rejected"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Staff wrote new response"})]})]}),s.jsxs("span",{className:"text-lg font-semibold text-red-700",children:[i.rejectRate.toFixed(0),"%"]})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm mb-8",children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance by Intent"}),o.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Intent"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Volume"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Quality"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Helpful %"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trend"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map(m=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 capitalize",children:m.intent.replace(/_/g," ")}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.count}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pg,{rating:Math.round(m.avgQuality),size:"sm"}),s.jsx("span",{className:"text-sm text-gray-600",children:m.avgQuality.toFixed(1)})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m.helpfulRate>=80?"bg-green-100 text-green-800":m.helpfulRate>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[m.helpfulRate.toFixed(0),"%"]})}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:m.trend>0?s.jsx("span",{className:"text-green-600",children:" Improving"}):m.trend<0?s.jsx("span",{className:"text-red-600",children:" Declining"}):s.jsx("span",{className:"text-gray-500",children:" Stable"})})]},m.intent))})]})}):s.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No intent data available yet. Start approving AI drafts to see performance by intent."})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Learning Examples"}),s.jsx("p",{className:"text-sm text-gray-500",children:"High-quality responses (4-5 stars) used to improve AI"})]}),s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[((c=a==null?void 0:a.examples)==null?void 0:c.length)||0," examples"]})]}),((d=a==null?void 0:a.examples)==null?void 0:d.length)>0?s.jsx("div",{className:"space-y-4",children:a.examples.slice(0,5).map(m=>{var h;return s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-500 capitalize px-2 py-1 bg-gray-100 rounded",children:((h=m.intent)==null?void 0:h.replace(/_/g," "))||"General"}),s.jsx(pg,{rating:m.quality_score,size:"sm"})]}),s.jsx("span",{className:"text-xs text-gray-500",children:m.created_at?hr(new Date(m.created_at),{addSuffix:!0}):""})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Customer Message"}),s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:m.customer_message})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"AI Response"}),s.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:m.ai_response})]})]})]},m.id)})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No learning examples yet"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Rate AI responses 4-5 stars to add them as learning examples"})]})]})]})}const l6=[1,2,3,4,5,6,0],yg=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function o6(){const e=mt(),[t,r]=u.useState(yg.map((f,g)=>({day_of_week:g,day_name:f,is_open:g>=1&&g<=5,open_time:"09:00",close_time:"17:00"}))),[n,a]=u.useState("Australia/Sydney"),[i,l]=u.useState("idle"),[o,c]=u.useState(""),{data:d,isLoading:m}=he({queryKey:["businessHours"],queryFn:()=>Rr.getBusinessHours().then(f=>f.data.businessHours)}),{data:h}=he({queryKey:["chatSettings"],queryFn:()=>Rr.getSettings().then(f=>f.data.settings)});u.useEffect(()=>{d&&r(d)},[d]),u.useEffect(()=>{h!=null&&h.timezone&&a(h.timezone)},[h]);const p=Ce({mutationFn:async()=>{await Rr.updateBusinessHours(t.map(f=>({day_of_week:f.day_of_week,is_open:f.is_open,open_time:f.is_open?f.open_time:null,close_time:f.is_open?f.close_time:null}))),await Rr.updateSettings({timezone:n})},onSuccess:()=>{e.invalidateQueries({queryKey:["businessHours"]}),e.invalidateQueries({queryKey:["chatSettings"]}),l("success"),setTimeout(()=>l("idle"),3e3)},onError:f=>{l("error"),c(f.message),setTimeout(()=>l("idle"),5e3)}}),j=(f,g,y)=>{r(b=>b.map(x=>x.day_of_week===f?{...x,[g]:y}:x))};return m?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Business Hours"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Set your operating hours for live chat availability"})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),s.jsxs("select",{value:n,onChange:f=>a(f.target.value),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"Australia/Sydney",children:"Australia/Sydney (AEST/AEDT)"}),s.jsx("option",{value:"Australia/Melbourne",children:"Australia/Melbourne"}),s.jsx("option",{value:"Australia/Brisbane",children:"Australia/Brisbane"}),s.jsx("option",{value:"Australia/Perth",children:"Australia/Perth (AWST)"}),s.jsx("option",{value:"Pacific/Auckland",children:"New Zealand (NZST/NZDT)"}),s.jsx("option",{value:"America/New_York",children:"US Eastern (EST/EDT)"}),s.jsx("option",{value:"America/Los_Angeles",children:"US Pacific (PST/PDT)"}),s.jsx("option",{value:"Europe/London",children:"UK (GMT/BST)"})]})]}),s.jsx("div",{className:"space-y-3",children:l6.map(f=>{const g=t.find(y=>y.day_of_week===f)||{day_of_week:f,day_name:yg[f],is_open:!1,open_time:"09:00",close_time:"17:00"};return s.jsxs("div",{className:"flex items-center gap-4 py-3 border-b border-gray-100 last:border-0",children:[s.jsx("div",{className:"w-28",children:s.jsx("span",{className:"font-medium text-gray-900",children:g.day_name})}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer min-w-[80px]",children:[s.jsx("input",{type:"checkbox",checked:g.is_open,onChange:y=>j(g.day_of_week,"is_open",y.target.checked),className:"h-4 w-4 text-indigo-600 rounded border-gray-300"}),s.jsx("span",{className:"text-sm text-gray-600",children:g.is_open?"Open":"Closed"})]}),g.is_open?s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("input",{type:"time",value:g.open_time||"09:00",onChange:y=>j(g.day_of_week,"open_time",y.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm"}),s.jsx("span",{className:"text-gray-500",children:"to"}),s.jsx("input",{type:"time",value:g.close_time||"17:00",onChange:y=>j(g.day_of_week,"close_time",y.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm"})]}):s.jsx("span",{className:"text-sm text-gray-400 italic flex-1",children:"Closed all day"})]},g.day_of_week)})}),s.jsxs("div",{className:"flex gap-2 pt-6 mt-4 border-t border-gray-200",children:[s.jsx("button",{onClick:()=>r(f=>f.map(g=>({...g,is_open:g.day_of_week>=1&&g.day_of_week<=5,open_time:"09:00",close_time:"17:00"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"Mon-Fri 9am-5pm"}),s.jsx("button",{onClick:()=>r(f=>f.map(g=>({...g,is_open:g.day_of_week>=1&&g.day_of_week<=6,open_time:"08:00",close_time:"18:00"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"Mon-Sat 8am-6pm"}),s.jsx("button",{onClick:()=>r(f=>f.map(g=>({...g,is_open:!0,open_time:"00:00",close_time:"23:59"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"24/7"})]}),s.jsxs("div",{className:"flex justify-end pt-6 mt-6 border-t border-gray-200",children:[i==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),i==="error"&&s.jsx("span",{className:"text-red-600 text-sm",children:o||"Failed to save"}),s.jsx("button",{onClick:()=>p.mutate(),disabled:p.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:p.isPending?"Saving...":"Save Business Hours"})]})]})]})}function c6(){const e=mt(),[t,r]=u.useState({is_enabled:!0,primary_color:"#1e40af",secondary_color:"#ffffff",button_text:"Chat with us",welcome_message:"Hi! How can we help you today?",offline_message:"Our team is currently offline. Please leave a message.",show_business_hours:!0,require_email_when_offline:!0}),[n,a]=u.useState("idle"),[i,l]=u.useState(""),{data:o,isLoading:c}=he({queryKey:["chatSettings"],queryFn:()=>Rr.getSettings().then(m=>m.data.settings)});u.useEffect(()=>{o&&r(o)},[o]);const d=Ce({mutationFn:()=>Rr.updateSettings(t),onSuccess:()=>{e.invalidateQueries({queryKey:["chatSettings"]}),a("success"),setTimeout(()=>a("idle"),3e3)},onError:m=>{a("error"),l(m.message),setTimeout(()=>a("idle"),5e3)}});return c?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AI Chat Widget"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure the chat widget appearance and behavior"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Enable Chat Widget"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Show the chat widget on your website"})]}),s.jsx("button",{onClick:()=>r(m=>({...m,is_enabled:!m.is_enabled})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${t.is_enabled?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${t.is_enabled?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:t.primary_color,onChange:m=>r(h=>({...h,primary_color:m.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm",style:{backgroundColor:t.primary_color}})]}),s.jsx("input",{type:"text",value:t.primary_color,onChange:m=>r(h=>({...h,primary_color:m.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:t.secondary_color,onChange:m=>r(h=>({...h,secondary_color:m.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm",style:{backgroundColor:t.secondary_color}})]}),s.jsx("input",{type:"text",value:t.secondary_color,onChange:m=>r(h=>({...h,secondary_color:m.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),s.jsx("input",{type:"text",value:t.button_text,onChange:m=>r(h=>({...h,button_text:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Chat with us"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),s.jsx("textarea",{value:t.welcome_message,onChange:m=>r(h=>({...h,welcome_message:m.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Hi! How can we help you today?"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"First message shown when chat opens"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Offline Message"}),s.jsx("textarea",{value:t.offline_message,onChange:m=>r(h=>({...h,offline_message:m.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Our team is currently offline..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown when no staff are online"})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Business Hours"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Display hours in the widget"})]}),s.jsx("button",{onClick:()=>r(m=>({...m,show_business_hours:!m.show_business_hours})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${t.show_business_hours?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${t.show_business_hours?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Require Email When Offline"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Collect email for follow-up"})]}),s.jsx("button",{onClick:()=>r(m=>({...m,require_email_when_offline:!m.require_email_when_offline})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${t.require_email_when_offline?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${t.require_email_when_offline?"translate-x-5":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:[n==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),n==="error"&&s.jsx("span",{className:"text-red-600 text-sm",children:i||"Failed to save"}),s.jsx("button",{onClick:()=>d.mutate(),disabled:d.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:d.isPending?"Saving...":"Save Settings"})]})]})}),s.jsxs("div",{className:"bg-gray-100 rounded-lg p-6",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Preview"}),s.jsxs("div",{className:"bg-white rounded-lg shadow-inner h-96 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 p-4",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),s.jsx("div",{className:"h-24 bg-gray-100 rounded mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),s.jsx("div",{className:"absolute bottom-4 right-4",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-5 py-3 rounded-full shadow-lg cursor-pointer transform hover:scale-105 transition-transform",style:{backgroundColor:t.primary_color,color:t.secondary_color},children:[s.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx("span",{className:"font-medium",children:t.button_text})]})})]})]})]})]})}const Yd={email:"",first_name:"",last_name:"",role:"agent",job_title:"",phone:"",department:"Customer Service",password:""};function d6(){const e=mt(),{user:t}=ws(),r=(t==null?void 0:t.role)==="admin",[n,a]=u.useState(!1),[i,l]=u.useState(null),[o,c]=u.useState(Yd),[d,m]=u.useState(""),[h,p]=u.useState(null),j=u.useRef(null),[f,g]=u.useState(null),{data:y,isLoading:b}=he({queryKey:["staffUsers"],queryFn:()=>tt.list().then(H=>{const T=H.data.staff;return!r&&(t!=null&&t.id)?T.filter(Y=>Y.id===t.id):T})}),{data:x}=he({queryKey:["tickets","all"],queryFn:()=>Ie.list({limit:1e3}).then(H=>H.data.tickets)}),v=H=>x?x.filter(T=>T.assigned_to===H&&T.status!=="resolved"&&T.status!=="closed").length:0,w=Ce({mutationFn:({staffId:H,status:T})=>tt.updateAvailability(H,T),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]})}}),N=Ce({mutationFn:H=>tt.create({...H,password:H.password||""}),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),ke()},onError:H=>{var T,Y;m(((Y=(T=H.response)==null?void 0:T.data)==null?void 0:Y.error)||"Failed to create staff member")}}),_=Ce({mutationFn:({id:H,data:T})=>tt.update(H,T),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),ke()},onError:H=>{var T,Y;m(((Y=(T=H.response)==null?void 0:T.data)==null?void 0:Y.error)||"Failed to update staff member")}}),F=Ce({mutationFn:({staffId:H,file:T})=>tt.uploadAvatar(H,T),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),e.invalidateQueries({queryKey:["currentStaff"]}),p(null)},onError:H=>{var T,Y;m(((Y=(T=H.response)==null?void 0:T.data)==null?void 0:Y.error)||"Failed to upload photo"),p(null)}}),R=H=>{var T;!r&&H!==(t==null?void 0:t.id)||(g(H),(T=j.current)==null||T.click())},J=H=>{var Y;const T=(Y=H.target.files)==null?void 0:Y[0];if(T&&f){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(T.type)){m("Invalid file type. Please use JPEG, PNG, GIF, or WebP");return}if(T.size>5*1024*1024){m("File too large. Maximum size is 5MB");return}p(f),F.mutate({staffId:f,file:T})}j.current&&(j.current.value=""),g(null)},q={online:{color:"bg-green-500",label:"Available",badgeClass:"bg-green-100 text-green-700 border-green-200"},offline:{color:"bg-gray-400",label:"Offline",badgeClass:"bg-gray-100 text-gray-600 border-gray-200"},away:{color:"bg-amber-500",label:"Away",badgeClass:"bg-amber-100 text-amber-700 border-amber-200"}},K=H=>{if(H.job_title)return H.job_title;switch(H.role){case"admin":return"Administrator";case"manager":return"Customer Service Manager";default:return"Support Agent"}},ne=H=>new Date(H).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}),re=()=>{l(null),c(Yd),m(""),a(!0)},pe=H=>{!r&&H.id!==(t==null?void 0:t.id)||(l(H),c({email:H.email,first_name:H.first_name,last_name:H.last_name,role:H.role,job_title:H.job_title||"",phone:H.phone||"",department:H.department||"Customer Service",password:""}),m(""),a(!0))},ke=()=>{a(!1),l(null),c(Yd),m("")},we=H=>{if(H.preventDefault(),m(""),!o.email||!o.first_name){m("Email and First Name are required");return}if(i){const T={first_name:o.first_name,last_name:o.last_name,job_title:o.job_title,phone:o.phone,department:o.department};r&&(T.role=o.role,T.email=o.email),o.password&&(T.password=o.password),_.mutate({id:i.id,data:T})}else{if(!o.password){m("Password is required for new staff members");return}N.mutate(o)}};return b?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Members"}),s.jsx("p",{className:"text-gray-600 mt-1",children:r?"Manage your support team and their availability":"View and edit your profile"})]}),r&&s.jsxs("button",{onClick:re,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[s.jsx(nd,{className:"w-5 h-5"}),"Add Staff Member"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y==null?void 0:y.map(H=>{const T=H.availability_status||"offline",Y=q[T],G=v(H.id),X=H.id===(t==null?void 0:t.id),ie=r||X;return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"p-5 pb-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative group",children:[H.avatar_url?s.jsx("img",{src:tt.getAvatarUrl(H.avatar_url)||"",alt:`${H.first_name} ${H.last_name}`,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-gray-500",children:s.jsx(Xl,{className:"w-6 h-6"})}),s.jsx("span",{className:`absolute bottom-0 right-0 w-3.5 h-3.5 rounded-full border-2 border-white ${Y.color}`}),(r||X)&&s.jsx("button",{onClick:()=>R(H.id),className:"absolute inset-0 rounded-full bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",title:"Upload photo",children:h===H.id?s.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):s.jsx(e3,{className:"w-5 h-5 text-white"})})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:[X?"You":`${H.first_name}`,H.last_name&&!X&&` ${H.last_name}`]}),s.jsx("p",{className:"text-sm text-gray-500",children:K(H)})]})]}),r||X?s.jsxs("select",{value:T,onChange:se=>w.mutate({staffId:H.id,status:se.target.value}),className:`text-xs font-medium px-3 py-1 rounded-full border cursor-pointer ${Y.badgeClass}`,children:[s.jsx("option",{value:"online",children:"Available"}),s.jsx("option",{value:"away",children:"Away"}),s.jsx("option",{value:"offline",children:"Offline"})]}):s.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full border ${Y.badgeClass}`,children:Y.label})]})}),s.jsxs("div",{className:"px-5 pb-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(tr,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"truncate",children:H.email})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(xa,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{children:H.phone||"Not set"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(xb,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{children:H.department||"Customer Service"})]})]}),s.jsxs("div",{className:"px-5 py-3 bg-gray-50 border-t border-gray-100 flex items-center justify-between text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Active Tickets: "}),s.jsx("span",{className:`font-medium ${G>0?"text-indigo-600":"text-gray-900"}`,children:G})]}),ie?s.jsxs("button",{onClick:()=>pe(H),className:"flex items-center gap-1 text-indigo-600 hover:text-indigo-800 font-medium",children:[s.jsx(Nb,{className:"w-4 h-4"}),"Edit"]}):s.jsxs("div",{className:"text-gray-500",children:["Joined: ",s.jsx("span",{className:"font-medium text-gray-700",children:ne(H.created_at)})]})]})]},H.id)})}),(!y||y.length===0)&&s.jsx("div",{className:"text-center py-12 text-gray-500 bg-white rounded-lg border border-gray-200",children:"No team members found"}),s.jsx("input",{ref:j,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:J,className:"hidden"}),n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i?"Edit Staff Member":"Add Staff Member"}),s.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:we,className:"p-6 space-y-4",children:[d&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:o.first_name,onChange:H=>c(T=>({...T,first_name:H.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),s.jsx("input",{type:"text",value:o.last_name,onChange:H=>c(T=>({...T,last_name:H.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"email",value:o.email,onChange:H=>c(T=>({...T,email:H.target.value})),disabled:!!i&&!r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:text-gray-500",required:!0}),i&&!r&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Contact an admin to change your email"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),s.jsx("input",{type:"tel",value:o.phone,onChange:H=>c(T=>({...T,phone:H.target.value})),placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title"}),s.jsx("input",{type:"text",value:o.job_title,onChange:H=>c(T=>({...T,job_title:H.target.value})),placeholder:"e.g., Senior Support Agent",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),s.jsx("input",{type:"text",value:o.department,onChange:H=>c(T=>({...T,department:H.target.value})),placeholder:"e.g., Customer Service",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),r&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),s.jsxs("select",{value:o.role,onChange:H=>c(T=>({...T,role:H.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[s.jsx("option",{value:"agent",children:"Support Agent"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"admin",children:"Administrator"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i?"New Password":"Password",!i&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"password",value:o.password,onChange:H=>c(T=>({...T,password:H.target.value})),placeholder:i?"Leave blank to keep current password":"Enter password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!i})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:ke,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:N.isPending||_.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:N.isPending||_.isPending?"Saving...":i?"Save Changes":"Add Staff Member"})]})]})]})})]})}function u6(){const{data:e,isLoading:t}=he({queryKey:["staffUsers"],queryFn:()=>tt.list().then(r=>r.data.staff)});return t?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Staff Performance"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Track team productivity and response metrics"})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Performance Analytics Coming Soon"}),s.jsx("p",{className:"text-gray-600 max-w-md mx-auto mb-6",children:"We're building detailed performance metrics including response times, ticket resolution rates, customer satisfaction scores, and more."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto mt-8",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Avg Response Time"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Tickets Resolved"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Satisfaction Score"})]})]}),s.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-8",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-4",children:["Team Members (",(e==null?void 0:e.length)||0,")"]}),s.jsx("div",{className:"flex justify-center gap-2 flex-wrap",children:e==null?void 0:e.map(r=>{var n,a;return s.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 rounded-full px-3 py-1.5",children:[s.jsxs("div",{className:"w-6 h-6 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 text-xs font-medium",children:[(n=r.first_name)==null?void 0:n[0],(a=r.last_name)==null?void 0:a[0]]}),s.jsx("span",{className:"text-sm text-gray-700",children:r.first_name})]},r.id)})})]})]})]})}const Qr={listConversations:async e=>(await O.get(`/api/chat/conversations?tab=${e}`)).data,getConversation:async e=>(await O.get(`/api/chat/conversation/${e}`)).data,takeoverConversation:async e=>(await O.post(`/api/chat/conversation/${e}/takeover`)).data,replyToConversation:async(e,t)=>(await O.post(`/api/chat/conversation/${e}/reply`,{message:t})).data,closeConversation:async(e,t)=>(await O.post(`/api/chat/conversation/${e}/close`,{resolution_type:t})).data,pickupFromQueue:async e=>(await O.post(`/api/chat/conversation/${e}/pickup`)).data,reassignConversation:async(e,t,r)=>(await O.post(`/api/chat/conversation/${e}/reassign`,{assignTo:t,reason:r})).data,getStaffList:async()=>(await O.get("/api/staff")).data},bg=[{key:"ai",label:"AI",icon:s.jsx(Xs,{className:"w-4 h-4"}),description:"Active chats with AI"},{key:"staff",label:"Staff",icon:s.jsx(Xl,{className:"w-4 h-4"}),description:"Escalated to staff"},{key:"queued",label:"Queued",icon:s.jsx(vb,{className:"w-4 h-4"}),description:"Awaiting staff"},{key:"closed",label:"Closed",icon:s.jsx(gb,{className:"w-4 h-4"}),description:"Resolved & inactive"}],Jd=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"";function m6(){var Fe,De,rt,Pt,Ln;const{user:e}=ws(),t=mt(),[r,n]=Hl(),[a,i]=u.useState("ai"),[l,o]=u.useState(null),[c,d]=u.useState(""),[m,h]=u.useState(!1),[p,j]=u.useState(!1),[f,g]=u.useState(""),[y,b]=u.useState(""),[x,v]=u.useState(!1),[w,N]=u.useState(""),[_,F]=u.useState(250),[R,J]=u.useState(null),[q,K]=u.useState(""),[ne,re]=u.useState(null),[pe,ke]=u.useState(!1),[we,H]=u.useState([]),[T,Y]=u.useState(!1),[G,X]=u.useState(!1),[ie,se]=u.useState(!1),[xe,$e]=u.useState("all"),[P,ae]=u.useState(0),[je,E]=u.useState(null),V=u.useRef(null),B=u.useRef(null);u.useEffect(()=>{ae(0)},[l,ie]),u.useEffect(()=>{const M=A=>{(A.ctrlKey||A.metaKey)&&A.key==="y"&&(A.preventDefault(),v(Ae=>!Ae))};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[]),u.useEffect(()=>{const M=r.get("conversation"),A=r.get("ticket");M?(o(M),r.delete("conversation"),n(r,{replace:!0})):A&&(O.get(`/api/chat/conversation/by-ticket/${A}`).then(Ae=>{if(Ae.data.conversation){o(Ae.data.conversation.id);const Re=Ae.data.conversation;Re.status==="closed"||Re.resolution_type?i("closed"):Re.status==="queued"?i("queued"):Re.status==="ai_handling"?i("ai"):Re.status==="assigned"||Re.status==="staff_handling"?i("staff"):i("ai")}}).catch(Ae=>console.error("Failed to find conversation for ticket:",Ae)),r.delete("ticket"),n(r,{replace:!0}))},[r,n]);const{data:Q,isLoading:U}=he({queryKey:["chat-conversations",a],queryFn:()=>Qr.listConversations(a),refetchInterval:5e3}),{data:me}=he({queryKey:["chat-tab-counts"],queryFn:async()=>{const[M,A,Ae,Re]=await Promise.all([O.get("/api/chat/conversations?tab=ai&count_only=true"),O.get("/api/chat/conversations?tab=staff&count_only=true"),O.get("/api/chat/conversations?tab=queued&count_only=true"),O.get("/api/chat/conversations?tab=closed&count_only=true")]);return{ai:M.data.count||0,staff:A.data.count||0,queued:Ae.data.count||0,closed:Re.data.count||0}},refetchInterval:1e4}),{data:ze,isLoading:be}=he({queryKey:["chat-conversation",l],queryFn:()=>Qr.getConversation(l),enabled:!!l,refetchInterval:3e3}),le=(ze==null?void 0:ze.messages)||[],D=ze==null?void 0:ze.conversation,{data:Me,isLoading:Te}=he({queryKey:["shopify-data",D==null?void 0:D.customer_email],queryFn:async()=>D!=null&&D.customer_email?(await O.get(`/api/shopify/ticket-data?email=${encodeURIComponent(D.customer_email)}`)).data:null,enabled:!!(D!=null&&D.customer_email)&&ie}),{data:$,refetch:ee}=he({queryKey:["ticket-notes",D==null?void 0:D.ticket_id],queryFn:async()=>D!=null&&D.ticket_id?(await Ie.get(D.ticket_id)).data:null,enabled:!!(D!=null&&D.ticket_id)}),oe=($==null?void 0:$.notes)||[],_e=Ce({mutationFn:M=>Qr.takeoverConversation(M),onSuccess:()=>{t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-conversation"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]})}}),Ee=Ce({mutationFn:M=>Qr.pickupFromQueue(M),onSuccess:()=>{t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-conversation"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]}),i("staff")}}),We=Ce({mutationFn:({id:M,message:A})=>Qr.replyToConversation(M,A),onSuccess:()=>{d(""),t.invalidateQueries({queryKey:["chat-conversation"]})}}),Je=Ce({mutationFn:({id:M,resolutionType:A})=>Qr.closeConversation(M,A),onSuccess:()=>{o(null),h(!1),t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]})}}),nt=Ce({mutationFn:({id:M,assignTo:A,reason:Ae})=>Qr.reassignConversation(M,A,Ae),onSuccess:()=>{j(!1),g(""),b(""),t.invalidateQueries({queryKey:["chat-conversations"]}),t.invalidateQueries({queryKey:["chat-conversation"]}),t.invalidateQueries({queryKey:["chat-tab-counts"]})}}),{data:kt}=he({queryKey:["staff-list"],queryFn:()=>Qr.getStaffList(),enabled:p||a==="staff"}),Gt=(kt==null?void 0:kt.staff)||[],ss=(Q==null?void 0:Q.conversations)||[];u.useEffect(()=>{!l&&ss.length>0&&!U&&o(ss[0].id)},[ss,l,U]);const Et=ss.filter(M=>xe==="all"||M.assigned_to===xe),rs=()=>{if(!l||Et.length===0)return;const M=Et.findIndex(A=>A.id===l);M>0&&o(Et[M-1].id)},Us=()=>{if(!l||Et.length===0)return;const M=Et.findIndex(A=>A.id===l);M<Et.length-1&&o(Et[M+1].id)},Ns=l?Et.findIndex(M=>M.id===l):-1,br=Ns>0,As=Ns>=0&&Ns<Et.length-1;u.useEffect(()=>{const M=Ae=>{if(!pe)return;const Re=_+(window.innerHeight-Ae.clientY-_),Ge=150,yt=window.innerHeight*.6;Re>=Ge&&Re<=yt&&F(Re)},A=()=>{ke(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return pe&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",M),window.addEventListener("mouseup",A)),()=>{window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",A)}},[pe,_]);const de=M=>new Promise((A,Ae)=>{const Re=new FileReader;Re.readAsDataURL(M),Re.onload=()=>A(Re.result),Re.onerror=Ge=>Ae(Ge)}),vr=async M=>{const A=Array.from(M.target.files||[]);for(const Ae of A)if(Ae.size>10*1024*1024){alert(`File ${Ae.name} is too large. Maximum size is 10MB.`),M.target.value="";return}H(Ae=>[...Ae,...A]),M.target.value=""},ms=M=>{H(A=>A.filter((Ae,Re)=>Re!==M))},Rs=()=>{!l||!c.trim()||(We.mutate({id:l,message:c.trim()}),setTimeout(()=>{var M;(M=B.current)==null||M.scrollIntoView({behavior:"smooth"})},100))},rr=M=>new Date(M).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"}),ks=M=>{if(!M)return null;const A=new Date(M),Re=new Date().getTime()-A.getTime(),Ge=Math.floor(Re/6e4);return Ge<1?"Just now":Ge===1?"1 min":`${Ge} mins`},at=M=>{switch(M){case"urgent":case"critical":return s.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700",children:M});case"high":return s.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-orange-100 text-orange-700",children:"high"});default:return null}},L=M=>{switch(M){case"angry":return s.jsx("span",{className:"text-xs",children:""});case"negative":return s.jsx("span",{className:"text-xs",children:""});case"positive":return s.jsx("span",{className:"text-xs",children:""});default:return null}},ge=M=>{switch(M){case"ai_resolved":return s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-100 text-green-700 flex items-center gap-1",children:[s.jsx(dt,{className:"w-3 h-3"})," AI Resolved"]});case"staff_resolved":return s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 flex items-center gap-1",children:[s.jsx(dt,{className:"w-3 h-3"})," Staff Resolved"]});case"inactive_closed":return s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600 flex items-center gap-1",children:[s.jsx(xr,{className:"w-3 h-3"})," Inactive"]});default:return null}};return s.jsxs("div",{className:"h-[calc(100vh-4rem)] flex",children:[s.jsxs("div",{className:"w-80 border-r border-gray-200 bg-white flex flex-col",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-2",children:[s.jsx(lt,{to:"/tickets",className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",title:"Back to Tickets",children:s.jsx(mi,{className:"w-5 h-5 text-gray-500"})}),s.jsxs("svg",{className:"w-5 h-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),"Live Chats"]}),s.jsx("div",{className:"flex gap-1 mb-2",children:bg.map(M=>s.jsxs("button",{onClick:()=>{i(M.key),o(null)},className:`flex-1 flex flex-col items-center px-2 py-1.5 text-xs rounded-lg transition-colors ${a===M.key?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:M.description,children:[M.icon,s.jsx("span",{className:"mt-0.5",children:M.label}),me&&me[M.key]>0&&s.jsx("span",{className:`mt-0.5 px-1.5 py-0.5 text-xs rounded-full ${a===M.key?"bg-white/20 text-white":"bg-indigo-100 text-indigo-700"}`,children:me[M.key]})]},M.key))}),s.jsxs("select",{value:a==="staff"?xe:"all",onChange:M=>$e(M.target.value),disabled:a!=="staff",className:`w-full h-7 text-xs border rounded-lg px-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a==="staff"?"border-indigo-300 bg-white":"border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[s.jsx("option",{value:"all",children:"All Staff"}),Gt.filter(M=>M.id!=="ai-agent-001").map(M=>s.jsxs("option",{value:M.id,children:[M.first_name," ",M.last_name," (",M.availability_status==="online"?"Online":M.availability_status==="away"?"Away":"Offline",")"]},M.id))]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:U?s.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading..."}):Et.length===0?s.jsxs("div",{className:"p-4 text-center text-gray-500",children:[s.jsxs("div",{className:"text-gray-300 mb-2",children:[a==="ai"&&s.jsx(V4,{className:"w-8 h-8 mx-auto"}),a==="staff"&&s.jsx(Xl,{className:"w-8 h-8 mx-auto"}),a==="queued"&&s.jsx(vb,{className:"w-8 h-8 mx-auto"}),a==="closed"&&s.jsx(gb,{className:"w-8 h-8 mx-auto"})]}),xe!=="all"?"No chats for selected staff member":`No ${(Fe=bg.find(M=>M.key===a))==null?void 0:Fe.label.toLowerCase()} chats`]}):Et.map(M=>s.jsxs("div",{onClick:()=>o(M.id),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${l===M.id?"bg-indigo-50 border-l-4 border-l-indigo-600":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:s.jsx(xn,{className:"w-4 h-4 text-indigo-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm",children:M.customer_name}),s.jsx("p",{className:"text-xs text-gray-500",children:M.customer_email})]})]}),s.jsx("span",{className:"text-xs text-gray-400",children:rr(M.last_message_at)})]}),s.jsx("p",{className:"mt-2 text-sm text-gray-600 truncate",children:M.last_message==="__SHOW_CALLBACK_FORM__"?"CALL BACK REQUEST":M.last_message||"No messages yet"}),s.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[at(M.priority),L(M.sentiment),a==="ai"&&s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-purple-100 text-purple-700 flex items-center gap-1",children:[s.jsx(Xs,{className:"w-3 h-3"})," McCarthy AI"]}),a==="staff"&&M.assigned_staff_first_name&&s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-700",children:[" ",M.assigned_staff_first_name]}),a==="queued"&&s.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 flex items-center gap-1",children:[s.jsx(Tl,{className:"w-3 h-3"})," ",ks(M.queue_entered_at)||"Waiting"]}),a==="closed"&&ge(M.resolution_type),s.jsxs("span",{className:"text-xs text-gray-400",children:[M.message_count," msgs"]})]})]},M.id))})]}),s.jsx("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden",children:l?be?s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Loading conversation..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[(De=D==null?void 0:D.subject)!=null&&De.toLowerCase().includes("callback request")?s.jsx(xa,{className:"w-4 h-4 text-red-600 fill-current"}):s.jsxs("svg",{className:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),D!=null&&D.ticket_number?s.jsx(lt,{to:`/tickets?search=${encodeURIComponent(D.ticket_number)}`,className:"text-base font-semibold text-blue-600 hover:text-blue-800 hover:underline",title:"View in All Tickets",children:D.ticket_number}):s.jsx("h1",{className:"text-base font-semibold text-gray-900",children:"Chat"})]}),s.jsx("button",{className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium ${(D==null?void 0:D.status)==="ai_handling"?"bg-green-100 text-green-800 border-green-200":(D==null?void 0:D.status)==="staff_handling"||(D==null?void 0:D.status)==="assigned"?"bg-blue-100 text-blue-800 border-blue-200":(D==null?void 0:D.status)==="queued"?"bg-green-100 text-green-800 border-green-200":(D==null?void 0:D.status)==="closed"?"bg-gray-100 text-gray-800 border-gray-200":"bg-green-100 text-green-800 border-green-200"}`,children:(D==null?void 0:D.status)==="ai_handling"?"open":(D==null?void 0:D.status)==="staff_handling"||(D==null?void 0:D.status)==="assigned"?"in-progress":(D==null?void 0:D.status)==="queued"?"open":(D==null?void 0:D.status)==="closed"?"resolved":D==null?void 0:D.status}),s.jsx("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-blue-50 text-blue-700 ring-blue-600/20",children:(D==null?void 0:D.priority)||"normal"}),s.jsxs("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-gray-50 text-gray-600 ring-gray-500/20",children:[(D==null?void 0:D.sentiment)==="positive"?"":(D==null?void 0:D.sentiment)==="negative"?"":(D==null?void 0:D.sentiment)==="angry"?"":""," ",(D==null?void 0:D.sentiment)||"neutral"]})]}),s.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(D==null?void 0:D.assigned_to)==="ai-agent-001"?"McCarthy AI":D!=null&&D.assigned_staff_first_name?`${D.assigned_staff_first_name} ${D.assigned_staff_last_name||""}`:"Unassigned"})]}),s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:(D==null?void 0:D.customer_name)||(D==null?void 0:D.customer_email)}),s.jsx("span",{className:"text-xs text-gray-500",children:(D==null?void 0:D.started_at)&&new Date(D.started_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[s.jsx("span",{className:"font-medium",children:"Subject:"})," Live Chat Conversation"]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(D==null?void 0:D.status)==="queued"&&s.jsxs("button",{onClick:()=>Ee.mutate(l),disabled:Ee.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Al,{className:"w-3 h-3"}),s.jsx("span",{children:"Pick Up"})]}),(D==null?void 0:D.status)==="ai_handling"&&(D==null?void 0:D.assigned_to)==="ai-agent-001"&&s.jsxs("button",{onClick:()=>_e.mutate(l),disabled:_e.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Al,{className:"w-3 h-3"}),s.jsx("span",{children:"Take Over"})]}),s.jsxs("button",{onClick:()=>j(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:"Reassign"})]}),(D==null?void 0:D.status)!=="closed"&&s.jsxs("button",{onClick:()=>h(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx(dt,{className:"w-3 h-3"}),s.jsx("span",{children:"Close Chat"})]})]})]})]}),s.jsxs("div",{className:"px-4 py-3 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>Y(!T),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(xn,{className:"w-3 h-3"}),s.jsx("span",{children:"Customer Info"})]}),s.jsxs("button",{onClick:()=>X(!G),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(Tl,{className:"w-3 h-3"}),s.jsx("span",{children:"Order History"})]}),s.jsxs("button",{onClick:()=>se(!ie),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${ie?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[s.jsx(dt,{className:"w-3 h-3"}),s.jsx("span",{children:"Shopify"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:rs,disabled:!br,className:`p-1 border border-gray-200 rounded ${br?"text-gray-400 hover:text-gray-600 hover:bg-gray-50":"text-gray-200 cursor-not-allowed"}`,children:s.jsx(mi,{className:"w-4 h-4"})}),s.jsx("button",{onClick:Us,disabled:!As,className:`p-1 border border-gray-200 rounded ${As?"text-gray-400 hover:text-gray-600 hover:bg-gray-50":"text-gray-200 cursor-not-allowed"}`,children:s.jsx(Yl,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[T&&s.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"}),s.jsx("span",{className:"ml-2 font-medium",children:D==null?void 0:D.customer_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"VIP:"}),s.jsx("span",{className:"ml-2 font-medium text-amber-600",children:"No"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"Email:"}),s.jsx("span",{className:"ml-2 font-medium",children:D==null?void 0:D.customer_email})]})]})]})}),G&&s.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),s.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[le.map(M=>{const A=M.sender_type==="customer",Ae=M.sender_type==="system",Re=M.sender_type==="ai";if(Ae){const Ge=M.content==="__SHOW_CALLBACK_FORM__"?"CALL BACK REQUEST":M.content;return s.jsx("div",{className:"py-3 text-center",children:s.jsx("span",{className:"inline-block px-3 py-1 text-xs text-gray-500 bg-gray-100 rounded-full",children:Ge})},M.id)}return s.jsxs("div",{className:`p-4 rounded-lg ${A?"bg-gray-100":Re?"bg-purple-50":"bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${A?"bg-gray-300":Re?"bg-purple-200":"bg-blue-200"}`,children:A?s.jsx(xn,{className:"w-3 h-3 text-gray-600"}):Re?s.jsx(Xs,{className:"w-3 h-3 text-purple-600"}):s.jsx(xn,{className:"w-3 h-3 text-blue-600"})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:M.sender_name||(A?D==null?void 0:D.customer_name:Re?"McCarthy AI":"Staff")}),s.jsx("span",{className:"text-xs text-gray-400",children:M.created_at&&hr(new Date(M.created_at),{addSuffix:!0})})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:M.content})]},M.id)}),s.jsx("div",{ref:B})]})]}),(a==="staff"||a==="ai"&&(D==null?void 0:D.assigned_to)!=="ai-agent-001")&&(D==null?void 0:D.status)!=="closed"&&s.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-t border-gray-200 p-4",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("textarea",{value:c,onChange:M=>d(M.target.value),onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),Rs())},placeholder:"Type your reply... (Press Enter to send, Shift+Enter for new line)",className:"flex-1 border border-gray-300 rounded-lg px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white",rows:3}),s.jsxs("button",{onClick:Rs,disabled:!c.trim()||We.isPending,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium transition-colors self-end",children:[s.jsx(ad,{className:"w-4 h-4"}),"Send"]})]})}),(D==null?void 0:D.status)==="closed"&&s.jsxs("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:[s.jsx(dt,{className:"w-5 h-5 inline-block mr-2"}),s.jsx("span",{className:"text-sm",children:"This chat has been closed"})]}),s.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[x&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>ke(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>v(!x),children:[s.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),x&&s.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${_}px`},children:[oe&&oe.length>0&&s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:oe.map(M=>{var A;return s.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:M.first_name||"Staff"}),s.jsx("span",{className:"text-xs text-gray-500",children:M.created_at&&typeof M.created_at=="string"?hr(new Date(M.created_at.includes("Z")?M.created_at:M.created_at+"Z"),{addSuffix:!0}):""}),M.edited_at&&s.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),s.jsx("div",{className:"flex items-center gap-2",children:(M.staff_id===(e==null?void 0:e.id)||(e==null?void 0:e.role)==="admin")&&R!==M.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{J(M.id),K(M.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),s.jsx("button",{onClick:()=>re(M.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]})})]}),R===M.id?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:q,onChange:Ae=>K(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:async()=>{var Ae,Re;if(!(!($!=null&&$.ticket)||!q.trim()))try{await Ie.editNote($.ticket.ticket_id,M.id,q),J(null),K(""),t.invalidateQueries({queryKey:["ticket-notes",D==null?void 0:D.ticket_id]})}catch(Ge){console.error("Failed to edit note:",Ge),alert(`Failed to edit note: ${((Re=(Ae=Ge.response)==null?void 0:Ae.data)==null?void 0:Re.error)||Ge.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{J(null),K("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:M.content}),M.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Zl(M.tags).map((Ae,Re)=>s.jsxs(lt,{to:`/tags?search=${encodeURIComponent(Ae)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[s.jsx(Ot,{className:"w-3 h-3 mr-1"}),Ae]},Re))}),M.attachment_url&&s.jsx("div",{className:"mt-2",children:(A=M.attachment_type)!=null&&A.startsWith("image/")?s.jsxs("a",{href:Jd(M.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Jd(M.attachment_url),alt:M.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:M.attachment_name})]}):s.jsxs("a",{href:Jd(M.attachment_url),download:M.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:M.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(M.attachment_size/1024).toFixed(1)," KB)"]})]})})]},M.id)})}),ne&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),s.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[s.jsx("button",{onClick:()=>re(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:async()=>{var M,A;if($!=null&&$.ticket)try{await Ie.deleteNote($.ticket.ticket_id,ne),re(null),t.invalidateQueries({queryKey:["ticket-notes",D==null?void 0:D.ticket_id]})}catch(Ae){console.error("Failed to delete note:",Ae),alert(`Failed to delete note: ${((A=(M=Ae.response)==null?void 0:M.data)==null?void 0:A.error)||Ae.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[we.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:we.map((M,A)=>s.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"max-w-[150px] truncate",children:M.name}),s.jsx("button",{onClick:()=>ms(A),className:"text-red-500 hover:text-red-700",children:s.jsx(_t,{className:"w-3 h-3"})})]},A))}),s.jsx("textarea",{value:w,onChange:M=>N(M.target.value),onKeyDown:async M=>{var A,Ae;if(M.key==="Enter"&&!M.shiftKey){M.preventDefault();const Re=M.currentTarget.value.trim();if(Re&&D){console.log("[DASHBOARD STAFF NOTES] Submitting note:",Re);try{const Ge=await Promise.all(we.map(async yt=>({name:yt.name,content:await de(yt),type:yt.type,size:yt.size})));await Ie.addNote(D.ticket_id,Re,void 0,Ge.length>0?Ge:void 0),N(""),H([]),ee(),console.log("[DASHBOARD STAFF NOTES] Note saved successfully")}catch(Ge){console.error("Failed to add note:",Ge),alert(`Failed to add note: ${((Ae=(A=Ge.response)==null?void 0:A.data)==null?void 0:Ae.error)||Ge.message||"Unknown error"}`)}}}},placeholder:"Add internal notes for other staff members... (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),s.jsx("input",{type:"file",ref:V,onChange:vr,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("button",{onClick:()=>{var M;return(M=V.current)==null?void 0:M.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx("p",{children:"Select a conversation to view"})]})})}),s.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${ie?"w-96":"w-0"}`,children:ie&&D&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600"}),s.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),s.jsx("button",{onClick:()=>se(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(xr,{className:"w-5 h-5"})})]}),Te&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})}),Me&&Me.customer&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Me.customer.firstName," ",Me.customer.lastName]}),s.jsx("p",{className:"text-xs text-gray-500",children:Me.customer.email}),Me.customer.phone&&s.jsx("p",{className:"text-xs text-gray-500",children:Me.customer.phone}),Me.customer.isVIP&&s.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[s.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),s.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((rt=Me.customer.totalSpent)==null?void 0:rt.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),s.jsx("span",{className:"font-semibold text-gray-900",children:Me.customer.ordersCount||0})]}),Me.customer.lastOrderDate&&s.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[s.jsx("span",{className:"text-gray-500",children:"Last Order:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Me.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),Me.orders&&Me.orders.length>0?s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",P+1," OF ",Me.orders.length]}),Me.orders.length>1&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>ae(Math.max(0,P-1)),disabled:P===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>ae(Math.min(Me.orders.length-1,P+1)),disabled:P===Me.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",Me.orders[P].orderNumber]}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${Me.orders[P].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":Me.orders[P].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Me.orders[P].fulfillmentStatus||"Unfulfilled"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",s.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(Pt=Me.orders[P].totalPrice)==null?void 0:Pt.toFixed(2)," ",Me.orders[P].currency]})]})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Created:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Me.orders[P].createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Payment:"}),s.jsx("span",{className:`font-medium ${Me.orders[P].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:Me.orders[P].financialStatus||"Pending"})]})]}),Me.orders[P].lineItems&&Me.orders[P].lineItems.length>0&&s.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),s.jsx("div",{className:"space-y-2",children:Me.orders[P].lineItems.map((M,A)=>{var Ae;return s.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[s.jsxs("button",{onClick:()=>E(je===M.id?null:M.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:M.title}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["x",M.quantity]}),s.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${je===M.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),je===M.id&&s.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Price:"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(Ae=M.price)==null?void 0:Ae.toFixed(2)]})]}),M.sku&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"SKU:"}),s.jsx("span",{className:"text-gray-900 font-mono",children:M.sku})]}),M.variantTitle&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Variant:"}),s.jsx("span",{className:"text-gray-900",children:M.variantTitle})]}),M.customAttributes&&M.customAttributes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),M.customAttributes.map((Re,Ge)=>s.jsxs("div",{className:"flex justify-between py-0.5",children:[s.jsxs("span",{className:"text-gray-500",children:[Re.key.replace("_",""),":"]}),Re.key.includes("Link")||Re.key.includes("link")?s.jsx("a",{href:Re.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:yt=>yt.stopPropagation(),children:"View "}):s.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:Re.value})]},Ge))]})]})]},M.id||A)})})]})]})]}):s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),Me.orders&&((Ln=Me.orders[P])==null?void 0:Ln.trackingNumber)&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),s.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:Me.orders[P].trackingNumber}),Me.orders[P].trackingCompany&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",s.jsx("span",{className:"text-gray-900",children:Me.orders[P].trackingCompany})]})]}),Me.orders[P].trackingUrl&&s.jsx("a",{href:Me.orders[P].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]})]})}),m&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Close Chat"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"How would you like to close this chat?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>Je.mutate({id:l,resolutionType:"resolved"}),disabled:Je.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[s.jsx(dt,{className:"w-6 h-6 text-green-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Mark as Resolved"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer's issue was solved"})]})]}),s.jsxs("button",{onClick:()=>Je.mutate({id:l,resolutionType:"closed"}),disabled:Je.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(xr,{className:"w-6 h-6 text-gray-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Close as Inactive"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer stopped responding"})]})]})]}),s.jsx("button",{onClick:()=>h(!1),className:"w-full mt-4 px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})}),p&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reassign Chat"})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Reassign this chat to another staff member:"}),Gt.filter(M=>M.availability_status==="online").length===1&&s.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${f==="ai-agent-001"?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:"ai-agent-001",checked:f==="ai-agent-001",onChange:M=>g(M.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-purple-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[s.jsx(Xs,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Return to McCarthy AI"})]})]}),Gt.filter(M=>M.id!=="ai-agent-001").map(M=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${f===M.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:M.id,checked:f===M.id,onChange:A=>g(A.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${M.availability_status==="online"?"bg-green-500":M.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[M.first_name," ",M.last_name]}),s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:M.availability_status||"Offline"})]})]},M.id))]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),s.jsx("textarea",{value:y,onChange:M=>b(M.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:()=>{j(!1),g(""),b("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>{f&&l&&nt.mutate({id:l,assignTo:f,reason:y||void 0})},disabled:!f||nt.isPending,className:"flex-1 px-4 py-2 text-sm text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:nt.isPending?"Reassigning...":"Reassign"})]})]})})]})}const h6={"in-progress":"bg-blue-100 text-blue-800 border-blue-200"},vg={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},jg={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},f6={positive:"",neutral:"",negative:"",angry:""},g6={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson","ai-agent-001":"McCarthy AI"},Vr={getConversationByTicket:async e=>(await O.get(`/api/chat/conversation/by-ticket/${e}`)).data,getConversation:async e=>(await O.get(`/api/chat/conversation/${e}`)).data,takeoverConversation:async e=>(await O.post(`/api/chat/conversation/${e}/takeover`)).data,replyToConversation:async(e,t)=>(await O.post(`/api/chat/conversation/${e}/reply`,{message:t})).data,closeConversation:async(e,t)=>(await O.post(`/api/chat/conversation/${e}/close`,{resolution_type:t})).data,pickupFromQueue:async e=>(await O.post(`/api/chat/conversation/${e}/pickup`)).data,reassignConversation:async(e,t,r)=>(await O.post(`/api/chat/conversation/${e}/reassign`,{assignTo:t,reason:r})).data,getStaffList:async()=>(await O.get("/api/staff")).data},Na=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"";function x6(){var Rs,rr,ks,at;const{id:e}=dy(),t=yr(),r=mt(),[n]=Hl(),{user:a}=ws(),[i,l]=u.useState(!1),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,p]=u.useState(0),[j,f]=u.useState(null),[g,y]=u.useState(""),[b,x]=u.useState(!1),[v,w]=u.useState(""),[N,_]=u.useState(250),[F,R]=u.useState(null),[J,q]=u.useState(""),[K,ne]=u.useState(null),[re,pe]=u.useState(!1),[ke,we]=u.useState(!1),[H,T]=u.useState([]),[Y,G]=u.useState(!1),[X,ie]=u.useState(""),[se,xe]=u.useState(""),$e=u.useRef(null),P=u.useRef(null),{data:ae,isLoading:je}=he({queryKey:["ticket",e],queryFn:async()=>(await Ie.get(e)).data,enabled:!!e}),{data:E,isLoading:V}=he({queryKey:["chat-conversation-by-ticket",e],queryFn:async()=>{const L=await Vr.getConversationByTicket(e);return L.conversation?await Vr.getConversation(L.conversation.id):null},enabled:!!e,refetchInterval:3e3}),{data:B}=he({queryKey:["tickets"],queryFn:async()=>(await Ie.list()).data}),{data:Q}=he({queryKey:["staff-list"],queryFn:()=>Vr.getStaffList(),enabled:Y}),U=(Q==null?void 0:Q.staff)||[],{data:me,refetch:ze}=he({queryKey:["ticket-notes",e],queryFn:async()=>(await Ie.get(e)).data,enabled:!!e}),be=ae==null?void 0:ae.ticket,le=E==null?void 0:E.conversation,D=(E==null?void 0:E.messages)||[],Me=(me==null?void 0:me.notes)||[],{data:Te,isLoading:$}=he({queryKey:["shopify-data",be==null?void 0:be.customer_email],queryFn:async()=>be!=null&&be.customer_email?(await O.get(`/api/shopify/ticket-data?email=${encodeURIComponent(be.customer_email)}`)).data:null,enabled:!!(be!=null&&be.customer_email)&&d});let ee=(B==null?void 0:B.tickets)||[];const oe=n.get("filter"),_e=n.get("from");oe==="my"||_e==="my"?ee=ee.filter(L=>L.assigned_to==="00000000-0000-0000-0000-000000000001"):oe==="vip"||_e==="vip"?ee=ee.filter(L=>L.vip===1):_e&&(ee=ee.filter(L=>L.assigned_to===_e));const Ee=ee.findIndex(L=>L.ticket_id===e),We=Ee>0,Je=Ee>=0&&Ee<ee.length-1,nt=()=>{if(We){const L=ee[Ee-1],ge=new URLSearchParams(n);L.channel==="chat"?t(`/chat-ticket/${L.ticket_id}?${ge.toString()}`):t(`/tickets/${L.ticket_id}?${ge.toString()}`)}},kt=()=>{if(Je){const L=ee[Ee+1],ge=new URLSearchParams(n);L.channel==="chat"?t(`/chat-ticket/${L.ticket_id}?${ge.toString()}`):t(`/tickets/${L.ticket_id}?${ge.toString()}`)}},Gt=Ce({mutationFn:()=>Vr.takeoverConversation(le.id),onSuccess:()=>{r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),ss=Ce({mutationFn:()=>Vr.pickupFromQueue(le.id),onSuccess:()=>{r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),Et=Ce({mutationFn:L=>Vr.replyToConversation(le.id,L),onSuccess:()=>{y(""),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),rs=Ce({mutationFn:L=>Vr.closeConversation(le.id,L),onSuccess:()=>{we(!1),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]}),r.invalidateQueries({queryKey:["tickets"]})}}),Us=Ce({mutationFn:({assignTo:L,reason:ge})=>Vr.reassignConversation(le.id,L,ge),onSuccess:()=>{G(!1),ie(""),xe(""),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),Ns=()=>{!g.trim()||!le||(Et.mutate(g.trim()),setTimeout(()=>{var L;(L=P.current)==null||L.scrollIntoView({behavior:"smooth"})},100))};u.useEffect(()=>{p(0)},[e,d]),u.useEffect(()=>{const L=ge=>{(ge.ctrlKey||ge.metaKey)&&ge.key==="y"&&(ge.preventDefault(),x(Fe=>!Fe))};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[]);const br=L=>new Promise((ge,Fe)=>{const De=new FileReader;De.readAsDataURL(L),De.onload=()=>ge(De.result),De.onerror=rt=>Fe(rt)}),As=async L=>{const ge=Array.from(L.target.files||[]);for(const Fe of ge)if(Fe.size>10*1024*1024){alert(`File ${Fe.name} is too large. Maximum size is 10MB.`),L.target.value="";return}T(Fe=>[...Fe,...ge]),L.target.value=""},de=L=>{T(ge=>ge.filter((Fe,De)=>De!==L))};if(u.useEffect(()=>{const L=Fe=>{if(!re)return;const De=N+(window.innerHeight-Fe.clientY-N),rt=150,Pt=window.innerHeight*.6;De>=rt&&De<=Pt&&_(De)},ge=()=>{pe(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return re&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",L),window.addEventListener("mouseup",ge)),()=>{window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",ge)}},[re,N]),je||V)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})});if(!be)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Ticket not found"})});const ms=le&&(le.status==="staff_handling"||le.status==="assigned"||le.status==="ai_handling"&&le.assigned_to!=="ai-agent-001");return s.jsxs("div",{className:"flex h-[calc(100vh-4rem)] bg-gray-50",children:[s.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(lt,{to:"/tickets",className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsxs("div",{className:"flex items-center gap-2",children:[(Rs=be.subject)!=null&&Rs.toLowerCase().includes("callback request")?s.jsx(xa,{className:"w-4 h-4 text-red-600 fill-current"}):s.jsxs("svg",{className:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx(lt,{to:`/tickets?search=${encodeURIComponent(be.ticket_number)}`,className:"text-base font-semibold text-blue-600 hover:text-blue-800 hover:underline",title:"View in All Tickets",children:be.ticket_number})]}),be.vip===1&&s.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 rounded-lg text-xs border border-yellow-200 font-medium",children:" VIP"}),s.jsx("button",{className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium ${h6["in-progress"]}`,children:(le==null?void 0:le.status)==="ai_handling"?"open":(le==null?void 0:le.status)==="staff_handling"||(le==null?void 0:le.status)==="assigned"?"in-progress":(le==null?void 0:le.status)==="queued"?"open":(le==null?void 0:le.status)==="closed"?"resolved":be.status}),s.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${vg[be.priority]||vg.normal}`,children:be.priority}),s.jsxs("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${jg[be.sentiment]||jg.neutral}`,children:[f6[be.sentiment]||""," ",be.sentiment||"neutral"]})]}),s.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(le==null?void 0:le.assigned_to)==="ai-agent-001"?"McCarthy AI":le!=null&&le.assigned_staff_first_name?`${le.assigned_staff_first_name} ${le.assigned_staff_last_name||""}`:be.assigned_to?g6[be.assigned_to]||be.assigned_to:"Unassigned"})]}),s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:be.customer_name||be.customer_email}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(be.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[s.jsx("span",{className:"font-medium",children:"Subject:"})," ",be.subject||"Live Chat Conversation"]}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(le==null?void 0:le.status)==="queued"&&s.jsxs("button",{onClick:()=>ss.mutate(),disabled:ss.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Al,{className:"w-3 h-3"}),s.jsx("span",{children:"Pick Up"})]}),(le==null?void 0:le.status)==="ai_handling"&&(le==null?void 0:le.assigned_to)==="ai-agent-001"&&s.jsxs("button",{onClick:()=>Gt.mutate(),disabled:Gt.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[s.jsx(Al,{className:"w-3 h-3"}),s.jsx("span",{children:"Take Over"})]}),s.jsxs("button",{onClick:()=>G(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{children:"Reassign"})]}),(le==null?void 0:le.status)!=="closed"&&s.jsxs("button",{onClick:()=>we(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[s.jsx(dt,{className:"w-3 h-3"}),s.jsx("span",{children:"Close Chat"})]})]})]})]}),s.jsxs("div",{className:"p-4 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>l(!i),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(xn,{className:"w-3 h-3"}),s.jsx("span",{children:"Customer Info"})]}),s.jsxs("button",{onClick:()=>c(!o),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(wb,{className:"w-3 h-3"}),s.jsx("span",{children:"Order History"})]}),s.jsxs("button",{onClick:()=>m(!d),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${d?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[s.jsx(ol,{className:"w-3 h-3"}),s.jsx("span",{children:"Shopify"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:nt,disabled:!We,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(mi,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:kt,disabled:!Je,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Yl,{className:"w-3.5 h-3.5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[i&&s.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Name:"}),s.jsx("span",{className:"ml-2 font-medium",children:be.customer_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"VIP:"}),s.jsx("span",{className:"ml-2 font-medium text-amber-600",children:be.vip?"Yes":"No"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"Email:"}),s.jsx("span",{className:"ml-2 font-medium",children:be.customer_email})]})]})]})}),o&&s.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:s.jsxs("div",{className:"bg-white rounded-lg p-3",children:[s.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),s.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[D.length===0?s.jsxs("div",{className:"text-center text-gray-500 py-8",children:[s.jsxs("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),s.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),s.jsx("p",{children:"No messages yet"})]}):D.map(L=>{var rt;const ge=L.sender_type==="customer",Fe=L.sender_type==="system",De=L.sender_type==="ai";return Fe?s.jsx("div",{className:"text-center py-2",children:s.jsx("span",{className:"inline-block px-3 py-1 text-xs text-gray-500 bg-gray-100 rounded-full",children:L.content})},L.id):s.jsxs("div",{className:`p-4 rounded-lg ${ge?"bg-gray-100":De?"bg-purple-50":"bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${ge?"bg-gray-300":De?"bg-purple-200":"bg-blue-200"}`,children:ge?s.jsx(xn,{className:"w-3 h-3 text-gray-600"}):De?s.jsx(Xs,{className:"w-3 h-3 text-purple-600"}):s.jsx(xn,{className:"w-3 h-3 text-blue-600"})}),s.jsx("span",{className:"font-medium text-sm text-gray-900",children:ge?L.sender_name||be.customer_name||"Customer":De?"McCarthy AI":L.sender_name?L.sender_name.split(" ")[0]:"Staff"}),s.jsx("span",{className:"text-xs text-gray-400",children:L.created_at&&typeof L.created_at=="string"?hr(new Date(L.created_at.includes("Z")?L.created_at:L.created_at+"Z"),{addSuffix:!0}):""})]}),s.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:L.content}),L.attachment_url&&s.jsx("div",{className:"mt-2 ml-8",children:(rt=L.attachment_type)!=null&&rt.startsWith("image/")?s.jsxs("a",{href:Na(L.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Na(L.attachment_url),alt:L.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:L.attachment_name})]}):s.jsxs("a",{href:Na(L.attachment_url),download:L.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:L.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",((L.attachment_size||0)/1024).toFixed(1)," KB)"]})]})})]},L.id)}),s.jsx("div",{ref:P})]})]}),ms&&s.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-t border-gray-200 p-4",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("textarea",{value:g,onChange:L=>y(L.target.value),onKeyDown:L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),Ns())},placeholder:"Type your reply... (Press Enter to send, Shift+Enter for new line)",className:"flex-1 border border-gray-300 rounded-lg px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white",rows:3}),s.jsxs("button",{onClick:Ns,disabled:!g.trim()||Et.isPending,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium transition-colors self-end",children:[s.jsx(ad,{className:"w-4 h-4"}),"Send"]})]})}),!ms&&(le==null?void 0:le.status)!=="closed"&&s.jsx("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:s.jsx("p",{className:"text-sm",children:(le==null?void 0:le.status)==="ai_handling"?'AI is handling this chat. Click "Take Over" to respond.':(le==null?void 0:le.status)==="queued"?'This chat is in queue. Click "Pick Up" to respond.':"Unable to respond to this chat."})}),(le==null?void 0:le.status)==="closed"&&s.jsxs("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:[s.jsx(dt,{className:"w-5 h-5 inline-block mr-2"}),s.jsx("span",{className:"text-sm",children:"This chat has been closed"})]}),s.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[b&&s.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>pe(!0),children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),s.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>x(!b),children:[s.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),s.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),b&&s.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${N}px`},children:[Me&&Me.length>0&&s.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:Me.map(L=>{var ge;return s.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-800",children:L.first_name||"Staff"}),s.jsx("span",{className:"text-xs text-gray-500",children:L.created_at&&typeof L.created_at=="string"?hr(new Date(L.created_at.includes("Z")?L.created_at:L.created_at+"Z"),{addSuffix:!0}):""}),L.edited_at&&s.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),s.jsx("div",{className:"flex items-center gap-2",children:(L.staff_id===(a==null?void 0:a.id)||(a==null?void 0:a.role)==="admin")&&F!==L.id&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{R(L.id),q(L.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),s.jsx("button",{onClick:()=>ne(L.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]})})]}),F===L.id?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:J,onChange:Fe=>q(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:async()=>{var Fe,De;if(!(!be||!J.trim()))try{await Ie.editNote(be.ticket_id,L.id,J),R(null),q(""),r.invalidateQueries({queryKey:["ticket",e]})}catch(rt){console.error("Failed to edit note:",rt),alert(`Failed to edit note: ${((De=(Fe=rt.response)==null?void 0:Fe.data)==null?void 0:De.error)||rt.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{R(null),q("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:L.content}),L.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Zl(L.tags).map((Fe,De)=>s.jsxs(lt,{to:`/tags?search=${encodeURIComponent(Fe)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[s.jsx(Ot,{className:"w-3 h-3 mr-1"}),Fe]},De))}),L.attachment_url&&s.jsx("div",{className:"mt-2",children:(ge=L.attachment_type)!=null&&ge.startsWith("image/")?s.jsxs("a",{href:Na(L.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[s.jsx("img",{src:Na(L.attachment_url),alt:L.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:L.attachment_name})]}):s.jsxs("a",{href:Na(L.attachment_url),download:L.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[s.jsx(St,{className:"w-4 h-4"}),s.jsx("span",{children:L.attachment_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(L.attachment_size/1024).toFixed(1)," KB)"]})]})})]},L.id)})}),K&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),s.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[s.jsx("button",{onClick:()=>ne(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),s.jsx("button",{onClick:async()=>{var L,ge;if(be)try{await Ie.deleteNote(be.ticket_id,K),ne(null),r.invalidateQueries({queryKey:["ticket",e]})}catch(Fe){console.error("Failed to delete note:",Fe),alert(`Failed to delete note: ${((ge=(L=Fe.response)==null?void 0:L.data)==null?void 0:ge.error)||Fe.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[H.length>0&&s.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:H.map((L,ge)=>s.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{className:"max-w-[150px] truncate",children:L.name}),s.jsx("button",{onClick:()=>de(ge),className:"text-red-500 hover:text-red-700",children:s.jsx(_t,{className:"w-3 h-3"})})]},ge))}),s.jsx("textarea",{"data-test":"chat-staff-notes-textarea",value:v,onChange:L=>{console.log("[CHAT STAFF NOTES] onChange fired:",L.target.value),w(L.target.value)},onKeyDown:async L=>{var ge,Fe;if(console.log("[CHAT STAFF NOTES] onKeyDown fired - key:",L.key),L.key==="Enter"&&!L.shiftKey){L.preventDefault();const De=L.currentTarget.value.trim();if(De&&be){console.log("[CHAT STAFF NOTES] Submitting note:",De);try{const rt=await Promise.all(H.map(async Pt=>({name:Pt.name,content:await br(Pt),type:Pt.type,size:Pt.size})));await Ie.addNote(be.ticket_id,De,void 0,rt.length>0?rt:void 0),w(""),T([]),ze()}catch(rt){console.error("Failed to add note:",rt),alert(`Failed to add note: ${((Fe=(ge=rt.response)==null?void 0:ge.data)==null?void 0:Fe.error)||rt.message||"Unknown error"}`)}}else console.log("[CHAT STAFF NOTES] Cannot submit - noteText:",De,"ticket:",!!be)}},onFocus:()=>console.log("[CHAT STAFF NOTES] onFocus fired"),onBlur:()=>console.log("[CHAT STAFF NOTES] onBlur fired"),placeholder:"Add internal notes... Use @to mention staff, #keyword to add tags (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),s.jsx("input",{type:"file",ref:$e,onChange:As,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),s.jsxs("button",{onClick:()=>{var L;return(L=$e.current)==null?void 0:L.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[s.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]}),s.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${d?"w-96":"w-0"}`,children:d&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ol,{className:"w-5 h-5 text-green-600"}),s.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),s.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),$&&s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})}),Te&&Te.customer&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Te.customer.firstName," ",Te.customer.lastName]}),s.jsx("p",{className:"text-xs text-gray-500",children:Te.customer.email}),Te.customer.phone&&s.jsx("p",{className:"text-xs text-gray-500",children:Te.customer.phone}),Te.customer.isVIP&&s.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[s.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[s.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),s.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((rr=Te.customer.totalSpent)==null?void 0:rr.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),s.jsx("span",{className:"font-semibold text-gray-900",children:Te.customer.ordersCount||0})]}),Te.customer.lastOrderDate&&s.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[s.jsx("span",{className:"text-gray-500",children:"Last Order:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Te.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),Te.orders&&Te.orders.length>0?s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",h+1," OF ",Te.orders.length]}),Te.orders.length>1&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>p(Math.max(0,h-1)),disabled:h===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>p(Math.min(Te.orders.length-1,h+1)),disabled:h===Te.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",Te.orders[h].orderNumber]}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${Te.orders[h].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":Te.orders[h].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Te.orders[h].fulfillmentStatus||"Unfulfilled"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",s.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(ks=Te.orders[h].totalPrice)==null?void 0:ks.toFixed(2)," ",Te.orders[h].currency]})]})]})]}),s.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Created:"}),s.jsx("span",{className:"text-gray-900",children:new Date(Te.orders[h].createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Payment:"}),s.jsx("span",{className:`font-medium ${Te.orders[h].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:Te.orders[h].financialStatus||"Pending"})]})]}),Te.orders[h].lineItems&&Te.orders[h].lineItems.length>0&&s.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),s.jsx("div",{className:"space-y-2",children:Te.orders[h].lineItems.map((L,ge)=>{var Fe;return s.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[s.jsxs("button",{onClick:()=>f(j===L.id?null:L.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:L.title}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["x",L.quantity]}),s.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${j===L.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),j===L.id&&s.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Price:"}),s.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(Fe=L.price)==null?void 0:Fe.toFixed(2)]})]}),L.sku&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"SKU:"}),s.jsx("span",{className:"text-gray-900 font-mono",children:L.sku})]}),L.variantTitle&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Variant:"}),s.jsx("span",{className:"text-gray-900",children:L.variantTitle})]}),L.customAttributes&&L.customAttributes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),L.customAttributes.map((De,rt)=>s.jsxs("div",{className:"flex justify-between py-0.5",children:[s.jsxs("span",{className:"text-gray-500",children:[De.key.replace("_",""),":"]}),De.key.includes("Link")||De.key.includes("link")?s.jsx("a",{href:De.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:Pt=>Pt.stopPropagation(),children:"View "}):s.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:De.value})]},rt))]})]})]},L.id||ge)})})]})]})]}):s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),Te.orders&&((at=Te.orders[h])==null?void 0:at.trackingNumber)&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),s.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:Te.orders[h].trackingNumber}),Te.orders[h].trackingCompany&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",s.jsx("span",{className:"text-gray-900",children:Te.orders[h].trackingCompany})]})]}),Te.orders[h].trackingUrl&&s.jsx("a",{href:Te.orders[h].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]})]})}),ke&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Close Chat"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"How would you like to close this chat?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>rs.mutate("resolved"),disabled:rs.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[s.jsx(dt,{className:"w-6 h-6 text-green-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Mark as Resolved"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer's issue was solved"})]})]}),s.jsxs("button",{onClick:()=>rs.mutate("closed"),disabled:rs.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(xr,{className:"w-6 h-6 text-gray-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Close as Inactive"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Customer stopped responding"})]})]})]}),s.jsx("button",{onClick:()=>we(!1),className:"w-full mt-4 px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})}),Y&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reassign Chat"})}),s.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reassign chat #",be==null?void 0:be.ticket_number," to another staff member:"]}),U.filter(L=>L.availability_status==="online").length===1&&s.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${X==="ai-agent-001"?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:"ai-agent-001",checked:X==="ai-agent-001",onChange:L=>ie(L.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-purple-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[s.jsx(Xs,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Return to McCarthy AI"})]})]}),U.filter(L=>L.id!=="ai-agent-001").map(L=>s.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${X===L.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[s.jsx("input",{type:"radio",name:"staff",value:L.id,checked:X===L.id,onChange:ge=>ie(ge.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),s.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${L.availability_status==="online"?"bg-green-500":L.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[L.first_name," ",L.last_name]}),s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:L.availability_status||"Offline"})]})]},L.id))]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),s.jsx("textarea",{value:se,onChange:L=>xe(L.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),s.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[s.jsx("button",{onClick:()=>{G(!1),ie(""),xe("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>{X&&Us.mutate({assignTo:X,reason:se||void 0})},disabled:!X||Us.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:Us.isPending?"Reassigning...":"Reassign Chat"})]})]})})]})}function p6(){const[e,t]=u.useState(!1),{data:r,isLoading:n,error:a}=he({queryKey:["chat-embed-code"],queryFn:async()=>(await O.get("/api/chat/embed-code")).data}),i=async()=>{r!=null&&r.embedCode&&(await navigator.clipboard.writeText(r.embedCode),t(!0),setTimeout(()=>t(!1),2e3))};return n?s.jsx("div",{className:"p-8",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),s.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):a?s.jsx("div",{className:"p-8",children:s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:"Failed to load embed code. Please try again."})}):s.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(yb,{className:"w-7 h-7 text-indigo-600"}),"Chat Widget Embed Code"]}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Add the McCarthy AI chat widget to your website with a simple code snippet."})]}),s.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-indigo-900 mb-3",children:"Installation Instructions"}),s.jsx("ol",{className:"list-decimal list-inside space-y-2 text-indigo-800",children:r==null?void 0:r.instructions.map((l,o)=>s.jsx("li",{children:l},o))})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Embed Code"}),s.jsx("button",{onClick:i,className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${e?"bg-green-100 text-green-700":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:e?s.jsxs(s.Fragment,{children:[s.jsx(jm,{className:"w-4 h-4"}),"Copied!"]}):s.jsxs(s.Fragment,{children:[s.jsx(bb,{className:"w-4 h-4"}),"Copy Code"]})})]}),s.jsx("div",{className:"p-4 bg-gray-900 overflow-x-auto",children:s.jsx("pre",{className:"text-sm text-gray-100 whitespace-pre-wrap font-mono",children:r==null?void 0:r.embedCode})})]}),s.jsxs("div",{className:"mt-6 bg-white border border-gray-200 rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Widget Settings"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Primary Color"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("div",{className:"w-6 h-6 rounded border border-gray-200",style:{backgroundColor:(r==null?void 0:r.settings.primary_color)||"#4F46E5"}}),s.jsx("span",{className:"font-mono text-sm",children:(r==null?void 0:r.settings.primary_color)||"#4F46E5"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Button Text"}),s.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.button_text)||"Chat with us"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Welcome Message"}),s.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.welcome_message)||"Hi!  I'm McCarthy AI. How can I help you today?"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Offline Message"}),s.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.offline_message)||"We're currently offline. Please leave a message!"})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs("a",{href:"/settings/chat-widget",className:"inline-flex items-center gap-2 text-indigo-600 hover:text-indigo-800 font-medium",children:[s.jsx(ll,{className:"w-4 h-4"}),"Customize Widget Settings"]})})]}),s.jsxs("div",{className:"mt-6 bg-amber-50 border border-amber-200 rounded-lg p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-amber-900 mb-2",children:"Test Your Widget"}),s.jsx("p",{className:"text-amber-800 mb-4",children:"After adding the embed code to your website, test the widget to ensure it's working correctly:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-amber-800",children:[s.jsx("li",{children:"Check that the chat bubble appears in the bottom-right corner"}),s.jsx("li",{children:"Click the bubble to open the chat window"}),s.jsx("li",{children:"Enter your name and email to start a conversation"}),s.jsx("li",{children:"Send a test message and verify you receive an AI response"}),s.jsx("li",{children:"Check the Chat Dashboard to see the conversation appear"})]})]})]})}function y6(){const e=mt(),[t,r]=u.useState("widget"),[n,a]=u.useState(!1),[i,l]=u.useState("idle"),[o,c]=u.useState(""),[d,m]=u.useState({is_enabled:!0,primary_color:"#4F46E5",secondary_color:"#FFFFFF",button_text:"Chat with us",welcome_message:"Hi!  I'm McCarthy AI. How can I help you today?",offline_message:"We're currently offline. Please leave a message and we'll get back to you!",show_business_hours:!0,require_email_when_offline:!0}),{data:h,isLoading:p}=he({queryKey:["chatSettings"],queryFn:()=>Rr.getSettings().then(y=>y.data)}),{data:j}=he({queryKey:["embedCode"],queryFn:()=>Rr.getEmbedCode().then(y=>y.data)});u.useEffect(()=>{h!=null&&h.settings&&m({is_enabled:h.settings.is_enabled??!0,primary_color:h.settings.primary_color||"#4F46E5",secondary_color:h.settings.secondary_color||"#FFFFFF",button_text:h.settings.button_text||"Chat with us",welcome_message:h.settings.welcome_message||"Hi!  I'm McCarthy AI. How can I help you today?",offline_message:h.settings.offline_message||"We're currently offline. Please leave a message!",show_business_hours:h.settings.show_business_hours??!0,require_email_when_offline:h.settings.require_email_when_offline??!0})},[h]);const f=Ce({mutationFn:()=>Rr.updateSettings(d),onSuccess:()=>{l("success"),e.invalidateQueries({queryKey:["chatSettings"]}),e.invalidateQueries({queryKey:["embedCode"]}),setTimeout(()=>l("idle"),3e3)},onError:y=>{l("error"),c(y.message||"Failed to save settings"),setTimeout(()=>l("idle"),5e3)}}),g=()=>{j!=null&&j.embedCode&&(navigator.clipboard.writeText(j.embedCode),a(!0),setTimeout(()=>a(!1),2e3))};return p?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AI Chat Widget"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure and embed the McCarthy AI chat widget on your website"})]}),s.jsx("div",{className:"border-b border-gray-200 mb-6",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsxs("button",{onClick:()=>r("widget"),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${t==="widget"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(fi,{className:"w-4 h-4"}),"Widget Settings"]}),s.jsxs("button",{onClick:()=>r("embed"),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${t==="embed"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(yb,{className:"w-4 h-4"}),"Embed Code"]})]})}),t==="widget"&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Enable Chat Widget"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Show the chat widget on your website"})]}),s.jsx("button",{onClick:()=>m(y=>({...y,is_enabled:!y.is_enabled})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.is_enabled?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.is_enabled?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:d.primary_color,onChange:y=>m(b=>({...b,primary_color:y.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm cursor-pointer",style:{backgroundColor:d.primary_color}})]}),s.jsx("input",{type:"text",value:d.primary_color,onChange:y=>m(b=>({...b,primary_color:y.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[s.jsx("input",{type:"color",value:d.secondary_color,onChange:y=>m(b=>({...b,secondary_color:y.target.value})),className:"sr-only"}),s.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm cursor-pointer",style:{backgroundColor:d.secondary_color}})]}),s.jsx("input",{type:"text",value:d.secondary_color,onChange:y=>m(b=>({...b,secondary_color:y.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),s.jsx("input",{type:"text",value:d.button_text,onChange:y=>m(b=>({...b,button_text:y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Chat with us"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),s.jsx("textarea",{value:d.welcome_message,onChange:y=>m(b=>({...b,welcome_message:y.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Hi! How can we help you today?"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"First message shown when chat opens"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Offline Message"}),s.jsx("textarea",{value:d.offline_message,onChange:y=>m(b=>({...b,offline_message:y.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Our team is currently offline..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown when no staff are online"})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Business Hours"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Display hours in the widget"})]}),s.jsx("button",{onClick:()=>m(y=>({...y,show_business_hours:!y.show_business_hours})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.show_business_hours?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.show_business_hours?"translate-x-5":"translate-x-0"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Require Email When Offline"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Collect email for follow-up"})]}),s.jsx("button",{onClick:()=>m(y=>({...y,require_email_when_offline:!y.require_email_when_offline})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.require_email_when_offline?"bg-indigo-600":"bg-gray-200"}`,children:s.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.require_email_when_offline?"translate-x-5":"translate-x-0"}`})})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[i==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-2 text-sm",children:[s.jsx(jm,{className:"w-4 h-4"})," Saved"]}),i==="error"&&s.jsx("span",{className:"text-red-600 text-sm",children:o||"Failed to save"}),s.jsx("button",{onClick:()=>f.mutate(),disabled:f.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:f.isPending?"Saving...":"Save Settings"})]})]})}),s.jsxs("div",{className:"bg-gray-100 rounded-lg p-6",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Preview"}),s.jsxs("div",{className:"bg-white rounded-lg shadow-inner h-96 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 p-4",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),s.jsx("div",{className:"h-24 bg-gray-100 rounded mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),s.jsx("div",{className:"absolute bottom-4 right-4",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-5 py-3 rounded-full shadow-lg cursor-pointer transform hover:scale-105 transition-transform",style:{backgroundColor:d.primary_color,color:d.secondary_color},children:[s.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M12 3l1.5 4.5L18 9l-4.5 1.5L12 15l-1.5-4.5L6 9l4.5-1.5L12 3z"}),s.jsx("path",{d:"M5 19l1 3 1-3 3-1-3-1-1-3-1 3-3 1 3 1z"})]}),s.jsx("span",{className:"font-medium",children:d.button_text})]})})]})]})]}),t==="embed"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Embed Code"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Copy and paste this code into your website, just before the closing ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"</body>"})," tag."]}),s.jsxs("div",{className:"relative bg-gray-800 rounded-lg p-4 text-sm font-mono text-green-400 overflow-x-auto",children:[s.jsx("pre",{className:"whitespace-pre-wrap",children:(j==null?void 0:j.embedCode)||"Loading..."}),s.jsx("button",{onClick:g,className:"absolute top-2 right-2 p-2 rounded-md bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors",title:"Copy to clipboard",children:n?s.jsx(jm,{className:"w-5 h-5 text-green-400"}):s.jsx(bb,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Widget Settings"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Enabled:"})," ",d.is_enabled?"Yes":"No"]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Button Color:"})," ",s.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:d.primary_color}})," ",d.primary_color]}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Text Color:"})," ",s.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:d.secondary_color}})," ",d.secondary_color]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Button Text:"}),' "',d.button_text,'"']})]}),s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Welcome Message:"}),' "',d.welcome_message,'"']}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Offline Message:"}),' "',d.offline_message,'"']}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Show Business Hours:"})," ",d.show_business_hours?"Yes":"No"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Testing Checklist"}),s.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-700",children:[s.jsx("li",{children:"Ensure the widget appears on your website"}),s.jsx("li",{children:"Test starting a new chat when online"}),s.jsx("li",{children:"Verify custom colors and messages are applied"}),s.jsx("li",{children:"Check responsiveness on mobile devices"}),s.jsx("li",{children:"Test the AI responses"}),s.jsx("li",{children:"Test escalation to human staff"})]})]})]})]})}const b6=[{value:"policies",label:"Policies",description:"Returns, shipping, terms, privacy"},{value:"products",label:"Products",description:"Product information and specs"},{value:"faq",label:"FAQ",description:"Frequently asked questions"},{value:"general",label:"General",description:"Company info, ordering process"},{value:"other",label:"Other",description:"Miscellaneous documents"}];function v6(){const e=mt(),[t,r]=u.useState("general"),[n,a]=u.useState(!1),[i,l]=u.useState("idle"),[o,c]=u.useState(""),{data:d,isLoading:m}=he({queryKey:["rag-documents"],queryFn:()=>jo.listDocuments().then(N=>N.data)}),h=(d==null?void 0:d.documents)||[],p=Ce({mutationFn:({file:N,category:_})=>jo.uploadDocument(N,_).then(F=>F.data),onSuccess:N=>{l("success"),c(N.message||"Document uploaded successfully"),e.invalidateQueries({queryKey:["rag-documents"]}),setTimeout(()=>l("idle"),3e3)},onError:N=>{var _,F;l("error"),c(((F=(_=N.response)==null?void 0:_.data)==null?void 0:F.error)||N.message||"Failed to upload document"),setTimeout(()=>l("idle"),5e3)}}),j=Ce({mutationFn:N=>jo.deleteDocument(N),onSuccess:()=>{e.invalidateQueries({queryKey:["rag-documents"]})}}),f=Ce({mutationFn:()=>jo.reprocessDocuments(),onSuccess:()=>{e.invalidateQueries({queryKey:["rag-documents"]})}}),g=N=>{N.preventDefault(),N.stopPropagation(),N.type==="dragenter"||N.type==="dragover"?a(!0):N.type==="dragleave"&&a(!1)},y=N=>{N.preventDefault(),N.stopPropagation(),a(!1),N.dataTransfer.files&&N.dataTransfer.files[0]&&x(N.dataTransfer.files[0])},b=N=>{N.target.files&&N.target.files[0]&&x(N.target.files[0])},x=N=>{var R;const _=[".md",".txt",".pdf"],F="."+((R=N.name.split(".").pop())==null?void 0:R.toLowerCase());if(!_.includes(F)){l("error"),c("Invalid file type. Please upload .md, .txt, or .pdf files."),setTimeout(()=>l("idle"),5e3);return}if(N.size>5*1024*1024){l("error"),c("File too large. Maximum size is 5MB."),setTimeout(()=>l("idle"),5e3);return}l("uploading"),p.mutate({file:N,category:t})},v=N=>{switch(N){case"active":return s.jsx(dt,{className:"w-4 h-4 text-green-500"});case"processing":return s.jsx(Yi,{className:"w-4 h-4 text-yellow-500 animate-spin"});case"error":return s.jsx(xr,{className:"w-4 h-4 text-red-500"});default:return s.jsx(rd,{className:"w-4 h-4 text-gray-400"})}},w=N=>({policies:"bg-blue-100 text-blue-700",products:"bg-green-100 text-green-700",faq:"bg-purple-100 text-purple-700",general:"bg-gray-100 text-gray-700",other:"bg-yellow-100 text-yellow-700"})[N]||"bg-gray-100 text-gray-700";return s.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(K4,{className:"w-6 h-6 text-indigo-600"}),"RAG Knowledge Base"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Upload documents to enhance the AI Agent's knowledge. The AI will use these documents to provide accurate, context-aware responses."})]}),s.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[s.jsx("h3",{className:"font-semibold text-indigo-900 mb-2",children:"What is RAG?"}),s.jsxs("p",{className:"text-sm text-indigo-800",children:[s.jsx("strong",{children:"RAG (Retrieval-Augmented Generation)"})," allows the AI to search through your uploaded documents and use relevant information when responding to customers. This ensures accurate, up-to-date answers based on your actual policies, products, and procedures - eliminating AI hallucinations."]}),s.jsxs("ul",{className:"mt-2 text-sm text-indigo-700 list-disc list-inside",children:[s.jsx("li",{children:"Upload your policies, FAQs, and product information"}),s.jsx("li",{children:"AI searches documents for relevant context"}),s.jsx("li",{children:"Responses are grounded in your actual content"}),s.jsx("li",{children:"Update documents anytime to keep AI knowledge current"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload Document"}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),s.jsx("select",{value:t,onChange:N=>r(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",children:b6.map(N=>s.jsxs("option",{value:N.value,children:[N.label," - ",N.description]},N.value))})]}),s.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${n?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:y,children:[s.jsx(Cb,{className:"w-10 h-10 mx-auto text-gray-400 mb-3"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drag & drop a file here, or"}),s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("span",{className:"px-4 py-2 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 inline-block",children:"Browse Files"}),s.jsx("input",{type:"file",className:"hidden",accept:".md,.txt,.pdf",onChange:b})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Supported: .md, .txt, .pdf (max 5MB)"})]}),i!=="idle"&&s.jsxs("div",{className:`mt-4 p-3 rounded-lg text-sm ${i==="uploading"?"bg-blue-50 text-blue-700":i==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[i==="uploading"&&s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Yi,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}),i==="success"&&s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(dt,{className:"w-4 h-4"}),o]}),i==="error"&&s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(xr,{className:"w-4 h-4"}),o]})]}),s.jsxs("button",{onClick:()=>f.mutate(),disabled:f.isPending,className:"w-full mt-4 px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2 disabled:opacity-50",children:[s.jsx(Yi,{className:`w-4 h-4 ${f.isPending?"animate-spin":""}`}),"Reprocess All Documents"]})]})}),s.jsx("div",{className:"lg:col-span-2",children:s.jsxs("div",{className:"bg-white rounded-lg shadow",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Uploaded Documents (",h.length,")"]})}),m?s.jsxs("div",{className:"p-8 text-center text-gray-500",children:[s.jsx(Yi,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading documents..."]}):h.length===0?s.jsxs("div",{className:"p-8 text-center text-gray-500",children:[s.jsx(eg,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),s.jsx("p",{children:"No documents uploaded yet"}),s.jsx("p",{className:"text-sm mt-1",children:"Upload your first document to get started"})]}):s.jsx("div",{className:"divide-y divide-gray-200",children:h.map(N=>{var _;return s.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(eg,{className:"w-5 h-5 text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:N.title||N.filename}),v(N.status)]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:N.filename}),s.jsxs("div",{className:"flex items-center gap-3 mt-2 flex-wrap",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${w(N.category)}`,children:N.category}),s.jsxs("span",{className:"text-xs text-gray-400",children:[(_=N.word_count)==null?void 0:_.toLocaleString()," words"]}),s.jsxs("span",{className:"text-xs text-gray-400",children:[" ",new Date(N.uploaded_at).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})," at ",new Date(N.uploaded_at).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"})]})]}),N.content_preview&&s.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:N.content_preview})]})]}),s.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this document?")&&j.mutate(N.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete document",children:s.jsx(gi,{className:"w-4 h-4"})})]})},N.id)})})]})})]})]})}const Gr={role:"You are McCarthy AI, a friendly and professional customer service assistant for Amazing Transfers, an Australian company specializing in DTF (Direct to Film) and UV DTF transfers for custom printing.",personality:`- Warm, helpful, and professional
- Use Australian English (colour, metre, etc.)
- Friendly but not overly casual
- Patient and understanding
- Knowledgeable about DTF printing`,responsibilities:`- Answer questions about products, ordering, and policies
- Help customers with order inquiries
- Provide application instructions for DTF and UV DTF transfers
- Explain shipping, returns, and refund policies
- Assist with artwork requirements and file formats
- Escalate complex issues to human staff when needed`,dos:`- Always be polite and respectful
- Provide accurate information from the knowledge base
- Acknowledge customer frustrations with empathy
- Offer to escalate to human staff when you can't help
- Use the customer's name when known
- Confirm understanding before providing solutions`,donts:`- Never make up information or guess at policies
- Don't provide specific pricing (direct to website)
- Don't promise things you can't guarantee
- Never argue with customers
- Don't share internal business information
- Don't use American spelling (use colour not color)`,tone:"Professional yet friendly. Think of a knowledgeable colleague who genuinely wants to help. Not robotic, but not overly casual either. Match the customer's energy level.",custom_instructions:""};function j6(){const e=mt(),[t,r]=u.useState(Gr),[n,a]=u.useState("idle"),[i,l]=u.useState(""),[o,c]=u.useState(!1),{data:d,isLoading:m}=he({queryKey:["ai-system-message"],queryFn:()=>Od.getConfig().then(f=>f.data)});u.useEffect(()=>{d!=null&&d.config&&r({role:d.config.role||Gr.role,personality:d.config.personality||Gr.personality,responsibilities:d.config.responsibilities||Gr.responsibilities,dos:d.config.dos||Gr.dos,donts:d.config.donts||Gr.donts,tone:d.config.tone||Gr.tone,custom_instructions:d.config.custom_instructions||""})},[d]);const h=Ce({mutationFn:()=>Od.updateConfig(t),onSuccess:()=>{a("success"),e.invalidateQueries({queryKey:["ai-system-message"]}),setTimeout(()=>a("idle"),3e3)},onError:f=>{var g,y;a("error"),l(((y=(g=f.response)==null?void 0:g.data)==null?void 0:y.error)||f.message||"Failed to save"),setTimeout(()=>a("idle"),5e3)}}),p=Ce({mutationFn:()=>Od.resetToDefault(),onSuccess:()=>{r(Gr),e.invalidateQueries({queryKey:["ai-system-message"]})}}),j=()=>`# System Message for McCarthy AI

## Role
${t.role}

## Personality
${t.personality}

## Responsibilities
${t.responsibilities}

## Do's
${t.dos}

## Don'ts
${t.donts}

## Tone
${t.tone}

${t.custom_instructions?`## Custom Instructions
${t.custom_instructions}`:""}
`;return m?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Xs,{className:"w-6 h-6 text-indigo-600"}),"AI System Message"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure the AI Agent's personality, role, and behavior guidelines. This defines how McCarthy AI interacts with customers."})]}),s.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[s.jsxs("h3",{className:"font-semibold text-indigo-900 mb-2 flex items-center gap-2",children:[s.jsx(wm,{className:"w-4 h-4"}),"What is a System Message?"]}),s.jsxs("p",{className:"text-sm text-indigo-800",children:["The ",s.jsx("strong",{children:"System Message"})," (also called a system prompt) defines the AI's identity, personality, and behavioral guidelines. It's the foundation that shapes how the AI responds to customers - its tone, what it can/can't do, and how it handles different situations."]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Role Definition",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Who is the AI?"})]}),s.jsx("textarea",{value:t.role,onChange:f=>r({...t,role:f.target.value}),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"You are McCarthy AI, a customer service assistant..."})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Personality Traits",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"How should the AI behave?"})]}),s.jsx("textarea",{value:t.personality,onChange:f=>r({...t,personality:f.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Friendly and professional
- Patient and understanding...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Responsibilities",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"What should the AI do?"})]}),s.jsx("textarea",{value:t.responsibilities,onChange:f=>r({...t,responsibilities:f.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Answer product questions
- Help with orders...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Do's ",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Best practices to follow"})]}),s.jsx("textarea",{value:t.dos,onChange:f=>r({...t,dos:f.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Always be polite
- Provide accurate information...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Don'ts ",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Things to avoid"})]}),s.jsx("textarea",{value:t.donts,onChange:f=>r({...t,donts:f.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Never make up information
- Don't promise things...`})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Tone of Voice",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"How should responses sound?"})]}),s.jsx("textarea",{value:t.tone,onChange:f=>r({...t,tone:f.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Professional yet friendly..."})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Custom Instructions",s.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Any additional guidelines"})]}),s.jsx("textarea",{value:t.custom_instructions,onChange:f=>r({...t,custom_instructions:f.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Add any specific instructions, business rules, or special handling..."}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use this for business-specific rules, special promotions, or temporary instructions."})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Actions"}),n==="success"&&s.jsxs("span",{className:"text-green-600 flex items-center gap-1 text-sm",children:[s.jsx(dt,{className:"w-4 h-4"})," Saved"]}),n==="error"&&s.jsxs("span",{className:"text-red-600 flex items-center gap-1 text-sm",children:[s.jsx(rd,{className:"w-4 h-4"})," ",i]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>h.mutate(),disabled:h.isPending,className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[s.jsx(Jl,{className:"w-4 h-4"}),h.isPending?"Saving...":"Save Configuration"]}),s.jsx("button",{onClick:()=>c(!o),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2",children:o?"Hide Preview":"Show Full Preview"}),s.jsxs("button",{onClick:()=>{confirm("Reset to default configuration? This will overwrite your current settings.")&&p.mutate()},disabled:p.isPending,className:"w-full px-4 py-2 border border-red-300 rounded-lg text-red-700 hover:bg-red-50 flex items-center justify-center gap-2 disabled:opacity-50",children:[s.jsx(Yi,{className:`w-4 h-4 ${p.isPending?"animate-spin":""}`}),"Reset to Default"]})]})]}),o&&s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Full System Message Preview"}),s.jsx("div",{className:"bg-gray-900 rounded-lg p-4 text-sm font-mono text-green-400 overflow-auto max-h-96",children:s.jsx("pre",{className:"whitespace-pre-wrap",children:j()})})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:" Tips for Better AI Responses"}),s.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[s.jsx("li",{children:" Be specific about what the AI should and shouldn't do"}),s.jsx("li",{children:" Include examples of ideal responses in custom instructions"}),s.jsx("li",{children:" Update regularly based on common customer issues"}),s.jsx("li",{children:" Use bullet points for clarity"}),s.jsx("li",{children:" Test changes with sample conversations"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Configuration Size"}),s.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[j().length.toLocaleString(),s.jsx("span",{className:"text-sm font-normal text-gray-500 ml-2",children:"characters"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: Keep under 4,000 characters for optimal performance"})]})]})]})]})}const w6={tenant_id:"default",business_name:"",business_email:"",business_phone:"",business_address:"",business_website:"",timezone:"Australia/Brisbane",language:"en-AU",measurement_system:"metric",currency:"AUD",currency_symbol:"$",date_format:"DD/MM/YYYY",time_format:"12h"};function N6(){var j,f;const e=mt(),[t,r]=u.useState(w6),[n,a]=u.useState(!1),{data:i,isLoading:l}=he({queryKey:["tenant-settings"],queryFn:async()=>(await O.get("/api/tenant/settings")).data}),{data:o}=he({queryKey:["tenant-settings-options"],queryFn:async()=>(await O.get("/api/tenant/settings/options")).data});u.useEffect(()=>{i&&r(i)},[i]);const c=Ce({mutationFn:async g=>(await O.put("/api/tenant/settings",g)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["tenant-settings"]}),alert("Settings saved successfully!")},onError:g=>{alert(`Failed to save settings: ${g.message}`)}}),d=()=>{c.mutate(t)},m=()=>{a(!0)},h=()=>{r({tenant_id:"default",business_name:"",business_email:"",business_phone:"",business_address:"",business_website:"",timezone:"Australia/Brisbane",language:"en-AU",measurement_system:"metric",currency:"AUD",currency_symbol:"$",date_format:"DD/MM/YYYY",time_format:"12h"}),a(!1)},p=g=>{const y=o==null?void 0:o.currencies.find(b=>b.value===g);r({...t,currency:g,currency_symbol:(y==null?void 0:y.symbol)||"$"})};return l?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading settings..."})}):s.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:s.jsx(fi,{className:"w-6 h-6 text-indigo-600"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dartmouth OS Settings"})]}),s.jsx("p",{className:"text-gray-600",children:"Configure global settings for your Dartmouth OS instance. These settings apply to all agents unless overridden."})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(J4,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Business Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Business Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:t.business_name,onChange:g=>r({...t,business_name:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Amazing Transfers"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Email"}),s.jsx("input",{type:"email",value:t.business_email,onChange:g=>r({...t,business_email:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"support@amazingtransfers.com.au"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Phone"}),s.jsx("input",{type:"tel",value:t.business_phone,onChange:g=>r({...t,business_phone:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"+61 7 1234 5678"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),s.jsx("input",{type:"url",value:t.business_website,onChange:g=>r({...t,business_website:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"https://amazingtransfers.com.au"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Address"}),s.jsx("input",{type:"text",value:t.business_address,onChange:g=>r({...t,business_address:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"123 Transfer Lane, Brisbane QLD 4000"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Dh,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Regional Settings"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(Tl,{className:"w-4 h-4 inline mr-1"}),"Timezone"]}),s.jsx("select",{value:t.timezone,onChange:g=>r({...t,timezone:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.timezones.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx($3,{className:"w-4 h-4 inline mr-1"}),"Language / Spelling"]}),s.jsx("select",{value:t.language,onChange:g=>r({...t,language:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.languages.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(j=o==null?void 0:o.languages.find(g=>g.value===t.language))==null?void 0:j.spelling})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(G3,{className:"w-4 h-4 inline mr-1"}),"Measurement System"]}),s.jsx("select",{value:t.measurement_system,onChange:g=>r({...t,measurement_system:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.measurementSystems.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(x3,{className:"w-4 h-4 inline mr-1"}),"Currency"]}),s.jsx("select",{value:t.currency,onChange:g=>p(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.currencies.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(pb,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Date & Time Formats"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),s.jsx("select",{value:t.date_format,onChange:g=>r({...t,date_format:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.dateFormats.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),s.jsx("select",{value:t.time_format,onChange:g=>r({...t,time_format:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.timeFormats.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]})]})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-xl border border-indigo-200 p-6 mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-indigo-900 mb-3",children:"Preview - How AI Will Format Responses"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Date:"}),s.jsx("p",{className:"text-indigo-900",children:((f=o==null?void 0:o.dateFormats.find(g=>g.value===t.date_format))==null?void 0:f.example)||"31/12/2025"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Time:"}),s.jsx("p",{className:"text-indigo-900",children:t.time_format==="12h"?"2:30 PM":"14:30"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Currency:"}),s.jsxs("p",{className:"text-indigo-900",children:[t.currency_symbol,"99.95 ",t.currency]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-indigo-600 font-medium",children:"Measurement:"}),s.jsx("p",{className:"text-indigo-900",children:t.measurement_system==="metric"?"50 cm, 2.5 kg":"20 in, 5.5 lb"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(kb,{className:"w-4 h-4"}),"Reset to Defaults"]}),s.jsxs("button",{onClick:d,disabled:c.isPending,className:"flex items-center gap-2 px-6 py-2 text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[s.jsx(Jl,{className:"w-4 h-4"}),c.isPending?"Saving...":"Save Settings"]})]}),n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Reset to Factory Defaults?"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This will reset all settings to their factory defaults:"}),s.jsxs("ul",{className:"text-sm text-gray-600 mb-4 list-disc list-inside",children:[s.jsx("li",{children:"Timezone: Australia/Brisbane"}),s.jsx("li",{children:"Language: Australian English"}),s.jsx("li",{children:"Measurement: Metric"}),s.jsx("li",{children:"Currency: AUD ($)"}),s.jsx("li",{children:"Date Format: DD/MM/YYYY"}),s.jsx("li",{children:"Time Format: 12-hour"}),s.jsx("li",{children:"Business information will be cleared"})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:h,className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Reset Settings"})]})]})})]})}function k6(){var p,j;const e=mt(),[t,r]=u.useState({agent_id:"customer-service-agent",timezone:null,language:null,measurement_system:null,currency:null,currency_symbol:null,date_format:null,time_format:null}),{data:n}=he({queryKey:["tenant-settings"],queryFn:async()=>(await O.get("/api/tenant/settings")).data}),{data:a,isLoading:i}=he({queryKey:["agent-overrides"],queryFn:async()=>(await O.get("/api/ai-agent/regional-overrides")).data}),{data:l}=he({queryKey:["tenant-settings-options"],queryFn:async()=>(await O.get("/api/tenant/settings/options")).data});u.useEffect(()=>{a&&r(a)},[a]);const o=Ce({mutationFn:async f=>(await O.put("/api/ai-agent/regional-overrides",f)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["agent-overrides"]}),alert("Overrides saved successfully!")},onError:f=>{alert(`Failed to save overrides: ${f.message}`)}}),c=()=>{o.mutate(t)},d=()=>{r({agent_id:"customer-service-agent",timezone:null,language:null,measurement_system:null,currency:null,currency_symbol:null,date_format:null,time_format:null})},m=f=>{const g=t[f];return g!==null&&g!==""?g:(n==null?void 0:n[f])||""},h=f=>t[f]!==null&&t[f]!=="";return i?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-500",children:"Loading overrides..."})}):s.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs(lt,{to:"/ai-agent/system-message",className:"text-sm text-indigo-600 hover:text-indigo-800 flex items-center gap-1 mb-4",children:[s.jsx(B4,{className:"w-4 h-4"}),"Back to AI Agent Settings"]}),s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(Dh,{className:"w-6 h-6 text-purple-600"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agent Regional Overrides"})]}),s.jsx("p",{className:"text-gray-600",children:"Override tenant-level regional settings for this specific agent. Leave fields empty to inherit from Dartmouth OS Settings."})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"How it works:"}),' Settings left as "Inherit from tenant" will use the values from',s.jsx(lt,{to:"/settings/dartmouth-os",className:"text-blue-600 hover:underline mx-1",children:"Dartmouth OS Settings"}),". Only set overrides if this agent needs different regional settings (e.g., for a US market)."]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(fi,{className:"w-5 h-5 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Regional Overrides"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Timezone",h("timezone")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.timezone||"",onChange:f=>r({...t,timezone:f.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.timezone,")"]}),l==null?void 0:l.timezones.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Language / Spelling",h("language")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.language||"",onChange:f=>r({...t,language:f.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",(p=l==null?void 0:l.languages.find(f=>f.value===(n==null?void 0:n.language)))==null?void 0:p.label,")"]}),l==null?void 0:l.languages.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Measurement System",h("measurement_system")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.measurement_system||"",onChange:f=>r({...t,measurement_system:f.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.measurement_system,")"]}),l==null?void 0:l.measurementSystems.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Currency",h("currency")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.currency||"",onChange:f=>{const g=l==null?void 0:l.currencies.find(y=>y.value===f.target.value);r({...t,currency:f.target.value||null,currency_symbol:(g==null?void 0:g.symbol)||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.currency,")"]}),l==null?void 0:l.currencies.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date Format",h("date_format")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.date_format||"",onChange:f=>r({...t,date_format:f.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.date_format,")"]}),l==null?void 0:l.dateFormats.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Time Format",h("time_format")&&s.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),s.jsxs("select",{value:t.time_format||"",onChange:f=>r({...t,time_format:f.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsxs("option",{value:"",children:["Inherit from tenant (",(n==null?void 0:n.time_format)==="12h"?"12-hour":"24-hour",")"]}),l==null?void 0:l.timeFormats.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))]})]})]})]}),s.jsxs("div",{className:"bg-purple-50 rounded-xl border border-purple-200 p-6 mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-purple-900 mb-3",children:"Effective Settings for This Agent"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Timezone:"}),s.jsx("p",{className:"text-purple-900",children:m("timezone")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Language:"}),s.jsx("p",{className:"text-purple-900",children:((j=l==null?void 0:l.languages.find(f=>f.value===m("language")))==null?void 0:j.label)||m("language")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Measurement:"}),s.jsx("p",{className:"text-purple-900",children:m("measurement_system")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Currency:"}),s.jsx("p",{className:"text-purple-900",children:m("currency")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Date Format:"}),s.jsx("p",{className:"text-purple-900",children:m("date_format")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-purple-600 font-medium",children:"Time Format:"}),s.jsx("p",{className:"text-purple-900",children:m("time_format")==="12h"?"12-hour":"24-hour"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(kb,{className:"w-4 h-4"}),"Clear All Overrides"]}),s.jsxs("button",{onClick:c,disabled:o.isPending,className:"flex items-center gap-2 px-6 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[s.jsx(Jl,{className:"w-4 h-4"}),o.isPending?"Saving...":"Save Overrides"]})]})]})}function S6(){var p,j;const e=mt(),[t,r]=u.useState({enabled:!1,maxAssignedTickets:8,refillThreshold:3,priorityOrder:"priority_first",channels:["email","chat"],businessHoursOnly:!0}),{data:n,isLoading:a}=he({queryKey:["autoAssignmentConfig"],queryFn:async()=>(await wo.getConfig()).data}),{data:i,isLoading:l}=he({queryKey:["autoAssignmentHistory"],queryFn:async()=>(await wo.getHistory(50)).data});u.useEffect(()=>{n!=null&&n.config&&r(n.config)},[n]);const o=Ce({mutationFn:f=>wo.updateConfig(f),onSuccess:()=>{e.invalidateQueries({queryKey:["autoAssignmentConfig"]})}}),c=Ce({mutationFn:()=>wo.runNow(),onSuccess:()=>{e.invalidateQueries({queryKey:["autoAssignmentHistory"]})}}),d=()=>{o.mutate(t)},m=()=>{c.mutate()},h=f=>{const g=t.channels.includes(f)?t.channels.filter(y=>y!==f):[...t.channels,f];r({...t,channels:g})};return a?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):s.jsxs("div",{className:"max-w-4xl mx-auto py-6 px-4",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Auto-Assignment Settings"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Configure automatic ticket assignment to online staff members"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6 pb-6 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Auto-Assignment"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatically assign unassigned tickets to online staff"})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:t.enabled,onChange:f=>r({...t,enabled:f.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max Tickets per Staff"}),s.jsx("input",{type:"number",min:"1",max:"50",value:t.maxAssignedTickets,onChange:f=>r({...t,maxAssignedTickets:parseInt(f.target.value)||8}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Maximum tickets auto-assigned per staff member"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Refill Threshold"}),s.jsx("input",{type:"number",min:"0",max:"20",value:t.refillThreshold,onChange:f=>r({...t,refillThreshold:parseInt(f.target.value)||3}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Auto-assign more when staff drops below this count"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Assignment Priority"}),s.jsxs("select",{value:t.priorityOrder,onChange:f=>r({...t,priorityOrder:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[s.jsx("option",{value:"priority_first",children:"High Priority First"}),s.jsx("option",{value:"oldest_first",children:"Oldest First (FIFO)"}),s.jsx("option",{value:"newest_first",children:"Newest First"})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Order in which unassigned tickets are assigned"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Business Hours Only"}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer mt-2",children:[s.jsx("input",{type:"checkbox",checked:t.businessHoursOnly,onChange:f=>r({...t,businessHoursOnly:f.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),s.jsx("span",{className:"ml-3 text-sm text-gray-600 dark:text-gray-400",children:"Only assign during business hours"})]})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Channels to Auto-Assign"}),s.jsx("div",{className:"flex gap-4",children:["email","chat","phone"].map(f=>s.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:t.channels.includes(f),onChange:()=>h(f),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300 capitalize",children:f})]},f))})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[s.jsxs("button",{onClick:d,disabled:o.isPending,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[o.isPending?s.jsx(rg,{className:"h-4 w-4 mr-2 animate-spin"}):s.jsx(RS,{className:"h-4 w-4 mr-2"}),"Save Settings"]}),s.jsxs("button",{onClick:m,disabled:c.isPending||!t.enabled,className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[c.isPending?s.jsx(rg,{className:"h-4 w-4 mr-2 animate-spin"}):s.jsx(DS,{className:"h-4 w-4 mr-2"}),"Run Now"]})]}),c.isSuccess&&c.data&&s.jsxs("div",{className:"mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:[s.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200",children:[" ",c.data.data.message]}),((p=c.data.data.results)==null?void 0:p.length)>0&&s.jsx("ul",{className:"mt-2 text-sm text-green-700 dark:text-green-300",children:c.data.data.results.map((f,g)=>s.jsxs("li",{children:[" ",f.ticketNumber,"  ",f.staffName]},g))})]}),o.isSuccess&&s.jsx("div",{className:"mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:s.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:" Settings saved successfully"})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(ng,{className:"h-5 w-5"}),"Assignment History"]}),s.jsx("button",{onClick:()=>e.invalidateQueries({queryKey:["autoAssignmentHistory"]}),className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Refresh"})]}),l?s.jsx("div",{className:"flex items-center justify-center h-32",children:s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):((j=i==null?void 0:i.history)==null?void 0:j.length)>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Ticket"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Assigned To"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reason"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Staff Queue"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Time"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:i.history.map(f=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:f.ticket_number}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:[f.staff_first_name," ",f.staff_last_name||""]}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${f.reason==="auto_refill"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"}`,children:f.reason==="auto_refill"?"Refill":"Initial"})}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:[f.staff_ticket_count," tickets"]}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(f.assigned_at).toLocaleString()})]},f.id))})]})}):s.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[s.jsx(ng,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),s.jsx("p",{children:"No auto-assignments yet"}),s.jsx("p",{className:"text-sm mt-1",children:"Enable auto-assignment and assignments will appear here"})]})]})]})}const C6=[{title:"Dartmouth OS",description:"Global system settings including timezone, language, currency, and regional preferences",path:"/settings/dartmouth-os",category:"System"},{title:"Operational Hours",description:"Set your business operating hours for live chat availability",path:"/settings/business-hours",category:"Business"},{title:"Auto-Assignment",description:"Configure automatic ticket assignment to online staff members",path:"/settings/auto-assignment",category:"Business"},{title:"Group Chat",description:"Configure Group Chat channels, permissions, and edit/delete timeframes",path:"/settings/group-chat",category:"Business"},{title:"Widget & Embed",description:"Configure the chat widget appearance and get embed code for your website",path:"/ai-agent/widget",category:"AI Agent"},{title:"RAG Knowledge",description:"Upload and manage documents for AI to reference when answering questions",path:"/ai-agent/knowledge",category:"AI Agent"},{title:"System Message",description:"Define AI agent personality, role, responsibilities, and guidelines",path:"/ai-agent/system-message",category:"AI Agent"},{title:"Regional Overrides",description:"Override regional settings for specific AI agents",path:"/ai-agent/regional-overrides",category:"AI Agent"},{title:"Print ERP",description:"Connect and configure your Print ERP system integration",path:"/settings/integrations/perp",category:"Integrations"},{title:"Shopify",description:"Connect and configure your Shopify store integration",path:"/settings/integrations/shopify",category:"Integrations"},{title:"Facebook",description:"Connect your Facebook page for customer support",path:"/settings/meta/facebook",category:"Meta"},{title:"Instagram",description:"Connect your Instagram business account for DMs",path:"/settings/meta/instagram",category:"Meta"},{title:"Messenger",description:"Configure Facebook Messenger integration",path:"/settings/meta/messenger",category:"Meta"},{title:"WhatsApp",description:"Connect WhatsApp Business for customer messaging",path:"/settings/meta/whatsapp",category:"Meta"},{title:"Auth & Security",description:"Authentication settings, password policies, and security options",path:"/settings/general/auth",category:"General"},{title:"Templates",description:"Manage email templates and canned responses",path:"/settings/general/templates",category:"General"},{title:"Tags",description:"Configure AI auto-tagging, tag suggestions, and display preferences",path:"/settings/tags",category:"General"},{title:"Subscription",description:"Manage your subscription plan and billing details",path:"/settings/billing/subscription",category:"Billing"},{title:"Transactions",description:"View billing history and transaction records",path:"/settings/billing/transactions",category:"Billing"}];function _6(){const e=yr(),t=C6.reduce((a,i)=>(a[i.category]||(a[i.category]=[]),a[i.category].push(i),a),{}),r=["System","Business","AI Agent","Integrations","Meta","General","Billing"],n=a=>{switch(a){case"System":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})});case"Business":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"AI Agent":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})});case"Integrations":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"})});case"Meta":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})});case"General":return s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});case"Billing":return s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})});default:return s.jsx(Wo,{className:"w-5 h-5"})}};return s.jsxs("div",{className:"max-w-5xl mx-auto py-8 px-4",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[s.jsx(Wo,{className:"h-8 w-8 text-indigo-600"}),"Settings"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Configure your system settings and integrations"})]}),r.map(a=>t[a]&&s.jsxs("div",{className:"mb-8",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 border-b border-gray-200 dark:border-gray-700 pb-2 flex items-center gap-2",children:[n(a),a]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t[a].map(i=>s.jsxs("button",{onClick:()=>e(i.path),className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-md transition-all text-left group",children:[s.jsx("div",{className:"flex-shrink-0 p-2 bg-gray-100 dark:bg-gray-700 rounded-lg group-hover:bg-indigo-100 dark:group-hover:bg-indigo-900/30 transition-colors",children:s.jsx(Wo,{className:"h-6 w-6 text-gray-500 dark:text-gray-400 group-hover:text-indigo-600 dark:group-hover:text-indigo-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400",children:i.title}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:i.description})]}),s.jsx("div",{className:"flex-shrink-0 self-center",children:s.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},i.path))})]},a))]})}const Xd={online:{color:"bg-green-500",label:"Online",description:"Available for chats and tickets"},away:{color:"bg-yellow-500",label:"Away",description:"Temporarily unavailable"},offline:{color:"bg-gray-400",label:"Offline",description:"Not available for new assignments"}};function E6(){var v,w,N;const{user:e}=ws(),t=mt(),[r,n]=u.useState(""),[a,i]=u.useState(""),l=u.useRef(null),[o,c]=u.useState({first_name:"",last_name:"",email:"",job_title:"",phone:"",department:""}),{data:d,isLoading:m}=he({queryKey:["currentStaff"],queryFn:()=>tt.me().then(_=>_.data.staff),enabled:!!e});u.useEffect(()=>{d&&c({first_name:d.first_name||"",last_name:d.last_name||"",email:d.email||"",job_title:d.job_title||"",phone:d.phone||"",department:d.department||""})},[d]);const h=Ce({mutationFn:_=>tt.update((e==null?void 0:e.id)||"",_),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),n("Profile updated successfully!"),i(""),setTimeout(()=>n(""),3e3)},onError:_=>{var F,R;i(((R=(F=_.response)==null?void 0:F.data)==null?void 0:R.error)||"Failed to update profile"),n("")}}),p=Ce({mutationFn:_=>tt.updateAvailability((e==null?void 0:e.id)||"",_),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),n("Status updated!"),setTimeout(()=>n(""),2e3)}}),j=Ce({mutationFn:_=>tt.uploadAvatar((e==null?void 0:e.id)||"",_),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),t.invalidateQueries({queryKey:["staffUsers"]}),n("Photo uploaded successfully!"),setTimeout(()=>n(""),3e3)},onError:_=>{var F,R;i(((R=(F=_.response)==null?void 0:F.data)==null?void 0:R.error)||"Failed to upload photo")}}),f=Ce({mutationFn:()=>tt.deleteAvatar((e==null?void 0:e.id)||""),onSuccess:()=>{t.invalidateQueries({queryKey:["currentStaff"]}),t.invalidateQueries({queryKey:["staffUsers"]}),n("Photo removed"),setTimeout(()=>n(""),2e3)},onError:_=>{var F,R;i(((R=(F=_.response)==null?void 0:F.data)==null?void 0:R.error)||"Failed to remove photo")}}),g=_=>{var R;const F=(R=_.target.files)==null?void 0:R[0];if(F){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(F.type)){i("Invalid file type. Please use JPEG, PNG, GIF, or WebP");return}if(F.size>5*1024*1024){i("File too large. Maximum size is 5MB");return}j.mutate(F)}l.current&&(l.current.value="")},y=_=>{_.preventDefault(),h.mutate(o)},b=_=>{c(F=>({...F,[_.target.name]:_.target.value}))},x=(d==null?void 0:d.availability_status)||"offline";return m?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):s.jsxs("div",{className:"py-6 px-4 sm:px-6 lg:px-8 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Account"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your profile information and availability status"})]}),r&&s.jsx("div",{className:"mb-6 rounded-md bg-green-50 p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx(Nm,{className:"h-5 w-5 text-green-400"}),s.jsx("p",{className:"ml-3 text-sm font-medium text-green-800",children:r})]})}),a&&s.jsx("div",{className:"mb-6 rounded-md bg-red-50 p-4",children:s.jsxs("div",{className:"flex",children:[s.jsx(IS,{className:"h-5 w-5 text-red-400"}),s.jsx("p",{className:"ml-3 text-sm font-medium text-red-800",children:a})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsxs("div",{className:"relative group",children:[d!=null&&d.avatar_url?s.jsx("img",{src:tt.getAvatarUrl(d.avatar_url)||"",alt:`${d.first_name} ${d.last_name}`,className:"w-24 h-24 rounded-full object-cover"}):s.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-3xl font-bold",children:[(v=d==null?void 0:d.first_name)==null?void 0:v[0],(w=d==null?void 0:d.last_name)==null?void 0:w[0]]}),s.jsx("div",{className:`absolute bottom-1 right-1 w-5 h-5 rounded-full border-2 border-white ${Xd[x].color}`}),s.jsxs("div",{className:"absolute inset-0 rounded-full bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:[s.jsx("button",{onClick:()=>{var _;return(_=l.current)==null?void 0:_.click()},className:"p-2 text-white hover:text-indigo-200 transition-colors",title:"Upload photo",children:s.jsx(TS,{className:"w-6 h-6"})}),(d==null?void 0:d.avatar_url)&&s.jsx("button",{onClick:()=>f.mutate(),className:"p-2 text-white hover:text-red-300 transition-colors",title:"Remove photo",children:s.jsx(BS,{className:"w-6 h-6"})})]}),s.jsx("input",{ref:l,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:g,className:"hidden"})]}),j.isPending&&s.jsxs("div",{className:"mt-2 text-sm text-indigo-600 flex items-center gap-1",children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}),s.jsxs("h2",{className:"mt-4 text-lg font-semibold text-gray-900",children:[d==null?void 0:d.first_name," ",d==null?void 0:d.last_name]}),s.jsx("p",{className:"text-sm text-gray-500",children:(d==null?void 0:d.job_title)||"Team Member"}),s.jsx("span",{className:`mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(d==null?void 0:d.role)==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:(d==null?void 0:d.role)==="admin"?"Administrator":"Staff"})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Your Status"}),s.jsx("div",{className:"space-y-2",children:Object.keys(Xd).map(_=>{const F=Xd[_],R=_===x;return s.jsxs("button",{onClick:()=>p.mutate(_),disabled:p.isPending,className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-all ${R?"bg-indigo-50 ring-2 ring-indigo-500":"hover:bg-gray-50 border border-gray-200"}`,children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${F.color}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:`text-sm font-medium ${R?"text-indigo-700":"text-gray-700"}`,children:F.label}),s.jsx("p",{className:"text-xs text-gray-500",children:F.description})]}),R&&s.jsx(Nm,{className:"w-5 h-5 text-indigo-600"})]},_)})})]})]})}),s.jsxs("div",{className:"lg:col-span-2",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Profile Information"}),s.jsxs("form",{onSubmit:y,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700",children:"First Name"}),s.jsx("input",{type:"text",id:"first_name",name:"first_name",value:o.first_name,onChange:b,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),s.jsx("input",{type:"text",id:"last_name",name:"last_name",value:o.last_name,onChange:b,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),s.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:b,disabled:!0,className:"mt-1 block w-full rounded-lg border-gray-300 bg-gray-50 shadow-sm sm:text-sm cursor-not-allowed"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Email cannot be changed"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"job_title",className:"block text-sm font-medium text-gray-700",children:"Job Title"}),s.jsx("input",{type:"text",id:"job_title",name:"job_title",value:o.job_title,onChange:b,placeholder:"e.g. Customer Support Specialist",className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),s.jsx("input",{type:"tel",id:"phone",name:"phone",value:o.phone,onChange:b,placeholder:"e.g. 0412 345 678",className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700",children:"Department"}),s.jsxs("select",{id:"department",name:"department",value:o.department,onChange:b,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[s.jsx("option",{value:"",children:"Select a department"}),s.jsx("option",{value:"Customer Support",children:"Customer Support"}),s.jsx("option",{value:"Sales",children:"Sales"}),s.jsx("option",{value:"Production",children:"Production"}),s.jsx("option",{value:"Design",children:"Design"}),s.jsx("option",{value:"Management",children:"Management"}),s.jsx("option",{value:"Other",children:"Other"})]})]}),s.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:s.jsx("button",{type:"submit",disabled:h.isPending,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:h.isPending?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]})]}),s.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account Information"}),s.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Account ID"}),s.jsxs("dd",{className:"mt-1 text-sm text-gray-900 font-mono",children:[(N=e==null?void 0:e.id)==null?void 0:N.slice(0,8),"..."]})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Role"}),s.jsx("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:(d==null?void 0:d.role)||"Staff"})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Member Since"}),s.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:d!=null&&d.created_at?new Date(d.created_at).toLocaleDateString():"N/A"})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),s.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:d!=null&&d.updated_at?new Date(d.updated_at).toLocaleDateString():"N/A"})]})]})]})]})]})]})}function M6(){var y,b,x,v,w,N,_,F,R,J,q;const e=mt(),[t,r]=u.useState(null),[n,a]=u.useState({}),{data:i,isLoading:l}=he({queryKey:["integrations"],queryFn:async()=>(await O.get("/api/integrations")).data}),o=Ce({mutationFn:async K=>(await O.post(`/api/integrations/${K}/test`)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["integrations"]})}}),c=Ce({mutationFn:async({integrationId:K,settings:ne})=>(await O.post(`/api/integrations/${K}/settings`,ne)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["integrations"]}),r(null),a({})}}),d=[{id:"shopify",name:"Shopify",description:"Connect your Shopify store to view customer orders and data",icon:s.jsx(Sb,{className:"w-6 h-6"}),status:(y=i==null?void 0:i.shopify)!=null&&y.connected?"connected":"disconnected",settings:[{key:"SHOPIFY_DOMAIN",label:"Store Domain",type:"url",value:((b=i==null?void 0:i.shopify)==null?void 0:b.domain)||"",placeholder:"your-store.myshopify.com",required:!0,helpText:"Your Shopify store domain (e.g., your-store.myshopify.com)"},{key:"SHOPIFY_ACCESS_TOKEN",label:"Admin API Access Token",type:"password",value:((x=i==null?void 0:i.shopify)==null?void 0:x.accessToken)||"",placeholder:"shpat_xxxxxxxxxxxxx",required:!0,helpText:"Create a custom app in Shopify Admin  Settings  Apps and sales channels  Develop apps"}]},{id:"cloudflare-r2",name:"Cloudflare R2",description:"Object storage for file attachments",icon:s.jsx(m3,{className:"w-6 h-6"}),status:(v=i==null?void 0:i.r2)!=null&&v.connected?"connected":"disconnected",settings:[{key:"R2_BUCKET_NAME",label:"Bucket Name",type:"text",value:((w=i==null?void 0:i.r2)==null?void 0:w.bucketName)||"dartmouth-attachments",placeholder:"dartmouth-attachments",required:!0,helpText:"Your Cloudflare R2 bucket name"}]},{id:"email",name:"Email (Gmail)",description:"Send and receive emails via Gmail",icon:s.jsx(tr,{className:"w-6 h-6"}),status:(N=i==null?void 0:i.email)!=null&&N.connected?"connected":"disconnected",settings:[{key:"GMAIL_CLIENT_ID",label:"Gmail Client ID",type:"text",value:((_=i==null?void 0:i.email)==null?void 0:_.clientId)||"",placeholder:"xxxxx.apps.googleusercontent.com",required:!0},{key:"GMAIL_CLIENT_SECRET",label:"Gmail Client Secret",type:"password",value:((F=i==null?void 0:i.email)==null?void 0:F.clientSecret)||"",placeholder:"GOCSPX-xxxxx",required:!0},{key:"GMAIL_REFRESH_TOKEN",label:"Gmail Refresh Token",type:"password",value:((R=i==null?void 0:i.email)==null?void 0:R.refreshToken)||"",placeholder:"1//xxxxx",required:!0}]},{id:"resend",name:"Resend",description:"Email service for transactional emails",icon:s.jsx(tr,{className:"w-6 h-6"}),status:(J=i==null?void 0:i.resend)!=null&&J.connected?"connected":"disconnected",settings:[{key:"RESEND_API_KEY",label:"Resend API Key",type:"password",value:((q=i==null?void 0:i.resend)==null?void 0:q.apiKey)||"",placeholder:"re_xxxxx",required:!0,helpText:"Get your API key from resend.com"}]}],m=(K,ne)=>{r(K);const re={};ne.settings.forEach(pe=>{re[pe.key]=pe.value}),a(re)},h=K=>{c.mutate({integrationId:K,settings:n})},p=K=>{o.mutate(K)},j=K=>{switch(K){case"connected":return s.jsx(dt,{className:"w-5 h-5 text-green-600"});case"error":return s.jsx(xr,{className:"w-5 h-5 text-red-600"});default:return s.jsx(rd,{className:"w-5 h-5 text-gray-400"})}},f=K=>{switch(K){case"connected":return"Connected";case"error":return"Error";default:return"Not Connected"}},g=K=>{switch(K){case"connected":return"text-green-600";case"error":return"text-red-600";default:return"text-gray-500"}};return l?s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"text-gray-500",children:"Loading integrations..."})}):s.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Integrations"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Connect and manage your third-party integrations"})]}),s.jsx("div",{className:"space-y-4",children:d.map(K=>s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg text-blue-600",children:K.icon}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:K.name}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:K.description}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[j(K.status),s.jsx("span",{className:`text-sm font-medium ${g(K.status)}`,children:f(K.status)})]})]})]}),s.jsx("div",{className:"flex gap-2",children:t===K.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{r(null),a({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>h(K.id),disabled:c.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:c.isPending?"Saving...":"Save"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>p(K.id),disabled:o.isPending||K.status==="disconnected",className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:o.isPending?"Testing...":"Test Connection"}),s.jsx("button",{onClick:()=>m(K.id,K),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Configure"})]})})]})}),t===K.id&&s.jsx("div",{className:"p-6 bg-gray-50",children:s.jsx("div",{className:"space-y-4",children:K.settings.map(ne=>s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[ne.label,ne.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsx("input",{type:ne.type,value:n[ne.key]||"",onChange:re=>a({...n,[ne.key]:re.target.value}),placeholder:ne.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),ne.helpText&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:ne.helpText})]},ne.key))})})]},K.id))}),s.jsxs("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Need Help?"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Shopify:"})," Create a custom app in your Shopify Admin to get API credentials"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Cloudflare R2:"})," Configured via wrangler.toml and Cloudflare dashboard"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Gmail:"})," Set up OAuth 2.0 credentials in Google Cloud Console"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Resend:"})," Sign up at resend.com and create an API key"]})]})]})]})}function T6(){var J,q,K,ne;const e=mt(),[t,r]=u.useState("config"),[n,a]=u.useState(!1),[i,l]=u.useState(""),[o,c]=u.useState(""),[d,m]=u.useState(null),[h,p]=u.useState(null),{data:j,isLoading:f}=he({queryKey:["integrations"],queryFn:async()=>(await O.get("/api/integrations")).data}),{data:g,refetch:y}=he({queryKey:["integrations-debug"],queryFn:async()=>(await O.get("/api/integrations/debug")).data,enabled:!1}),b=Ce({mutationFn:async re=>(await O.post("/api/integrations/shopify/settings",re)).data,onSuccess:()=>{p({success:!0,message:"Settings saved successfully!"}),a(!1),e.invalidateQueries({queryKey:["integrations"]}),l(""),c("")},onError:re=>{var pe,ke;p({success:!1,message:((ke=(pe=re.response)==null?void 0:pe.data)==null?void 0:ke.message)||"Failed to save settings"})}}),x=Ce({mutationFn:async()=>(await O.post("/api/integrations/shopify/test")).data,onSuccess:re=>{m(re),e.invalidateQueries({queryKey:["integrations"]})},onError:re=>{var pe,ke;m({success:!1,message:((ke=(pe=re.response)==null?void 0:pe.data)==null?void 0:ke.message)||"Connection test failed"})}}),v=j==null?void 0:j.shopify,w=v==null?void 0:v.connected,N=()=>{var re;a(!0),p(null),m(null),l(((re=v==null?void 0:v.domain)==null?void 0:re.replace(//g,""))||""),c("")},_=()=>{a(!1),l(""),c(""),p(null)},F=()=>{if(!i||!o){p({success:!1,message:"Both fields are required"});return}b.mutate({domain:i,accessToken:o})},R=()=>{m(null),x.mutate()};return f?s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"text-gray-500",children:"Loading..."})}):s.jsxs("div",{className:"p-6 max-w-4xl",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Shopify Integration"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Connect your Shopify store to view customer orders and data in tickets"})]}),s.jsx("div",{className:"mb-6 border-b border-gray-200",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsx("button",{onClick:()=>r("config"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Configuration"}),s.jsx("button",{onClick:()=>r("guide"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="guide"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Installation Guide"})]})}),t==="config"&&s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-3 bg-green-50 rounded-lg text-green-600",children:s.jsx(Sb,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Shopify Store"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View customer order history, tracking info, and purchase data"}),s.jsx("div",{className:"flex items-center gap-2 mt-3",children:w?s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:"Connected"})]}):s.jsxs(s.Fragment,{children:[s.jsx(rd,{className:"w-5 h-5 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Not Connected"})]})})]})]}),s.jsx("div",{className:"flex gap-2",children:n?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:_,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:F,disabled:b.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:b.isPending?"Saving...":"Save"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>y(),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Debug Info"}),s.jsx("button",{onClick:R,disabled:x.isPending||!w,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:x.isPending?"Testing...":"Test Connection"}),s.jsx("button",{onClick:N,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Configure"})]})})]})}),d&&s.jsx("div",{className:`p-4 border-b ${d.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[d.success?s.jsx(dt,{className:"w-5 h-5 text-green-600 mt-0.5"}):s.jsx(xr,{className:"w-5 h-5 text-red-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:`text-sm font-medium ${d.success?"text-green-900":"text-red-900"}`,children:d.success?"Connection Successful!":"Connection Failed"}),s.jsx("p",{className:`text-sm mt-1 ${d.success?"text-green-700":"text-red-700"}`,children:d.message})]})]})}),h&&s.jsx("div",{className:`p-4 border-b ${h.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[h.success?s.jsx(dt,{className:"w-5 h-5 text-green-600 mt-0.5"}):s.jsx(xr,{className:"w-5 h-5 text-red-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:`text-sm font-medium ${h.success?"text-green-900":"text-red-900"}`,children:h.success?"Saved Successfully!":"Save Failed"}),s.jsx("p",{className:`text-sm mt-1 ${h.success?"text-green-700":"text-red-700"}`,children:h.message})]})]})}),g&&s.jsxs("div",{className:"p-4 border-b bg-gray-50 border-gray-200",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Debug Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"KV Storage:"}),s.jsxs("p",{className:"text-gray-600",children:["Domain: ",((J=g.kv)==null?void 0:J.SHOPIFY_DOMAIN)||"not set"]}),s.jsxs("p",{className:"text-gray-600",children:["Token: ",((q=g.kv)==null?void 0:q.SHOPIFY_ACCESS_TOKEN)||"not set"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Secrets:"}),s.jsxs("p",{className:"text-gray-600",children:["Domain: ",((K=g.secrets)==null?void 0:K.SHOPIFY_DOMAIN)||"not set"]}),s.jsxs("p",{className:"text-gray-600",children:["Token: ",((ne=g.secrets)==null?void 0:ne.SHOPIFY_ACCESS_TOKEN)||"not set"]})]})]})]}),!n&&s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Current Settings"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Store Domain"}),s.jsx("div",{className:"text-sm text-gray-900",children:(v==null?void 0:v.domain)||"Not configured"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Access Token"}),s.jsx("div",{className:"text-sm text-gray-900",children:(v==null?void 0:v.accessToken)||"Not configured"})]})]})]}),n&&s.jsxs("div",{className:"p-6 bg-gray-50",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Shopify Configuration"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Store Domain ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:i,onChange:re=>l(re.target.value),placeholder:"your-store.myshopify.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Shopify store domain (e.g., your-store.myshopify.com)"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Admin API Access Token ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"password",value:o,onChange:re=>c(re.target.value),placeholder:"shpat_xxxxxxxxxxxxx",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Shopify Admin API access token (starts with shpat_)"})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"How to get your Shopify credentials:"}),s.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[s.jsx("li",{children:"Go to Shopify Admin  Settings  Apps and sales channels"}),s.jsx("li",{children:'Click "Develop apps"  "Create an app" (name it "Dartmouth OS")'}),s.jsxs("li",{children:["Configure Admin API scopes: ",s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_customers"}),", ",s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_orders"}),", ",s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_products"})]}),s.jsx("li",{children:'Click "Install app" and copy the Admin API access token'})]}),s.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[s.jsx(ll,{className:"w-4 h-4 text-blue-600"}),s.jsx("a",{href:"https://help.shopify.com/en/manual/apps/app-types/custom-apps",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 underline",children:"Shopify Custom Apps Documentation"})]})]})]})]}),s.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"What You'll Get"}),s.jsxs("ul",{className:"space-y-3",children:[s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Customer Order History"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"View all orders from a customer when viewing their ticket"})]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Order Tracking"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"See tracking numbers and fulfillment status"})]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Product Information"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"View product details and variants from orders"})]})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"AI Agent Context"}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"AI can reference customer's order history when responding"})]})]})]})]})]}),t==="guide"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Shopify Installation Guide"}),s.jsx("p",{className:"text-gray-700 mb-4",children:"Follow these steps to connect your Shopify store to Dartmouth OS. This will allow you to view customer order history, tracking information, and product details directly in your support tickets."}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Time required:"})," 5-10 minutes",s.jsx("br",{}),s.jsx("strong",{children:"Shopify plan:"})," Any plan (Basic, Shopify, Advanced, Plus)",s.jsx("br",{}),s.jsx("strong",{children:"Access needed:"}),' Store owner or staff with "Develop apps" permission']})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Shopify Admin"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsx("span",{children:"Log in to your Shopify Admin panel"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Settings"})," (bottom left corner)"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Apps and sales channels"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"4."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Develop apps"})," (top right)"]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"}),` If you don't see "Develop apps", you may need to enable it first. Click "Allow custom app development" and confirm.`]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"2"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Create Custom App"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Create an app"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Enter app name: ",s.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Dartmouth OS"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsx("span",{children:"Select an app developer (usually yourself)"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"4."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Create app"})]})]})]})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"3"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Configure API Scopes"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Configure Admin API scopes"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsx("span",{children:"Search for and enable these scopes:"})]})]}),s.jsxs("div",{className:"mt-3 ml-6 space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600"}),s.jsx("code",{className:"font-mono text-sm",children:"read_customers"}),s.jsx("span",{className:"text-xs text-gray-600",children:"- View customer information"})]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600"}),s.jsx("code",{className:"font-mono text-sm",children:"read_orders"}),s.jsx("span",{className:"text-xs text-gray-600",children:"- View order history"})]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[s.jsx(dt,{className:"w-5 h-5 text-green-600"}),s.jsx("code",{className:"font-mono text-sm",children:"read_products"}),s.jsx("span",{className:"text-xs text-gray-600",children:"- View product details"})]})]}),s.jsx("ol",{start:3,className:"space-y-3 text-gray-700 mt-3",children:s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Save"})]})]})}),s.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded",children:s.jsxs("p",{className:"text-sm text-red-800",children:[s.jsx("strong",{children:"Important:"})," Only enable these three scopes. Do not enable write permissions unless absolutely necessary."]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"4"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Install the App"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Install app"})," (top right)"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Review the permissions and click ",s.jsx("strong",{children:"Install"})]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"})," You must install the app before you can get the access token. If you skip this step, you'll get a 403 Forbidden error."]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Get API Credentials"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"API credentials"})," tab"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Copy your ",s.jsx("strong",{children:"Admin API access token"})," (starts with ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"shpat_"}),")"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsxs("span",{children:["Note your store domain (e.g., ",s.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"your-store.myshopify.com"}),")"]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded",children:s.jsxs("p",{className:"text-sm text-red-800",children:[s.jsx("strong",{children:"Security Warning:"})," The access token is shown only once! Copy it immediately and store it securely. If you lose it, you'll need to uninstall and reinstall the app to get a new token."]})})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center font-bold",children:"6"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connect to Dartmouth OS"}),s.jsxs("ol",{className:"space-y-3 text-gray-700",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"1."}),s.jsxs("span",{children:["Go to the ",s.jsx("strong",{children:"Configuration"})," tab above"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"2."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Configure"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"3."}),s.jsx("span",{children:"Enter your Store Domain and Admin API Access Token"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"4."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Save"})]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-medium",children:"5."}),s.jsxs("span",{children:["Click ",s.jsx("strong",{children:"Test Connection"})," to verify everything works"]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:s.jsxs("p",{className:"text-sm text-green-800",children:[s.jsx("strong",{children:"Success!"})," If the test passes, you're all set. Customer order data will now appear in your support tickets."]})})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Troubleshooting Common Issues"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"403 Forbidden Error"}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This usually means:"}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 ml-4",children:[s.jsx("li",{children:" The app wasn't installed (Step 4)"}),s.jsx("li",{children:" Wrong API scopes were configured"}),s.jsx("li",{children:" You copied the API Key instead of the Access Token"})]}),s.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[s.jsx("strong",{children:"Solution:"})," Go back to Step 3 and verify the scopes, then reinstall the app."]})]}),s.jsxs("div",{className:"border-l-4 border-yellow-500 pl-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"401 Unauthorized Error"}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This means the access token is invalid."}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Solution:"})," Double-check you copied the entire token (starts with shpat_). If still failing, uninstall and reinstall the app to get a new token."]})]}),s.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Connection Timeout"}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This means the domain is incorrect."}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Solution:"})," Verify your store domain is in the format: your-store.myshopify.com (not your custom domain)."]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Resources"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("a",{href:"https://help.shopify.com/en/manual/apps/app-types/custom-apps",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[s.jsx(ll,{className:"w-4 h-4"}),"Shopify Custom Apps Documentation"]}),s.jsxs("a",{href:"https://shopify.dev/docs/api/admin-rest",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[s.jsx(ll,{className:"w-4 h-4"}),"Shopify Admin API Reference"]})]})]})]})]})}function A6(){var yt,Ci,Fn,qr;const{user:e}=ws(),t=mt(),[r]=Hl(),n=u.useRef(null),a=u.useRef(null),[i,l]=u.useState(null),[o,c]=u.useState(null),[d,m]=u.useState(""),[h,p]=u.useState([]),[j,f]=u.useState(!1),[g,y]=u.useState(!0),[b,x]=u.useState(""),[v,w]=u.useState(""),[N,_]=u.useState(null),[F,R]=u.useState(null),[J,q]=u.useState(""),[K,ne]=u.useState(!1),[re,pe]=u.useState(null),[ke,we]=u.useState(null),[H,T]=u.useState(!1),[Y,G]=u.useState(""),[X,ie]=u.useState(0),se=u.useRef(null),[xe,$e]=u.useState(null),[P,ae]=u.useState(!1),[je,E]=u.useState(null),[V,B]=u.useState(""),[Q,U]=u.useState(null),[me,ze]=u.useState(null),[be,le]=u.useState(!1),D=u.useRef(null),[Me,Te]=u.useState(""),[$,ee]=u.useState([]),[oe,_e]=u.useState(0),[Ee,We]=u.useState(!1),{data:Je}=he({queryKey:["group-chat-channels"],queryFn:async()=>(await ft.listChannels()).data,refetchInterval:5e3}),nt=(Je==null?void 0:Je.channels)||[],{data:kt}=he({queryKey:["group-chat-time-limit"],queryFn:async()=>(await ft.getTimeLimit()).data}),Gt=(kt==null?void 0:kt.timeLimit)??10,ss=S=>{if((e==null?void 0:e.role)==="admin"||Gt===0)return!0;const ve=new Date(S.created_at).getTime(),ye=Date.now(),Pe=Gt*60*1e3;return S.sender_id===(e==null?void 0:e.id)&&ye-ve<=Pe},Et=()=>{n.current&&n.current.scrollIntoView({behavior:"smooth",block:"end"})},rs=S=>{c(S),setTimeout(()=>{const ve=document.getElementById(`message-${S}`);ve&&ve.scrollIntoView({behavior:"smooth",block:"center"})},100),setTimeout(()=>{c(null)},5e3)},Us=S=>{if(Te(S),!S.trim()||!de.length){ee([]),_e(0);return}const ve=S.toLowerCase(),ye=[];[...de].reverse().forEach(Pe=>{let He=!1;Pe.content.toLowerCase().includes(ve)&&(He=!0),Pe.tags&&Pe.tags.split(",").map(ot=>ot.trim().toLowerCase()).some(ot=>ot.includes(ve))&&(He=!0),He&&ye.push(Pe.id)}),ee(ye),_e(0),ye.length>0&&rs(ye[0])},Ns=()=>{if($.length===0)return;const S=(oe+1)%$.length;_e(S),rs($[S])},br=()=>{if($.length===0)return;const S=oe===0?$.length-1:oe-1;_e(S),rs($[S])};u.useEffect(()=>{!i&&nt.length>0&&l(nt[0].id)},[nt,i]),u.useEffect(()=>{const S=r.get("channel"),ve=r.get("message");S&&l(S),ve&&(c(ve),setTimeout(()=>{const ye=document.getElementById(`message-${ve}`);ye&&ye.scrollIntoView({behavior:"smooth",block:"center"})},500),setTimeout(()=>{c(null)},5e3))},[r]),u.useEffect(()=>{const S=D.current;if(!S)return;const ve=()=>{const{scrollTop:ye,scrollHeight:Pe,clientHeight:He}=S,et=Pe-ye-He<100;le(!et)};return S.addEventListener("scroll",ve),()=>S.removeEventListener("scroll",ve)},[i]);const{data:As}=he({queryKey:["group-chat-messages",i],queryFn:async()=>i?(await ft.getMessages(i,{limit:50})).data:{messages:[]},enabled:!!i,refetchInterval:5e3,refetchOnWindowFocus:!1}),de=(As==null?void 0:As.messages)||[];u.useEffect(()=>{if(de.length>0){const S=de[de.length-1];S.id!==N&&(_(S.id),i&&ft.markAsRead(i,S.id))}},[de,N,i]);const{data:vr}=he({queryKey:["group-chat-members",i],queryFn:async()=>i?(await ft.getMembers(i)).data:{members:[]},enabled:!!i}),ms=(vr==null?void 0:vr.members)||[],Rs=ms.find(S=>S.staff_id===(e==null?void 0:e.id)),rr=(Rs==null?void 0:Rs.role)==="admin";u.useEffect(()=>{n.current&&n.current.scrollIntoView({behavior:"smooth",block:"end"})},[de]),u.useEffect(()=>{const S=setTimeout(()=>{n.current&&n.current.scrollIntoView({behavior:"auto",block:"end"})},100);return()=>clearTimeout(S)},[]),u.useEffect(()=>{const S=()=>$e(null);if(xe)return document.addEventListener("click",S),()=>document.removeEventListener("click",S)},[xe]);const ks=Ce({mutationFn:async S=>{if(!i)throw new Error("No active channel");return ft.sendMessage(i,S)},onSuccess:()=>{m(""),p([]),t.invalidateQueries({queryKey:["group-chat-messages",i]}),t.invalidateQueries({queryKey:["group-chat-channels"]})}}),at=Ce({mutationFn:S=>ft.createChannel(S),onSuccess:()=>{f(!1),x(""),w(""),t.invalidateQueries({queryKey:["group-chat-channels"]})}}),L=Ce({mutationFn:({messageId:S,content:ve,deleteAttachment:ye})=>ft.editMessage(S,ve,ye),onSuccess:()=>{R(null),ne(!1),q(""),t.invalidateQueries({queryKey:["group-chat-messages",i]})}}),ge=Ce({mutationFn:S=>ft.deleteMessage(S),onSuccess:()=>{t.invalidateQueries({queryKey:["group-chat-messages",i]})}}),Fe=Ce({mutationFn:({messageId:S,emoji:ve})=>ft.addReaction(S,ve),onSuccess:()=>{t.invalidateQueries({queryKey:["group-chat-messages",i]}),pe(null)}}),De=async()=>{if(!d.trim()&&h.length===0||ks.isPending)return;let S=[];if(h.length>0)for(const ye of h){const Pe=await Pt(ye);S.push({name:ye.name,content:Pe,type:ye.type,size:ye.size})}let ve=d;me&&(ve=` Replying to ${me.first_name}: "${me.content.substring(0,50)}${me.content.length>50?"...":""}" [msg:${me.id}]

${d}`),ks.mutate({content:ve,attachments:S.length>0?S:void 0}),ze(null)},rt=S=>{S.target.files&&S.target.files.length>0&&p(Array.from(S.target.files))},Pt=S=>new Promise((ve,ye)=>{const Pe=new FileReader;Pe.readAsDataURL(S),Pe.onload=()=>ve(Pe.result),Pe.onerror=He=>ye(He)}),Ln=async(S,ve)=>{try{const Pe=await(await fetch(S)).blob(),He=window.URL.createObjectURL(Pe),et=document.createElement("a");et.href=He,et.download=ve,document.body.appendChild(et),et.click(),document.body.removeChild(et),window.URL.revokeObjectURL(He)}catch(ye){console.error("Error downloading file:",ye)}},M=()=>{b.trim()&&at.mutate({name:b,description:v||void 0,channelType:"public"})},A=S=>S.startsWith("http")?S:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${S}`,Ae=S=>S.split(/(@\w+|@\d+|#\d+|TKT-\d+|ticket\s+\d+|\*\d+(?:-\d+)?|TSK-\d+(?:-\d+)?)/gi).map((ye,Pe)=>{if(ye.match(/^@\w+$/)&&!ye.match(/^@\d+$/))return s.jsx("span",{className:"bg-blue-100 text-blue-700 font-semibold px-1 rounded",children:ye},Pe);const He=ye.match(/^@(\d+)$|^#(\d+)$|^TKT-(\d+)$|^ticket\s+(\d+)$/i);if(He){const ot=He[1]||He[2]||He[3]||He[4];return s.jsx("a",{href:`/tickets?search=TKT-${ot}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",onClick:$t=>{$t.stopPropagation()},children:ye},Pe)}const et=ye.match(/^\*(\d+)(?:-(\d+))?$|^TSK-(\d+)(?:-(\d+))?$/i);if(et){const ot=et[1]||et[3],$t=et[2]||et[4],nr=$t?`TSK-${ot}-${$t}`:`TSK-${ot}`;return s.jsx("a",{href:`/tickets?search=${nr}`,target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800 hover:underline font-medium",onClick:Ke=>{Ke.stopPropagation()},children:ye},Pe)}return ye}),Re=S=>{const ve=S.content,ye=ve.match(/^ Replying to (\w+): "(.+?)" \[msg:([^\]]+)\]\n\n([\s\S]*)$/);if(ye){const[,Pe,He,et,ot]=ye;return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-2 pb-2 border-b border-gray-300",children:s.jsxs("button",{onClick:()=>{rs(et)},className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 hover:underline",title:"Click to view original message",children:[s.jsx("span",{className:"text-base",children:""}),s.jsxs("span",{children:["Replying to ",Pe,': "',He,'"']})]})}),s.jsx("div",{children:Ae(ot)})]})}return Ae(ve)},Ge=nt.find(S=>S.id===i);return s.jsxs("div",{className:"w-full flex bg-gray-50",style:{height:"calc(100vh - 3.5rem)"},children:[s.jsxs("div",{className:"w-64 bg-white border-r border-gray-200 flex flex-col flex-shrink-0 h-full overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",style:{height:"73px"},children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Team Chat"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Internal Communication"})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"p-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[s.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Channels"}),rr&&s.jsx("button",{onClick:()=>f(!0),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",title:"Create new channel (Admin only)",children:s.jsx(nd,{className:"w-4 h-4"})})]}),nt.map(S=>s.jsxs("button",{onClick:()=>l(S.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg text-left transition-colors border ${i===S.id?"bg-indigo-50 text-indigo-900 font-semibold border-indigo-300":"text-gray-700 hover:bg-gray-50 border-transparent"}`,children:[s.jsx(Ot,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{className:"flex-1 truncate font-medium",children:S.name}),S.unread_count>0&&s.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5",children:S.unread_count})]},S.id))]})})]}),s.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:Ge?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",style:{minHeight:"73px"},children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsx(Ot,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:Ge.name}),Ge.description&&s.jsx("p",{className:"text-sm text-gray-500 truncate",children:Ge.description})]})]}),s.jsx("button",{onClick:()=>We(!Ee),className:`p-2 rounded-lg flex-shrink-0 ${Ee?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Search messages",children:s.jsx(hi,{className:"w-5 h-5"})}),s.jsxs("button",{onClick:()=>y(!g),className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg flex-shrink-0",children:[s.jsx(Xl,{className:"w-5 h-5"}),s.jsxs("span",{className:"text-sm font-medium",children:[ms.length," members"]})]})]}),Ee&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{type:"text",value:Me,onChange:S=>Us(S.target.value),placeholder:"Search messages and tags... (e.g., James Scott, #james-scott)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),$.length>0&&s.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2 bg-white px-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[oe+1," / ",$.length]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:br,className:"p-1 hover:bg-gray-100 rounded",title:"Previous result",children:s.jsx(or,{className:"w-4 h-4"})}),s.jsx("button",{onClick:Ns,className:"p-1 hover:bg-gray-100 rounded",title:"Next result",children:s.jsx(qs,{className:"w-4 h-4"})})]})]})]}),s.jsx("button",{onClick:()=>{We(!1),Te(""),ee([]),_e(0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Close search",children:s.jsx(_t,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{ref:D,className:"flex-1 overflow-y-auto p-6 space-y-3 relative",children:[de.map(S=>{var et,ot,$t,nr;const ve=S.sender_id===(e==null?void 0:e.id),ye=S.reactions?JSON.parse(S.reactions):[],Pe=F===S.id,He=o===S.id;return s.jsxs("div",{id:`message-${S.id}`,className:`group flex gap-3 -mx-2 px-2 py-1 rounded transition-all duration-300 ${He?"bg-yellow-100 border-l-4 border-yellow-500 pl-1":"hover:bg-gray-50"}`,onContextMenu:Ke=>{Ke.preventDefault(),$e({x:Ke.clientX,y:Ke.clientY,messageId:S.id})},children:[s.jsxs("div",{className:"flex-shrink-0",children:[S.profile_picture&&tt.getAvatarUrl(S.profile_picture)?s.jsx("img",{src:tt.getAvatarUrl(S.profile_picture)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-10 h-10 rounded-full object-cover",onError:Ke=>{var Mt;Ke.currentTarget.style.display="none",(Mt=Ke.currentTarget.nextElementSibling)==null||Mt.classList.remove("hidden")}}):null,s.jsxs("div",{className:`w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-semibold ${S.profile_picture&&tt.getAvatarUrl(S.profile_picture)?"hidden":""}`,children:[(et=S.first_name)==null?void 0:et[0],(ot=S.last_name)==null?void 0:ot[0]]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[s.jsxs("span",{className:"font-semibold text-gray-900 text-sm",children:[S.first_name," ",S.last_name]}),s.jsx("span",{className:"text-xs text-gray-500",children:(()=>{const Ke=new Date(S.created_at),Mt=new Date;return Ke.toDateString()===Mt.toDateString()?Ke.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Ke.toLocaleString([],{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})()}),S.edited_at&&s.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Edited at ${new Date(S.edited_at).toLocaleString()}`,children:["(edited ",new Date(S.edited_at).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),")"]}),ve&&!Pe&&ss(S)&&s.jsxs("div",{className:"ml-auto opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1",children:[s.jsx("button",{onClick:()=>{R(S.id),q(S.content),ne(!1)},className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",title:"Edit message (within 10 mins)",children:s.jsx(Nb,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:()=>we(S.id),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Delete message (within 10 mins)",children:s.jsx(gi,{className:"w-3.5 h-3.5"})})]})]}),Pe?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:J,onChange:Ke=>q(Ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3,autoFocus:!0}),S.attachment_url&&!K&&s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded border border-gray-200",children:[($t=S.attachment_type)!=null&&$t.startsWith("image/")?s.jsx(Sc,{className:"w-4 h-4 text-gray-500"}):s.jsx(qo,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700 flex-1",children:S.attachment_name}),s.jsx("button",{onClick:()=>ne(!0),className:"p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded",title:"Remove attachment",children:s.jsx(_t,{className:"w-4 h-4"})})]}),K&&s.jsx("div",{className:"text-xs text-gray-500 italic",children:"Attachment will be removed when you save"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{L.mutate({messageId:S.id,content:J,deleteAttachment:K})},className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Save"}),s.jsx("button",{onClick:()=>{R(null),q(""),ne(!1)},className:"px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300",children:"Cancel"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg px-4 py-2.5 border border-gray-200",children:[s.jsx("div",{className:"text-gray-900 text-sm whitespace-pre-wrap break-words",children:Re(S)}),S.attachment_url&&s.jsx("div",{className:"mt-2",children:(nr=S.attachment_type)!=null&&nr.startsWith("image/")?s.jsxs("div",{className:"relative inline-block",children:[s.jsx("a",{href:A(S.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:s.jsx("img",{src:A(S.attachment_url),alt:S.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300"})}),s.jsx("button",{onClick:()=>S.attachment_url&&Ln(A(S.attachment_url),S.attachment_name||"image.png"),className:"absolute top-2 right-2 p-2 bg-white/90 hover:bg-white text-gray-700 hover:text-blue-600 rounded-lg shadow-md border border-gray-200",title:"Download image",children:s.jsx(kc,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("a",{href:A(S.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 hover:underline",children:[s.jsx(qo,{className:"w-4 h-4"}),s.jsx("span",{children:S.attachment_name}),S.attachment_size&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(",(S.attachment_size/1024).toFixed(1)," KB)"]})]}),s.jsx("button",{onClick:()=>S.attachment_url&&Ln(A(S.attachment_url),S.attachment_name||"download"),className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Download file",children:s.jsx(kc,{className:"w-4 h-4"})})]})}),S.tags&&s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Zl(S.tags).map((Ke,Mt)=>s.jsxs(lt,{to:`/tags?tag=${encodeURIComponent(Ke)}`,className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors",children:[s.jsx(Ot,{className:"w-3 h-3"}),Ke]},Mt))})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[ye.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(ye.reduce((Ke,Mt)=>(Ke[Mt.emoji]=(Ke[Mt.emoji]||0)+1,Ke),{})).map(([Ke,Mt])=>s.jsxs("button",{onClick:()=>Fe.mutate({messageId:S.id,emoji:Ke}),className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-full text-xs",children:[s.jsx("span",{children:Ke}),s.jsx("span",{className:"text-blue-600 font-medium",children:Mt})]},Ke))}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>pe(re===S.id?null:S.id),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",title:"Add reaction",children:s.jsx(nS,{className:"w-4 h-4"})}),re===S.id&&s.jsx("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex gap-1 z-10",children:["","","","","","",""].map(Ke=>s.jsx("button",{onClick:()=>Fe.mutate({messageId:S.id,emoji:Ke}),className:"text-2xl hover:bg-gray-100 rounded p-1",children:Ke},Ke))})]})]})]})]})]},S.id)}),s.jsx("div",{ref:n})]}),be&&s.jsx("button",{onClick:Et,className:"absolute bottom-28 right-8 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-3 shadow-lg transition-all duration-200 z-50",title:"Scroll to bottom",children:s.jsx(U4,{className:"w-5 h-5"})}),s.jsxs("div",{className:"bg-white pt-8 pb-4 px-4",children:[s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:Mb}),h.length>0&&s.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:h.map((S,ve)=>s.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-2",children:[S.type.startsWith("image/")?s.jsx(Sc,{className:"w-4 h-4 text-gray-600"}):s.jsx(qo,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm text-gray-700",children:S.name}),s.jsx("button",{onClick:()=>p(h.filter((ye,Pe)=>Pe!==ve)),className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-4 h-4"})})]},ve))}),me&&s.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-xs text-blue-600 font-semibold",children:["Replying to ",me.first_name," ",me.last_name]}),s.jsx("div",{className:"text-sm text-gray-600 truncate",children:me.content})]}),s.jsx("button",{onClick:()=>ze(null),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",children:s.jsx(_t,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"file",ref:a,onChange:rt,className:"hidden",multiple:!0}),s.jsx("button",{onClick:()=>{var S;return(S=a.current)==null?void 0:S.click()},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(St,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{ref:se,type:"text",value:d,onChange:S=>{const ve=S.target.value;m(ve);const ye=S.target.selectionStart||0,He=ve.substring(0,ye).match(/@(\w*)$/);He?(G(He[1].toLowerCase()),ie(ye),T(!0)):T(!1)},onKeyDown:S=>{S.key==="Enter"&&!H?(S.preventDefault(),De()):S.key==="Escape"&&H&&T(!1)},placeholder:"Type a message... Use @ to mention, #keyword to add tags",className:"w-full px-4 h-[42px] border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),H&&ms.length>0&&s.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-50",children:[ms.filter(S=>{const ve=`${S.first_name} ${S.last_name}`.toLowerCase(),ye=S.first_name.toLowerCase();return ve.includes(Y)||ye.includes(Y)}).map(S=>s.jsxs("button",{onClick:()=>{var He;const ve=d.substring(0,X).replace(/@\w*$/,""),ye=d.substring(X),Pe=`${ve}@${S.first_name.toLowerCase()} ${ye}`;m(Pe),T(!1),(He=se.current)==null||He.focus()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-2",children:[S.avatar_url&&tt.getAvatarUrl(S.avatar_url)?s.jsx("img",{src:tt.getAvatarUrl(S.avatar_url)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-8 h-8 rounded-full object-cover",onError:ve=>{var ye;ve.currentTarget.style.display="none",(ye=ve.currentTarget.nextElementSibling)==null||ye.classList.remove("hidden")}}):null,s.jsxs("div",{className:`w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm font-semibold ${S.avatar_url&&tt.getAvatarUrl(S.avatar_url)?"hidden":""}`,children:[S.first_name[0],S.last_name[0]]}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-sm",children:[S.first_name," ",S.last_name]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["@",S.first_name.toLowerCase()]})]})]},S.staff_id)),("mccarthy".includes(Y)||"mc".includes(Y))&&s.jsxs("button",{onClick:()=>{var Pe;const S=d.substring(0,X).replace(/@\w*$/,""),ve=d.substring(X),ye=`${S}@mccarthy ${ve}`;m(ye),T(!1),(Pe=se.current)==null||Pe.focus()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-2 border-t border-gray-200",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500 text-white flex items-center justify-center text-sm font-semibold",children:"AI"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-sm",children:"McCarthy AI"}),s.jsx("div",{className:"text-xs text-gray-500",children:"@mccarthy"})]})]})]})]}),s.jsx("button",{onClick:De,disabled:!d.trim()&&h.length===0||ks.isPending,className:"px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 h-[42px]",children:ks.isPending?s.jsxs(s.Fragment,{children:[s.jsx(jb,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"Uploading..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(ad,{className:"w-5 h-5"}),s.jsx("span",{children:"Send"})]})})]})]})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ot,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("p",{className:"text-lg font-medium",children:"No channel selected"}),s.jsx("p",{className:"text-sm",children:"Select a channel from the sidebar to start chatting"})]})})}),g&&Ge&&s.jsxs("div",{className:"w-64 bg-white border-l border-gray-200 flex flex-col flex-shrink-0 h-full overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",style:{height:"73px"},children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Members"}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ms.length," in this channel"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:ms.map(S=>{var ve,ye;return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative",children:[S.avatar_url&&tt.getAvatarUrl(S.avatar_url)?s.jsx("img",{src:tt.getAvatarUrl(S.avatar_url)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-8 h-8 rounded-full object-cover",onError:Pe=>{var He;Pe.currentTarget.style.display="none",(He=Pe.currentTarget.nextElementSibling)==null||He.classList.remove("hidden")}}):null,s.jsxs("div",{className:`w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold ${S.avatar_url&&tt.getAvatarUrl(S.avatar_url)?"hidden":""}`,children:[(ve=S.first_name)==null?void 0:ve[0],(ye=S.last_name)==null?void 0:ye[0]]}),S.availability_status==="available"&&s.jsx("div",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-white"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[S.first_name," ",S.last_name]}),S.role==="admin"&&s.jsx("span",{className:"text-xs text-blue-600",children:"Admin"})]})]},S.id)})})]}),j&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Channel"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),s.jsx("input",{type:"text",value:b,onChange:S=>x(S.target.value),placeholder:"e.g., general, support, sales",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),s.jsx("textarea",{value:v,onChange:S=>w(S.target.value),placeholder:"What is this channel for?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>{f(!1),x(""),w("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:M,disabled:!b.trim(),className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Channel"})]})]})}),ke&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Message"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this message? This action cannot be undone."}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>we(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>{ge.mutate(ke),we(null)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),xe&&s.jsxs("div",{className:"fixed bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",style:{top:xe.y,left:xe.x},onClick:S=>S.stopPropagation(),children:[s.jsxs("button",{onClick:()=>{var ve;const S=de.find(ye=>ye.id===xe.messageId);S&&(ze(S),$e(null),(ve=se.current)==null||ve.focus())},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{children:""})," Reply"]}),s.jsxs("button",{onClick:()=>{E(xe.messageId),ae(!0),$e(null)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{children:""})," Share"]}),s.jsxs("button",{onClick:()=>{const S=de.find(ve=>ve.id===xe.messageId);S&&(navigator.clipboard.writeText(S.content),$e(null))},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[s.jsx("span",{children:""})," Copy Message"]})]}),P&&je&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Share Message"}),Q?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Sharing to: ",s.jsx("span",{className:"font-semibold",children:Q==="MEMOS"?"@Memos":`#${(yt=nt.find(S=>S.id===Q))==null?void 0:yt.name}`})]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Original message:"}),s.jsx("p",{className:"text-sm text-gray-900 line-clamp-3",children:(Ci=de.find(S=>S.id===je))==null?void 0:Ci.content}),((Fn=de.find(S=>S.id===je))==null?void 0:Fn.attachment_name)&&s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 mt-2",children:[s.jsx(St,{className:"w-3 h-3"}),s.jsx("span",{children:(qr=de.find(S=>S.id===je))==null?void 0:qr.attachment_name})]})]}),s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:Q==="MEMOS"?"Add your note (optional):":"Add your comment (optional - use @ to mention someone):"}),s.jsx("textarea",{value:V,onChange:S=>B(S.target.value),placeholder:Q==="MEMOS"?"Add a note about this shared message...":"@gaille can you review this?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>{U(null),B("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Back"}),s.jsx("button",{onClick:async()=>{var ve,ye;const S=de.find(Pe=>Pe.id===je);if(S&&i&&Q&&e)if(Q==="MEMOS"){const Pe=(ve=nt.find(ot=>ot.id===i))==null?void 0:ve.name;let He="";V.trim()?He=`${V}

 Shared from #${Pe}:
${S.content}`:He=` Shared from #${Pe}:

${S.content}`;let et;if(S.attachment_url&&S.attachment_name)try{const $t=await(await fetch(A(S.attachment_url))).blob(),nr=await new Promise(Ke=>{const Mt=new FileReader;Mt.onloadend=()=>Ke(Mt.result),Mt.readAsDataURL($t)});et={name:S.attachment_name,data:nr,type:S.attachment_type||"application/octet-stream",size:S.attachment_size||0}}catch(ot){console.error("Error fetching attachment:",ot)}console.log("[Share to Memos] Creating memo with:",{content:He,attachment:et}),Qi.createMemo({content:He,attachment:et}).then(()=>{ae(!1),E(null),U(null),B(""),t.invalidateQueries({queryKey:["memos"]})}).catch(ot=>{console.error("Error creating memo:",ot),alert("Failed to share to @Memos. Please try again.")})}else{const Pe=(ye=nt.find($t=>$t.id===i))==null?void 0:ye.name,He=`${e.firstName} ${e.lastName}`;let et="";V.trim()?et=`${V}

 ${He} shared from #${Pe}:
${S.content}`:et=` ${He} shared from #${Pe}:

${S.content}`;let ot;if(S.attachment_url&&S.attachment_name)try{const nr=await(await fetch(A(S.attachment_url))).blob(),Ke=await new Promise(Mt=>{const pa=new FileReader;pa.onloadend=()=>Mt(pa.result),pa.readAsDataURL(nr)});ot=[{name:S.attachment_name,content:Ke,type:S.attachment_type||"application/octet-stream",size:S.attachment_size||0}]}catch($t){console.error("Error fetching attachment:",$t)}ft.sendMessage(Q,{content:et,attachments:ot}).then(()=>{ae(!1),E(null),U(null),B(""),t.invalidateQueries({queryKey:["group-chat-channels"]})}).catch($t=>{console.error("Error sharing message:",$t),alert("Failed to share message. Please try again.")})}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Share"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select where to share this message:"}),s.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4",children:[nt.filter(S=>S.id!==i).map(S=>s.jsxs("button",{onClick:()=>U(S.id),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded border border-gray-200 flex items-center gap-2",children:[s.jsx(Ot,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{children:S.name})]},S.id)),s.jsxs("button",{onClick:()=>U("MEMOS"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded border border-gray-200 flex items-center gap-2",children:[s.jsx(Cc,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{children:"@Memos (Personal notes)"})]})]}),s.jsx("div",{className:"flex gap-3 justify-end",children:s.jsx("button",{onClick:()=>{ae(!1),E(null),U(null),B("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})})]})]})})]})}function R6(){const e=mt(),[t,r]=u.useState("channels"),[n,a]=u.useState(null),[i,l]=u.useState(!1),[o,c]=u.useState(!1),[d,m]=u.useState(!1),[h,p]=u.useState(""),[j,f]=u.useState(""),[g,y]=u.useState(""),[b,x]=u.useState(""),[v,w]=u.useState(!0),[N,_]=u.useState(!0),[F,R]=u.useState(!0),[J,q]=u.useState(10),[K,ne]=u.useState(12),{data:re}=he({queryKey:["group-chat-channels-settings"],queryFn:async()=>(await ft.listChannels()).data}),pe=(re==null?void 0:re.channels)||[],{data:ke}=he({queryKey:["group-chat-time-limit"],queryFn:async()=>(await ft.getTimeLimit()).data});u.useState(()=>{(ke==null?void 0:ke.timeLimit)!==void 0&&q(ke.timeLimit)});const we=Ce({mutationFn:U=>ft.setTimeLimit(U),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-time-limit"]})}}),{data:H}=he({queryKey:["mentions-auto-archive"],queryFn:async()=>(await ft.getAutoArchiveHours()).data});u.useState(()=>{(H==null?void 0:H.hours)!==void 0&&ne(H.hours)});const T=Ce({mutationFn:U=>ft.setAutoArchiveHours(U),onSuccess:()=>{e.invalidateQueries({queryKey:["mentions-auto-archive"]})}}),{data:Y}=he({queryKey:["group-chat-members-settings",n==null?void 0:n.id],queryFn:async()=>n?(await ft.getMembers(n.id)).data:{members:[]},enabled:!!n}),G=(Y==null?void 0:Y.members)||[],{data:X}=he({queryKey:["staff-list"],queryFn:async()=>(await tt.list()).data}),ie=(X==null?void 0:X.staff)||[],se=Ce({mutationFn:U=>ft.updateChannel(U.channelId,{name:U.name,description:U.description,allow_message_editing:U.allow_message_editing,allow_message_deletion:U.allow_message_deletion,allow_file_deletion:U.allow_file_deletion}),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-channels-settings"]}),l(!1),a(null)}}),xe=Ce({mutationFn:U=>ft.archiveChannel(U),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-channels-settings"]}),a(null)}}),$e=Ce({mutationFn:U=>ft.addMember(U.channelId,U.staffId),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-members-settings",n==null?void 0:n.id]})}}),P=Ce({mutationFn:U=>ft.removeMember(U.channelId,U.staffId),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-members-settings",n==null?void 0:n.id]})}}),ae=Ce({mutationFn:U=>ft.createChannel(U),onSuccess:()=>{m(!1),y(""),x(""),e.invalidateQueries({queryKey:["group-chat-channels-settings"]})}}),je=()=>{!n||!h.trim()||se.mutate({channelId:n.id,name:h,description:j,allow_message_editing:v,allow_message_deletion:N,allow_file_deletion:F})},E=U=>{n&&$e.mutate({channelId:n.id,staffId:U})},V=U=>{n&&confirm("Are you sure you want to remove this member from the channel?")&&P.mutate({channelId:n.id,staffId:U})},B=ie.filter(U=>!G.some(me=>me.staff_id===U.id)),Q=()=>{g.trim()&&ae.mutate({name:g,description:b||void 0,channelType:"public"})};return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Group Chat Settings"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage channels, members, and group chat configuration"})]}),s.jsx("div",{className:"mb-6 border-b border-gray-200",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsxs("button",{onClick:()=>r("channels"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="channels"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(Ot,{className:"w-4 h-4 inline-block mr-2"}),"Channels"]}),s.jsxs("button",{onClick:()=>r("global"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="global"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(fi,{className:"w-4 h-4 inline-block mr-2"}),"Global Settings"]}),s.jsx("button",{onClick:()=>r("mentions"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="mentions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"@Mentions"})]})}),t==="channels"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[s.jsx(nd,{className:"w-4 h-4"}),"Create Channel"]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Ot,{className:"w-5 h-5"}),"Channels"]}),pe.length===0?s.jsx("p",{className:"text-gray-500 text-center py-8",children:"No channels yet. Create one to get started!"}):s.jsx("div",{className:"space-y-2",children:pe.map(U=>s.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[s.jsx(Ot,{className:"w-4 h-4"}),U.name,U.is_archived===1&&s.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Archived"})]}),U.description&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:U.description})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{a(U),c(!0)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Manage Members",children:s.jsx(Xl,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>{a(U),p(U.name),f(U.description||""),l(!0)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Edit Channel",children:s.jsx(Uh,{className:"w-4 h-4"})}),U.is_archived===0&&s.jsx("button",{onClick:()=>{confirm(`Archive channel "${U.name}"?`)&&xe.mutate(U.id)},className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded",title:"Archive Channel",children:s.jsx(gi,{className:"w-4 h-4"})})]})]},U.id))})]})})]}),t==="global"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(fi,{className:"w-5 h-5"}),"Global Settings"]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Edit/Delete Time Limit"}),s.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"How long staff members can edit or delete their messages. Admins can always edit/delete."}),s.jsxs("select",{value:J,onChange:U=>{const me=parseInt(U.target.value,10);q(me),we.mutate(me)},className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:5,children:"5 minutes"}),s.jsx("option",{value:10,children:"10 minutes (default)"}),s.jsx("option",{value:15,children:"15 minutes"}),s.jsx("option",{value:30,children:"30 minutes"}),s.jsx("option",{value:60,children:"1 hour"}),s.jsx("option",{value:0,children:"No limit (always allow)"})]}),we.isPending&&s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Saving..."}),we.isSuccess&&s.jsx("p",{className:"text-xs text-green-600 mt-2",children:" Saved successfully"})]})})]}),t==="mentions"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"@Mentions Settings"}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto Archive Mentions"}),s.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Automatically archive Read mentions after the specified time. This keeps your Mentions page clean and focused on active items."}),s.jsxs("select",{value:K,onChange:U=>{const me=parseInt(U.target.value,10);ne(me),T.mutate(me)},className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:12,children:"12 Hours (default)"}),s.jsx("option",{value:24,children:"24 Hours"}),s.jsx("option",{value:36,children:"36 Hours"}),s.jsx("option",{value:48,children:"48 Hours"}),s.jsx("option",{value:72,children:"72 Hours"}),s.jsx("option",{value:0,children:"Never Archive"})]}),T.isPending&&s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Saving..."}),T.isSuccess&&s.jsx("p",{className:"text-xs text-green-600 mt-2",children:" Saved successfully"})]})})]}),i&&n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Channel"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),s.jsx("input",{type:"text",value:h,onChange:U=>p(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:j,onChange:U=>f(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Channel Permissions"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Message Editing"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Members can edit their own messages"})]}),s.jsx("input",{type:"checkbox",checked:v,onChange:U=>w(U.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("label",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Message Deletion"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Members can delete their own messages"})]}),s.jsx("input",{type:"checkbox",checked:N,onChange:U=>_(U.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("label",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow File Deletion"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Members can delete attached files"})]}),s.jsx("input",{type:"checkbox",checked:F,onChange:U=>R(U.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]})]})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>{l(!1),a(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:je,disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Changes"})]})]})}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Channel"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),s.jsx("input",{type:"text",value:g,onChange:U=>y(U.target.value),placeholder:"e.g., general, support, sales",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),s.jsx("textarea",{value:b,onChange:U=>x(U.target.value),placeholder:"What is this channel for?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>{m(!1),y(""),x("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:Q,disabled:!g.trim()||ae.isPending,className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:ae.isPending?"Creating...":"Create Channel"})]})]})}),o&&n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Manage Members - #",n.name]}),s.jsx("button",{onClick:()=>{c(!1),a(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Current Members (",G.length,")"]}),s.jsx("div",{className:"space-y-2",children:G.map(U=>{var me,ze;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold",children:[(me=U.first_name)==null?void 0:me[0],(ze=U.last_name)==null?void 0:ze[0]]}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[U.first_name," ",U.last_name]}),s.jsx("p",{className:"text-xs text-gray-500",children:U.email})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[U.role==="admin"&&s.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:"Admin"}),s.jsx("button",{onClick:()=>V(U.staff_id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove member",children:s.jsx(_t,{className:"w-4 h-4"})})]})]},U.id)})})]}),B.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Add Members (",B.length," available)"]}),s.jsx("div",{className:"space-y-2",children:B.map(U=>{var me,ze;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold",children:[(me=U.first_name)==null?void 0:me[0],(ze=U.last_name)==null?void 0:ze[0]]}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[U.first_name," ",U.last_name]}),s.jsx("p",{className:"text-xs text-gray-500",children:U.email})]})]}),s.jsxs("button",{onClick:()=>E(U.id),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-800 text-white rounded-lg hover:bg-gray-900",children:[s.jsx(Al,{className:"w-4 h-4"}),s.jsx("span",{children:"Add"})]})]},U.id)})})]}),B.length===0&&G.length>0&&s.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"All staff members are already in this channel"})]})})]})}function P6(){const[e,t]=u.useState(null),[r,n]=u.useState(""),[a,i]=u.useState(0),{data:l,isLoading:o}=he({queryKey:["tags",r],queryFn:async()=>(await Bf.getAllTags(r||void 0)).data}),{data:c,isLoading:d}=he({queryKey:["tag-content",e],queryFn:async()=>e?(await Bf.searchTags(e)).data:{results:[]},enabled:!!e}),m=(l==null?void 0:l.tags)||[],h=(c==null?void 0:c.results)||[],p=h[a],j=()=>{a>0&&i(a-1)},f=()=>{a<h.length-1&&i(a+1)};return s.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[s.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(sg,{className:"w-6 h-6 text-blue-600"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tags"})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[m.length," ",m.length===1?"tag":"tags"," found"]})]}),s.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(hi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",value:r,onChange:g=>n(g.target.value),placeholder:"Filter tags by name... (e.g., james-scott, urgent, team)",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r&&s.jsx("button",{onClick:()=>n(""),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:"Clear search",children:s.jsx(_t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsx("div",{className:"max-w-6xl mx-auto",children:o?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading tags..."})]}):m.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(sg,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tags yet"}),s.jsx("p",{className:"text-gray-600",children:"Tags will appear here when you add them to memos or group chat messages."})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(g=>s.jsxs("button",{onClick:()=>{const y=g.name===e?null:g.name;t(y),i(0)},className:`p-4 rounded-lg border-2 transition-all text-left ${e===g.name?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-semibold text-gray-900",children:g.name})]}),s.jsx("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded",children:g.count})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[g.count," ",g.count===1?"reference":"references"]})]},g.name))}),e&&s.jsx("div",{className:"mt-8",children:s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["#",e]}),s.jsxs("span",{className:"text-sm text-gray-500",children:["(",h.length," ",h.length===1?"reference":"references",")"]})]}),s.jsx("button",{onClick:()=>t(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(_t,{className:"w-5 h-5"})})]}),d?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Loading content..."})]}):h.length===0?s.jsx("p",{className:"text-center text-gray-500 py-8",children:"No content found with this tag."}):s.jsxs(s.Fragment,{children:[h.length>1&&s.jsxs("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-gray-200",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",a+1," of ",h.length]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:j,disabled:a===0,className:"p-2 text-blue-600 hover:bg-blue-50 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous",children:s.jsx(mi,{className:"w-5 h-5"})}),s.jsx("button",{onClick:f,disabled:a===h.length-1,className:"p-2 text-blue-600 hover:bg-blue-50 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Next",children:s.jsx(Yl,{className:"w-5 h-5"})})]})]}),p&&s.jsx("div",{children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:p.type==="memo"?s.jsx(Cc,{className:"w-6 h-6 text-yellow-600"}):p.type==="group_chat"?s.jsx(Ur,{className:"w-6 h-6 text-blue-600"}):s.jsx(mS,{className:"w-6 h-6 text-green-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-500 uppercase",children:p.type==="memo"?"@Memos":p.type==="group_chat"?"Group Chat":"Ticket"}),s.jsx("span",{className:"text-sm text-gray-400",children:""}),s.jsx("span",{className:"text-sm text-gray-500",children:new Date(p.created_at).toLocaleString()})]}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap mb-4",children:p.content}),p.tags&&s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:p.tags.split(",").map((g,y)=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-sm rounded",children:[s.jsx(Ot,{className:"w-3 h-3"}),g.trim()]},y))}),p.type==="memo"&&s.jsx(lt,{to:"/memos",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"View in @Memos "}),p.type==="group_chat"&&p.channel_id&&s.jsx(lt,{to:`/group-chat/${p.channel_id}`,className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"View in Group Chat "})]})]})})]})]})})]})})})]})}function $6(){const e=mt(),[t,r]=u.useState(!1),[n,a]=u.useState(!1),{data:i,isLoading:l}=he({queryKey:["tag-settings"],queryFn:async()=>({ai_auto_tagging_enabled:!0,tag_suggestions_enabled:!0,tag_display_position:"below"})}),[o,c]=u.useState({ai_auto_tagging_enabled:!0,tag_suggestions_enabled:!0,tag_display_position:"below"});Le.useEffect(()=>{i&&c(i)},[i]);const d=async()=>{r(!0);try{await new Promise(m=>setTimeout(m,500)),e.invalidateQueries({queryKey:["tag-settings"]}),a(!0),setTimeout(()=>a(!1),3e3)}catch(m){console.error("Error saving tag settings:",m),alert("Failed to save settings")}finally{r(!1)}};return l?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("div",{className:"text-gray-500",children:"Loading settings..."})}):s.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[s.jsxs("header",{className:"flex-shrink-0 bg-white border-b border-gray-200 px-6 py-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ot,{className:"w-6 h-6 text-blue-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Tags Settings"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Configure tagging behavior and display options"})]})]}),s.jsxs("button",{onClick:d,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(Jl,{className:"w-4 h-4"}),t?"Saving...":"Save Changes"]})]}),n&&s.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-800 text-sm",children:" Settings saved successfully"})]}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"McCarthy AI Auto-Tagging"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enable McCarthy AI to automatically tag tickets, Live Chat conversations, and Group Chat messages based on content analysis, sentiment, intent, and customer behavior (RFM)."}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 bg-blue-50 p-3 rounded-lg",children:[s.jsx(wm,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{children:"McCarthy AI analyzes content in real-time and suggests relevant tags. You can always manually add or remove tags."})]})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[s.jsx("input",{type:"checkbox",checked:o.ai_auto_tagging_enabled,onChange:m=>c({...o,ai_auto_tagging_enabled:m.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tag Suggestions"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Show tag suggestions while typing in Group Chat, Live Chat, and ticket notes. Suggestions are based on previously used tags and McCarthy AI recommendations."})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[s.jsx("input",{type:"checkbox",checked:o.tag_suggestions_enabled,onChange:m=>c({...o,tag_suggestions_enabled:m.target.checked}),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tag Display Position"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose how tags are displayed in messages and posts."}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[s.jsx("input",{type:"radio",name:"tag_display_position",value:"below",checked:o.tag_display_position==="below",onChange:()=>c({...o,tag_display_position:"below"}),className:"w-4 h-4 text-blue-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Below Message"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Tags appear as blue pills below the message content (recommended)"})]})]}),s.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[s.jsx("input",{type:"radio",name:"tag_display_position",value:"inline",checked:o.tag_display_position==="inline",onChange:()=>c({...o,tag_display_position:"inline"}),className:"w-4 h-4 text-blue-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Inline with Message"}),s.jsx("div",{className:"text-sm text-gray-500",children:"Tags appear within the message text as #keywords"})]})]})]})]})}),s.jsxs("div",{className:"bg-gray-100 rounded-lg border border-gray-300 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(wm,{className:"w-5 h-5"}),"Coming Soon"]}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Advanced tagging features currently in development:"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"AI Confidence Threshold:"})," Set minimum confidence level for auto-tagging"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Tag Categories:"})," Organize tags into predefined categories (Customer Type, Product, Issue Type, etc.)"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"RFM Integration:"})," Auto-tag VIP customers based on Recency, Frequency, Monetary analysis"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Shopify Integration:"})," Map product categories to tags and auto-tag based on purchase history"]})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-600",children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:"Tag Cleanup:"})," Auto-merge similar tags and archive unused ones"]})]})]})]})]})})]})}function L6(){const e=mt(),{user:t}=ws(),[r,n]=u.useState(""),[a,i]=u.useState(""),[l,o]=u.useState(!1),c=u.useRef(null),[d,m]=u.useState("Amazing Transfers"),[h,p]=u.useState("info@amazingtransfers.com.au"),[j,f]=u.useState("amazingtransfers.com"),{data:g,isLoading:y}=he({queryKey:["email-signature-settings"],queryFn:async()=>(await No.getSettings()).data});u.useEffect(()=>{g&&(i(g.logoUrl??""),m(g.companyName??"Amazing Transfers"),p(g.email??"info@amazingtransfers.com.au"),f(g.website??"amazingtransfers.com"))},[g]);const{data:b}=he({queryKey:["email-signature-preview",a,d,h,j],queryFn:async()=>(await No.getPreviewFromSettings({logoUrl:a,companyName:d,email:h,website:j})).data,enabled:!!d&&!!h});u.useEffect(()=>{b!=null&&b.signatureHtml&&n(b.signatureHtml)},[b]);const x=Ce({mutationFn:()=>No.saveSettings({logoUrl:a,companyName:d,email:h,website:j}),onSuccess:()=>{e.invalidateQueries({queryKey:["email-signature-settings"]}),e.invalidateQueries({queryKey:["email-signature-preview"]})}}),v=()=>{x.mutate()},w=async N=>{var F;const _=(F=N.target.files)==null?void 0:F[0];if(_){if(!_.type.startsWith("image/")){alert("Please upload an image file (PNG, JPG, etc.)");return}if(_.size>2*1024*1024){alert("Logo file size must be less than 2MB");return}o(!0);try{const R=new FileReader;R.onload=async()=>{const J=R.result,K=(await No.uploadLogo({name:_.name,data:J,type:_.type,size:_.size})).data.logoUrl;i(K),alert(`Logo uploaded successfully!

URL: ${K}

You can now use this URL in your signature template.`)},R.readAsDataURL(_)}catch(R){console.error("Logo upload failed:",R),alert("Failed to upload logo. Please try again.")}finally{o(!1),c.current&&(c.current.value="")}}};return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(tr,{className:"w-7 h-7"}),"Email Settings"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Configure email signature template for all staff members"})]}),y?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading settings..."})]}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(fi,{className:"w-5 h-5"}),"Signature Builder"]}),s.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsxs("h3",{className:"text-sm font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[s.jsx(Sc,{className:"w-4 h-4"}),"Company Logo"]}),s.jsx("p",{className:"text-xs text-blue-800 mb-3",children:"Upload your logo - it will be hosted on Cloudflare and automatically included in your signature."}),s.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:w,className:"hidden"}),s.jsxs("button",{onClick:()=>{var N;return(N=c.current)==null?void 0:N.click()},disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[s.jsx(Cb,{className:"w-4 h-4"}),l?"Uploading...":a?"Change Logo":"Upload Logo"]}),a&&s.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[s.jsx("img",{src:a,alt:"Logo",className:"w-16 h-16 object-contain border border-gray-300 rounded bg-white p-1"}),s.jsx("p",{className:"text-xs text-green-700",children:" Logo uploaded"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[s.jsx(xb,{className:"w-4 h-4"}),"Company Name"]}),s.jsx("input",{type:"text",value:d,onChange:N=>m(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Amazing Transfers"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[s.jsx(tr,{className:"w-4 h-4"}),"Email Address"]}),s.jsx("input",{type:"email",value:h,onChange:N=>p(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., info@amazingtransfers.com.au"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[s.jsx(Dh,{className:"w-4 h-4"}),"Website"]}),s.jsx("input",{type:"text",value:j,onChange:N=>f(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., amazingtransfers.com"})]}),s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-xs text-blue-700",children:[s.jsx("strong",{children:"Note:"})," Staff names and job titles are automatically pulled from their profile settings."]})})]}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("button",{onClick:v,disabled:x.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[s.jsx(Jl,{className:"w-5 h-5"}),x.isPending?"Saving...":"Save Signature"]}),x.isSuccess&&s.jsx("p",{className:"text-sm text-green-600 mt-2 text-center",children:" Signature saved successfully!"}),x.isError&&s.jsx("p",{className:"text-sm text-red-600 mt-2 text-center",children:" Failed to save signature."})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(j3,{className:"w-5 h-5"}),"Preview (Your Signature)"]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["This is how the signature will appear for ",s.jsxs("strong",{children:[t==null?void 0:t.firstName," ",t==null?void 0:t.lastName]})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:s.jsx("div",{dangerouslySetInnerHTML:{__html:r},className:"prose prose-sm max-w-none"})}),s.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:" How it works:"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:" Upload your company logo (stored on Cloudflare)"}),s.jsx("li",{children:" Set your company name, email, and website"}),s.jsx("li",{children:" Staff names and job titles are pulled from their profiles automatically"}),s.jsx("li",{children:" Signatures are auto-appended to all email ticket replies"}),s.jsx("li",{children:" Each staff member gets a personalized signature"})]})]})]})]})]})}function F6({children:e}){const{token:t}=ws();return t?s.jsx(s.Fragment,{children:e}):s.jsx(gy,{to:"/login",replace:!0})}function I6(){return s.jsx(ew,{children:s.jsxs(K1,{children:[s.jsx(Xe,{path:"/login",element:s.jsx(yk,{})}),s.jsxs(Xe,{path:"/",element:s.jsx(F6,{children:s.jsx(YS,{})}),children:[s.jsx(Xe,{index:!0,element:s.jsx(gy,{to:"/tickets",replace:!0})}),s.jsx(Xe,{path:"tickets",element:s.jsx(QC,{})}),s.jsx(Xe,{path:"tickets/:id",element:s.jsx(r6,{})}),s.jsx(Xe,{path:"mentions",element:s.jsx(n6,{})}),s.jsx(Xe,{path:"memo",element:s.jsx(a6,{})}),s.jsx(Xe,{path:"tags",element:s.jsx(P6,{})}),s.jsx(Xe,{path:"analytics/ai-agent",element:s.jsx(i6,{})}),s.jsx(Xe,{path:"settings",element:s.jsx(_6,{})}),s.jsx(Xe,{path:"settings/tags",element:s.jsx($6,{})}),s.jsx(Xe,{path:"settings/email",element:s.jsx(L6,{})}),s.jsx(Xe,{path:"settings/business-hours",element:s.jsx(o6,{})}),s.jsx(Xe,{path:"settings/chat-widget",element:s.jsx(c6,{})}),s.jsx(Xe,{path:"settings/chat-embed",element:s.jsx(p6,{})}),s.jsx(Xe,{path:"ai-agent/widget",element:s.jsx(y6,{})}),s.jsx(Xe,{path:"ai-agent/knowledge",element:s.jsx(v6,{})}),s.jsx(Xe,{path:"ai-agent/system-message",element:s.jsx(j6,{})}),s.jsx(Xe,{path:"ai-agent/regional-overrides",element:s.jsx(k6,{})}),s.jsx(Xe,{path:"settings/dartmouth-os",element:s.jsx(N6,{})}),s.jsx(Xe,{path:"settings/auto-assignment",element:s.jsx(S6,{})}),s.jsx(Xe,{path:"staff",element:s.jsx(d6,{})}),s.jsx(Xe,{path:"staff/performance",element:s.jsx(u6,{})}),s.jsx(Xe,{path:"chat",element:s.jsx(m6,{})}),s.jsx(Xe,{path:"chat-ticket/:id",element:s.jsx(x6,{})}),s.jsx(Xe,{path:"group-chat",element:s.jsx(A6,{})}),s.jsx(Xe,{path:"settings/group-chat",element:s.jsx(R6,{})}),s.jsx(Xe,{path:"integrations",element:s.jsx(M6,{})}),s.jsx(Xe,{path:"settings/integrations/shopify",element:s.jsx(T6,{})}),s.jsx(Xe,{path:"account",element:s.jsx(E6,{})})]})]})})}const O6=new Dj({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});Zd.createRoot(document.getElementById("root")).render(s.jsx(Le.StrictMode,{children:s.jsx(zj,{client:O6,children:s.jsx(I6,{})})}));
