var Gh=e=>{throw TypeError(e)};var ld=(e,s,r)=>s.has(e)||Gh("Cannot "+r);var C=(e,s,r)=>(ld(e,s,"read from private field"),r?r.call(e):s.get(e)),Se=(e,s,r)=>s.has(e)?Gh("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,r),ce=(e,s,r,n)=>(ld(e,s,"write to private field"),n?n.call(e,r):s.set(e,r),r),Ue=(e,s,r)=>(ld(e,s,"access private method"),r);var to=(e,s,r,n)=>({set _(a){ce(e,s,a,r)},get _(){return C(e,s,n)}});function Qb(e,s){for(var r=0;r<s.length;r++){const n=s[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function Rg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lg={exports:{}},Mc={},$g={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ol=Symbol.for("react.element"),Gb=Symbol.for("react.portal"),Yb=Symbol.for("react.fragment"),Jb=Symbol.for("react.strict_mode"),Xb=Symbol.for("react.profiler"),Zb=Symbol.for("react.provider"),ev=Symbol.for("react.context"),tv=Symbol.for("react.forward_ref"),sv=Symbol.for("react.suspense"),rv=Symbol.for("react.memo"),nv=Symbol.for("react.lazy"),Yh=Symbol.iterator;function av(e){return e===null||typeof e!="object"?null:(e=Yh&&e[Yh]||e["@@iterator"],typeof e=="function"?e:null)}var Fg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ig=Object.assign,Og={};function pi(e,s,r){this.props=e,this.context=s,this.refs=Og,this.updater=r||Fg}pi.prototype.isReactComponent={};pi.prototype.setState=function(e,s){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,s,"setState")};pi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Dg(){}Dg.prototype=pi.prototype;function _m(e,s,r){this.props=e,this.context=s,this.refs=Og,this.updater=r||Fg}var Em=_m.prototype=new Dg;Em.constructor=_m;Ig(Em,pi.prototype);Em.isPureReactComponent=!0;var Jh=Array.isArray,zg=Object.prototype.hasOwnProperty,Mm={current:null},Ug={key:!0,ref:!0,__self:!0,__source:!0};function Hg(e,s,r){var n,a={},i=null,l=null;if(s!=null)for(n in s.ref!==void 0&&(l=s.ref),s.key!==void 0&&(i=""+s.key),s)zg.call(s,n)&&!Ug.hasOwnProperty(n)&&(a[n]=s[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Ol,type:e,key:i,ref:l,props:a,_owner:Mm.current}}function iv(e,s){return{$$typeof:Ol,type:e.type,key:s,ref:e.ref,props:e.props,_owner:e._owner}}function Tm(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ol}function lv(e){var s={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return s[r]})}var Xh=/\/+/g;function od(e,s){return typeof e=="object"&&e!==null&&e.key!=null?lv(""+e.key):s.toString(36)}function Mo(e,s,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Ol:case Gb:l=!0}}if(l)return l=e,a=a(l),e=n===""?"."+od(l,0):n,Jh(a)?(r="",e!=null&&(r=e.replace(Xh,"$&/")+"/"),Mo(a,s,r,"",function(d){return d})):a!=null&&(Tm(a)&&(a=iv(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(Xh,"$&/")+"/")+e)),s.push(a)),1;if(l=0,n=n===""?".":n+":",Jh(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+od(i,o);l+=Mo(i,s,r,c,a)}else if(c=av(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+od(i,o++),l+=Mo(i,s,r,c,a);else if(i==="object")throw s=String(e),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return l}function so(e,s,r){if(e==null)return e;var n=[],a=0;return Mo(e,n,"","",function(i){return s.call(r,i,a++)}),n}function ov(e){if(e._status===-1){var s=e._result;s=s(),s.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=s)}if(e._status===1)return e._result.default;throw e._result}var ds={current:null},To={transition:null},cv={ReactCurrentDispatcher:ds,ReactCurrentBatchConfig:To,ReactCurrentOwner:Mm};function Bg(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:so,forEach:function(e,s,r){so(e,function(){s.apply(this,arguments)},r)},count:function(e){var s=0;return so(e,function(){s++}),s},toArray:function(e){return so(e,function(s){return s})||[]},only:function(e){if(!Tm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=pi;qe.Fragment=Yb;qe.Profiler=Xb;qe.PureComponent=_m;qe.StrictMode=Jb;qe.Suspense=sv;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cv;qe.act=Bg;qe.cloneElement=function(e,s,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ig({},e.props),a=e.key,i=e.ref,l=e._owner;if(s!=null){if(s.ref!==void 0&&(i=s.ref,l=Mm.current),s.key!==void 0&&(a=""+s.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in s)zg.call(s,c)&&!Ug.hasOwnProperty(c)&&(n[c]=s[c]===void 0&&o!==void 0?o[c]:s[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:Ol,type:e.type,key:a,ref:i,props:n,_owner:l}};qe.createContext=function(e){return e={$$typeof:ev,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Zb,_context:e},e.Consumer=e};qe.createElement=Hg;qe.createFactory=function(e){var s=Hg.bind(null,e);return s.type=e,s};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:tv,render:e}};qe.isValidElement=Tm;qe.lazy=function(e){return{$$typeof:nv,_payload:{_status:-1,_result:e},_init:ov}};qe.memo=function(e,s){return{$$typeof:rv,type:e,compare:s===void 0?null:s}};qe.startTransition=function(e){var s=To.transition;To.transition={};try{e()}finally{To.transition=s}};qe.unstable_act=Bg;qe.useCallback=function(e,s){return ds.current.useCallback(e,s)};qe.useContext=function(e){return ds.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return ds.current.useDeferredValue(e)};qe.useEffect=function(e,s){return ds.current.useEffect(e,s)};qe.useId=function(){return ds.current.useId()};qe.useImperativeHandle=function(e,s,r){return ds.current.useImperativeHandle(e,s,r)};qe.useInsertionEffect=function(e,s){return ds.current.useInsertionEffect(e,s)};qe.useLayoutEffect=function(e,s){return ds.current.useLayoutEffect(e,s)};qe.useMemo=function(e,s){return ds.current.useMemo(e,s)};qe.useReducer=function(e,s,r){return ds.current.useReducer(e,s,r)};qe.useRef=function(e){return ds.current.useRef(e)};qe.useState=function(e){return ds.current.useState(e)};qe.useSyncExternalStore=function(e,s,r){return ds.current.useSyncExternalStore(e,s,r)};qe.useTransition=function(){return ds.current.useTransition()};qe.version="18.3.1";$g.exports=qe;var m=$g.exports;const $e=Rg(m),si=Qb({__proto__:null,default:$e},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv=m,uv=Symbol.for("react.element"),mv=Symbol.for("react.fragment"),hv=Object.prototype.hasOwnProperty,xv=dv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gv={key:!0,ref:!0,__self:!0,__source:!0};function qg(e,s,r){var n,a={},i=null,l=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(l=s.ref);for(n in s)hv.call(s,n)&&!gv.hasOwnProperty(n)&&(a[n]=s[n]);if(e&&e.defaultProps)for(n in s=e.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:uv,type:e,key:i,ref:l,props:a,_owner:xv.current}}Mc.Fragment=mv;Mc.jsx=qg;Mc.jsxs=qg;Lg.exports=Mc;var t=Lg.exports,eu={},Wg={exports:{}},Ms={},Kg={exports:{}},Vg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function s(R,G){var K=R.length;R.push(G);e:for(;0<K;){var ee=K-1>>>1,ae=R[ee];if(0<a(ae,G))R[ee]=G,R[K]=ae,K=ee;else break e}}function r(R){return R.length===0?null:R[0]}function n(R){if(R.length===0)return null;var G=R[0],K=R.pop();if(K!==G){R[0]=K;e:for(var ee=0,ae=R.length,ne=ae>>>1;ee<ne;){var fe=2*(ee+1)-1,Le=R[fe],L=fe+1,ye=R[L];if(0>a(Le,K))L<ae&&0>a(ye,Le)?(R[ee]=ye,R[L]=K,ee=L):(R[ee]=Le,R[fe]=K,ee=fe);else if(L<ae&&0>a(ye,K))R[ee]=ye,R[L]=K,ee=L;else break e}}return G}function a(R,G){var K=R.sortIndex-G.sortIndex;return K!==0?K:R.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],d=[],h=1,u=null,p=3,j=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(R){for(var G=r(d);G!==null;){if(G.callback===null)n(d);else if(G.startTime<=R)n(d),G.sortIndex=G.expirationTime,s(c,G);else break;G=r(d)}}function w(R){if(g=!1,v(R),!x)if(r(c)!==null)x=!0,ke(N);else{var G=r(d);G!==null&&q(w,G.startTime-R)}}function N(R,G){x=!1,g&&(g=!1,b(E),E=-1),j=!0;var K=p;try{for(v(G),u=r(c);u!==null&&(!(u.expirationTime>G)||R&&!F());){var ee=u.callback;if(typeof ee=="function"){u.callback=null,p=u.priorityLevel;var ae=ee(u.expirationTime<=G);G=e.unstable_now(),typeof ae=="function"?u.callback=ae:u===r(c)&&n(c),v(G)}else n(c);u=r(c)}if(u!==null)var ne=!0;else{var fe=r(d);fe!==null&&q(w,fe.startTime-G),ne=!1}return ne}finally{u=null,p=K,j=!1}}var P=!1,z=null,E=-1,X=5,T=-1;function F(){return!(e.unstable_now()-T<X)}function Q(){if(z!==null){var R=e.unstable_now();T=R;var G=!0;try{G=z(!0,R)}finally{G?Z():(P=!1,z=null)}}else P=!1}var Z;if(typeof f=="function")Z=function(){f(Q)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,ve=xe.port2;xe.port1.onmessage=Q,Z=function(){ve.postMessage(null)}}else Z=function(){y(Q,0)};function ke(R){z=R,P||(P=!0,Z())}function q(R,G){E=y(function(){R(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){x||j||(x=!0,ke(N))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(R){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var K=p;p=G;try{return R()}finally{p=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,G){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var K=p;p=R;try{return G()}finally{p=K}},e.unstable_scheduleCallback=function(R,G,K){var ee=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ee+K:ee):K=ee,R){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=K+ae,R={id:h++,callback:G,priorityLevel:R,startTime:K,expirationTime:ae,sortIndex:-1},K>ee?(R.sortIndex=K,s(d,R),r(c)===null&&R===r(d)&&(g?(b(E),E=-1):g=!0,q(w,K-ee))):(R.sortIndex=ae,s(c,R),x||j||(x=!0,ke(N))),R},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(R){var G=p;return function(){var K=p;p=G;try{return R.apply(this,arguments)}finally{p=K}}}})(Vg);Kg.exports=Vg;var fv=Kg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pv=m,Es=fv;function te(e){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Qg=new Set,ul={};function fa(e,s){ri(e,s),ri(e+"Capture",s)}function ri(e,s){for(ul[e]=s,e=0;e<s.length;e++)Qg.add(s[e])}var Or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tu=Object.prototype.hasOwnProperty,yv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zh={},e0={};function bv(e){return tu.call(e0,e)?!0:tu.call(Zh,e)?!1:yv.test(e)?e0[e]=!0:(Zh[e]=!0,!1)}function vv(e,s,r,n){if(r!==null&&r.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function jv(e,s,r,n){if(s===null||typeof s>"u"||vv(e,s,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function us(e,s,r,n,a,i,l){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=s,this.sanitizeURL=i,this.removeEmptyString=l}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Vt[e]=new us(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var s=e[0];Vt[s]=new us(s,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Vt[e]=new us(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Vt[e]=new us(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Vt[e]=new us(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Vt[e]=new us(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Vt[e]=new us(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Vt[e]=new us(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Vt[e]=new us(e,5,!1,e.toLowerCase(),null,!1,!1)});var Am=/[\-:]([a-z])/g;function Pm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var s=e.replace(Am,Pm);Vt[s]=new us(s,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var s=e.replace(Am,Pm);Vt[s]=new us(s,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var s=e.replace(Am,Pm);Vt[s]=new us(s,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Vt[e]=new us(e,1,!1,e.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new us("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Vt[e]=new us(e,1,!1,e.toLowerCase(),null,!0,!0)});function Rm(e,s,r,n){var a=Vt.hasOwnProperty(s)?Vt[s]:null;(a!==null?a.type!==0:n||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(jv(s,r,a,n)&&(r=null),n||a===null?bv(s)&&(r===null?e.removeAttribute(s):e.setAttribute(s,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(s=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(s):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,s,r):e.setAttribute(s,r))))}var Br=pv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ro=Symbol.for("react.element"),Ca=Symbol.for("react.portal"),_a=Symbol.for("react.fragment"),Lm=Symbol.for("react.strict_mode"),su=Symbol.for("react.profiler"),Gg=Symbol.for("react.provider"),Yg=Symbol.for("react.context"),$m=Symbol.for("react.forward_ref"),ru=Symbol.for("react.suspense"),nu=Symbol.for("react.suspense_list"),Fm=Symbol.for("react.memo"),Xr=Symbol.for("react.lazy"),Jg=Symbol.for("react.offscreen"),t0=Symbol.iterator;function Mi(e){return e===null||typeof e!="object"?null:(e=t0&&e[t0]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,cd;function qi(e){if(cd===void 0)try{throw Error()}catch(r){var s=r.stack.trim().match(/\n( *(at )?)/);cd=s&&s[1]||""}return`
`+cd+e}var dd=!1;function ud(e,s){if(!e||dd)return"";dd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(d){var n=d}Reflect.construct(e,[],s)}else{try{s.call()}catch(d){n=d}e.call(s.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{dd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qi(e):""}function wv(e){switch(e.tag){case 5:return qi(e.type);case 16:return qi("Lazy");case 13:return qi("Suspense");case 19:return qi("SuspenseList");case 0:case 2:case 15:return e=ud(e.type,!1),e;case 11:return e=ud(e.type.render,!1),e;case 1:return e=ud(e.type,!0),e;default:return""}}function au(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _a:return"Fragment";case Ca:return"Portal";case su:return"Profiler";case Lm:return"StrictMode";case ru:return"Suspense";case nu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Yg:return(e.displayName||"Context")+".Consumer";case Gg:return(e._context.displayName||"Context")+".Provider";case $m:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Fm:return s=e.displayName||null,s!==null?s:au(e.type)||"Memo";case Xr:s=e._payload,e=e._init;try{return au(e(s))}catch{}}return null}function Nv(e){var s=e.type;switch(e.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=s.render,e=e.displayName||e.name||"",s.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return au(s);case 8:return s===Lm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Mn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Xg(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function kv(e){var s=Xg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),n=""+e[s];if(!e.hasOwnProperty(s)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return a.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,s,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function no(e){e._valueTracker||(e._valueTracker=kv(e))}function Zg(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var r=s.getValue(),n="";return e&&(n=Xg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(s.setValue(e),!0):!1}function Qo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function iu(e,s){var r=s.checked;return pt({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function s0(e,s){var r=s.defaultValue==null?"":s.defaultValue,n=s.checked!=null?s.checked:s.defaultChecked;r=Mn(s.value!=null?s.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ef(e,s){s=s.checked,s!=null&&Rm(e,"checked",s,!1)}function lu(e,s){ef(e,s);var r=Mn(s.value),n=s.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}s.hasOwnProperty("value")?ou(e,s.type,r):s.hasOwnProperty("defaultValue")&&ou(e,s.type,Mn(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(e.defaultChecked=!!s.defaultChecked)}function r0(e,s,r){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var n=s.type;if(!(n!=="submit"&&n!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+e._wrapperState.initialValue,r||s===e.value||(e.value=s),e.defaultValue=s}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ou(e,s,r){(s!=="number"||Qo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Wi=Array.isArray;function Oa(e,s,r,n){if(e=e.options,s){s={};for(var a=0;a<r.length;a++)s["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=s.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Mn(r),s=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}s!==null||e[a].disabled||(s=e[a])}s!==null&&(s.selected=!0)}}function cu(e,s){if(s.dangerouslySetInnerHTML!=null)throw Error(te(91));return pt({},s,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function n0(e,s){var r=s.value;if(r==null){if(r=s.children,s=s.defaultValue,r!=null){if(s!=null)throw Error(te(92));if(Wi(r)){if(1<r.length)throw Error(te(93));r=r[0]}s=r}s==null&&(s=""),r=s}e._wrapperState={initialValue:Mn(r)}}function tf(e,s){var r=Mn(s.value),n=Mn(s.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),s.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function a0(e){var s=e.textContent;s===e._wrapperState.initialValue&&s!==""&&s!==null&&(e.value=s)}function sf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function du(e,s){return e==null||e==="http://www.w3.org/1999/xhtml"?sf(s):e==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ao,rf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(s,r,n,a)})}:e}(function(e,s){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=s;else{for(ao=ao||document.createElement("div"),ao.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=ao.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;s.firstChild;)e.appendChild(s.firstChild)}});function ml(e,s){if(s){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=s;return}}e.textContent=s}var Zi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sv=["Webkit","ms","Moz","O"];Object.keys(Zi).forEach(function(e){Sv.forEach(function(s){s=s+e.charAt(0).toUpperCase()+e.substring(1),Zi[s]=Zi[e]})});function nf(e,s,r){return s==null||typeof s=="boolean"||s===""?"":r||typeof s!="number"||s===0||Zi.hasOwnProperty(e)&&Zi[e]?(""+s).trim():s+"px"}function af(e,s){e=e.style;for(var r in s)if(s.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=nf(r,s[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Cv=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uu(e,s){if(s){if(Cv[e]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(te(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(te(61))}if(s.style!=null&&typeof s.style!="object")throw Error(te(62))}}function mu(e,s){if(e.indexOf("-")===-1)return typeof s.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hu=null;function Im(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xu=null,Da=null,za=null;function i0(e){if(e=Ul(e)){if(typeof xu!="function")throw Error(te(280));var s=e.stateNode;s&&(s=Lc(s),xu(e.stateNode,e.type,s))}}function lf(e){Da?za?za.push(e):za=[e]:Da=e}function of(){if(Da){var e=Da,s=za;if(za=Da=null,i0(e),s)for(e=0;e<s.length;e++)i0(s[e])}}function cf(e,s){return e(s)}function df(){}var md=!1;function uf(e,s,r){if(md)return e(s,r);md=!0;try{return cf(e,s,r)}finally{md=!1,(Da!==null||za!==null)&&(df(),of())}}function hl(e,s){var r=e.stateNode;if(r===null)return null;var n=Lc(r);if(n===null)return null;r=n[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,s,typeof r));return r}var gu=!1;if(Or)try{var Ti={};Object.defineProperty(Ti,"passive",{get:function(){gu=!0}}),window.addEventListener("test",Ti,Ti),window.removeEventListener("test",Ti,Ti)}catch{gu=!1}function _v(e,s,r,n,a,i,l,o,c){var d=Array.prototype.slice.call(arguments,3);try{s.apply(r,d)}catch(h){this.onError(h)}}var el=!1,Go=null,Yo=!1,fu=null,Ev={onError:function(e){el=!0,Go=e}};function Mv(e,s,r,n,a,i,l,o,c){el=!1,Go=null,_v.apply(Ev,arguments)}function Tv(e,s,r,n,a,i,l,o,c){if(Mv.apply(this,arguments),el){if(el){var d=Go;el=!1,Go=null}else throw Error(te(198));Yo||(Yo=!0,fu=d)}}function pa(e){var s=e,r=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,s.flags&4098&&(r=s.return),e=s.return;while(e)}return s.tag===3?r:null}function mf(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function l0(e){if(pa(e)!==e)throw Error(te(188))}function Av(e){var s=e.alternate;if(!s){if(s=pa(e),s===null)throw Error(te(188));return s!==e?null:e}for(var r=e,n=s;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return l0(a),e;if(i===n)return l0(a),s;i=i.sibling}throw Error(te(188))}if(r.return!==n.return)r=a,n=i;else{for(var l=!1,o=a.child;o;){if(o===r){l=!0,r=a,n=i;break}if(o===n){l=!0,n=a,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=a;break}if(o===n){l=!0,n=i,r=a;break}o=o.sibling}if(!l)throw Error(te(189))}}if(r.alternate!==n)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:s}function hf(e){return e=Av(e),e!==null?xf(e):null}function xf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var s=xf(e);if(s!==null)return s;e=e.sibling}return null}var gf=Es.unstable_scheduleCallback,o0=Es.unstable_cancelCallback,Pv=Es.unstable_shouldYield,Rv=Es.unstable_requestPaint,jt=Es.unstable_now,Lv=Es.unstable_getCurrentPriorityLevel,Om=Es.unstable_ImmediatePriority,ff=Es.unstable_UserBlockingPriority,Jo=Es.unstable_NormalPriority,$v=Es.unstable_LowPriority,pf=Es.unstable_IdlePriority,Tc=null,fr=null;function Fv(e){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(Tc,e,void 0,(e.current.flags&128)===128)}catch{}}var Js=Math.clz32?Math.clz32:Dv,Iv=Math.log,Ov=Math.LN2;function Dv(e){return e>>>=0,e===0?32:31-(Iv(e)/Ov|0)|0}var io=64,lo=4194304;function Ki(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xo(e,s){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~a;o!==0?n=Ki(o):(i&=l,i!==0&&(n=Ki(i)))}else l=r&~a,l!==0?n=Ki(l):i!==0&&(n=Ki(i));if(n===0)return 0;if(s!==0&&s!==n&&!(s&a)&&(a=n&-n,i=s&-s,a>=i||a===16&&(i&4194240)!==0))return s;if(n&4&&(n|=r&16),s=e.entangledLanes,s!==0)for(e=e.entanglements,s&=n;0<s;)r=31-Js(s),a=1<<r,n|=e[r],s&=~a;return n}function zv(e,s){switch(e){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uv(e,s){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Js(i),o=1<<l,c=a[l];c===-1?(!(o&r)||o&n)&&(a[l]=zv(o,s)):c<=s&&(e.expiredLanes|=o),i&=~o}}function pu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yf(){var e=io;return io<<=1,!(io&4194240)&&(io=64),e}function hd(e){for(var s=[],r=0;31>r;r++)s.push(e);return s}function Dl(e,s,r){e.pendingLanes|=s,s!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,s=31-Js(s),e[s]=r}function Hv(e,s){var r=e.pendingLanes&~s;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=s,e.mutableReadLanes&=s,e.entangledLanes&=s,s=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Js(r),i=1<<a;s[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Dm(e,s){var r=e.entangledLanes|=s;for(e=e.entanglements;r;){var n=31-Js(r),a=1<<n;a&s|e[n]&s&&(e[n]|=s),r&=~a}}var nt=0;function bf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vf,zm,jf,wf,Nf,yu=!1,oo=[],yn=null,bn=null,vn=null,xl=new Map,gl=new Map,en=[],Bv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function c0(e,s){switch(e){case"focusin":case"focusout":yn=null;break;case"dragenter":case"dragleave":bn=null;break;case"mouseover":case"mouseout":vn=null;break;case"pointerover":case"pointerout":xl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":gl.delete(s.pointerId)}}function Ai(e,s,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:s,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},s!==null&&(s=Ul(s),s!==null&&zm(s)),e):(e.eventSystemFlags|=n,s=e.targetContainers,a!==null&&s.indexOf(a)===-1&&s.push(a),e)}function qv(e,s,r,n,a){switch(s){case"focusin":return yn=Ai(yn,e,s,r,n,a),!0;case"dragenter":return bn=Ai(bn,e,s,r,n,a),!0;case"mouseover":return vn=Ai(vn,e,s,r,n,a),!0;case"pointerover":var i=a.pointerId;return xl.set(i,Ai(xl.get(i)||null,e,s,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,gl.set(i,Ai(gl.get(i)||null,e,s,r,n,a)),!0}return!1}function kf(e){var s=Bn(e.target);if(s!==null){var r=pa(s);if(r!==null){if(s=r.tag,s===13){if(s=mf(r),s!==null){e.blockedOn=s,Nf(e.priority,function(){jf(r)});return}}else if(s===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ao(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var r=bu(e.domEventName,e.eventSystemFlags,s[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);hu=n,r.target.dispatchEvent(n),hu=null}else return s=Ul(r),s!==null&&zm(s),e.blockedOn=r,!1;s.shift()}return!0}function d0(e,s,r){Ao(e)&&r.delete(s)}function Wv(){yu=!1,yn!==null&&Ao(yn)&&(yn=null),bn!==null&&Ao(bn)&&(bn=null),vn!==null&&Ao(vn)&&(vn=null),xl.forEach(d0),gl.forEach(d0)}function Pi(e,s){e.blockedOn===s&&(e.blockedOn=null,yu||(yu=!0,Es.unstable_scheduleCallback(Es.unstable_NormalPriority,Wv)))}function fl(e){function s(a){return Pi(a,e)}if(0<oo.length){Pi(oo[0],e);for(var r=1;r<oo.length;r++){var n=oo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(yn!==null&&Pi(yn,e),bn!==null&&Pi(bn,e),vn!==null&&Pi(vn,e),xl.forEach(s),gl.forEach(s),r=0;r<en.length;r++)n=en[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<en.length&&(r=en[0],r.blockedOn===null);)kf(r),r.blockedOn===null&&en.shift()}var Ua=Br.ReactCurrentBatchConfig,Zo=!0;function Kv(e,s,r,n){var a=nt,i=Ua.transition;Ua.transition=null;try{nt=1,Um(e,s,r,n)}finally{nt=a,Ua.transition=i}}function Vv(e,s,r,n){var a=nt,i=Ua.transition;Ua.transition=null;try{nt=4,Um(e,s,r,n)}finally{nt=a,Ua.transition=i}}function Um(e,s,r,n){if(Zo){var a=bu(e,s,r,n);if(a===null)Nd(e,s,n,ec,r),c0(e,n);else if(qv(a,e,s,r,n))n.stopPropagation();else if(c0(e,n),s&4&&-1<Bv.indexOf(e)){for(;a!==null;){var i=Ul(a);if(i!==null&&vf(i),i=bu(e,s,r,n),i===null&&Nd(e,s,n,ec,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Nd(e,s,n,null,r)}}var ec=null;function bu(e,s,r,n){if(ec=null,e=Im(n),e=Bn(e),e!==null)if(s=pa(e),s===null)e=null;else if(r=s.tag,r===13){if(e=mf(s),e!==null)return e;e=null}else if(r===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null);return ec=e,null}function Sf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Lv()){case Om:return 1;case ff:return 4;case Jo:case $v:return 16;case pf:return 536870912;default:return 16}default:return 16}}var hn=null,Hm=null,Po=null;function Cf(){if(Po)return Po;var e,s=Hm,r=s.length,n,a="value"in hn?hn.value:hn.textContent,i=a.length;for(e=0;e<r&&s[e]===a[e];e++);var l=r-e;for(n=1;n<=l&&s[r-n]===a[i-n];n++);return Po=a.slice(e,1<n?1-n:void 0)}function Ro(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function co(){return!0}function u0(){return!1}function Ts(e){function s(r,n,a,i,l){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?co:u0,this.isPropagationStopped=u0,this}return pt(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=co)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=co)},persist:function(){},isPersistent:co}),s}var yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bm=Ts(yi),zl=pt({},yi,{view:0,detail:0}),Qv=Ts(zl),xd,gd,Ri,Ac=pt({},zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ri&&(Ri&&e.type==="mousemove"?(xd=e.screenX-Ri.screenX,gd=e.screenY-Ri.screenY):gd=xd=0,Ri=e),xd)},movementY:function(e){return"movementY"in e?e.movementY:gd}}),m0=Ts(Ac),Gv=pt({},Ac,{dataTransfer:0}),Yv=Ts(Gv),Jv=pt({},zl,{relatedTarget:0}),fd=Ts(Jv),Xv=pt({},yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Zv=Ts(Xv),ej=pt({},yi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),tj=Ts(ej),sj=pt({},yi,{data:0}),h0=Ts(sj),rj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ij(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=aj[e])?!!s[e]:!1}function qm(){return ij}var lj=pt({},zl,{key:function(e){if(e.key){var s=rj[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=Ro(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?nj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qm,charCode:function(e){return e.type==="keypress"?Ro(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ro(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),oj=Ts(lj),cj=pt({},Ac,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x0=Ts(cj),dj=pt({},zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qm}),uj=Ts(dj),mj=pt({},yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),hj=Ts(mj),xj=pt({},Ac,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),gj=Ts(xj),fj=[9,13,27,32],Wm=Or&&"CompositionEvent"in window,tl=null;Or&&"documentMode"in document&&(tl=document.documentMode);var pj=Or&&"TextEvent"in window&&!tl,_f=Or&&(!Wm||tl&&8<tl&&11>=tl),g0=" ",f0=!1;function Ef(e,s){switch(e){case"keyup":return fj.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ea=!1;function yj(e,s){switch(e){case"compositionend":return Mf(s);case"keypress":return s.which!==32?null:(f0=!0,g0);case"textInput":return e=s.data,e===g0&&f0?null:e;default:return null}}function bj(e,s){if(Ea)return e==="compositionend"||!Wm&&Ef(e,s)?(e=Cf(),Po=Hm=hn=null,Ea=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return _f&&s.locale!=="ko"?null:s.data;default:return null}}var vj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p0(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!vj[e.type]:s==="textarea"}function Tf(e,s,r,n){lf(n),s=tc(s,"onChange"),0<s.length&&(r=new Bm("onChange","change",null,r,n),e.push({event:r,listeners:s}))}var sl=null,pl=null;function jj(e){Uf(e,0)}function Pc(e){var s=Aa(e);if(Zg(s))return e}function wj(e,s){if(e==="change")return s}var Af=!1;if(Or){var pd;if(Or){var yd="oninput"in document;if(!yd){var y0=document.createElement("div");y0.setAttribute("oninput","return;"),yd=typeof y0.oninput=="function"}pd=yd}else pd=!1;Af=pd&&(!document.documentMode||9<document.documentMode)}function b0(){sl&&(sl.detachEvent("onpropertychange",Pf),pl=sl=null)}function Pf(e){if(e.propertyName==="value"&&Pc(pl)){var s=[];Tf(s,pl,e,Im(e)),uf(jj,s)}}function Nj(e,s,r){e==="focusin"?(b0(),sl=s,pl=r,sl.attachEvent("onpropertychange",Pf)):e==="focusout"&&b0()}function kj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Pc(pl)}function Sj(e,s){if(e==="click")return Pc(s)}function Cj(e,s){if(e==="input"||e==="change")return Pc(s)}function _j(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var er=typeof Object.is=="function"?Object.is:_j;function yl(e,s){if(er(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var r=Object.keys(e),n=Object.keys(s);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!tu.call(s,a)||!er(e[a],s[a]))return!1}return!0}function v0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function j0(e,s){var r=v0(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=s&&n>=s)return{node:r,offset:s-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=v0(r)}}function Rf(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?Rf(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function Lf(){for(var e=window,s=Qo();s instanceof e.HTMLIFrameElement;){try{var r=typeof s.contentWindow.location.href=="string"}catch{r=!1}if(r)e=s.contentWindow;else break;s=Qo(e.document)}return s}function Km(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}function Ej(e){var s=Lf(),r=e.focusedElem,n=e.selectionRange;if(s!==r&&r&&r.ownerDocument&&Rf(r.ownerDocument.documentElement,r)){if(n!==null&&Km(r)){if(s=n.start,e=n.end,e===void 0&&(e=s),"selectionStart"in r)r.selectionStart=s,r.selectionEnd=Math.min(e,r.value.length);else if(e=(s=r.ownerDocument||document)&&s.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=j0(r,i);var l=j0(r,n);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(s=s.createRange(),s.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(s),e.extend(l.node,l.offset)):(s.setEnd(l.node,l.offset),e.addRange(s)))}}for(s=[],e=r;e=e.parentNode;)e.nodeType===1&&s.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<s.length;r++)e=s[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Mj=Or&&"documentMode"in document&&11>=document.documentMode,Ma=null,vu=null,rl=null,ju=!1;function w0(e,s,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ju||Ma==null||Ma!==Qo(n)||(n=Ma,"selectionStart"in n&&Km(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),rl&&yl(rl,n)||(rl=n,n=tc(vu,"onSelect"),0<n.length&&(s=new Bm("onSelect","select",null,s,r),e.push({event:s,listeners:n}),s.target=Ma)))}function uo(e,s){var r={};return r[e.toLowerCase()]=s.toLowerCase(),r["Webkit"+e]="webkit"+s,r["Moz"+e]="moz"+s,r}var Ta={animationend:uo("Animation","AnimationEnd"),animationiteration:uo("Animation","AnimationIteration"),animationstart:uo("Animation","AnimationStart"),transitionend:uo("Transition","TransitionEnd")},bd={},$f={};Or&&($f=document.createElement("div").style,"AnimationEvent"in window||(delete Ta.animationend.animation,delete Ta.animationiteration.animation,delete Ta.animationstart.animation),"TransitionEvent"in window||delete Ta.transitionend.transition);function Rc(e){if(bd[e])return bd[e];if(!Ta[e])return e;var s=Ta[e],r;for(r in s)if(s.hasOwnProperty(r)&&r in $f)return bd[e]=s[r];return e}var Ff=Rc("animationend"),If=Rc("animationiteration"),Of=Rc("animationstart"),Df=Rc("transitionend"),zf=new Map,N0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function An(e,s){zf.set(e,s),fa(s,[e])}for(var vd=0;vd<N0.length;vd++){var jd=N0[vd],Tj=jd.toLowerCase(),Aj=jd[0].toUpperCase()+jd.slice(1);An(Tj,"on"+Aj)}An(Ff,"onAnimationEnd");An(If,"onAnimationIteration");An(Of,"onAnimationStart");An("dblclick","onDoubleClick");An("focusin","onFocus");An("focusout","onBlur");An(Df,"onTransitionEnd");ri("onMouseEnter",["mouseout","mouseover"]);ri("onMouseLeave",["mouseout","mouseover"]);ri("onPointerEnter",["pointerout","pointerover"]);ri("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vi));function k0(e,s,r){var n=e.type||"unknown-event";e.currentTarget=r,Tv(n,s,void 0,e),e.currentTarget=null}function Uf(e,s){s=(s&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(s)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;k0(a,o,d),i=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;k0(a,o,d),i=c}}}if(Yo)throw e=fu,Yo=!1,fu=null,e}function ut(e,s){var r=s[Cu];r===void 0&&(r=s[Cu]=new Set);var n=e+"__bubble";r.has(n)||(Hf(s,e,2,!1),r.add(n))}function wd(e,s,r){var n=0;s&&(n|=4),Hf(r,e,n,s)}var mo="_reactListening"+Math.random().toString(36).slice(2);function bl(e){if(!e[mo]){e[mo]=!0,Qg.forEach(function(r){r!=="selectionchange"&&(Pj.has(r)||wd(r,!1,e),wd(r,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[mo]||(s[mo]=!0,wd("selectionchange",!1,s))}}function Hf(e,s,r,n){switch(Sf(s)){case 1:var a=Kv;break;case 4:a=Vv;break;default:a=Um}r=a.bind(null,s,r,e),a=void 0,!gu||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(s,r,{capture:!0,passive:a}):e.addEventListener(s,r,!0):a!==void 0?e.addEventListener(s,r,{passive:a}):e.addEventListener(s,r,!1)}function Nd(e,s,r,n,a){var i=n;if(!(s&1)&&!(s&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=Bn(o),l===null)return;if(c=l.tag,c===5||c===6){n=i=l;continue e}o=o.parentNode}}n=n.return}uf(function(){var d=i,h=Im(r),u=[];e:{var p=zf.get(e);if(p!==void 0){var j=Bm,x=e;switch(e){case"keypress":if(Ro(r)===0)break e;case"keydown":case"keyup":j=oj;break;case"focusin":x="focus",j=fd;break;case"focusout":x="blur",j=fd;break;case"beforeblur":case"afterblur":j=fd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=m0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=Yv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=uj;break;case Ff:case If:case Of:j=Zv;break;case Df:j=hj;break;case"scroll":j=Qv;break;case"wheel":j=gj;break;case"copy":case"cut":case"paste":j=tj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=x0}var g=(s&4)!==0,y=!g&&e==="scroll",b=g?p!==null?p+"Capture":null:p;g=[];for(var f=d,v;f!==null;){v=f;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,b!==null&&(w=hl(f,b),w!=null&&g.push(vl(f,w,v)))),y)break;f=f.return}0<g.length&&(p=new j(p,x,null,r,h),u.push({event:p,listeners:g}))}}if(!(s&7)){e:{if(p=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",p&&r!==hu&&(x=r.relatedTarget||r.fromElement)&&(Bn(x)||x[Dr]))break e;if((j||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,j?(x=r.relatedTarget||r.toElement,j=d,x=x?Bn(x):null,x!==null&&(y=pa(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(j=null,x=d),j!==x)){if(g=m0,w="onMouseLeave",b="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(g=x0,w="onPointerLeave",b="onPointerEnter",f="pointer"),y=j==null?p:Aa(j),v=x==null?p:Aa(x),p=new g(w,f+"leave",j,r,h),p.target=y,p.relatedTarget=v,w=null,Bn(h)===d&&(g=new g(b,f+"enter",x,r,h),g.target=v,g.relatedTarget=y,w=g),y=w,j&&x)t:{for(g=j,b=x,f=0,v=g;v;v=Na(v))f++;for(v=0,w=b;w;w=Na(w))v++;for(;0<f-v;)g=Na(g),f--;for(;0<v-f;)b=Na(b),v--;for(;f--;){if(g===b||b!==null&&g===b.alternate)break t;g=Na(g),b=Na(b)}g=null}else g=null;j!==null&&S0(u,p,j,g,!1),x!==null&&y!==null&&S0(u,y,x,g,!0)}}e:{if(p=d?Aa(d):window,j=p.nodeName&&p.nodeName.toLowerCase(),j==="select"||j==="input"&&p.type==="file")var N=wj;else if(p0(p))if(Af)N=Cj;else{N=kj;var P=Nj}else(j=p.nodeName)&&j.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=Sj);if(N&&(N=N(e,d))){Tf(u,N,r,h);break e}P&&P(e,p,d),e==="focusout"&&(P=p._wrapperState)&&P.controlled&&p.type==="number"&&ou(p,"number",p.value)}switch(P=d?Aa(d):window,e){case"focusin":(p0(P)||P.contentEditable==="true")&&(Ma=P,vu=d,rl=null);break;case"focusout":rl=vu=Ma=null;break;case"mousedown":ju=!0;break;case"contextmenu":case"mouseup":case"dragend":ju=!1,w0(u,r,h);break;case"selectionchange":if(Mj)break;case"keydown":case"keyup":w0(u,r,h)}var z;if(Wm)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ea?Ef(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(_f&&r.locale!=="ko"&&(Ea||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ea&&(z=Cf()):(hn=h,Hm="value"in hn?hn.value:hn.textContent,Ea=!0)),P=tc(d,E),0<P.length&&(E=new h0(E,e,null,r,h),u.push({event:E,listeners:P}),z?E.data=z:(z=Mf(r),z!==null&&(E.data=z)))),(z=pj?yj(e,r):bj(e,r))&&(d=tc(d,"onBeforeInput"),0<d.length&&(h=new h0("onBeforeInput","beforeinput",null,r,h),u.push({event:h,listeners:d}),h.data=z))}Uf(u,s)})}function vl(e,s,r){return{instance:e,listener:s,currentTarget:r}}function tc(e,s){for(var r=s+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=hl(e,r),i!=null&&n.unshift(vl(e,i,a)),i=hl(e,s),i!=null&&n.push(vl(e,i,a))),e=e.return}return n}function Na(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function S0(e,s,r,n,a){for(var i=s._reactName,l=[];r!==null&&r!==n;){var o=r,c=o.alternate,d=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&d!==null&&(o=d,a?(c=hl(r,i),c!=null&&l.unshift(vl(r,c,o))):a||(c=hl(r,i),c!=null&&l.push(vl(r,c,o)))),r=r.return}l.length!==0&&e.push({event:s,listeners:l})}var Rj=/\r\n?/g,Lj=/\u0000|\uFFFD/g;function C0(e){return(typeof e=="string"?e:""+e).replace(Rj,`
`).replace(Lj,"")}function ho(e,s,r){if(s=C0(s),C0(e)!==s&&r)throw Error(te(425))}function sc(){}var wu=null,Nu=null;function ku(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Su=typeof setTimeout=="function"?setTimeout:void 0,$j=typeof clearTimeout=="function"?clearTimeout:void 0,_0=typeof Promise=="function"?Promise:void 0,Fj=typeof queueMicrotask=="function"?queueMicrotask:typeof _0<"u"?function(e){return _0.resolve(null).then(e).catch(Ij)}:Su;function Ij(e){setTimeout(function(){throw e})}function kd(e,s){var r=s,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),fl(s);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);fl(s)}function jn(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return e}function E0(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(s===0)return e;s--}else r==="/$"&&s++}e=e.previousSibling}return null}var bi=Math.random().toString(36).slice(2),xr="__reactFiber$"+bi,jl="__reactProps$"+bi,Dr="__reactContainer$"+bi,Cu="__reactEvents$"+bi,Oj="__reactListeners$"+bi,Dj="__reactHandles$"+bi;function Bn(e){var s=e[xr];if(s)return s;for(var r=e.parentNode;r;){if(s=r[Dr]||r[xr]){if(r=s.alternate,s.child!==null||r!==null&&r.child!==null)for(e=E0(e);e!==null;){if(r=e[xr])return r;e=E0(e)}return s}e=r,r=e.parentNode}return null}function Ul(e){return e=e[xr]||e[Dr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Aa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function Lc(e){return e[jl]||null}var _u=[],Pa=-1;function Pn(e){return{current:e}}function mt(e){0>Pa||(e.current=_u[Pa],_u[Pa]=null,Pa--)}function ot(e,s){Pa++,_u[Pa]=e.current,e.current=s}var Tn={},es=Pn(Tn),ys=Pn(!1),la=Tn;function ni(e,s){var r=e.type.contextTypes;if(!r)return Tn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===s)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=s[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),a}function bs(e){return e=e.childContextTypes,e!=null}function rc(){mt(ys),mt(es)}function M0(e,s,r){if(es.current!==Tn)throw Error(te(168));ot(es,s),ot(ys,r)}function Bf(e,s,r){var n=e.stateNode;if(s=s.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in s))throw Error(te(108,Nv(e)||"Unknown",a));return pt({},r,n)}function nc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Tn,la=es.current,ot(es,e),ot(ys,ys.current),!0}function T0(e,s,r){var n=e.stateNode;if(!n)throw Error(te(169));r?(e=Bf(e,s,la),n.__reactInternalMemoizedMergedChildContext=e,mt(ys),mt(es),ot(es,e)):mt(ys),ot(ys,r)}var Sr=null,$c=!1,Sd=!1;function qf(e){Sr===null?Sr=[e]:Sr.push(e)}function zj(e){$c=!0,qf(e)}function Rn(){if(!Sd&&Sr!==null){Sd=!0;var e=0,s=nt;try{var r=Sr;for(nt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Sr=null,$c=!1}catch(a){throw Sr!==null&&(Sr=Sr.slice(e+1)),gf(Om,Rn),a}finally{nt=s,Sd=!1}}return null}var Ra=[],La=0,ac=null,ic=0,$s=[],Fs=0,oa=null,Ar=1,Pr="";function Un(e,s){Ra[La++]=ic,Ra[La++]=ac,ac=e,ic=s}function Wf(e,s,r){$s[Fs++]=Ar,$s[Fs++]=Pr,$s[Fs++]=oa,oa=e;var n=Ar;e=Pr;var a=32-Js(n)-1;n&=~(1<<a),r+=1;var i=32-Js(s)+a;if(30<i){var l=a-a%5;i=(n&(1<<l)-1).toString(32),n>>=l,a-=l,Ar=1<<32-Js(s)+a|r<<a|n,Pr=i+e}else Ar=1<<i|r<<a|n,Pr=e}function Vm(e){e.return!==null&&(Un(e,1),Wf(e,1,0))}function Qm(e){for(;e===ac;)ac=Ra[--La],Ra[La]=null,ic=Ra[--La],Ra[La]=null;for(;e===oa;)oa=$s[--Fs],$s[Fs]=null,Pr=$s[--Fs],$s[Fs]=null,Ar=$s[--Fs],$s[Fs]=null}var _s=null,Cs=null,ht=!1,Gs=null;function Kf(e,s){var r=Is(5,null,null,0);r.elementType="DELETED",r.stateNode=s,r.return=e,s=e.deletions,s===null?(e.deletions=[r],e.flags|=16):s.push(r)}function A0(e,s){switch(e.tag){case 5:var r=e.type;return s=s.nodeType!==1||r.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(e.stateNode=s,_s=e,Cs=jn(s.firstChild),!0):!1;case 6:return s=e.pendingProps===""||s.nodeType!==3?null:s,s!==null?(e.stateNode=s,_s=e,Cs=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(r=oa!==null?{id:Ar,overflow:Pr}:null,e.memoizedState={dehydrated:s,treeContext:r,retryLane:1073741824},r=Is(18,null,null,0),r.stateNode=s,r.return=e,e.child=r,_s=e,Cs=null,!0):!1;default:return!1}}function Eu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mu(e){if(ht){var s=Cs;if(s){var r=s;if(!A0(e,s)){if(Eu(e))throw Error(te(418));s=jn(r.nextSibling);var n=_s;s&&A0(e,s)?Kf(n,r):(e.flags=e.flags&-4097|2,ht=!1,_s=e)}}else{if(Eu(e))throw Error(te(418));e.flags=e.flags&-4097|2,ht=!1,_s=e}}}function P0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_s=e}function xo(e){if(e!==_s)return!1;if(!ht)return P0(e),ht=!0,!1;var s;if((s=e.tag!==3)&&!(s=e.tag!==5)&&(s=e.type,s=s!=="head"&&s!=="body"&&!ku(e.type,e.memoizedProps)),s&&(s=Cs)){if(Eu(e))throw Vf(),Error(te(418));for(;s;)Kf(e,s),s=jn(s.nextSibling)}if(P0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(s===0){Cs=jn(e.nextSibling);break e}s--}else r!=="$"&&r!=="$!"&&r!=="$?"||s++}e=e.nextSibling}Cs=null}}else Cs=_s?jn(e.stateNode.nextSibling):null;return!0}function Vf(){for(var e=Cs;e;)e=jn(e.nextSibling)}function ai(){Cs=_s=null,ht=!1}function Gm(e){Gs===null?Gs=[e]:Gs.push(e)}var Uj=Br.ReactCurrentBatchConfig;function Li(e,s,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var n=r.stateNode}if(!n)throw Error(te(147,e));var a=n,i=""+e;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===i?s.ref:(s=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},s._stringRef=i,s)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function go(e,s){throw e=Object.prototype.toString.call(s),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}function R0(e){var s=e._init;return s(e._payload)}function Qf(e){function s(b,f){if(e){var v=b.deletions;v===null?(b.deletions=[f],b.flags|=16):v.push(f)}}function r(b,f){if(!e)return null;for(;f!==null;)s(b,f),f=f.sibling;return null}function n(b,f){for(b=new Map;f!==null;)f.key!==null?b.set(f.key,f):b.set(f.index,f),f=f.sibling;return b}function a(b,f){return b=Sn(b,f),b.index=0,b.sibling=null,b}function i(b,f,v){return b.index=v,e?(v=b.alternate,v!==null?(v=v.index,v<f?(b.flags|=2,f):v):(b.flags|=2,f)):(b.flags|=1048576,f)}function l(b){return e&&b.alternate===null&&(b.flags|=2),b}function o(b,f,v,w){return f===null||f.tag!==6?(f=Pd(v,b.mode,w),f.return=b,f):(f=a(f,v),f.return=b,f)}function c(b,f,v,w){var N=v.type;return N===_a?h(b,f,v.props.children,w,v.key):f!==null&&(f.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Xr&&R0(N)===f.type)?(w=a(f,v.props),w.ref=Li(b,f,v),w.return=b,w):(w=zo(v.type,v.key,v.props,null,b.mode,w),w.ref=Li(b,f,v),w.return=b,w)}function d(b,f,v,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==v.containerInfo||f.stateNode.implementation!==v.implementation?(f=Rd(v,b.mode,w),f.return=b,f):(f=a(f,v.children||[]),f.return=b,f)}function h(b,f,v,w,N){return f===null||f.tag!==7?(f=aa(v,b.mode,w,N),f.return=b,f):(f=a(f,v),f.return=b,f)}function u(b,f,v){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Pd(""+f,b.mode,v),f.return=b,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case ro:return v=zo(f.type,f.key,f.props,null,b.mode,v),v.ref=Li(b,null,f),v.return=b,v;case Ca:return f=Rd(f,b.mode,v),f.return=b,f;case Xr:var w=f._init;return u(b,w(f._payload),v)}if(Wi(f)||Mi(f))return f=aa(f,b.mode,v,null),f.return=b,f;go(b,f)}return null}function p(b,f,v,w){var N=f!==null?f.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return N!==null?null:o(b,f,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ro:return v.key===N?c(b,f,v,w):null;case Ca:return v.key===N?d(b,f,v,w):null;case Xr:return N=v._init,p(b,f,N(v._payload),w)}if(Wi(v)||Mi(v))return N!==null?null:h(b,f,v,w,null);go(b,v)}return null}function j(b,f,v,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return b=b.get(v)||null,o(f,b,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ro:return b=b.get(w.key===null?v:w.key)||null,c(f,b,w,N);case Ca:return b=b.get(w.key===null?v:w.key)||null,d(f,b,w,N);case Xr:var P=w._init;return j(b,f,v,P(w._payload),N)}if(Wi(w)||Mi(w))return b=b.get(v)||null,h(f,b,w,N,null);go(f,w)}return null}function x(b,f,v,w){for(var N=null,P=null,z=f,E=f=0,X=null;z!==null&&E<v.length;E++){z.index>E?(X=z,z=null):X=z.sibling;var T=p(b,z,v[E],w);if(T===null){z===null&&(z=X);break}e&&z&&T.alternate===null&&s(b,z),f=i(T,f,E),P===null?N=T:P.sibling=T,P=T,z=X}if(E===v.length)return r(b,z),ht&&Un(b,E),N;if(z===null){for(;E<v.length;E++)z=u(b,v[E],w),z!==null&&(f=i(z,f,E),P===null?N=z:P.sibling=z,P=z);return ht&&Un(b,E),N}for(z=n(b,z);E<v.length;E++)X=j(z,b,E,v[E],w),X!==null&&(e&&X.alternate!==null&&z.delete(X.key===null?E:X.key),f=i(X,f,E),P===null?N=X:P.sibling=X,P=X);return e&&z.forEach(function(F){return s(b,F)}),ht&&Un(b,E),N}function g(b,f,v,w){var N=Mi(v);if(typeof N!="function")throw Error(te(150));if(v=N.call(v),v==null)throw Error(te(151));for(var P=N=null,z=f,E=f=0,X=null,T=v.next();z!==null&&!T.done;E++,T=v.next()){z.index>E?(X=z,z=null):X=z.sibling;var F=p(b,z,T.value,w);if(F===null){z===null&&(z=X);break}e&&z&&F.alternate===null&&s(b,z),f=i(F,f,E),P===null?N=F:P.sibling=F,P=F,z=X}if(T.done)return r(b,z),ht&&Un(b,E),N;if(z===null){for(;!T.done;E++,T=v.next())T=u(b,T.value,w),T!==null&&(f=i(T,f,E),P===null?N=T:P.sibling=T,P=T);return ht&&Un(b,E),N}for(z=n(b,z);!T.done;E++,T=v.next())T=j(z,b,E,T.value,w),T!==null&&(e&&T.alternate!==null&&z.delete(T.key===null?E:T.key),f=i(T,f,E),P===null?N=T:P.sibling=T,P=T);return e&&z.forEach(function(Q){return s(b,Q)}),ht&&Un(b,E),N}function y(b,f,v,w){if(typeof v=="object"&&v!==null&&v.type===_a&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case ro:e:{for(var N=v.key,P=f;P!==null;){if(P.key===N){if(N=v.type,N===_a){if(P.tag===7){r(b,P.sibling),f=a(P,v.props.children),f.return=b,b=f;break e}}else if(P.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Xr&&R0(N)===P.type){r(b,P.sibling),f=a(P,v.props),f.ref=Li(b,P,v),f.return=b,b=f;break e}r(b,P);break}else s(b,P);P=P.sibling}v.type===_a?(f=aa(v.props.children,b.mode,w,v.key),f.return=b,b=f):(w=zo(v.type,v.key,v.props,null,b.mode,w),w.ref=Li(b,f,v),w.return=b,b=w)}return l(b);case Ca:e:{for(P=v.key;f!==null;){if(f.key===P)if(f.tag===4&&f.stateNode.containerInfo===v.containerInfo&&f.stateNode.implementation===v.implementation){r(b,f.sibling),f=a(f,v.children||[]),f.return=b,b=f;break e}else{r(b,f);break}else s(b,f);f=f.sibling}f=Rd(v,b.mode,w),f.return=b,b=f}return l(b);case Xr:return P=v._init,y(b,f,P(v._payload),w)}if(Wi(v))return x(b,f,v,w);if(Mi(v))return g(b,f,v,w);go(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,f!==null&&f.tag===6?(r(b,f.sibling),f=a(f,v),f.return=b,b=f):(r(b,f),f=Pd(v,b.mode,w),f.return=b,b=f),l(b)):r(b,f)}return y}var ii=Qf(!0),Gf=Qf(!1),lc=Pn(null),oc=null,$a=null,Ym=null;function Jm(){Ym=$a=oc=null}function Xm(e){var s=lc.current;mt(lc),e._currentValue=s}function Tu(e,s,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,n!==null&&(n.childLanes|=s)):n!==null&&(n.childLanes&s)!==s&&(n.childLanes|=s),e===r)break;e=e.return}}function Ha(e,s){oc=e,Ym=$a=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&s&&(ps=!0),e.firstContext=null)}function zs(e){var s=e._currentValue;if(Ym!==e)if(e={context:e,memoizedValue:s,next:null},$a===null){if(oc===null)throw Error(te(308));$a=e,oc.dependencies={lanes:0,firstContext:e}}else $a=$a.next=e;return s}var qn=null;function Zm(e){qn===null?qn=[e]:qn.push(e)}function Yf(e,s,r,n){var a=s.interleaved;return a===null?(r.next=r,Zm(s)):(r.next=a.next,a.next=r),s.interleaved=r,zr(e,n)}function zr(e,s){e.lanes|=s;var r=e.alternate;for(r!==null&&(r.lanes|=s),r=e,e=e.return;e!==null;)e.childLanes|=s,r=e.alternate,r!==null&&(r.childLanes|=s),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Zr=!1;function eh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jf(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Lr(e,s){return{eventTime:e,lane:s,tag:0,payload:null,callback:null,next:null}}function wn(e,s,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Xe&2){var a=n.pending;return a===null?s.next=s:(s.next=a.next,a.next=s),n.pending=s,zr(e,r)}return a=n.interleaved,a===null?(s.next=s,Zm(n)):(s.next=a.next,a.next=s),n.interleaved=s,zr(e,r)}function Lo(e,s,r){if(s=s.updateQueue,s!==null&&(s=s.shared,(r&4194240)!==0)){var n=s.lanes;n&=e.pendingLanes,r|=n,s.lanes=r,Dm(e,r)}}function L0(e,s){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?a=i=s:i=i.next=s}else a=i=s;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=s:e.next=s,r.lastBaseUpdate=s}function cc(e,s,r,n){var a=e.updateQueue;Zr=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,d=c.next;c.next=null,l===null?i=d:l.next=d,l=c;var h=e.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==l&&(o===null?h.firstBaseUpdate=d:o.next=d,h.lastBaseUpdate=c))}if(i!==null){var u=a.baseState;l=0,h=d=c=null,o=i;do{var p=o.lane,j=o.eventTime;if((n&p)===p){h!==null&&(h=h.next={eventTime:j,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(p=s,j=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){u=x.call(j,u,p);break e}u=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,p=typeof x=="function"?x.call(j,u,p):x,p==null)break e;u=pt({},u,p);break e;case 2:Zr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else j={eventTime:j,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(d=h=j,c=u):h=h.next=j,l|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(h===null&&(c=u),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=h,s=a.shared.interleaved,s!==null){a=s;do l|=a.lane,a=a.next;while(a!==s)}else i===null&&(a.shared.lanes=0);da|=l,e.lanes=l,e.memoizedState=u}}function $0(e,s,r){if(e=s.effects,s.effects=null,e!==null)for(s=0;s<e.length;s++){var n=e[s],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(te(191,a));a.call(n)}}}var Hl={},pr=Pn(Hl),wl=Pn(Hl),Nl=Pn(Hl);function Wn(e){if(e===Hl)throw Error(te(174));return e}function th(e,s){switch(ot(Nl,s),ot(wl,e),ot(pr,Hl),e=s.nodeType,e){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:du(null,"");break;default:e=e===8?s.parentNode:s,s=e.namespaceURI||null,e=e.tagName,s=du(s,e)}mt(pr),ot(pr,s)}function li(){mt(pr),mt(wl),mt(Nl)}function Xf(e){Wn(Nl.current);var s=Wn(pr.current),r=du(s,e.type);s!==r&&(ot(wl,e),ot(pr,r))}function sh(e){wl.current===e&&(mt(pr),mt(wl))}var gt=Pn(0);function dc(e){for(var s=e;s!==null;){if(s.tag===13){var r=s.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Cd=[];function rh(){for(var e=0;e<Cd.length;e++)Cd[e]._workInProgressVersionPrimary=null;Cd.length=0}var $o=Br.ReactCurrentDispatcher,_d=Br.ReactCurrentBatchConfig,ca=0,ft=null,Tt=null,It=null,uc=!1,nl=!1,kl=0,Hj=0;function Yt(){throw Error(te(321))}function nh(e,s){if(s===null)return!1;for(var r=0;r<s.length&&r<e.length;r++)if(!er(e[r],s[r]))return!1;return!0}function ah(e,s,r,n,a,i){if(ca=i,ft=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,$o.current=e===null||e.memoizedState===null?Kj:Vj,e=r(n,a),nl){i=0;do{if(nl=!1,kl=0,25<=i)throw Error(te(301));i+=1,It=Tt=null,s.updateQueue=null,$o.current=Qj,e=r(n,a)}while(nl)}if($o.current=mc,s=Tt!==null&&Tt.next!==null,ca=0,It=Tt=ft=null,uc=!1,s)throw Error(te(300));return e}function ih(){var e=kl!==0;return kl=0,e}function cr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?ft.memoizedState=It=e:It=It.next=e,It}function Us(){if(Tt===null){var e=ft.alternate;e=e!==null?e.memoizedState:null}else e=Tt.next;var s=It===null?ft.memoizedState:It.next;if(s!==null)It=s,Tt=e;else{if(e===null)throw Error(te(310));Tt=e,e={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},It===null?ft.memoizedState=It=e:It=It.next=e}return It}function Sl(e,s){return typeof s=="function"?s(e):s}function Ed(e){var s=Us(),r=s.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=Tt,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=l=null,c=null,d=i;do{var h=d.lane;if((ca&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var u={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=u,l=n):c=c.next=u,ft.lanes|=h,da|=h}d=d.next}while(d!==null&&d!==i);c===null?l=n:c.next=o,er(n,s.memoizedState)||(ps=!0),s.memoizedState=n,s.baseState=l,s.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,ft.lanes|=i,da|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[s.memoizedState,r.dispatch]}function Md(e){var s=Us(),r=s.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=s.memoizedState;if(a!==null){r.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);er(i,s.memoizedState)||(ps=!0),s.memoizedState=i,s.baseQueue===null&&(s.baseState=i),r.lastRenderedState=i}return[i,n]}function Zf(){}function ep(e,s){var r=ft,n=Us(),a=s(),i=!er(n.memoizedState,a);if(i&&(n.memoizedState=a,ps=!0),n=n.queue,lh(rp.bind(null,r,n,e),[e]),n.getSnapshot!==s||i||It!==null&&It.memoizedState.tag&1){if(r.flags|=2048,Cl(9,sp.bind(null,r,n,a,s),void 0,null),zt===null)throw Error(te(349));ca&30||tp(r,s,a)}return a}function tp(e,s,r){e.flags|=16384,e={getSnapshot:s,value:r},s=ft.updateQueue,s===null?(s={lastEffect:null,stores:null},ft.updateQueue=s,s.stores=[e]):(r=s.stores,r===null?s.stores=[e]:r.push(e))}function sp(e,s,r,n){s.value=r,s.getSnapshot=n,np(s)&&ap(e)}function rp(e,s,r){return r(function(){np(s)&&ap(e)})}function np(e){var s=e.getSnapshot;e=e.value;try{var r=s();return!er(e,r)}catch{return!0}}function ap(e){var s=zr(e,1);s!==null&&Xs(s,e,1,-1)}function F0(e){var s=cr();return typeof e=="function"&&(e=e()),s.memoizedState=s.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:e},s.queue=e,e=e.dispatch=Wj.bind(null,ft,e),[s.memoizedState,e]}function Cl(e,s,r,n){return e={tag:e,create:s,destroy:r,deps:n,next:null},s=ft.updateQueue,s===null?(s={lastEffect:null,stores:null},ft.updateQueue=s,s.lastEffect=e.next=e):(r=s.lastEffect,r===null?s.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,s.lastEffect=e)),e}function ip(){return Us().memoizedState}function Fo(e,s,r,n){var a=cr();ft.flags|=e,a.memoizedState=Cl(1|s,r,void 0,n===void 0?null:n)}function Fc(e,s,r,n){var a=Us();n=n===void 0?null:n;var i=void 0;if(Tt!==null){var l=Tt.memoizedState;if(i=l.destroy,n!==null&&nh(n,l.deps)){a.memoizedState=Cl(s,r,i,n);return}}ft.flags|=e,a.memoizedState=Cl(1|s,r,i,n)}function I0(e,s){return Fo(8390656,8,e,s)}function lh(e,s){return Fc(2048,8,e,s)}function lp(e,s){return Fc(4,2,e,s)}function op(e,s){return Fc(4,4,e,s)}function cp(e,s){if(typeof s=="function")return e=e(),s(e),function(){s(null)};if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function dp(e,s,r){return r=r!=null?r.concat([e]):null,Fc(4,4,cp.bind(null,s,e),r)}function oh(){}function up(e,s){var r=Us();s=s===void 0?null:s;var n=r.memoizedState;return n!==null&&s!==null&&nh(s,n[1])?n[0]:(r.memoizedState=[e,s],e)}function mp(e,s){var r=Us();s=s===void 0?null:s;var n=r.memoizedState;return n!==null&&s!==null&&nh(s,n[1])?n[0]:(e=e(),r.memoizedState=[e,s],e)}function hp(e,s,r){return ca&21?(er(r,s)||(r=yf(),ft.lanes|=r,da|=r,e.baseState=!0),s):(e.baseState&&(e.baseState=!1,ps=!0),e.memoizedState=r)}function Bj(e,s){var r=nt;nt=r!==0&&4>r?r:4,e(!0);var n=_d.transition;_d.transition={};try{e(!1),s()}finally{nt=r,_d.transition=n}}function xp(){return Us().memoizedState}function qj(e,s,r){var n=kn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},gp(e))fp(s,r);else if(r=Yf(e,s,r,n),r!==null){var a=cs();Xs(r,e,n,a),pp(r,s,n)}}function Wj(e,s,r){var n=kn(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(gp(e))fp(s,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=s.lastRenderedReducer,i!==null))try{var l=s.lastRenderedState,o=i(l,r);if(a.hasEagerState=!0,a.eagerState=o,er(o,l)){var c=s.interleaved;c===null?(a.next=a,Zm(s)):(a.next=c.next,c.next=a),s.interleaved=a;return}}catch{}finally{}r=Yf(e,s,a,n),r!==null&&(a=cs(),Xs(r,e,n,a),pp(r,s,n))}}function gp(e){var s=e.alternate;return e===ft||s!==null&&s===ft}function fp(e,s){nl=uc=!0;var r=e.pending;r===null?s.next=s:(s.next=r.next,r.next=s),e.pending=s}function pp(e,s,r){if(r&4194240){var n=s.lanes;n&=e.pendingLanes,r|=n,s.lanes=r,Dm(e,r)}}var mc={readContext:zs,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},Kj={readContext:zs,useCallback:function(e,s){return cr().memoizedState=[e,s===void 0?null:s],e},useContext:zs,useEffect:I0,useImperativeHandle:function(e,s,r){return r=r!=null?r.concat([e]):null,Fo(4194308,4,cp.bind(null,s,e),r)},useLayoutEffect:function(e,s){return Fo(4194308,4,e,s)},useInsertionEffect:function(e,s){return Fo(4,2,e,s)},useMemo:function(e,s){var r=cr();return s=s===void 0?null:s,e=e(),r.memoizedState=[e,s],e},useReducer:function(e,s,r){var n=cr();return s=r!==void 0?r(s):s,n.memoizedState=n.baseState=s,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},n.queue=e,e=e.dispatch=qj.bind(null,ft,e),[n.memoizedState,e]},useRef:function(e){var s=cr();return e={current:e},s.memoizedState=e},useState:F0,useDebugValue:oh,useDeferredValue:function(e){return cr().memoizedState=e},useTransition:function(){var e=F0(!1),s=e[0];return e=Bj.bind(null,e[1]),cr().memoizedState=e,[s,e]},useMutableSource:function(){},useSyncExternalStore:function(e,s,r){var n=ft,a=cr();if(ht){if(r===void 0)throw Error(te(407));r=r()}else{if(r=s(),zt===null)throw Error(te(349));ca&30||tp(n,s,r)}a.memoizedState=r;var i={value:r,getSnapshot:s};return a.queue=i,I0(rp.bind(null,n,i,e),[e]),n.flags|=2048,Cl(9,sp.bind(null,n,i,r,s),void 0,null),r},useId:function(){var e=cr(),s=zt.identifierPrefix;if(ht){var r=Pr,n=Ar;r=(n&~(1<<32-Js(n)-1)).toString(32)+r,s=":"+s+"R"+r,r=kl++,0<r&&(s+="H"+r.toString(32)),s+=":"}else r=Hj++,s=":"+s+"r"+r.toString(32)+":";return e.memoizedState=s},unstable_isNewReconciler:!1},Vj={readContext:zs,useCallback:up,useContext:zs,useEffect:lh,useImperativeHandle:dp,useInsertionEffect:lp,useLayoutEffect:op,useMemo:mp,useReducer:Ed,useRef:ip,useState:function(){return Ed(Sl)},useDebugValue:oh,useDeferredValue:function(e){var s=Us();return hp(s,Tt.memoizedState,e)},useTransition:function(){var e=Ed(Sl)[0],s=Us().memoizedState;return[e,s]},useMutableSource:Zf,useSyncExternalStore:ep,useId:xp,unstable_isNewReconciler:!1},Qj={readContext:zs,useCallback:up,useContext:zs,useEffect:lh,useImperativeHandle:dp,useInsertionEffect:lp,useLayoutEffect:op,useMemo:mp,useReducer:Md,useRef:ip,useState:function(){return Md(Sl)},useDebugValue:oh,useDeferredValue:function(e){var s=Us();return Tt===null?s.memoizedState=e:hp(s,Tt.memoizedState,e)},useTransition:function(){var e=Md(Sl)[0],s=Us().memoizedState;return[e,s]},useMutableSource:Zf,useSyncExternalStore:ep,useId:xp,unstable_isNewReconciler:!1};function qs(e,s){if(e&&e.defaultProps){s=pt({},s),e=e.defaultProps;for(var r in e)s[r]===void 0&&(s[r]=e[r]);return s}return s}function Au(e,s,r,n){s=e.memoizedState,r=r(n,s),r=r==null?s:pt({},s,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ic={isMounted:function(e){return(e=e._reactInternals)?pa(e)===e:!1},enqueueSetState:function(e,s,r){e=e._reactInternals;var n=cs(),a=kn(e),i=Lr(n,a);i.payload=s,r!=null&&(i.callback=r),s=wn(e,i,a),s!==null&&(Xs(s,e,a,n),Lo(s,e,a))},enqueueReplaceState:function(e,s,r){e=e._reactInternals;var n=cs(),a=kn(e),i=Lr(n,a);i.tag=1,i.payload=s,r!=null&&(i.callback=r),s=wn(e,i,a),s!==null&&(Xs(s,e,a,n),Lo(s,e,a))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var r=cs(),n=kn(e),a=Lr(r,n);a.tag=2,s!=null&&(a.callback=s),s=wn(e,a,n),s!==null&&(Xs(s,e,n,r),Lo(s,e,n))}};function O0(e,s,r,n,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):s.prototype&&s.prototype.isPureReactComponent?!yl(r,n)||!yl(a,i):!0}function yp(e,s,r){var n=!1,a=Tn,i=s.contextType;return typeof i=="object"&&i!==null?i=zs(i):(a=bs(s)?la:es.current,n=s.contextTypes,i=(n=n!=null)?ni(e,a):Tn),s=new s(r,i),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Ic,e.stateNode=s,s._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),s}function D0(e,s,r,n){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(r,n),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(r,n),s.state!==e&&Ic.enqueueReplaceState(s,s.state,null)}function Pu(e,s,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},eh(e);var i=s.contextType;typeof i=="object"&&i!==null?a.context=zs(i):(i=bs(s)?la:es.current,a.context=ni(e,i)),a.state=e.memoizedState,i=s.getDerivedStateFromProps,typeof i=="function"&&(Au(e,s,i,r),a.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(s=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),s!==a.state&&Ic.enqueueReplaceState(a,a.state,null),cc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function oi(e,s){try{var r="",n=s;do r+=wv(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:s,stack:a,digest:null}}function Td(e,s,r){return{value:e,source:null,stack:r??null,digest:s??null}}function Ru(e,s){try{console.error(s.value)}catch(r){setTimeout(function(){throw r})}}var Gj=typeof WeakMap=="function"?WeakMap:Map;function bp(e,s,r){r=Lr(-1,r),r.tag=3,r.payload={element:null};var n=s.value;return r.callback=function(){xc||(xc=!0,Bu=n),Ru(e,s)},r}function vp(e,s,r){r=Lr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=s.value;r.payload=function(){return n(a)},r.callback=function(){Ru(e,s)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ru(e,s),typeof n!="function"&&(Nn===null?Nn=new Set([this]):Nn.add(this));var l=s.stack;this.componentDidCatch(s.value,{componentStack:l!==null?l:""})}),r}function z0(e,s,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Gj;var a=new Set;n.set(s,a)}else a=n.get(s),a===void 0&&(a=new Set,n.set(s,a));a.has(r)||(a.add(r),e=c2.bind(null,e,s,r),s.then(e,e))}function U0(e){do{var s;if((s=e.tag===13)&&(s=e.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return e;e=e.return}while(e!==null);return null}function H0(e,s,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===s?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(s=Lr(-1,1),s.tag=2,wn(r,s,1))),r.lanes|=1),e)}var Yj=Br.ReactCurrentOwner,ps=!1;function ls(e,s,r,n){s.child=e===null?Gf(s,null,r,n):ii(s,e.child,r,n)}function B0(e,s,r,n,a){r=r.render;var i=s.ref;return Ha(s,a),n=ah(e,s,r,n,i,a),r=ih(),e!==null&&!ps?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~a,Ur(e,s,a)):(ht&&r&&Vm(s),s.flags|=1,ls(e,s,n,a),s.child)}function q0(e,s,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!fh(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(s.tag=15,s.type=i,jp(e,s,i,n,a)):(e=zo(r.type,null,n,s,s.mode,a),e.ref=s.ref,e.return=s,s.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:yl,r(l,n)&&e.ref===s.ref)return Ur(e,s,a)}return s.flags|=1,e=Sn(i,n),e.ref=s.ref,e.return=s,s.child=e}function jp(e,s,r,n,a){if(e!==null){var i=e.memoizedProps;if(yl(i,n)&&e.ref===s.ref)if(ps=!1,s.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(ps=!0);else return s.lanes=e.lanes,Ur(e,s,a)}return Lu(e,s,r,n,a)}function wp(e,s,r){var n=s.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(Ia,Ss),Ss|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:e,cachePool:null,transitions:null},s.updateQueue=null,ot(Ia,Ss),Ss|=e,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ot(Ia,Ss),Ss|=n}else i!==null?(n=i.baseLanes|r,s.memoizedState=null):n=r,ot(Ia,Ss),Ss|=n;return ls(e,s,a,r),s.child}function Np(e,s){var r=s.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(s.flags|=512,s.flags|=2097152)}function Lu(e,s,r,n,a){var i=bs(r)?la:es.current;return i=ni(s,i),Ha(s,a),r=ah(e,s,r,n,i,a),n=ih(),e!==null&&!ps?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~a,Ur(e,s,a)):(ht&&n&&Vm(s),s.flags|=1,ls(e,s,r,a),s.child)}function W0(e,s,r,n,a){if(bs(r)){var i=!0;nc(s)}else i=!1;if(Ha(s,a),s.stateNode===null)Io(e,s),yp(s,r,n),Pu(s,r,n,a),n=!0;else if(e===null){var l=s.stateNode,o=s.memoizedProps;l.props=o;var c=l.context,d=r.contextType;typeof d=="object"&&d!==null?d=zs(d):(d=bs(r)?la:es.current,d=ni(s,d));var h=r.getDerivedStateFromProps,u=typeof h=="function"||typeof l.getSnapshotBeforeUpdate=="function";u||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==d)&&D0(s,l,n,d),Zr=!1;var p=s.memoizedState;l.state=p,cc(s,n,l,a),c=s.memoizedState,o!==n||p!==c||ys.current||Zr?(typeof h=="function"&&(Au(s,r,h,n),c=s.memoizedState),(o=Zr||O0(s,r,o,n,p,c,d))?(u||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(s.flags|=4194308)):(typeof l.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=n,s.memoizedState=c),l.props=n,l.state=c,l.context=d,n=o):(typeof l.componentDidMount=="function"&&(s.flags|=4194308),n=!1)}else{l=s.stateNode,Jf(e,s),o=s.memoizedProps,d=s.type===s.elementType?o:qs(s.type,o),l.props=d,u=s.pendingProps,p=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=zs(c):(c=bs(r)?la:es.current,c=ni(s,c));var j=r.getDerivedStateFromProps;(h=typeof j=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==u||p!==c)&&D0(s,l,n,c),Zr=!1,p=s.memoizedState,l.state=p,cc(s,n,l,a);var x=s.memoizedState;o!==u||p!==x||ys.current||Zr?(typeof j=="function"&&(Au(s,r,j,n),x=s.memoizedState),(d=Zr||O0(s,r,d,n,p,x,c)||!1)?(h||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,x,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,x,c)),typeof l.componentDidUpdate=="function"&&(s.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(s.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(s.flags|=1024),s.memoizedProps=n,s.memoizedState=x),l.props=n,l.state=x,l.context=c,n=d):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(s.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(s.flags|=1024),n=!1)}return $u(e,s,r,n,i,a)}function $u(e,s,r,n,a,i){Np(e,s);var l=(s.flags&128)!==0;if(!n&&!l)return a&&T0(s,r,!1),Ur(e,s,i);n=s.stateNode,Yj.current=s;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return s.flags|=1,e!==null&&l?(s.child=ii(s,e.child,null,i),s.child=ii(s,null,o,i)):ls(e,s,o,i),s.memoizedState=n.state,a&&T0(s,r,!0),s.child}function kp(e){var s=e.stateNode;s.pendingContext?M0(e,s.pendingContext,s.pendingContext!==s.context):s.context&&M0(e,s.context,!1),th(e,s.containerInfo)}function K0(e,s,r,n,a){return ai(),Gm(a),s.flags|=256,ls(e,s,r,n),s.child}var Fu={dehydrated:null,treeContext:null,retryLane:0};function Iu(e){return{baseLanes:e,cachePool:null,transitions:null}}function Sp(e,s,r){var n=s.pendingProps,a=gt.current,i=!1,l=(s.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,s.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ot(gt,a&1),e===null)return Mu(s),e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(s.mode&1?e.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(l=n.children,e=n.fallback,i?(n=s.mode,i=s.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=zc(l,n,0,null),e=aa(e,n,r,null),i.return=s,e.return=s,i.sibling=e,s.child=i,s.child.memoizedState=Iu(r),s.memoizedState=Fu,e):ch(s,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Jj(e,s,l,n,o,a,r);if(i){i=n.fallback,l=s.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&s.child!==a?(n=s.child,n.childLanes=0,n.pendingProps=c,s.deletions=null):(n=Sn(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Sn(o,i):(i=aa(i,l,r,null),i.flags|=2),i.return=s,n.return=s,n.sibling=i,s.child=n,n=i,i=s.child,l=e.child.memoizedState,l=l===null?Iu(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,s.memoizedState=Fu,n}return i=e.child,e=i.sibling,n=Sn(i,{mode:"visible",children:n.children}),!(s.mode&1)&&(n.lanes=r),n.return=s,n.sibling=null,e!==null&&(r=s.deletions,r===null?(s.deletions=[e],s.flags|=16):r.push(e)),s.child=n,s.memoizedState=null,n}function ch(e,s){return s=zc({mode:"visible",children:s},e.mode,0,null),s.return=e,e.child=s}function fo(e,s,r,n){return n!==null&&Gm(n),ii(s,e.child,null,r),e=ch(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function Jj(e,s,r,n,a,i,l){if(r)return s.flags&256?(s.flags&=-257,n=Td(Error(te(422))),fo(e,s,l,n)):s.memoizedState!==null?(s.child=e.child,s.flags|=128,null):(i=n.fallback,a=s.mode,n=zc({mode:"visible",children:n.children},a,0,null),i=aa(i,a,l,null),i.flags|=2,n.return=s,i.return=s,n.sibling=i,s.child=n,s.mode&1&&ii(s,e.child,null,l),s.child.memoizedState=Iu(l),s.memoizedState=Fu,i);if(!(s.mode&1))return fo(e,s,l,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(te(419)),n=Td(i,n,void 0),fo(e,s,l,n)}if(o=(l&e.childLanes)!==0,ps||o){if(n=zt,n!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,zr(e,a),Xs(n,e,a,-1))}return gh(),n=Td(Error(te(421))),fo(e,s,l,n)}return a.data==="$?"?(s.flags|=128,s.child=e.child,s=d2.bind(null,e),a._reactRetry=s,null):(e=i.treeContext,Cs=jn(a.nextSibling),_s=s,ht=!0,Gs=null,e!==null&&($s[Fs++]=Ar,$s[Fs++]=Pr,$s[Fs++]=oa,Ar=e.id,Pr=e.overflow,oa=s),s=ch(s,n.children),s.flags|=4096,s)}function V0(e,s,r){e.lanes|=s;var n=e.alternate;n!==null&&(n.lanes|=s),Tu(e.return,s,r)}function Ad(e,s,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=s,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Cp(e,s,r){var n=s.pendingProps,a=n.revealOrder,i=n.tail;if(ls(e,s,n.children,r),n=gt.current,n&2)n=n&1|2,s.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&V0(e,r,s);else if(e.tag===19)V0(e,r,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break e;for(;e.sibling===null;){if(e.return===null||e.return===s)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ot(gt,n),!(s.mode&1))s.memoizedState=null;else switch(a){case"forwards":for(r=s.child,a=null;r!==null;)e=r.alternate,e!==null&&dc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=s.child,s.child=null):(a=r.sibling,r.sibling=null),Ad(s,!1,a,r,i);break;case"backwards":for(r=null,a=s.child,s.child=null;a!==null;){if(e=a.alternate,e!==null&&dc(e)===null){s.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Ad(s,!0,r,null,i);break;case"together":Ad(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Io(e,s){!(s.mode&1)&&e!==null&&(e.alternate=null,s.alternate=null,s.flags|=2)}function Ur(e,s,r){if(e!==null&&(s.dependencies=e.dependencies),da|=s.lanes,!(r&s.childLanes))return null;if(e!==null&&s.child!==e.child)throw Error(te(153));if(s.child!==null){for(e=s.child,r=Sn(e,e.pendingProps),s.child=r,r.return=s;e.sibling!==null;)e=e.sibling,r=r.sibling=Sn(e,e.pendingProps),r.return=s;r.sibling=null}return s.child}function Xj(e,s,r){switch(s.tag){case 3:kp(s),ai();break;case 5:Xf(s);break;case 1:bs(s.type)&&nc(s);break;case 4:th(s,s.stateNode.containerInfo);break;case 10:var n=s.type._context,a=s.memoizedProps.value;ot(lc,n._currentValue),n._currentValue=a;break;case 13:if(n=s.memoizedState,n!==null)return n.dehydrated!==null?(ot(gt,gt.current&1),s.flags|=128,null):r&s.child.childLanes?Sp(e,s,r):(ot(gt,gt.current&1),e=Ur(e,s,r),e!==null?e.sibling:null);ot(gt,gt.current&1);break;case 19:if(n=(r&s.childLanes)!==0,e.flags&128){if(n)return Cp(e,s,r);s.flags|=128}if(a=s.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ot(gt,gt.current),n)break;return null;case 22:case 23:return s.lanes=0,wp(e,s,r)}return Ur(e,s,r)}var _p,Ou,Ep,Mp;_p=function(e,s){for(var r=s.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ou=function(){};Ep=function(e,s,r,n){var a=e.memoizedProps;if(a!==n){e=s.stateNode,Wn(pr.current);var i=null;switch(r){case"input":a=iu(e,a),n=iu(e,n),i=[];break;case"select":a=pt({},a,{value:void 0}),n=pt({},n,{value:void 0}),i=[];break;case"textarea":a=cu(e,a),n=cu(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=sc)}uu(r,n);var l;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var o=a[d];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ul.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ul.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ut("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(s.updateQueue=d)&&(s.flags|=4)}};Mp=function(e,s,r,n){r!==n&&(s.flags|=4)};function $i(e,s){if(!ht)switch(e.tailMode){case"hidden":s=e.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Jt(e){var s=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(s)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,s}function Zj(e,s,r){var n=s.pendingProps;switch(Qm(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(s),null;case 1:return bs(s.type)&&rc(),Jt(s),null;case 3:return n=s.stateNode,li(),mt(ys),mt(es),rh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(xo(s)?s.flags|=4:e===null||e.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Gs!==null&&(Ku(Gs),Gs=null))),Ou(e,s),Jt(s),null;case 5:sh(s);var a=Wn(Nl.current);if(r=s.type,e!==null&&s.stateNode!=null)Ep(e,s,r,n,a),e.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!n){if(s.stateNode===null)throw Error(te(166));return Jt(s),null}if(e=Wn(pr.current),xo(s)){n=s.stateNode,r=s.type;var i=s.memoizedProps;switch(n[xr]=s,n[jl]=i,e=(s.mode&1)!==0,r){case"dialog":ut("cancel",n),ut("close",n);break;case"iframe":case"object":case"embed":ut("load",n);break;case"video":case"audio":for(a=0;a<Vi.length;a++)ut(Vi[a],n);break;case"source":ut("error",n);break;case"img":case"image":case"link":ut("error",n),ut("load",n);break;case"details":ut("toggle",n);break;case"input":s0(n,i),ut("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ut("invalid",n);break;case"textarea":n0(n,i),ut("invalid",n)}uu(r,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&ho(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&ho(n.textContent,o,e),a=["children",""+o]):ul.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&ut("scroll",n)}switch(r){case"input":no(n),r0(n,i,!0);break;case"textarea":no(n),a0(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=sc)}n=a,s.updateQueue=n,n!==null&&(s.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sf(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[xr]=s,e[jl]=n,_p(e,s,!1,!1),s.stateNode=e;e:{switch(l=mu(r,n),r){case"dialog":ut("cancel",e),ut("close",e),a=n;break;case"iframe":case"object":case"embed":ut("load",e),a=n;break;case"video":case"audio":for(a=0;a<Vi.length;a++)ut(Vi[a],e);a=n;break;case"source":ut("error",e),a=n;break;case"img":case"image":case"link":ut("error",e),ut("load",e),a=n;break;case"details":ut("toggle",e),a=n;break;case"input":s0(e,n),a=iu(e,n),ut("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=pt({},n,{value:void 0}),ut("invalid",e);break;case"textarea":n0(e,n),a=cu(e,n),ut("invalid",e);break;default:a=n}uu(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?af(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rf(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ml(e,c):typeof c=="number"&&ml(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ul.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ut("scroll",e):c!=null&&Rm(e,i,c,l))}switch(r){case"input":no(e),r0(e,n,!1);break;case"textarea":no(e),a0(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Mn(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Oa(e,!!n.multiple,i,!1):n.defaultValue!=null&&Oa(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=sc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Jt(s),null;case 6:if(e&&s.stateNode!=null)Mp(e,s,e.memoizedProps,n);else{if(typeof n!="string"&&s.stateNode===null)throw Error(te(166));if(r=Wn(Nl.current),Wn(pr.current),xo(s)){if(n=s.stateNode,r=s.memoizedProps,n[xr]=s,(i=n.nodeValue!==r)&&(e=_s,e!==null))switch(e.tag){case 3:ho(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ho(n.nodeValue,r,(e.mode&1)!==0)}i&&(s.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[xr]=s,s.stateNode=n}return Jt(s),null;case 13:if(mt(gt),n=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ht&&Cs!==null&&s.mode&1&&!(s.flags&128))Vf(),ai(),s.flags|=98560,i=!1;else if(i=xo(s),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(te(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(te(317));i[xr]=s}else ai(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Jt(s),i=!1}else Gs!==null&&(Ku(Gs),Gs=null),i=!0;if(!i)return s.flags&65536?s:null}return s.flags&128?(s.lanes=r,s):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(s.child.flags|=8192,s.mode&1&&(e===null||gt.current&1?Pt===0&&(Pt=3):gh())),s.updateQueue!==null&&(s.flags|=4),Jt(s),null);case 4:return li(),Ou(e,s),e===null&&bl(s.stateNode.containerInfo),Jt(s),null;case 10:return Xm(s.type._context),Jt(s),null;case 17:return bs(s.type)&&rc(),Jt(s),null;case 19:if(mt(gt),i=s.memoizedState,i===null)return Jt(s),null;if(n=(s.flags&128)!==0,l=i.rendering,l===null)if(n)$i(i,!1);else{if(Pt!==0||e!==null&&e.flags&128)for(e=s.child;e!==null;){if(l=dc(e),l!==null){for(s.flags|=128,$i(i,!1),n=l.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),s.subtreeFlags=0,n=r,r=s.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ot(gt,gt.current&1|2),s.child}e=e.sibling}i.tail!==null&&jt()>ci&&(s.flags|=128,n=!0,$i(i,!1),s.lanes=4194304)}else{if(!n)if(e=dc(l),e!==null){if(s.flags|=128,n=!0,r=e.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),$i(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!ht)return Jt(s),null}else 2*jt()-i.renderingStartTime>ci&&r!==1073741824&&(s.flags|=128,n=!0,$i(i,!1),s.lanes=4194304);i.isBackwards?(l.sibling=s.child,s.child=l):(r=i.last,r!==null?r.sibling=l:s.child=l,i.last=l)}return i.tail!==null?(s=i.tail,i.rendering=s,i.tail=s.sibling,i.renderingStartTime=jt(),s.sibling=null,r=gt.current,ot(gt,n?r&1|2:r&1),s):(Jt(s),null);case 22:case 23:return xh(),n=s.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(s.flags|=8192),n&&s.mode&1?Ss&1073741824&&(Jt(s),s.subtreeFlags&6&&(s.flags|=8192)):Jt(s),null;case 24:return null;case 25:return null}throw Error(te(156,s.tag))}function e2(e,s){switch(Qm(s),s.tag){case 1:return bs(s.type)&&rc(),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return li(),mt(ys),mt(es),rh(),e=s.flags,e&65536&&!(e&128)?(s.flags=e&-65537|128,s):null;case 5:return sh(s),null;case 13:if(mt(gt),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(te(340));ai()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return mt(gt),null;case 4:return li(),null;case 10:return Xm(s.type._context),null;case 22:case 23:return xh(),null;case 24:return null;default:return null}}var po=!1,Xt=!1,t2=typeof WeakSet=="function"?WeakSet:Set,he=null;function Fa(e,s){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){vt(e,s,n)}else r.current=null}function Du(e,s,r){try{r()}catch(n){vt(e,s,n)}}var Q0=!1;function s2(e,s){if(wu=Zo,e=Lf(),Km(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,d=0,h=0,u=e,p=null;t:for(;;){for(var j;u!==r||a!==0&&u.nodeType!==3||(o=l+a),u!==i||n!==0&&u.nodeType!==3||(c=l+n),u.nodeType===3&&(l+=u.nodeValue.length),(j=u.firstChild)!==null;)p=u,u=j;for(;;){if(u===e)break t;if(p===r&&++d===a&&(o=l),p===i&&++h===n&&(c=l),(j=u.nextSibling)!==null)break;u=p,p=u.parentNode}u=j}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nu={focusedElem:e,selectionRange:r},Zo=!1,he=s;he!==null;)if(s=he,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,he=e;else for(;he!==null;){s=he;try{var x=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,y=x.memoizedState,b=s.stateNode,f=b.getSnapshotBeforeUpdate(s.elementType===s.type?g:qs(s.type,g),y);b.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var v=s.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(w){vt(s,s.return,w)}if(e=s.sibling,e!==null){e.return=s.return,he=e;break}he=s.return}return x=Q0,Q0=!1,x}function al(e,s,r){var n=s.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Du(s,r,i)}a=a.next}while(a!==n)}}function Oc(e,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==s)}}function zu(e){var s=e.ref;if(s!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof s=="function"?s(e):s.current=e}}function Tp(e){var s=e.alternate;s!==null&&(e.alternate=null,Tp(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&(delete s[xr],delete s[jl],delete s[Cu],delete s[Oj],delete s[Dj])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ap(e){return e.tag===5||e.tag===3||e.tag===4}function G0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ap(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Uu(e,s,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,s?r.nodeType===8?r.parentNode.insertBefore(e,s):r.insertBefore(e,s):(r.nodeType===8?(s=r.parentNode,s.insertBefore(e,r)):(s=r,s.appendChild(e)),r=r._reactRootContainer,r!=null||s.onclick!==null||(s.onclick=sc));else if(n!==4&&(e=e.child,e!==null))for(Uu(e,s,r),e=e.sibling;e!==null;)Uu(e,s,r),e=e.sibling}function Hu(e,s,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,s?r.insertBefore(e,s):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Hu(e,s,r),e=e.sibling;e!==null;)Hu(e,s,r),e=e.sibling}var Bt=null,Qs=!1;function Kr(e,s,r){for(r=r.child;r!==null;)Pp(e,s,r),r=r.sibling}function Pp(e,s,r){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(Tc,r)}catch{}switch(r.tag){case 5:Xt||Fa(r,s);case 6:var n=Bt,a=Qs;Bt=null,Kr(e,s,r),Bt=n,Qs=a,Bt!==null&&(Qs?(e=Bt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Bt.removeChild(r.stateNode));break;case 18:Bt!==null&&(Qs?(e=Bt,r=r.stateNode,e.nodeType===8?kd(e.parentNode,r):e.nodeType===1&&kd(e,r),fl(e)):kd(Bt,r.stateNode));break;case 4:n=Bt,a=Qs,Bt=r.stateNode.containerInfo,Qs=!0,Kr(e,s,r),Bt=n,Qs=a;break;case 0:case 11:case 14:case 15:if(!Xt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Du(r,s,l),a=a.next}while(a!==n)}Kr(e,s,r);break;case 1:if(!Xt&&(Fa(r,s),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){vt(r,s,o)}Kr(e,s,r);break;case 21:Kr(e,s,r);break;case 22:r.mode&1?(Xt=(n=Xt)||r.memoizedState!==null,Kr(e,s,r),Xt=n):Kr(e,s,r);break;default:Kr(e,s,r)}}function Y0(e){var s=e.updateQueue;if(s!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new t2),s.forEach(function(n){var a=u2.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Bs(e,s){var r=s.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,l=s,o=l;e:for(;o!==null;){switch(o.tag){case 5:Bt=o.stateNode,Qs=!1;break e;case 3:Bt=o.stateNode.containerInfo,Qs=!0;break e;case 4:Bt=o.stateNode.containerInfo,Qs=!0;break e}o=o.return}if(Bt===null)throw Error(te(160));Pp(i,l,a),Bt=null,Qs=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){vt(a,s,d)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Rp(s,e),s=s.sibling}function Rp(e,s){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bs(s,e),ir(e),n&4){try{al(3,e,e.return),Oc(3,e)}catch(g){vt(e,e.return,g)}try{al(5,e,e.return)}catch(g){vt(e,e.return,g)}}break;case 1:Bs(s,e),ir(e),n&512&&r!==null&&Fa(r,r.return);break;case 5:if(Bs(s,e),ir(e),n&512&&r!==null&&Fa(r,r.return),e.flags&32){var a=e.stateNode;try{ml(a,"")}catch(g){vt(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&ef(a,i),mu(o,l);var d=mu(o,i);for(l=0;l<c.length;l+=2){var h=c[l],u=c[l+1];h==="style"?af(a,u):h==="dangerouslySetInnerHTML"?rf(a,u):h==="children"?ml(a,u):Rm(a,h,u,d)}switch(o){case"input":lu(a,i);break;case"textarea":tf(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var j=i.value;j!=null?Oa(a,!!i.multiple,j,!1):p!==!!i.multiple&&(i.defaultValue!=null?Oa(a,!!i.multiple,i.defaultValue,!0):Oa(a,!!i.multiple,i.multiple?[]:"",!1))}a[jl]=i}catch(g){vt(e,e.return,g)}}break;case 6:if(Bs(s,e),ir(e),n&4){if(e.stateNode===null)throw Error(te(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){vt(e,e.return,g)}}break;case 3:if(Bs(s,e),ir(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{fl(s.containerInfo)}catch(g){vt(e,e.return,g)}break;case 4:Bs(s,e),ir(e);break;case 13:Bs(s,e),ir(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(mh=jt())),n&4&&Y0(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(Xt=(d=Xt)||h,Bs(s,e),Xt=d):Bs(s,e),ir(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!h&&e.mode&1)for(he=e,h=e.child;h!==null;){for(u=he=h;he!==null;){switch(p=he,j=p.child,p.tag){case 0:case 11:case 14:case 15:al(4,p,p.return);break;case 1:Fa(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,r=p.return;try{s=n,x.props=s.memoizedProps,x.state=s.memoizedState,x.componentWillUnmount()}catch(g){vt(n,r,g)}}break;case 5:Fa(p,p.return);break;case 22:if(p.memoizedState!==null){X0(u);continue}}j!==null?(j.return=p,he=j):X0(u)}h=h.sibling}e:for(h=null,u=e;;){if(u.tag===5){if(h===null){h=u;try{a=u.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=u.stateNode,c=u.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=nf("display",l))}catch(g){vt(e,e.return,g)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(g){vt(e,e.return,g)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Bs(s,e),ir(e),n&4&&Y0(e);break;case 21:break;default:Bs(s,e),ir(e)}}function ir(e){var s=e.flags;if(s&2){try{e:{for(var r=e.return;r!==null;){if(Ap(r)){var n=r;break e}r=r.return}throw Error(te(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ml(a,""),n.flags&=-33);var i=G0(e);Hu(e,i,a);break;case 3:case 4:var l=n.stateNode.containerInfo,o=G0(e);Uu(e,o,l);break;default:throw Error(te(161))}}catch(c){vt(e,e.return,c)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function r2(e,s,r){he=e,Lp(e)}function Lp(e,s,r){for(var n=(e.mode&1)!==0;he!==null;){var a=he,i=a.child;if(a.tag===22&&n){var l=a.memoizedState!==null||po;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Xt;o=po;var d=Xt;if(po=l,(Xt=c)&&!d)for(he=a;he!==null;)l=he,c=l.child,l.tag===22&&l.memoizedState!==null?Z0(a):c!==null?(c.return=l,he=c):Z0(a);for(;i!==null;)he=i,Lp(i),i=i.sibling;he=a,po=o,Xt=d}J0(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,he=i):J0(e)}}function J0(e){for(;he!==null;){var s=he;if(s.flags&8772){var r=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Xt||Oc(5,s);break;case 1:var n=s.stateNode;if(s.flags&4&&!Xt)if(r===null)n.componentDidMount();else{var a=s.elementType===s.type?r.memoizedProps:qs(s.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=s.updateQueue;i!==null&&$0(s,i,n);break;case 3:var l=s.updateQueue;if(l!==null){if(r=null,s.child!==null)switch(s.child.tag){case 5:r=s.child.stateNode;break;case 1:r=s.child.stateNode}$0(s,l,r)}break;case 5:var o=s.stateNode;if(r===null&&s.flags&4){r=o;var c=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var d=s.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&fl(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Xt||s.flags&512&&zu(s)}catch(p){vt(s,s.return,p)}}if(s===e){he=null;break}if(r=s.sibling,r!==null){r.return=s.return,he=r;break}he=s.return}}function X0(e){for(;he!==null;){var s=he;if(s===e){he=null;break}var r=s.sibling;if(r!==null){r.return=s.return,he=r;break}he=s.return}}function Z0(e){for(;he!==null;){var s=he;try{switch(s.tag){case 0:case 11:case 15:var r=s.return;try{Oc(4,s)}catch(c){vt(s,r,c)}break;case 1:var n=s.stateNode;if(typeof n.componentDidMount=="function"){var a=s.return;try{n.componentDidMount()}catch(c){vt(s,a,c)}}var i=s.return;try{zu(s)}catch(c){vt(s,i,c)}break;case 5:var l=s.return;try{zu(s)}catch(c){vt(s,l,c)}}}catch(c){vt(s,s.return,c)}if(s===e){he=null;break}var o=s.sibling;if(o!==null){o.return=s.return,he=o;break}he=s.return}}var n2=Math.ceil,hc=Br.ReactCurrentDispatcher,dh=Br.ReactCurrentOwner,Ds=Br.ReactCurrentBatchConfig,Xe=0,zt=null,Ct=null,Kt=0,Ss=0,Ia=Pn(0),Pt=0,_l=null,da=0,Dc=0,uh=0,il=null,fs=null,mh=0,ci=1/0,kr=null,xc=!1,Bu=null,Nn=null,yo=!1,xn=null,gc=0,ll=0,qu=null,Oo=-1,Do=0;function cs(){return Xe&6?jt():Oo!==-1?Oo:Oo=jt()}function kn(e){return e.mode&1?Xe&2&&Kt!==0?Kt&-Kt:Uj.transition!==null?(Do===0&&(Do=yf()),Do):(e=nt,e!==0||(e=window.event,e=e===void 0?16:Sf(e.type)),e):1}function Xs(e,s,r,n){if(50<ll)throw ll=0,qu=null,Error(te(185));Dl(e,r,n),(!(Xe&2)||e!==zt)&&(e===zt&&(!(Xe&2)&&(Dc|=r),Pt===4&&tn(e,Kt)),vs(e,n),r===1&&Xe===0&&!(s.mode&1)&&(ci=jt()+500,$c&&Rn()))}function vs(e,s){var r=e.callbackNode;Uv(e,s);var n=Xo(e,e===zt?Kt:0);if(n===0)r!==null&&o0(r),e.callbackNode=null,e.callbackPriority=0;else if(s=n&-n,e.callbackPriority!==s){if(r!=null&&o0(r),s===1)e.tag===0?zj(ex.bind(null,e)):qf(ex.bind(null,e)),Fj(function(){!(Xe&6)&&Rn()}),r=null;else{switch(bf(n)){case 1:r=Om;break;case 4:r=ff;break;case 16:r=Jo;break;case 536870912:r=pf;break;default:r=Jo}r=Hp(r,$p.bind(null,e))}e.callbackPriority=s,e.callbackNode=r}}function $p(e,s){if(Oo=-1,Do=0,Xe&6)throw Error(te(327));var r=e.callbackNode;if(Ba()&&e.callbackNode!==r)return null;var n=Xo(e,e===zt?Kt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||s)s=fc(e,n);else{s=n;var a=Xe;Xe|=2;var i=Ip();(zt!==e||Kt!==s)&&(kr=null,ci=jt()+500,na(e,s));do try{l2();break}catch(o){Fp(e,o)}while(!0);Jm(),hc.current=i,Xe=a,Ct!==null?s=0:(zt=null,Kt=0,s=Pt)}if(s!==0){if(s===2&&(a=pu(e),a!==0&&(n=a,s=Wu(e,a))),s===1)throw r=_l,na(e,0),tn(e,n),vs(e,jt()),r;if(s===6)tn(e,n);else{if(a=e.current.alternate,!(n&30)&&!a2(a)&&(s=fc(e,n),s===2&&(i=pu(e),i!==0&&(n=i,s=Wu(e,i))),s===1))throw r=_l,na(e,0),tn(e,n),vs(e,jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,s){case 0:case 1:throw Error(te(345));case 2:Hn(e,fs,kr);break;case 3:if(tn(e,n),(n&130023424)===n&&(s=mh+500-jt(),10<s)){if(Xo(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){cs(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Su(Hn.bind(null,e,fs,kr),s);break}Hn(e,fs,kr);break;case 4:if(tn(e,n),(n&4194240)===n)break;for(s=e.eventTimes,a=-1;0<n;){var l=31-Js(n);i=1<<l,l=s[l],l>a&&(a=l),n&=~i}if(n=a,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*n2(n/1960))-n,10<n){e.timeoutHandle=Su(Hn.bind(null,e,fs,kr),n);break}Hn(e,fs,kr);break;case 5:Hn(e,fs,kr);break;default:throw Error(te(329))}}}return vs(e,jt()),e.callbackNode===r?$p.bind(null,e):null}function Wu(e,s){var r=il;return e.current.memoizedState.isDehydrated&&(na(e,s).flags|=256),e=fc(e,s),e!==2&&(s=fs,fs=r,s!==null&&Ku(s)),e}function Ku(e){fs===null?fs=e:fs.push.apply(fs,e)}function a2(e){for(var s=e;;){if(s.flags&16384){var r=s.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!er(i(),a))return!1}catch{return!1}}}if(r=s.child,s.subtreeFlags&16384&&r!==null)r.return=s,s=r;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function tn(e,s){for(s&=~uh,s&=~Dc,e.suspendedLanes|=s,e.pingedLanes&=~s,e=e.expirationTimes;0<s;){var r=31-Js(s),n=1<<r;e[r]=-1,s&=~n}}function ex(e){if(Xe&6)throw Error(te(327));Ba();var s=Xo(e,0);if(!(s&1))return vs(e,jt()),null;var r=fc(e,s);if(e.tag!==0&&r===2){var n=pu(e);n!==0&&(s=n,r=Wu(e,n))}if(r===1)throw r=_l,na(e,0),tn(e,s),vs(e,jt()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=s,Hn(e,fs,kr),vs(e,jt()),null}function hh(e,s){var r=Xe;Xe|=1;try{return e(s)}finally{Xe=r,Xe===0&&(ci=jt()+500,$c&&Rn())}}function ua(e){xn!==null&&xn.tag===0&&!(Xe&6)&&Ba();var s=Xe;Xe|=1;var r=Ds.transition,n=nt;try{if(Ds.transition=null,nt=1,e)return e()}finally{nt=n,Ds.transition=r,Xe=s,!(Xe&6)&&Rn()}}function xh(){Ss=Ia.current,mt(Ia)}function na(e,s){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,$j(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(Qm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&rc();break;case 3:li(),mt(ys),mt(es),rh();break;case 5:sh(n);break;case 4:li();break;case 13:mt(gt);break;case 19:mt(gt);break;case 10:Xm(n.type._context);break;case 22:case 23:xh()}r=r.return}if(zt=e,Ct=e=Sn(e.current,null),Kt=Ss=s,Pt=0,_l=null,uh=Dc=da=0,fs=il=null,qn!==null){for(s=0;s<qn.length;s++)if(r=qn[s],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=a,n.next=l}r.pending=n}qn=null}return e}function Fp(e,s){do{var r=Ct;try{if(Jm(),$o.current=mc,uc){for(var n=ft.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}uc=!1}if(ca=0,It=Tt=ft=null,nl=!1,kl=0,dh.current=null,r===null||r.return===null){Pt=1,_l=s,Ct=null;break}e:{var i=e,l=r.return,o=r,c=s;if(s=Kt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=o,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var j=U0(l);if(j!==null){j.flags&=-257,H0(j,l,o,i,s),j.mode&1&&z0(i,d,s),s=j,c=d;var x=s.updateQueue;if(x===null){var g=new Set;g.add(c),s.updateQueue=g}else x.add(c);break e}else{if(!(s&1)){z0(i,d,s),gh();break e}c=Error(te(426))}}else if(ht&&o.mode&1){var y=U0(l);if(y!==null){!(y.flags&65536)&&(y.flags|=256),H0(y,l,o,i,s),Gm(oi(c,o));break e}}i=c=oi(c,o),Pt!==4&&(Pt=2),il===null?il=[i]:il.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,s&=-s,i.lanes|=s;var b=bp(i,c,s);L0(i,b);break e;case 1:o=c;var f=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Nn===null||!Nn.has(v)))){i.flags|=65536,s&=-s,i.lanes|=s;var w=vp(i,o,s);L0(i,w);break e}}i=i.return}while(i!==null)}Dp(r)}catch(N){s=N,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function Ip(){var e=hc.current;return hc.current=mc,e===null?mc:e}function gh(){(Pt===0||Pt===3||Pt===2)&&(Pt=4),zt===null||!(da&268435455)&&!(Dc&268435455)||tn(zt,Kt)}function fc(e,s){var r=Xe;Xe|=2;var n=Ip();(zt!==e||Kt!==s)&&(kr=null,na(e,s));do try{i2();break}catch(a){Fp(e,a)}while(!0);if(Jm(),Xe=r,hc.current=n,Ct!==null)throw Error(te(261));return zt=null,Kt=0,Pt}function i2(){for(;Ct!==null;)Op(Ct)}function l2(){for(;Ct!==null&&!Pv();)Op(Ct)}function Op(e){var s=Up(e.alternate,e,Ss);e.memoizedProps=e.pendingProps,s===null?Dp(e):Ct=s,dh.current=null}function Dp(e){var s=e;do{var r=s.alternate;if(e=s.return,s.flags&32768){if(r=e2(r,s),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Pt=6,Ct=null;return}}else if(r=Zj(r,s,Ss),r!==null){Ct=r;return}if(s=s.sibling,s!==null){Ct=s;return}Ct=s=e}while(s!==null);Pt===0&&(Pt=5)}function Hn(e,s,r){var n=nt,a=Ds.transition;try{Ds.transition=null,nt=1,o2(e,s,r,n)}finally{Ds.transition=a,nt=n}return null}function o2(e,s,r,n){do Ba();while(xn!==null);if(Xe&6)throw Error(te(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Hv(e,i),e===zt&&(Ct=zt=null,Kt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yo||(yo=!0,Hp(Jo,function(){return Ba(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Ds.transition,Ds.transition=null;var l=nt;nt=1;var o=Xe;Xe|=4,dh.current=null,s2(e,r),Rp(r,e),Ej(Nu),Zo=!!wu,Nu=wu=null,e.current=r,r2(r),Rv(),Xe=o,nt=l,Ds.transition=i}else e.current=r;if(yo&&(yo=!1,xn=e,gc=a),i=e.pendingLanes,i===0&&(Nn=null),Fv(r.stateNode),vs(e,jt()),s!==null)for(n=e.onRecoverableError,r=0;r<s.length;r++)a=s[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(xc)throw xc=!1,e=Bu,Bu=null,e;return gc&1&&e.tag!==0&&Ba(),i=e.pendingLanes,i&1?e===qu?ll++:(ll=0,qu=e):ll=0,Rn(),null}function Ba(){if(xn!==null){var e=bf(gc),s=Ds.transition,r=nt;try{if(Ds.transition=null,nt=16>e?16:e,xn===null)var n=!1;else{if(e=xn,xn=null,gc=0,Xe&6)throw Error(te(331));var a=Xe;for(Xe|=4,he=e.current;he!==null;){var i=he,l=i.child;if(he.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(he=d;he!==null;){var h=he;switch(h.tag){case 0:case 11:case 15:al(8,h,i)}var u=h.child;if(u!==null)u.return=h,he=u;else for(;he!==null;){h=he;var p=h.sibling,j=h.return;if(Tp(h),h===d){he=null;break}if(p!==null){p.return=j,he=p;break}he=j}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}he=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,he=l;else e:for(;he!==null;){if(i=he,i.flags&2048)switch(i.tag){case 0:case 11:case 15:al(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,he=b;break e}he=i.return}}var f=e.current;for(he=f;he!==null;){l=he;var v=l.child;if(l.subtreeFlags&2064&&v!==null)v.return=l,he=v;else e:for(l=f;he!==null;){if(o=he,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Oc(9,o)}}catch(N){vt(o,o.return,N)}if(o===l){he=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,he=w;break e}he=o.return}}if(Xe=a,Rn(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(Tc,e)}catch{}n=!0}return n}finally{nt=r,Ds.transition=s}}return!1}function tx(e,s,r){s=oi(r,s),s=bp(e,s,1),e=wn(e,s,1),s=cs(),e!==null&&(Dl(e,1,s),vs(e,s))}function vt(e,s,r){if(e.tag===3)tx(e,e,r);else for(;s!==null;){if(s.tag===3){tx(s,e,r);break}else if(s.tag===1){var n=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Nn===null||!Nn.has(n))){e=oi(r,e),e=vp(s,e,1),s=wn(s,e,1),e=cs(),s!==null&&(Dl(s,1,e),vs(s,e));break}}s=s.return}}function c2(e,s,r){var n=e.pingCache;n!==null&&n.delete(s),s=cs(),e.pingedLanes|=e.suspendedLanes&r,zt===e&&(Kt&r)===r&&(Pt===4||Pt===3&&(Kt&130023424)===Kt&&500>jt()-mh?na(e,0):uh|=r),vs(e,s)}function zp(e,s){s===0&&(e.mode&1?(s=lo,lo<<=1,!(lo&130023424)&&(lo=4194304)):s=1);var r=cs();e=zr(e,s),e!==null&&(Dl(e,s,r),vs(e,r))}function d2(e){var s=e.memoizedState,r=0;s!==null&&(r=s.retryLane),zp(e,r)}function u2(e,s){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(te(314))}n!==null&&n.delete(s),zp(e,r)}var Up;Up=function(e,s,r){if(e!==null)if(e.memoizedProps!==s.pendingProps||ys.current)ps=!0;else{if(!(e.lanes&r)&&!(s.flags&128))return ps=!1,Xj(e,s,r);ps=!!(e.flags&131072)}else ps=!1,ht&&s.flags&1048576&&Wf(s,ic,s.index);switch(s.lanes=0,s.tag){case 2:var n=s.type;Io(e,s),e=s.pendingProps;var a=ni(s,es.current);Ha(s,r),a=ah(null,s,n,e,a,r);var i=ih();return s.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,bs(n)?(i=!0,nc(s)):i=!1,s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,eh(s),a.updater=Ic,s.stateNode=a,a._reactInternals=s,Pu(s,n,e,r),s=$u(null,s,n,!0,i,r)):(s.tag=0,ht&&i&&Vm(s),ls(null,s,a,r),s=s.child),s;case 16:n=s.elementType;e:{switch(Io(e,s),e=s.pendingProps,a=n._init,n=a(n._payload),s.type=n,a=s.tag=h2(n),e=qs(n,e),a){case 0:s=Lu(null,s,n,e,r);break e;case 1:s=W0(null,s,n,e,r);break e;case 11:s=B0(null,s,n,e,r);break e;case 14:s=q0(null,s,n,qs(n.type,e),r);break e}throw Error(te(306,n,""))}return s;case 0:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:qs(n,a),Lu(e,s,n,a,r);case 1:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:qs(n,a),W0(e,s,n,a,r);case 3:e:{if(kp(s),e===null)throw Error(te(387));n=s.pendingProps,i=s.memoizedState,a=i.element,Jf(e,s),cc(s,n,null,r);var l=s.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},s.updateQueue.baseState=i,s.memoizedState=i,s.flags&256){a=oi(Error(te(423)),s),s=K0(e,s,n,r,a);break e}else if(n!==a){a=oi(Error(te(424)),s),s=K0(e,s,n,r,a);break e}else for(Cs=jn(s.stateNode.containerInfo.firstChild),_s=s,ht=!0,Gs=null,r=Gf(s,null,n,r),s.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ai(),n===a){s=Ur(e,s,r);break e}ls(e,s,n,r)}s=s.child}return s;case 5:return Xf(s),e===null&&Mu(s),n=s.type,a=s.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,ku(n,a)?l=null:i!==null&&ku(n,i)&&(s.flags|=32),Np(e,s),ls(e,s,l,r),s.child;case 6:return e===null&&Mu(s),null;case 13:return Sp(e,s,r);case 4:return th(s,s.stateNode.containerInfo),n=s.pendingProps,e===null?s.child=ii(s,null,n,r):ls(e,s,n,r),s.child;case 11:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:qs(n,a),B0(e,s,n,a,r);case 7:return ls(e,s,s.pendingProps,r),s.child;case 8:return ls(e,s,s.pendingProps.children,r),s.child;case 12:return ls(e,s,s.pendingProps.children,r),s.child;case 10:e:{if(n=s.type._context,a=s.pendingProps,i=s.memoizedProps,l=a.value,ot(lc,n._currentValue),n._currentValue=l,i!==null)if(er(i.value,l)){if(i.children===a.children&&!ys.current){s=Ur(e,s,r);break e}}else for(i=s.child,i!==null&&(i.return=s);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Lr(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Tu(i.return,r,s),o.lanes|=r;break}c=c.next}}else if(i.tag===10)l=i.type===s.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(te(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Tu(l,r,s),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===s){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}ls(e,s,a.children,r),s=s.child}return s;case 9:return a=s.type,n=s.pendingProps.children,Ha(s,r),a=zs(a),n=n(a),s.flags|=1,ls(e,s,n,r),s.child;case 14:return n=s.type,a=qs(n,s.pendingProps),a=qs(n.type,a),q0(e,s,n,a,r);case 15:return jp(e,s,s.type,s.pendingProps,r);case 17:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:qs(n,a),Io(e,s),s.tag=1,bs(n)?(e=!0,nc(s)):e=!1,Ha(s,r),yp(s,n,a),Pu(s,n,a,r),$u(null,s,n,!0,e,r);case 19:return Cp(e,s,r);case 22:return wp(e,s,r)}throw Error(te(156,s.tag))};function Hp(e,s){return gf(e,s)}function m2(e,s,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Is(e,s,r,n){return new m2(e,s,r,n)}function fh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function h2(e){if(typeof e=="function")return fh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===$m)return 11;if(e===Fm)return 14}return 2}function Sn(e,s){var r=e.alternate;return r===null?(r=Is(e.tag,s,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=s,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,s=e.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function zo(e,s,r,n,a,i){var l=2;if(n=e,typeof e=="function")fh(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case _a:return aa(r.children,a,i,s);case Lm:l=8,a|=8;break;case su:return e=Is(12,r,s,a|2),e.elementType=su,e.lanes=i,e;case ru:return e=Is(13,r,s,a),e.elementType=ru,e.lanes=i,e;case nu:return e=Is(19,r,s,a),e.elementType=nu,e.lanes=i,e;case Jg:return zc(r,a,i,s);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Gg:l=10;break e;case Yg:l=9;break e;case $m:l=11;break e;case Fm:l=14;break e;case Xr:l=16,n=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return s=Is(l,r,s,a),s.elementType=e,s.type=n,s.lanes=i,s}function aa(e,s,r,n){return e=Is(7,e,n,s),e.lanes=r,e}function zc(e,s,r,n){return e=Is(22,e,n,s),e.elementType=Jg,e.lanes=r,e.stateNode={isHidden:!1},e}function Pd(e,s,r){return e=Is(6,e,null,s),e.lanes=r,e}function Rd(e,s,r){return s=Is(4,e.children!==null?e.children:[],e.key,s),s.lanes=r,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}function x2(e,s,r,n,a){this.tag=s,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hd(0),this.expirationTimes=hd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hd(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function ph(e,s,r,n,a,i,l,o,c){return e=new x2(e,s,r,o,c),s===1?(s=1,i===!0&&(s|=8)):s=0,i=Is(3,null,null,s),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},eh(i),e}function g2(e,s,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ca,key:n==null?null:""+n,children:e,containerInfo:s,implementation:r}}function Bp(e){if(!e)return Tn;e=e._reactInternals;e:{if(pa(e)!==e||e.tag!==1)throw Error(te(170));var s=e;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(bs(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(bs(r))return Bf(e,r,s)}return s}function qp(e,s,r,n,a,i,l,o,c){return e=ph(r,n,!0,e,a,i,l,o,c),e.context=Bp(null),r=e.current,n=cs(),a=kn(r),i=Lr(n,a),i.callback=s??null,wn(r,i,a),e.current.lanes=a,Dl(e,a,n),vs(e,n),e}function Uc(e,s,r,n){var a=s.current,i=cs(),l=kn(a);return r=Bp(r),s.context===null?s.context=r:s.pendingContext=r,s=Lr(i,l),s.payload={element:e},n=n===void 0?null:n,n!==null&&(s.callback=n),e=wn(a,s,l),e!==null&&(Xs(e,a,l,i),Lo(e,a,l)),l}function pc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sx(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<s?r:s}}function yh(e,s){sx(e,s),(e=e.alternate)&&sx(e,s)}function f2(){return null}var Wp=typeof reportError=="function"?reportError:function(e){console.error(e)};function bh(e){this._internalRoot=e}Hc.prototype.render=bh.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(te(409));Uc(e,s,null,null)};Hc.prototype.unmount=bh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;ua(function(){Uc(null,e,null,null)}),s[Dr]=null}};function Hc(e){this._internalRoot=e}Hc.prototype.unstable_scheduleHydration=function(e){if(e){var s=wf();e={blockedOn:null,target:e,priority:s};for(var r=0;r<en.length&&s!==0&&s<en[r].priority;r++);en.splice(r,0,e),r===0&&kf(e)}};function vh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rx(){}function p2(e,s,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=pc(l);i.call(d)}}var l=qp(s,n,e,0,null,!1,!1,"",rx);return e._reactRootContainer=l,e[Dr]=l.current,bl(e.nodeType===8?e.parentNode:e),ua(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var d=pc(c);o.call(d)}}var c=ph(e,0,!1,null,null,!1,!1,"",rx);return e._reactRootContainer=c,e[Dr]=c.current,bl(e.nodeType===8?e.parentNode:e),ua(function(){Uc(s,c,r,n)}),c}function qc(e,s,r,n,a){var i=r._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var c=pc(l);o.call(c)}}Uc(s,l,e,a)}else l=p2(r,s,e,a,n);return pc(l)}vf=function(e){switch(e.tag){case 3:var s=e.stateNode;if(s.current.memoizedState.isDehydrated){var r=Ki(s.pendingLanes);r!==0&&(Dm(s,r|1),vs(s,jt()),!(Xe&6)&&(ci=jt()+500,Rn()))}break;case 13:ua(function(){var n=zr(e,1);if(n!==null){var a=cs();Xs(n,e,1,a)}}),yh(e,1)}};zm=function(e){if(e.tag===13){var s=zr(e,134217728);if(s!==null){var r=cs();Xs(s,e,134217728,r)}yh(e,134217728)}};jf=function(e){if(e.tag===13){var s=kn(e),r=zr(e,s);if(r!==null){var n=cs();Xs(r,e,s,n)}yh(e,s)}};wf=function(){return nt};Nf=function(e,s){var r=nt;try{return nt=e,s()}finally{nt=r}};xu=function(e,s,r){switch(s){case"input":if(lu(e,r),s=r.name,r.type==="radio"&&s!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<r.length;s++){var n=r[s];if(n!==e&&n.form===e.form){var a=Lc(n);if(!a)throw Error(te(90));Zg(n),lu(n,a)}}}break;case"textarea":tf(e,r);break;case"select":s=r.value,s!=null&&Oa(e,!!r.multiple,s,!1)}};cf=hh;df=ua;var y2={usingClientEntryPoint:!1,Events:[Ul,Aa,Lc,lf,of,hh]},Fi={findFiberByHostInstance:Bn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},b2={bundleType:Fi.bundleType,version:Fi.version,rendererPackageName:Fi.rendererPackageName,rendererConfig:Fi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Br.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hf(e),e===null?null:e.stateNode},findFiberByHostInstance:Fi.findFiberByHostInstance||f2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{Tc=bo.inject(b2),fr=bo}catch{}}Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y2;Ms.createPortal=function(e,s){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vh(s))throw Error(te(200));return g2(e,s,null,r)};Ms.createRoot=function(e,s){if(!vh(e))throw Error(te(299));var r=!1,n="",a=Wp;return s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(n=s.identifierPrefix),s.onRecoverableError!==void 0&&(a=s.onRecoverableError)),s=ph(e,1,!1,null,null,r,!1,n,a),e[Dr]=s.current,bl(e.nodeType===8?e.parentNode:e),new bh(s)};Ms.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=hf(s),e=e===null?null:e.stateNode,e};Ms.flushSync=function(e){return ua(e)};Ms.hydrate=function(e,s,r){if(!Bc(s))throw Error(te(200));return qc(null,e,s,!0,r)};Ms.hydrateRoot=function(e,s,r){if(!vh(e))throw Error(te(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",l=Wp;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),s=qp(s,null,e,1,r??null,a,!1,i,l),e[Dr]=s.current,bl(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[r,a]:s.mutableSourceEagerHydrationData.push(r,a);return new Hc(s)};Ms.render=function(e,s,r){if(!Bc(s))throw Error(te(200));return qc(null,e,s,!1,r)};Ms.unmountComponentAtNode=function(e){if(!Bc(e))throw Error(te(40));return e._reactRootContainer?(ua(function(){qc(null,null,e,!1,function(){e._reactRootContainer=null,e[Dr]=null})}),!0):!1};Ms.unstable_batchedUpdates=hh;Ms.unstable_renderSubtreeIntoContainer=function(e,s,r,n){if(!Bc(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return qc(e,s,r,!1,n)};Ms.version="18.3.1-next-f1338f8080-20240426";function Kp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kp)}catch(e){console.error(e)}}Kp(),Wg.exports=Ms;var Vp=Wg.exports,nx=Vp;eu.createRoot=nx.createRoot,eu.hydrateRoot=nx.hydrateRoot;var vi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},v2={setTimeout:(e,s)=>setTimeout(e,s),clearTimeout:e=>clearTimeout(e),setInterval:(e,s)=>setInterval(e,s),clearInterval:e=>clearInterval(e)},rn,Cm,wg,j2=(wg=class{constructor(){Se(this,rn,v2);Se(this,Cm,!1)}setTimeoutProvider(e){ce(this,rn,e)}setTimeout(e,s){return C(this,rn).setTimeout(e,s)}clearTimeout(e){C(this,rn).clearTimeout(e)}setInterval(e,s){return C(this,rn).setInterval(e,s)}clearInterval(e){C(this,rn).clearInterval(e)}},rn=new WeakMap,Cm=new WeakMap,wg),Kn=new j2;function w2(e){setTimeout(e,0)}var ma=typeof window>"u"||"Deno"in globalThis;function os(){}function N2(e,s){return typeof e=="function"?e(s):e}function Vu(e){return typeof e=="number"&&e>=0&&e!==1/0}function Qp(e,s){return Math.max(e+(s||0)-Date.now(),0)}function Cn(e,s){return typeof e=="function"?e(s):e}function Ls(e,s){return typeof e=="function"?e(s):e}function ax(e,s){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(s.queryHash!==jh(l,s.options))return!1}else if(!El(s.queryKey,l))return!1}if(r!=="all"){const c=s.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&s.isStale()!==o||a&&a!==s.state.fetchStatus||i&&!i(s))}function ix(e,s){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!s.options.mutationKey)return!1;if(r){if(ha(s.options.mutationKey)!==ha(i))return!1}else if(!El(s.options.mutationKey,i))return!1}return!(n&&s.state.status!==n||a&&!a(s))}function jh(e,s){return((s==null?void 0:s.queryKeyHashFn)||ha)(e)}function ha(e){return JSON.stringify(e,(s,r)=>Qu(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function El(e,s){return e===s?!0:typeof e!=typeof s?!1:e&&s&&typeof e=="object"&&typeof s=="object"?Object.keys(s).every(r=>El(e[r],s[r])):!1}var k2=Object.prototype.hasOwnProperty;function Gp(e,s){if(e===s)return e;const r=lx(e)&&lx(s);if(!r&&!(Qu(e)&&Qu(s)))return s;const a=(r?e:Object.keys(e)).length,i=r?s:Object.keys(s),l=i.length,o=r?new Array(l):{};let c=0;for(let d=0;d<l;d++){const h=r?d:i[d],u=e[h],p=s[h];if(u===p){o[h]=u,(r?d<a:k2.call(e,h))&&c++;continue}if(u===null||p===null||typeof u!="object"||typeof p!="object"){o[h]=p;continue}const j=Gp(u,p);o[h]=j,j===u&&c++}return a===l&&c===a?e:o}function yc(e,s){if(!s||Object.keys(e).length!==Object.keys(s).length)return!1;for(const r in e)if(e[r]!==s[r])return!1;return!0}function lx(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Qu(e){if(!ox(e))return!1;const s=e.constructor;if(s===void 0)return!0;const r=s.prototype;return!(!ox(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ox(e){return Object.prototype.toString.call(e)==="[object Object]"}function S2(e){return new Promise(s=>{Kn.setTimeout(s,e)})}function Gu(e,s,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,s):r.structuralSharing!==!1?Gp(e,s):s}function C2(e,s,r=0){const n=[...e,s];return r&&n.length>r?n.slice(1):n}function _2(e,s,r=0){const n=[s,...e];return r&&n.length>r?n.slice(0,-1):n}var wh=Symbol();function Yp(e,s){return!e.queryFn&&(s!=null&&s.initialPromise)?()=>s.initialPromise:!e.queryFn||e.queryFn===wh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Jp(e,s){return typeof e=="function"?e(...s):!!e}var Gn,nn,qa,Ng,E2=(Ng=class extends vi{constructor(){super();Se(this,Gn);Se(this,nn);Se(this,qa);ce(this,qa,s=>{if(!ma&&window.addEventListener){const r=()=>s();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){C(this,nn)||this.setEventListener(C(this,qa))}onUnsubscribe(){var s;this.hasListeners()||((s=C(this,nn))==null||s.call(this),ce(this,nn,void 0))}setEventListener(s){var r;ce(this,qa,s),(r=C(this,nn))==null||r.call(this),ce(this,nn,s(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(s){C(this,Gn)!==s&&(ce(this,Gn,s),this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(r=>{r(s)})}isFocused(){var s;return typeof C(this,Gn)=="boolean"?C(this,Gn):((s=globalThis.document)==null?void 0:s.visibilityState)!=="hidden"}},Gn=new WeakMap,nn=new WeakMap,qa=new WeakMap,Ng),Nh=new E2;function Yu(){let e,s;const r=new Promise((a,i)=>{e=a,s=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),s(a)},r}var M2=w2;function T2(){let e=[],s=0,r=o=>{o()},n=o=>{o()},a=M2;const i=o=>{s?e.push(o):a(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;s++;try{c=o()}finally{s--,s||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var At=T2(),Wa,an,Ka,kg,A2=(kg=class extends vi{constructor(){super();Se(this,Wa,!0);Se(this,an);Se(this,Ka);ce(this,Ka,s=>{if(!ma&&window.addEventListener){const r=()=>s(!0),n=()=>s(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){C(this,an)||this.setEventListener(C(this,Ka))}onUnsubscribe(){var s;this.hasListeners()||((s=C(this,an))==null||s.call(this),ce(this,an,void 0))}setEventListener(s){var r;ce(this,Ka,s),(r=C(this,an))==null||r.call(this),ce(this,an,s(this.setOnline.bind(this)))}setOnline(s){C(this,Wa)!==s&&(ce(this,Wa,s),this.listeners.forEach(n=>{n(s)}))}isOnline(){return C(this,Wa)}},Wa=new WeakMap,an=new WeakMap,Ka=new WeakMap,kg),bc=new A2;function P2(e){return Math.min(1e3*2**e,3e4)}function Xp(e){return(e??"online")==="online"?bc.isOnline():!0}var Ju=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Zp(e){let s=!1,r=0,n;const a=Yu(),i=()=>a.status!=="pending",l=g=>{var y;if(!i()){const b=new Ju(g);p(b),(y=e.onCancel)==null||y.call(e,b)}},o=()=>{s=!0},c=()=>{s=!1},d=()=>Nh.isFocused()&&(e.networkMode==="always"||bc.isOnline())&&e.canRun(),h=()=>Xp(e.networkMode)&&e.canRun(),u=g=>{i()||(n==null||n(),a.resolve(g))},p=g=>{i()||(n==null||n(),a.reject(g))},j=()=>new Promise(g=>{var y;n=b=>{(i()||d())&&g(b)},(y=e.onPause)==null||y.call(e)}).then(()=>{var g;n=void 0,i()||(g=e.onContinue)==null||g.call(e)}),x=()=>{if(i())return;let g;const y=r===0?e.initialPromise:void 0;try{g=y??e.fn()}catch(b){g=Promise.reject(b)}Promise.resolve(g).then(u).catch(b=>{var P;if(i())return;const f=e.retry??(ma?0:3),v=e.retryDelay??P2,w=typeof v=="function"?v(r,b):v,N=f===!0||typeof f=="number"&&r<f||typeof f=="function"&&f(r,b);if(s||!N){p(b);return}r++,(P=e.onFail)==null||P.call(e,r,b),S2(w).then(()=>d()?void 0:j()).then(()=>{s?p(b):x()})})};return{promise:a,status:()=>a.status,cancel:l,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:c,canStart:h,start:()=>(h()?x():j().then(x),a)}}var Yn,Sg,ey=(Sg=class{constructor(){Se(this,Yn)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Vu(this.gcTime)&&ce(this,Yn,Kn.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ma?1/0:5*60*1e3))}clearGcTimeout(){C(this,Yn)&&(Kn.clearTimeout(C(this,Yn)),ce(this,Yn,void 0))}},Yn=new WeakMap,Sg),Jn,Va,Rs,Xn,$t,Rl,Zn,Ks,Nr,Cg,R2=(Cg=class extends ey{constructor(s){super();Se(this,Ks);Se(this,Jn);Se(this,Va);Se(this,Rs);Se(this,Xn);Se(this,$t);Se(this,Rl);Se(this,Zn);ce(this,Zn,!1),ce(this,Rl,s.defaultOptions),this.setOptions(s.options),this.observers=[],ce(this,Xn,s.client),ce(this,Rs,C(this,Xn).getQueryCache()),this.queryKey=s.queryKey,this.queryHash=s.queryHash,ce(this,Jn,dx(this.options)),this.state=s.state??C(this,Jn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var s;return(s=C(this,$t))==null?void 0:s.promise}setOptions(s){if(this.options={...C(this,Rl),...s},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=dx(this.options);r.data!==void 0&&(this.setState(cx(r.data,r.dataUpdatedAt)),ce(this,Jn,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&C(this,Rs).remove(this)}setData(s,r){const n=Gu(this.state.data,s,this.options);return Ue(this,Ks,Nr).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(s,r){Ue(this,Ks,Nr).call(this,{type:"setState",state:s,setStateOptions:r})}cancel(s){var n,a;const r=(n=C(this,$t))==null?void 0:n.promise;return(a=C(this,$t))==null||a.cancel(s),r?r.then(os).catch(os):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(C(this,Jn))}isActive(){return this.observers.some(s=>Ls(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===wh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(s=>Cn(s.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(s=0){return this.state.data===void 0?!0:s==="static"?!1:this.state.isInvalidated?!0:!Qp(this.state.dataUpdatedAt,s)}onFocus(){var r;const s=this.observers.find(n=>n.shouldFetchOnWindowFocus());s==null||s.refetch({cancelRefetch:!1}),(r=C(this,$t))==null||r.continue()}onOnline(){var r;const s=this.observers.find(n=>n.shouldFetchOnReconnect());s==null||s.refetch({cancelRefetch:!1}),(r=C(this,$t))==null||r.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),C(this,Rs).notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(r=>r!==s),this.observers.length||(C(this,$t)&&(C(this,Zn)?C(this,$t).cancel({revert:!0}):C(this,$t).cancelRetry()),this.scheduleGc()),C(this,Rs).notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ue(this,Ks,Nr).call(this,{type:"invalidate"})}async fetch(s,r){var c,d,h,u,p,j,x,g,y,b,f,v;if(this.state.fetchStatus!=="idle"&&((c=C(this,$t))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(C(this,$t))return C(this,$t).continueRetry(),C(this,$t).promise}if(s&&this.setOptions(s),!this.options.queryFn){const w=this.observers.find(N=>N.options.queryFn);w&&this.setOptions(w.options)}const n=new AbortController,a=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(ce(this,Zn,!0),n.signal)})},i=()=>{const w=Yp(this.options,r),P=(()=>{const z={client:C(this,Xn),queryKey:this.queryKey,meta:this.meta};return a(z),z})();return ce(this,Zn,!1),this.options.persister?this.options.persister(w,P,this):w(P)},o=(()=>{const w={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:C(this,Xn),state:this.state,fetchFn:i};return a(w),w})();(d=this.options.behavior)==null||d.onFetch(o,this),ce(this,Va,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=o.fetchOptions)==null?void 0:h.meta))&&Ue(this,Ks,Nr).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta}),ce(this,$t,Zp({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:w=>{w instanceof Ju&&w.revert&&this.setState({...C(this,Va),fetchStatus:"idle"}),n.abort()},onFail:(w,N)=>{Ue(this,Ks,Nr).call(this,{type:"failed",failureCount:w,error:N})},onPause:()=>{Ue(this,Ks,Nr).call(this,{type:"pause"})},onContinue:()=>{Ue(this,Ks,Nr).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const w=await C(this,$t).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(j=(p=C(this,Rs).config).onSuccess)==null||j.call(p,w,this),(g=(x=C(this,Rs).config).onSettled)==null||g.call(x,w,this.state.error,this),w}catch(w){if(w instanceof Ju){if(w.silent)return C(this,$t).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw Ue(this,Ks,Nr).call(this,{type:"error",error:w}),(b=(y=C(this,Rs).config).onError)==null||b.call(y,w,this),(v=(f=C(this,Rs).config).onSettled)==null||v.call(f,this.state.data,w,this),w}finally{this.scheduleGc()}}},Jn=new WeakMap,Va=new WeakMap,Rs=new WeakMap,Xn=new WeakMap,$t=new WeakMap,Rl=new WeakMap,Zn=new WeakMap,Ks=new WeakSet,Nr=function(s){const r=n=>{switch(s.type){case"failed":return{...n,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...ty(n.data,this.options),fetchMeta:s.meta??null};case"success":const a={...n,...cx(s.data,s.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ce(this,Va,s.manual?a:void 0),a;case"error":const i=s.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...s.state}}};this.state=r(this.state),At.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),C(this,Rs).notify({query:this,type:"updated",action:s})})},Cg);function ty(e,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Xp(s.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function cx(e,s){return{data:e,dataUpdatedAt:s??Date.now(),error:null,isInvalidated:!1,status:"success"}}function dx(e){const s=typeof e.initialData=="function"?e.initialData():e.initialData,r=s!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var xs,Qe,Ll,as,ea,Qa,Cr,ln,$l,Ga,Ya,ta,sa,on,Ja,tt,Qi,Xu,Zu,em,tm,sm,rm,nm,sy,_g,L2=(_g=class extends vi{constructor(s,r){super();Se(this,tt);Se(this,xs);Se(this,Qe);Se(this,Ll);Se(this,as);Se(this,ea);Se(this,Qa);Se(this,Cr);Se(this,ln);Se(this,$l);Se(this,Ga);Se(this,Ya);Se(this,ta);Se(this,sa);Se(this,on);Se(this,Ja,new Set);this.options=r,ce(this,xs,s),ce(this,ln,null),ce(this,Cr,Yu()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(C(this,Qe).addObserver(this),ux(C(this,Qe),this.options)?Ue(this,tt,Qi).call(this):this.updateResult(),Ue(this,tt,tm).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return am(C(this,Qe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return am(C(this,Qe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ue(this,tt,sm).call(this),Ue(this,tt,rm).call(this),C(this,Qe).removeObserver(this)}setOptions(s){const r=this.options,n=C(this,Qe);if(this.options=C(this,xs).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ls(this.options.enabled,C(this,Qe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ue(this,tt,nm).call(this),C(this,Qe).setOptions(this.options),r._defaulted&&!yc(this.options,r)&&C(this,xs).getQueryCache().notify({type:"observerOptionsUpdated",query:C(this,Qe),observer:this});const a=this.hasListeners();a&&mx(C(this,Qe),n,this.options,r)&&Ue(this,tt,Qi).call(this),this.updateResult(),a&&(C(this,Qe)!==n||Ls(this.options.enabled,C(this,Qe))!==Ls(r.enabled,C(this,Qe))||Cn(this.options.staleTime,C(this,Qe))!==Cn(r.staleTime,C(this,Qe)))&&Ue(this,tt,Xu).call(this);const i=Ue(this,tt,Zu).call(this);a&&(C(this,Qe)!==n||Ls(this.options.enabled,C(this,Qe))!==Ls(r.enabled,C(this,Qe))||i!==C(this,on))&&Ue(this,tt,em).call(this,i)}getOptimisticResult(s){const r=C(this,xs).getQueryCache().build(C(this,xs),s),n=this.createResult(r,s);return F2(this,n)&&(ce(this,as,n),ce(this,Qa,this.options),ce(this,ea,C(this,Qe).state)),n}getCurrentResult(){return C(this,as)}trackResult(s,r){return new Proxy(s,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&C(this,Cr).status==="pending"&&C(this,Cr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(s){C(this,Ja).add(s)}getCurrentQuery(){return C(this,Qe)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const r=C(this,xs).defaultQueryOptions(s),n=C(this,xs).getQueryCache().build(C(this,xs),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(s){return Ue(this,tt,Qi).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),C(this,as)))}createResult(s,r){var X;const n=C(this,Qe),a=this.options,i=C(this,as),l=C(this,ea),o=C(this,Qa),d=s!==n?s.state:C(this,Ll),{state:h}=s;let u={...h},p=!1,j;if(r._optimisticResults){const T=this.hasListeners(),F=!T&&ux(s,r),Q=T&&mx(s,n,r,a);(F||Q)&&(u={...u,...ty(h.data,s.options)}),r._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:x,errorUpdatedAt:g,status:y}=u;j=u.data;let b=!1;if(r.placeholderData!==void 0&&j===void 0&&y==="pending"){let T;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(T=i.data,b=!0):T=typeof r.placeholderData=="function"?r.placeholderData((X=C(this,Ya))==null?void 0:X.state.data,C(this,Ya)):r.placeholderData,T!==void 0&&(y="success",j=Gu(i==null?void 0:i.data,T,r),p=!0)}if(r.select&&j!==void 0&&!b)if(i&&j===(l==null?void 0:l.data)&&r.select===C(this,$l))j=C(this,Ga);else try{ce(this,$l,r.select),j=r.select(j),j=Gu(i==null?void 0:i.data,j,r),ce(this,Ga,j),ce(this,ln,null)}catch(T){ce(this,ln,T)}C(this,ln)&&(x=C(this,ln),j=C(this,Ga),g=Date.now(),y="error");const f=u.fetchStatus==="fetching",v=y==="pending",w=y==="error",N=v&&f,P=j!==void 0,E={status:y,fetchStatus:u.fetchStatus,isPending:v,isSuccess:y==="success",isError:w,isInitialLoading:N,isLoading:N,data:j,dataUpdatedAt:u.dataUpdatedAt,error:x,errorUpdatedAt:g,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>d.dataUpdateCount||u.errorUpdateCount>d.errorUpdateCount,isFetching:f,isRefetching:f&&!v,isLoadingError:w&&!P,isPaused:u.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&P,isStale:kh(s,r),refetch:this.refetch,promise:C(this,Cr),isEnabled:Ls(r.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const T=Z=>{E.status==="error"?Z.reject(E.error):E.data!==void 0&&Z.resolve(E.data)},F=()=>{const Z=ce(this,Cr,E.promise=Yu());T(Z)},Q=C(this,Cr);switch(Q.status){case"pending":s.queryHash===n.queryHash&&T(Q);break;case"fulfilled":(E.status==="error"||E.data!==Q.value)&&F();break;case"rejected":(E.status!=="error"||E.error!==Q.reason)&&F();break}}return E}updateResult(){const s=C(this,as),r=this.createResult(C(this,Qe),this.options);if(ce(this,ea,C(this,Qe).state),ce(this,Qa,this.options),C(this,ea).data!==void 0&&ce(this,Ya,C(this,Qe)),yc(r,s))return;ce(this,as,r);const n=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!C(this,Ja).size)return!0;const l=new Set(i??C(this,Ja));return this.options.throwOnError&&l.add("error"),Object.keys(C(this,as)).some(o=>{const c=o;return C(this,as)[c]!==s[c]&&l.has(c)})};Ue(this,tt,sy).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ue(this,tt,tm).call(this)}},xs=new WeakMap,Qe=new WeakMap,Ll=new WeakMap,as=new WeakMap,ea=new WeakMap,Qa=new WeakMap,Cr=new WeakMap,ln=new WeakMap,$l=new WeakMap,Ga=new WeakMap,Ya=new WeakMap,ta=new WeakMap,sa=new WeakMap,on=new WeakMap,Ja=new WeakMap,tt=new WeakSet,Qi=function(s){Ue(this,tt,nm).call(this);let r=C(this,Qe).fetch(this.options,s);return s!=null&&s.throwOnError||(r=r.catch(os)),r},Xu=function(){Ue(this,tt,sm).call(this);const s=Cn(this.options.staleTime,C(this,Qe));if(ma||C(this,as).isStale||!Vu(s))return;const n=Qp(C(this,as).dataUpdatedAt,s)+1;ce(this,ta,Kn.setTimeout(()=>{C(this,as).isStale||this.updateResult()},n))},Zu=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(C(this,Qe)):this.options.refetchInterval)??!1},em=function(s){Ue(this,tt,rm).call(this),ce(this,on,s),!(ma||Ls(this.options.enabled,C(this,Qe))===!1||!Vu(C(this,on))||C(this,on)===0)&&ce(this,sa,Kn.setInterval(()=>{(this.options.refetchIntervalInBackground||Nh.isFocused())&&Ue(this,tt,Qi).call(this)},C(this,on)))},tm=function(){Ue(this,tt,Xu).call(this),Ue(this,tt,em).call(this,Ue(this,tt,Zu).call(this))},sm=function(){C(this,ta)&&(Kn.clearTimeout(C(this,ta)),ce(this,ta,void 0))},rm=function(){C(this,sa)&&(Kn.clearInterval(C(this,sa)),ce(this,sa,void 0))},nm=function(){const s=C(this,xs).getQueryCache().build(C(this,xs),this.options);if(s===C(this,Qe))return;const r=C(this,Qe);ce(this,Qe,s),ce(this,Ll,s.state),this.hasListeners()&&(r==null||r.removeObserver(this),s.addObserver(this))},sy=function(s){At.batch(()=>{s.listeners&&this.listeners.forEach(r=>{r(C(this,as))}),C(this,xs).getQueryCache().notify({query:C(this,Qe),type:"observerResultsUpdated"})})},_g);function $2(e,s){return Ls(s.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&s.retryOnMount===!1)}function ux(e,s){return $2(e,s)||e.state.data!==void 0&&am(e,s,s.refetchOnMount)}function am(e,s,r){if(Ls(s.enabled,e)!==!1&&Cn(s.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&kh(e,s)}return!1}function mx(e,s,r,n){return(e!==s||Ls(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&kh(e,r)}function kh(e,s){return Ls(s.enabled,e)!==!1&&e.isStaleByTime(Cn(s.staleTime,e))}function F2(e,s){return!yc(e.getCurrentResult(),s)}function hx(e){return{onFetch:(s,r)=>{var h,u,p,j,x;const n=s.options,a=(p=(u=(h=s.fetchOptions)==null?void 0:h.meta)==null?void 0:u.fetchMore)==null?void 0:p.direction,i=((j=s.state.data)==null?void 0:j.pages)||[],l=((x=s.state.data)==null?void 0:x.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const d=async()=>{let g=!1;const y=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(s.signal.aborted?g=!0:s.signal.addEventListener("abort",()=>{g=!0}),s.signal)})},b=Yp(s.options,s.fetchOptions),f=async(v,w,N)=>{if(g)return Promise.reject();if(w==null&&v.pages.length)return Promise.resolve(v);const z=(()=>{const F={client:s.client,queryKey:s.queryKey,pageParam:w,direction:N?"backward":"forward",meta:s.options.meta};return y(F),F})(),E=await b(z),{maxPages:X}=s.options,T=N?_2:C2;return{pages:T(v.pages,E,X),pageParams:T(v.pageParams,w,X)}};if(a&&i.length){const v=a==="backward",w=v?I2:xx,N={pages:i,pageParams:l},P=w(n,N);o=await f(N,P,v)}else{const v=e??i.length;do{const w=c===0?l[0]??n.initialPageParam:xx(n,o);if(c>0&&w==null)break;o=await f(o,w),c++}while(c<v)}return o};s.options.persister?s.fetchFn=()=>{var g,y;return(y=(g=s.options).persister)==null?void 0:y.call(g,d,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},r)}:s.fetchFn=d}}}function xx(e,{pages:s,pageParams:r}){const n=s.length-1;return s.length>0?e.getNextPageParam(s[n],s,r[n],r):void 0}function I2(e,{pages:s,pageParams:r}){var n;return s.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,s[0],s,r[0],r):void 0}var Fl,ur,is,ra,mr,Jr,Eg,O2=(Eg=class extends ey{constructor(s){super();Se(this,mr);Se(this,Fl);Se(this,ur);Se(this,is);Se(this,ra);ce(this,Fl,s.client),this.mutationId=s.mutationId,ce(this,is,s.mutationCache),ce(this,ur,[]),this.state=s.state||ry(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){C(this,ur).includes(s)||(C(this,ur).push(s),this.clearGcTimeout(),C(this,is).notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){ce(this,ur,C(this,ur).filter(r=>r!==s)),this.scheduleGc(),C(this,is).notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){C(this,ur).length||(this.state.status==="pending"?this.scheduleGc():C(this,is).remove(this))}continue(){var s;return((s=C(this,ra))==null?void 0:s.continue())??this.execute(this.state.variables)}async execute(s){var l,o,c,d,h,u,p,j,x,g,y,b,f,v,w,N,P,z,E,X;const r=()=>{Ue(this,mr,Jr).call(this,{type:"continue"})},n={client:C(this,Fl),meta:this.options.meta,mutationKey:this.options.mutationKey};ce(this,ra,Zp({fn:()=>this.options.mutationFn?this.options.mutationFn(s,n):Promise.reject(new Error("No mutationFn found")),onFail:(T,F)=>{Ue(this,mr,Jr).call(this,{type:"failed",failureCount:T,error:F})},onPause:()=>{Ue(this,mr,Jr).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>C(this,is).canRun(this)}));const a=this.state.status==="pending",i=!C(this,ra).canStart();try{if(a)r();else{Ue(this,mr,Jr).call(this,{type:"pending",variables:s,isPaused:i}),await((o=(l=C(this,is).config).onMutate)==null?void 0:o.call(l,s,this,n));const F=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,s,n));F!==this.state.context&&Ue(this,mr,Jr).call(this,{type:"pending",context:F,variables:s,isPaused:i})}const T=await C(this,ra).start();return await((u=(h=C(this,is).config).onSuccess)==null?void 0:u.call(h,T,s,this.state.context,this,n)),await((j=(p=this.options).onSuccess)==null?void 0:j.call(p,T,s,this.state.context,n)),await((g=(x=C(this,is).config).onSettled)==null?void 0:g.call(x,T,null,this.state.variables,this.state.context,this,n)),await((b=(y=this.options).onSettled)==null?void 0:b.call(y,T,null,s,this.state.context,n)),Ue(this,mr,Jr).call(this,{type:"success",data:T}),T}catch(T){try{throw await((v=(f=C(this,is).config).onError)==null?void 0:v.call(f,T,s,this.state.context,this,n)),await((N=(w=this.options).onError)==null?void 0:N.call(w,T,s,this.state.context,n)),await((z=(P=C(this,is).config).onSettled)==null?void 0:z.call(P,void 0,T,this.state.variables,this.state.context,this,n)),await((X=(E=this.options).onSettled)==null?void 0:X.call(E,void 0,T,s,this.state.context,n)),T}finally{Ue(this,mr,Jr).call(this,{type:"error",error:T})}}finally{C(this,is).runNext(this)}}},Fl=new WeakMap,ur=new WeakMap,is=new WeakMap,ra=new WeakMap,mr=new WeakSet,Jr=function(s){const r=n=>{switch(s.type){case"failed":return{...n,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...n,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:s.error,failureCount:n.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=r(this.state),At.batch(()=>{C(this,ur).forEach(n=>{n.onMutationUpdate(s)}),C(this,is).notify({mutation:this,type:"updated",action:s})})},Eg);function ry(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var _r,Vs,Il,Mg,D2=(Mg=class extends vi{constructor(s={}){super();Se(this,_r);Se(this,Vs);Se(this,Il);this.config=s,ce(this,_r,new Set),ce(this,Vs,new Map),ce(this,Il,0)}build(s,r,n){const a=new O2({client:s,mutationCache:this,mutationId:++to(this,Il)._,options:s.defaultMutationOptions(r),state:n});return this.add(a),a}add(s){C(this,_r).add(s);const r=vo(s);if(typeof r=="string"){const n=C(this,Vs).get(r);n?n.push(s):C(this,Vs).set(r,[s])}this.notify({type:"added",mutation:s})}remove(s){if(C(this,_r).delete(s)){const r=vo(s);if(typeof r=="string"){const n=C(this,Vs).get(r);if(n)if(n.length>1){const a=n.indexOf(s);a!==-1&&n.splice(a,1)}else n[0]===s&&C(this,Vs).delete(r)}}this.notify({type:"removed",mutation:s})}canRun(s){const r=vo(s);if(typeof r=="string"){const n=C(this,Vs).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===s}else return!0}runNext(s){var n;const r=vo(s);if(typeof r=="string"){const a=(n=C(this,Vs).get(r))==null?void 0:n.find(i=>i!==s&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){At.batch(()=>{C(this,_r).forEach(s=>{this.notify({type:"removed",mutation:s})}),C(this,_r).clear(),C(this,Vs).clear()})}getAll(){return Array.from(C(this,_r))}find(s){const r={exact:!0,...s};return this.getAll().find(n=>ix(r,n))}findAll(s={}){return this.getAll().filter(r=>ix(s,r))}notify(s){At.batch(()=>{this.listeners.forEach(r=>{r(s)})})}resumePausedMutations(){const s=this.getAll().filter(r=>r.state.isPaused);return At.batch(()=>Promise.all(s.map(r=>r.continue().catch(os))))}},_r=new WeakMap,Vs=new WeakMap,Il=new WeakMap,Mg);function vo(e){var s;return(s=e.options.scope)==null?void 0:s.id}var Er,cn,gs,Mr,Ir,Uo,im,Tg,z2=(Tg=class extends vi{constructor(r,n){super();Se(this,Ir);Se(this,Er);Se(this,cn);Se(this,gs);Se(this,Mr);ce(this,Er,r),this.setOptions(n),this.bindMethods(),Ue(this,Ir,Uo).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=C(this,Er).defaultMutationOptions(r),yc(this.options,n)||C(this,Er).getMutationCache().notify({type:"observerOptionsUpdated",mutation:C(this,gs),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&ha(n.mutationKey)!==ha(this.options.mutationKey)?this.reset():((a=C(this,gs))==null?void 0:a.state.status)==="pending"&&C(this,gs).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=C(this,gs))==null||r.removeObserver(this)}onMutationUpdate(r){Ue(this,Ir,Uo).call(this),Ue(this,Ir,im).call(this,r)}getCurrentResult(){return C(this,cn)}reset(){var r;(r=C(this,gs))==null||r.removeObserver(this),ce(this,gs,void 0),Ue(this,Ir,Uo).call(this),Ue(this,Ir,im).call(this)}mutate(r,n){var a;return ce(this,Mr,n),(a=C(this,gs))==null||a.removeObserver(this),ce(this,gs,C(this,Er).getMutationCache().build(C(this,Er),this.options)),C(this,gs).addObserver(this),C(this,gs).execute(r)}},Er=new WeakMap,cn=new WeakMap,gs=new WeakMap,Mr=new WeakMap,Ir=new WeakSet,Uo=function(){var n;const r=((n=C(this,gs))==null?void 0:n.state)??ry();ce(this,cn,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},im=function(r){At.batch(()=>{var n,a,i,l,o,c,d,h;if(C(this,Mr)&&this.hasListeners()){const u=C(this,cn).variables,p=C(this,cn).context,j={client:C(this,Er),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((a=(n=C(this,Mr)).onSuccess)==null||a.call(n,r.data,u,p,j),(l=(i=C(this,Mr)).onSettled)==null||l.call(i,r.data,null,u,p,j)):(r==null?void 0:r.type)==="error"&&((c=(o=C(this,Mr)).onError)==null||c.call(o,r.error,u,p,j),(h=(d=C(this,Mr)).onSettled)==null||h.call(d,void 0,r.error,u,p,j))}this.listeners.forEach(u=>{u(C(this,cn))})})},Tg),hr,Ag,U2=(Ag=class extends vi{constructor(s={}){super();Se(this,hr);this.config=s,ce(this,hr,new Map)}build(s,r,n){const a=r.queryKey,i=r.queryHash??jh(a,r);let l=this.get(i);return l||(l=new R2({client:s,queryKey:a,queryHash:i,options:s.defaultQueryOptions(r),state:n,defaultOptions:s.getQueryDefaults(a)}),this.add(l)),l}add(s){C(this,hr).has(s.queryHash)||(C(this,hr).set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const r=C(this,hr).get(s.queryHash);r&&(s.destroy(),r===s&&C(this,hr).delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){At.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return C(this,hr).get(s)}getAll(){return[...C(this,hr).values()]}find(s){const r={exact:!0,...s};return this.getAll().find(n=>ax(r,n))}findAll(s={}){const r=this.getAll();return Object.keys(s).length>0?r.filter(n=>ax(s,n)):r}notify(s){At.batch(()=>{this.listeners.forEach(r=>{r(s)})})}onFocus(){At.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){At.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},hr=new WeakMap,Ag),bt,dn,un,Xa,Za,mn,ei,ti,Pg,H2=(Pg=class{constructor(e={}){Se(this,bt);Se(this,dn);Se(this,un);Se(this,Xa);Se(this,Za);Se(this,mn);Se(this,ei);Se(this,ti);ce(this,bt,e.queryCache||new U2),ce(this,dn,e.mutationCache||new D2),ce(this,un,e.defaultOptions||{}),ce(this,Xa,new Map),ce(this,Za,new Map),ce(this,mn,0)}mount(){to(this,mn)._++,C(this,mn)===1&&(ce(this,ei,Nh.subscribe(async e=>{e&&(await this.resumePausedMutations(),C(this,bt).onFocus())})),ce(this,ti,bc.subscribe(async e=>{e&&(await this.resumePausedMutations(),C(this,bt).onOnline())})))}unmount(){var e,s;to(this,mn)._--,C(this,mn)===0&&((e=C(this,ei))==null||e.call(this),ce(this,ei,void 0),(s=C(this,ti))==null||s.call(this),ce(this,ti,void 0))}isFetching(e){return C(this,bt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return C(this,dn).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const s=this.defaultQueryOptions({queryKey:e});return(r=C(this,bt).get(s.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const s=this.defaultQueryOptions(e),r=C(this,bt).build(this,s),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Cn(s.staleTime,r))&&this.prefetchQuery(s),Promise.resolve(n))}getQueriesData(e){return C(this,bt).findAll(e).map(({queryKey:s,state:r})=>{const n=r.data;return[s,n]})}setQueryData(e,s,r){const n=this.defaultQueryOptions({queryKey:e}),a=C(this,bt).get(n.queryHash),i=a==null?void 0:a.state.data,l=N2(s,i);if(l!==void 0)return C(this,bt).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(e,s,r){return At.batch(()=>C(this,bt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,s,r)]))}getQueryState(e){var r;const s=this.defaultQueryOptions({queryKey:e});return(r=C(this,bt).get(s.queryHash))==null?void 0:r.state}removeQueries(e){const s=C(this,bt);At.batch(()=>{s.findAll(e).forEach(r=>{s.remove(r)})})}resetQueries(e,s){const r=C(this,bt);return At.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},s)))}cancelQueries(e,s={}){const r={revert:!0,...s},n=At.batch(()=>C(this,bt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(os).catch(os)}invalidateQueries(e,s={}){return At.batch(()=>(C(this,bt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},s)))}refetchQueries(e,s={}){const r={...s,cancelRefetch:s.cancelRefetch??!0},n=At.batch(()=>C(this,bt).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(os)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(os)}fetchQuery(e){const s=this.defaultQueryOptions(e);s.retry===void 0&&(s.retry=!1);const r=C(this,bt).build(this,s);return r.isStaleByTime(Cn(s.staleTime,r))?r.fetch(s):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(os).catch(os)}fetchInfiniteQuery(e){return e.behavior=hx(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(os).catch(os)}ensureInfiniteQueryData(e){return e.behavior=hx(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return bc.isOnline()?C(this,dn).resumePausedMutations():Promise.resolve()}getQueryCache(){return C(this,bt)}getMutationCache(){return C(this,dn)}getDefaultOptions(){return C(this,un)}setDefaultOptions(e){ce(this,un,e)}setQueryDefaults(e,s){C(this,Xa).set(ha(e),{queryKey:e,defaultOptions:s})}getQueryDefaults(e){const s=[...C(this,Xa).values()],r={};return s.forEach(n=>{El(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,s){C(this,Za).set(ha(e),{mutationKey:e,defaultOptions:s})}getMutationDefaults(e){const s=[...C(this,Za).values()],r={};return s.forEach(n=>{El(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const s={...C(this,un).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return s.queryHash||(s.queryHash=jh(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===wh&&(s.enabled=!1),s}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...C(this,un).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){C(this,bt).clear(),C(this,dn).clear()}},bt=new WeakMap,dn=new WeakMap,un=new WeakMap,Xa=new WeakMap,Za=new WeakMap,mn=new WeakMap,ei=new WeakMap,ti=new WeakMap,Pg),ny=m.createContext(void 0),ct=e=>{const s=m.useContext(ny);if(!s)throw new Error("No QueryClient set, use QueryClientProvider to set one");return s},B2=({client:e,children:s})=>(m.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(ny.Provider,{value:e,children:s})),ay=m.createContext(!1),q2=()=>m.useContext(ay);ay.Provider;function W2(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var K2=m.createContext(W2()),V2=()=>m.useContext(K2),Q2=(e,s)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(s.isReset()||(e.retryOnMount=!1))},G2=e=>{m.useEffect(()=>{e.clearReset()},[e])},Y2=({result:e,errorResetBoundary:s,throwOnError:r,query:n,suspense:a})=>e.isError&&!s.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||Jp(r,[e.error,n])),J2=e=>{if(e.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},X2=(e,s)=>e.isLoading&&e.isFetching&&!s,Z2=(e,s)=>(e==null?void 0:e.suspense)&&s.isPending,gx=(e,s,r)=>s.fetchOptimistic(e).catch(()=>{r.clearReset()});function e1(e,s,r){var u,p,j,x,g;const n=q2(),a=V2(),i=ct(),l=i.defaultQueryOptions(e);(p=(u=i.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||p.call(u,l),l._optimisticResults=n?"isRestoring":"optimistic",J2(l),Q2(l,a),G2(a);const o=!i.getQueryCache().get(l.queryHash),[c]=m.useState(()=>new s(i,l)),d=c.getOptimisticResult(l),h=!n&&e.subscribed!==!1;if(m.useSyncExternalStore(m.useCallback(y=>{const b=h?c.subscribe(At.batchCalls(y)):os;return c.updateResult(),b},[c,h]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),m.useEffect(()=>{c.setOptions(l)},[l,c]),Z2(l,d))throw gx(l,c,a);if(Y2({result:d,errorResetBoundary:a,throwOnError:l.throwOnError,query:i.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw d.error;if((x=(j=i.getDefaultOptions().queries)==null?void 0:j._experimental_afterQuery)==null||x.call(j,l,d),l.experimental_prefetchInRender&&!ma&&X2(d,n)){const y=o?gx(l,c,a):(g=i.getQueryCache().get(l.queryHash))==null?void 0:g.promise;y==null||y.catch(os).finally(()=>{c.updateResult()})}return l.notifyOnChangeProps?d:c.trackResult(d)}function ue(e,s){return e1(e,L2)}function Ne(e,s){const r=ct(),[n]=m.useState(()=>new z2(r,e));m.useEffect(()=>{n.setOptions(e)},[n,e]);const a=m.useSyncExternalStore(m.useCallback(l=>n.subscribe(At.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=m.useCallback((l,o)=>{n.mutate(l,o).catch(os)},[n]);if(a.error&&Jp(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ml(){return Ml=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ml.apply(this,arguments)}var gn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(gn||(gn={}));const fx="popstate";function t1(e){e===void 0&&(e={});function s(n,a){let{pathname:i,search:l,hash:o}=n.location;return lm("",{pathname:i,search:l,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:vc(a)}return r1(s,r,null,e)}function wt(e,s){if(e===!1||e===null||typeof e>"u")throw new Error(s)}function Sh(e,s){if(!e){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function s1(){return Math.random().toString(36).substr(2,8)}function px(e,s){return{usr:e.state,key:e.key,idx:s}}function lm(e,s,r,n){return r===void 0&&(r=null),Ml({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof s=="string"?ji(s):s,{state:r,key:s&&s.key||n||s1()})}function vc(e){let{pathname:s="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(s+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function ji(e){let s={};if(e){let r=e.indexOf("#");r>=0&&(s.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(s.search=e.substr(n),e=e.substr(0,n)),e&&(s.pathname=e)}return s}function r1(e,s,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,l=a.history,o=gn.Pop,c=null,d=h();d==null&&(d=0,l.replaceState(Ml({},l.state,{idx:d}),""));function h(){return(l.state||{idx:null}).idx}function u(){o=gn.Pop;let y=h(),b=y==null?null:y-d;d=y,c&&c({action:o,location:g.location,delta:b})}function p(y,b){o=gn.Push;let f=lm(g.location,y,b);d=h()+1;let v=px(f,d),w=g.createHref(f);try{l.pushState(v,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;a.location.assign(w)}i&&c&&c({action:o,location:g.location,delta:1})}function j(y,b){o=gn.Replace;let f=lm(g.location,y,b);d=h();let v=px(f,d),w=g.createHref(f);l.replaceState(v,"",w),i&&c&&c({action:o,location:g.location,delta:0})}function x(y){let b=a.location.origin!=="null"?a.location.origin:a.location.href,f=typeof y=="string"?y:vc(y);return f=f.replace(/ $/,"%20"),wt(b,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,b)}let g={get action(){return o},get location(){return e(a,l)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(fx,u),c=y,()=>{a.removeEventListener(fx,u),c=null}},createHref(y){return s(a,y)},createURL:x,encodeLocation(y){let b=x(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:j,go(y){return l.go(y)}};return g}var yx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(yx||(yx={}));function n1(e,s,r){return r===void 0&&(r="/"),a1(e,s,r)}function a1(e,s,r,n){let a=typeof s=="string"?ji(s):s,i=Ch(a.pathname||"/",r);if(i==null)return null;let l=iy(e);i1(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=y1(i);o=g1(l[c],d)}return o}function iy(e,s,r,n){s===void 0&&(s=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(wt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=_n([n,c.relativePath]),h=r.concat(c);i.children&&i.children.length>0&&(wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),iy(i.children,s,h,d)),!(i.path==null&&!i.index)&&s.push({path:d,score:h1(d,i.index),routesMeta:h})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,l);else for(let c of ly(i.path))a(i,l,c)}),s}function ly(e){let s=e.split("/");if(s.length===0)return[];let[r,...n]=s,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let l=ly(n.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function i1(e){e.sort((s,r)=>s.score!==r.score?r.score-s.score:x1(s.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const l1=/^:[\w-]+$/,o1=3,c1=2,d1=1,u1=10,m1=-2,bx=e=>e==="*";function h1(e,s){let r=e.split("/"),n=r.length;return r.some(bx)&&(n+=m1),s&&(n+=c1),r.filter(a=>!bx(a)).reduce((a,i)=>a+(l1.test(i)?o1:i===""?d1:u1),n)}function x1(e,s){return e.length===s.length&&e.slice(0,-1).every((n,a)=>n===s[a])?e[e.length-1]-s[s.length-1]:0}function g1(e,s,r){let{routesMeta:n}=e,a={},i="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,h=i==="/"?s:s.slice(i.length)||"/",u=f1({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),p=c.route;if(!u)return null;Object.assign(a,u.params),l.push({params:a,pathname:_n([i,u.pathname]),pathnameBase:N1(_n([i,u.pathnameBase])),route:p}),u.pathnameBase!=="/"&&(i=_n([i,u.pathnameBase]))}return l}function f1(e,s){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=p1(e.path,e.caseSensitive,e.end),a=s.match(r);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((d,h,u)=>{let{paramName:p,isOptional:j}=h;if(p==="*"){let g=o[u]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[u];return j&&!x?d[p]=void 0:d[p]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function p1(e,s,r){s===void 0&&(s=!1),r===void 0&&(r=!0),Sh(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,s?void 0:"i"),n]}function y1(e){try{return e.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Sh(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),e}}function Ch(e,s){if(s==="/")return e;if(!e.toLowerCase().startsWith(s.toLowerCase()))return null;let r=s.endsWith("/")?s.length-1:s.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const b1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,v1=e=>b1.test(e);function j1(e,s){s===void 0&&(s="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?ji(e):e,i;if(r)if(v1(r))i=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),Sh(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?i=vx(r.substring(1),"/"):i=vx(r,s)}else i=s;return{pathname:i,search:k1(n),hash:S1(a)}}function vx(e,s){let r=s.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Ld(e,s,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function w1(e){return e.filter((s,r)=>r===0||s.route.path&&s.route.path.length>0)}function _h(e,s){let r=w1(e);return s?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Eh(e,s,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=ji(e):(a=Ml({},e),wt(!a.pathname||!a.pathname.includes("?"),Ld("?","pathname","search",a)),wt(!a.pathname||!a.pathname.includes("#"),Ld("#","pathname","hash",a)),wt(!a.search||!a.search.includes("#"),Ld("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,o;if(l==null)o=r;else{let u=s.length-1;if(!n&&l.startsWith("..")){let p=l.split("/");for(;p[0]==="..";)p.shift(),u-=1;a.pathname=p.join("/")}o=u>=0?s[u]:"/"}let c=j1(a,o),d=l&&l!=="/"&&l.endsWith("/"),h=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const _n=e=>e.join("/").replace(/\/\/+/g,"/"),N1=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),k1=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,S1=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function C1(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const oy=["post","put","patch","delete"];new Set(oy);const _1=["get",...oy];new Set(_1);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tl(){return Tl=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tl.apply(this,arguments)}const Mh=m.createContext(null),E1=m.createContext(null),Ln=m.createContext(null),Wc=m.createContext(null),br=m.createContext({outlet:null,matches:[],isDataRoute:!1}),cy=m.createContext(null);function M1(e,s){let{relative:r}=s===void 0?{}:s;wi()||wt(!1);let{basename:n,navigator:a}=m.useContext(Ln),{hash:i,pathname:l,search:o}=my(e,{relative:r}),c=l;return n!=="/"&&(c=l==="/"?n:_n([n,l])),a.createHref({pathname:c,search:o,hash:i})}function wi(){return m.useContext(Wc)!=null}function $n(){return wi()||wt(!1),m.useContext(Wc).location}function dy(e){m.useContext(Ln).static||m.useLayoutEffect(e)}function vr(){let{isDataRoute:e}=m.useContext(br);return e?q1():T1()}function T1(){wi()||wt(!1);let e=m.useContext(Mh),{basename:s,future:r,navigator:n}=m.useContext(Ln),{matches:a}=m.useContext(br),{pathname:i}=$n(),l=JSON.stringify(_h(a,r.v7_relativeSplatPath)),o=m.useRef(!1);return dy(()=>{o.current=!0}),m.useCallback(function(d,h){if(h===void 0&&(h={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let u=Eh(d,JSON.parse(l),i,h.relative==="path");e==null&&s!=="/"&&(u.pathname=u.pathname==="/"?s:_n([s,u.pathname])),(h.replace?n.replace:n.push)(u,h.state,h)},[s,n,l,i,e])}const A1=m.createContext(null);function P1(e){let s=m.useContext(br).outlet;return s&&m.createElement(A1.Provider,{value:e},s)}function uy(){let{matches:e}=m.useContext(br),s=e[e.length-1];return s?s.params:{}}function my(e,s){let{relative:r}=s===void 0?{}:s,{future:n}=m.useContext(Ln),{matches:a}=m.useContext(br),{pathname:i}=$n(),l=JSON.stringify(_h(a,n.v7_relativeSplatPath));return m.useMemo(()=>Eh(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function R1(e,s){return L1(e,s)}function L1(e,s,r,n){wi()||wt(!1);let{navigator:a}=m.useContext(Ln),{matches:i}=m.useContext(br),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=$n(),h;if(s){var u;let y=typeof s=="string"?ji(s):s;c==="/"||(u=y.pathname)!=null&&u.startsWith(c)||wt(!1),h=y}else h=d;let p=h.pathname||"/",j=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");j="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let x=n1(e,{pathname:j}),g=D1(x&&x.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:_n([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:_n([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return s&&g?m.createElement(Wc.Provider,{value:{location:Tl({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:gn.Pop}},g):g}function $1(){let e=B1(),s=C1(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},s),r?m.createElement("pre",{style:a},r):null,null)}const F1=m.createElement($1,null);class I1 extends m.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,r){return r.location!==s.location||r.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:r.error,location:r.location,revalidation:s.revalidation||r.revalidation}}componentDidCatch(s,r){console.error("React Router caught the following error during render",s,r)}render(){return this.state.error!==void 0?m.createElement(br.Provider,{value:this.props.routeContext},m.createElement(cy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function O1(e){let{routeContext:s,match:r,children:n}=e,a=m.useContext(Mh);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),m.createElement(br.Provider,{value:s},n)}function D1(e,s,r,n){var a;if(s===void 0&&(s=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&s.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let h=l.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);h>=0||wt(!1),l=l.slice(0,Math.min(l.length,h+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<l.length;h++){let u=l[h];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=h),u.route.id){let{loaderData:p,errors:j}=r,x=u.route.loader&&p[u.route.id]===void 0&&(!j||j[u.route.id]===void 0);if(u.route.lazy||x){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((h,u,p)=>{let j,x=!1,g=null,y=null;r&&(j=o&&u.route.id?o[u.route.id]:void 0,g=u.route.errorElement||F1,c&&(d<0&&p===0?(W1("route-fallback"),x=!0,y=null):d===p&&(x=!0,y=u.route.hydrateFallbackElement||null)));let b=s.concat(l.slice(0,p+1)),f=()=>{let v;return j?v=g:x?v=y:u.route.Component?v=m.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=h,m.createElement(O1,{match:u,routeContext:{outlet:h,matches:b,isDataRoute:r!=null},children:v})};return r&&(u.route.ErrorBoundary||u.route.errorElement||p===0)?m.createElement(I1,{location:r.location,revalidation:r.revalidation,component:g,error:j,children:f(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):f()},null)}var hy=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(hy||{}),xy=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(xy||{});function z1(e){let s=m.useContext(Mh);return s||wt(!1),s}function U1(e){let s=m.useContext(E1);return s||wt(!1),s}function H1(e){let s=m.useContext(br);return s||wt(!1),s}function gy(e){let s=H1(),r=s.matches[s.matches.length-1];return r.route.id||wt(!1),r.route.id}function B1(){var e;let s=m.useContext(cy),r=U1(),n=gy();return s!==void 0?s:(e=r.errors)==null?void 0:e[n]}function q1(){let{router:e}=z1(hy.UseNavigateStable),s=gy(xy.UseNavigateStable),r=m.useRef(!1);return dy(()=>{r.current=!0}),m.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Tl({fromRouteId:s},i)))},[e,s])}const jx={};function W1(e,s,r){jx[e]||(jx[e]=!0)}function K1(e,s){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function fy(e){let{to:s,replace:r,state:n,relative:a}=e;wi()||wt(!1);let{future:i,static:l}=m.useContext(Ln),{matches:o}=m.useContext(br),{pathname:c}=$n(),d=vr(),h=Eh(s,_h(o,i.v7_relativeSplatPath),c,a==="path"),u=JSON.stringify(h);return m.useEffect(()=>d(JSON.parse(u),{replace:r,state:n,relative:a}),[d,u,a,r,n]),null}function V1(e){return P1(e.context)}function Ye(e){wt(!1)}function Q1(e){let{basename:s="/",children:r=null,location:n,navigationType:a=gn.Pop,navigator:i,static:l=!1,future:o}=e;wi()&&wt(!1);let c=s.replace(/^\/*/,"/"),d=m.useMemo(()=>({basename:c,navigator:i,static:l,future:Tl({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof n=="string"&&(n=ji(n));let{pathname:h="/",search:u="",hash:p="",state:j=null,key:x="default"}=n,g=m.useMemo(()=>{let y=Ch(h,c);return y==null?null:{location:{pathname:y,search:u,hash:p,state:j,key:x},navigationType:a}},[c,h,u,p,j,x,a]);return g==null?null:m.createElement(Ln.Provider,{value:d},m.createElement(Wc.Provider,{children:r,value:g}))}function G1(e){let{children:s,location:r}=e;return R1(om(s),r)}new Promise(()=>{});function om(e,s){s===void 0&&(s=[]);let r=[];return m.Children.forEach(e,(n,a)=>{if(!m.isValidElement(n))return;let i=[...s,a];if(n.type===m.Fragment){r.push.apply(r,om(n.props.children,i));return}n.type!==Ye&&wt(!1),!n.props.index||!n.props.children||wt(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=om(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cm(){return cm=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cm.apply(this,arguments)}function Y1(e,s){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(s.indexOf(a)>=0)&&(r[a]=e[a]);return r}function J1(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function X1(e,s){return e.button===0&&(!s||s==="_self")&&!J1(e)}function dm(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((s,r)=>{let n=e[r];return s.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function Z1(e,s){let r=dm(e);return s&&s.forEach((n,a)=>{r.has(a)||s.getAll(a).forEach(i=>{r.append(a,i)})}),r}const ew=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],tw="6";try{window.__reactRouterVersion=tw}catch{}const sw="startTransition",wx=si[sw];function rw(e){let{basename:s,children:r,future:n,window:a}=e,i=m.useRef();i.current==null&&(i.current=t1({window:a,v5Compat:!0}));let l=i.current,[o,c]=m.useState({action:l.action,location:l.location}),{v7_startTransition:d}=n||{},h=m.useCallback(u=>{d&&wx?wx(()=>c(u)):c(u)},[c,d]);return m.useLayoutEffect(()=>l.listen(h),[l,h]),m.useEffect(()=>K1(n),[n]),m.createElement(Q1,{basename:s,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const nw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",aw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Je=m.forwardRef(function(s,r){let{onClick:n,relative:a,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:h,viewTransition:u}=s,p=Y1(s,ew),{basename:j}=m.useContext(Ln),x,g=!1;if(typeof d=="string"&&aw.test(d)&&(x=d,nw))try{let v=new URL(window.location.href),w=d.startsWith("//")?new URL(v.protocol+d):new URL(d),N=Ch(w.pathname,j);w.origin===v.origin&&N!=null?d=N+w.search+w.hash:g=!0}catch{}let y=M1(d,{relative:a}),b=iw(d,{replace:l,state:o,target:c,preventScrollReset:h,relative:a,viewTransition:u});function f(v){n&&n(v),v.defaultPrevented||b(v)}return m.createElement("a",cm({},p,{href:x||y,onClick:g||i?n:f,ref:r,target:c}))});var Nx;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Nx||(Nx={}));var kx;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(kx||(kx={}));function iw(e,s){let{target:r,replace:n,state:a,preventScrollReset:i,relative:l,viewTransition:o}=s===void 0?{}:s,c=vr(),d=$n(),h=my(e,{relative:l});return m.useCallback(u=>{if(X1(u,r)){u.preventDefault();let p=n!==void 0?n:vc(d)===vc(h);c(e,{replace:p,state:a,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,h,n,a,r,e,i,l,o])}function Bl(e){let s=m.useRef(dm(e)),r=m.useRef(!1),n=$n(),a=m.useMemo(()=>Z1(n.search,r.current?null:s.current),[n.search]),i=vr(),l=m.useCallback((o,c)=>{const d=dm(typeof o=="function"?o(a):o);r.current=!0,i("?"+d,c)},[i,a]);return[a,l]}const lw={},Sx=e=>{let s;const r=new Set,n=(h,u)=>{const p=typeof h=="function"?h(s):h;if(!Object.is(p,s)){const j=s;s=u??(typeof p!="object"||p===null)?p:Object.assign({},s,p),r.forEach(x=>x(s,j))}},a=()=>s,c={setState:n,getState:a,getInitialState:()=>d,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(lw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=s=e(n,a,c);return c},ow=e=>e?Sx(e):Sx;var py={exports:{}},yy={},by={exports:{}},vy={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var di=m;function cw(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var dw=typeof Object.is=="function"?Object.is:cw,uw=di.useState,mw=di.useEffect,hw=di.useLayoutEffect,xw=di.useDebugValue;function gw(e,s){var r=s(),n=uw({inst:{value:r,getSnapshot:s}}),a=n[0].inst,i=n[1];return hw(function(){a.value=r,a.getSnapshot=s,$d(a)&&i({inst:a})},[e,r,s]),mw(function(){return $d(a)&&i({inst:a}),e(function(){$d(a)&&i({inst:a})})},[e]),xw(r),r}function $d(e){var s=e.getSnapshot;e=e.value;try{var r=s();return!dw(e,r)}catch{return!0}}function fw(e,s){return s()}var pw=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?fw:gw;vy.useSyncExternalStore=di.useSyncExternalStore!==void 0?di.useSyncExternalStore:pw;by.exports=vy;var yw=by.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kc=m,bw=yw;function vw(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var jw=typeof Object.is=="function"?Object.is:vw,ww=bw.useSyncExternalStore,Nw=Kc.useRef,kw=Kc.useEffect,Sw=Kc.useMemo,Cw=Kc.useDebugValue;yy.useSyncExternalStoreWithSelector=function(e,s,r,n,a){var i=Nw(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=Sw(function(){function c(j){if(!d){if(d=!0,h=j,j=n(j),a!==void 0&&l.hasValue){var x=l.value;if(a(x,j))return u=x}return u=j}if(x=u,jw(h,j))return x;var g=n(j);return a!==void 0&&a(x,g)?(h=j,x):(h=j,u=g)}var d=!1,h,u,p=r===void 0?null:r;return[function(){return c(s())},p===null?void 0:function(){return c(p())}]},[s,r,n,a]);var o=ww(e,i[0],i[1]);return kw(function(){l.hasValue=!0,l.value=o},[o]),Cw(o),o};py.exports=yy;var _w=py.exports;const Ew=Rg(_w),jy={},{useDebugValue:Mw}=$e,{useSyncExternalStoreWithSelector:Tw}=Ew;let Cx=!1;const Aw=e=>e;function Pw(e,s=Aw,r){(jy?"production":void 0)!=="production"&&r&&!Cx&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Cx=!0);const n=Tw(e.subscribe,e.getState,e.getServerState||e.getInitialState,s,r);return Mw(n),n}const Rw=e=>{(jy?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof e=="function"?ow(e):e,r=(n,a)=>Pw(s,n,a);return Object.assign(r,s),r},Lw=e=>Rw,$w={};function Fw(e,s){let r;try{r=e()}catch{return}return{getItem:a=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=r.getItem(a))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(a,i)=>r.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>r.removeItem(a)}}const Al=e=>s=>{try{const r=e(s);return r instanceof Promise?r:{then(n){return Al(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Al(n)(r)}}}},Iw=(e,s)=>(r,n,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,b)=>({...b,...y}),...s},l=!1;const o=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...y)},n,a);const h=Al(i.serialize),u=()=>{const y=i.partialize({...n()});let b;const f=h({state:y,version:i.version}).then(v=>d.setItem(i.name,v)).catch(v=>{b=v});if(b)throw b;return f},p=a.setState;a.setState=(y,b)=>{p(y,b),u()};const j=e((...y)=>{r(...y),u()},n,a);let x;const g=()=>{var y;if(!d)return;l=!1,o.forEach(f=>f(n()));const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,n()))||void 0;return Al(d.getItem.bind(d))(i.name).then(f=>{if(f)return i.deserialize(f)}).then(f=>{if(f)if(typeof f.version=="number"&&f.version!==i.version){if(i.migrate)return i.migrate(f.state,f.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return f.state}).then(f=>{var v;return x=i.merge(f,(v=n())!=null?v:j),r(x,!0),u()}).then(()=>{b==null||b(x,void 0),l=!0,c.forEach(f=>f(x))}).catch(f=>{b==null||b(void 0,f)})};return a.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(d=y.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>l,onHydrate:y=>(o.add(y),()=>{o.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},g(),x||j},Ow=(e,s)=>(r,n,a)=>{let i={storage:Fw(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...s},l=!1;const o=new Set,c=new Set;let d=i.storage;if(!d)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...g)},n,a);const h=()=>{const g=i.partialize({...n()});return d.setItem(i.name,{state:g,version:i.version})},u=a.setState;a.setState=(g,y)=>{u(g,y),h()};const p=e((...g)=>{r(...g),h()},n,a);a.getInitialState=()=>p;let j;const x=()=>{var g,y;if(!d)return;l=!1,o.forEach(f=>{var v;return f((v=n())!=null?v:p)});const b=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(g=n())!=null?g:p))||void 0;return Al(d.getItem.bind(d))(i.name).then(f=>{if(f)if(typeof f.version=="number"&&f.version!==i.version){if(i.migrate)return[!0,i.migrate(f.state,f.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,f.state];return[!1,void 0]}).then(f=>{var v;const[w,N]=f;if(j=i.merge(N,(v=n())!=null?v:p),r(j,!0),w)return h()}).then(()=>{b==null||b(j,void 0),j=n(),l=!0,c.forEach(f=>f(j))}).catch(f=>{b==null||b(void 0,f)})};return a.persist={setOptions:g=>{i={...i,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>l,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||x(),j||p},Dw=(e,s)=>"getStorage"in s||"serialize"in s||"deserialize"in s?(($w?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Iw(e,s)):Ow(e,s),zw=Dw,Uw={"tickets:view":["admin","manager","customer_service"],"tickets:create":["admin","manager","customer_service"],"tickets:edit":["admin","manager","customer_service"],"tickets:delete":["admin"],"tickets:assign":["admin","manager"],"tickets:bulk_assign":["admin","manager"],"chat:view":["admin","manager","customer_service"],"chat:respond":["admin","manager","customer_service"],"chat:takeover":["admin","manager","customer_service"],"group_chat:view":["admin","manager","customer_service","general"],"group_chat:send":["admin","manager","customer_service","general"],"customers:view":["admin","manager","customer_service","general"],"customers:edit":["admin","manager","customer_service"],"staff:view":["admin","manager"],"staff:create":["admin"],"staff:edit":["admin"],"staff:delete":["admin"],"analytics:view":["admin","manager"],"settings:view":["admin"],"settings:edit":["admin"],"ai_agent:view":["admin","manager"],"ai_agent:edit":["admin"]};function Hw(e,s){return e?Uw[s].includes(e):!1}const ts=Lw()(zw((e,s)=>({token:null,user:null,setAuth:(r,n)=>{const a={...n,role:n.role==="agent"?"customer_service":n.role};e({token:r,user:a})},logout:()=>e({token:null,user:null}),hasPermission:r=>{const n=s().user;return Hw(n==null?void 0:n.role,r)}}),{name:"auth-storage"}));function wy(e,s){return function(){return e.apply(s,arguments)}}const{toString:Bw}=Object.prototype,{getPrototypeOf:Th}=Object,{iterator:Vc,toStringTag:Ny}=Symbol,Qc=(e=>s=>{const r=Bw.call(s);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),rr=e=>(e=e.toLowerCase(),s=>Qc(s)===e),Gc=e=>s=>typeof s===e,{isArray:Ni}=Array,ui=Gc("undefined");function ql(e){return e!==null&&!ui(e)&&e.constructor!==null&&!ui(e.constructor)&&js(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ky=rr("ArrayBuffer");function qw(e){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(e):s=e&&e.buffer&&ky(e.buffer),s}const Ww=Gc("string"),js=Gc("function"),Sy=Gc("number"),Wl=e=>e!==null&&typeof e=="object",Kw=e=>e===!0||e===!1,Ho=e=>{if(Qc(e)!=="object")return!1;const s=Th(e);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Ny in e)&&!(Vc in e)},Vw=e=>{if(!Wl(e)||ql(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Qw=rr("Date"),Gw=rr("File"),Yw=rr("Blob"),Jw=rr("FileList"),Xw=e=>Wl(e)&&js(e.pipe),Zw=e=>{let s;return e&&(typeof FormData=="function"&&e instanceof FormData||js(e.append)&&((s=Qc(e))==="formdata"||s==="object"&&js(e.toString)&&e.toString()==="[object FormData]"))},eN=rr("URLSearchParams"),[tN,sN,rN,nN]=["ReadableStream","Request","Response","Headers"].map(rr),aN=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Kl(e,s,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Ni(e))for(n=0,a=e.length;n<a;n++)s.call(null,e[n],n,e);else{if(ql(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(n=0;n<l;n++)o=i[n],s.call(null,e[o],o,e)}}function Cy(e,s){if(ql(e))return null;s=s.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],s===a.toLowerCase())return a;return null}const Vn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_y=e=>!ui(e)&&e!==Vn;function um(){const{caseless:e,skipUndefined:s}=_y(this)&&this||{},r={},n=(a,i)=>{const l=e&&Cy(r,i)||i;Ho(r[l])&&Ho(a)?r[l]=um(r[l],a):Ho(a)?r[l]=um({},a):Ni(a)?r[l]=a.slice():(!s||!ui(a))&&(r[l]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&Kl(arguments[a],n);return r}const iN=(e,s,r,{allOwnKeys:n}={})=>(Kl(s,(a,i)=>{r&&js(a)?e[i]=wy(a,r):e[i]=a},{allOwnKeys:n}),e),lN=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),oN=(e,s,r,n)=>{e.prototype=Object.create(s.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:s.prototype}),r&&Object.assign(e.prototype,r)},cN=(e,s,r,n)=>{let a,i,l;const o={};if(s=s||{},e==null)return s;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)l=a[i],(!n||n(l,e,s))&&!o[l]&&(s[l]=e[l],o[l]=!0);e=r!==!1&&Th(e)}while(e&&(!r||r(e,s))&&e!==Object.prototype);return s},dN=(e,s,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=s.length;const n=e.indexOf(s,r);return n!==-1&&n===r},uN=e=>{if(!e)return null;if(Ni(e))return e;let s=e.length;if(!Sy(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=e[s];return r},mN=(e=>s=>e&&s instanceof e)(typeof Uint8Array<"u"&&Th(Uint8Array)),hN=(e,s)=>{const n=(e&&e[Vc]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;s.call(e,i[0],i[1])}},xN=(e,s)=>{let r;const n=[];for(;(r=e.exec(s))!==null;)n.push(r);return n},gN=rr("HTMLFormElement"),fN=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),_x=(({hasOwnProperty:e})=>(s,r)=>e.call(s,r))(Object.prototype),pN=rr("RegExp"),Ey=(e,s)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Kl(r,(a,i)=>{let l;(l=s(a,i,e))!==!1&&(n[i]=l||a)}),Object.defineProperties(e,n)},yN=e=>{Ey(e,(s,r)=>{if(js(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(js(n)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},bN=(e,s)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return Ni(e)?n(e):n(String(e).split(s)),r},vN=()=>{},jN=(e,s)=>e!=null&&Number.isFinite(e=+e)?e:s;function wN(e){return!!(e&&js(e.append)&&e[Ny]==="FormData"&&e[Vc])}const NN=e=>{const s=new Array(10),r=(n,a)=>{if(Wl(n)){if(s.indexOf(n)>=0)return;if(ql(n))return n;if(!("toJSON"in n)){s[a]=n;const i=Ni(n)?[]:{};return Kl(n,(l,o)=>{const c=r(l,a+1);!ui(c)&&(i[o]=c)}),s[a]=void 0,i}}return n};return r(e,0)},kN=rr("AsyncFunction"),SN=e=>e&&(Wl(e)||js(e))&&js(e.then)&&js(e.catch),My=((e,s)=>e?setImmediate:s?((r,n)=>(Vn.addEventListener("message",({source:a,data:i})=>{a===Vn&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Vn.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",js(Vn.postMessage)),CN=typeof queueMicrotask<"u"?queueMicrotask.bind(Vn):typeof process<"u"&&process.nextTick||My,_N=e=>e!=null&&js(e[Vc]),H={isArray:Ni,isArrayBuffer:ky,isBuffer:ql,isFormData:Zw,isArrayBufferView:qw,isString:Ww,isNumber:Sy,isBoolean:Kw,isObject:Wl,isPlainObject:Ho,isEmptyObject:Vw,isReadableStream:tN,isRequest:sN,isResponse:rN,isHeaders:nN,isUndefined:ui,isDate:Qw,isFile:Gw,isBlob:Yw,isRegExp:pN,isFunction:js,isStream:Xw,isURLSearchParams:eN,isTypedArray:mN,isFileList:Jw,forEach:Kl,merge:um,extend:iN,trim:aN,stripBOM:lN,inherits:oN,toFlatObject:cN,kindOf:Qc,kindOfTest:rr,endsWith:dN,toArray:uN,forEachEntry:hN,matchAll:xN,isHTMLForm:gN,hasOwnProperty:_x,hasOwnProp:_x,reduceDescriptors:Ey,freezeMethods:yN,toObjectSet:bN,toCamelCase:fN,noop:vN,toFiniteNumber:jN,findKey:Cy,global:Vn,isContextDefined:_y,isSpecCompliantForm:wN,toJSONObject:NN,isAsyncFn:kN,isThenable:SN,setImmediate:My,asap:CN,isIterable:_N};function De(e,s,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}H.inherits(De,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const Ty=De.prototype,Ay={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ay[e]={value:e}});Object.defineProperties(De,Ay);Object.defineProperty(Ty,"isAxiosError",{value:!0});De.from=(e,s,r,n,a,i)=>{const l=Object.create(Ty);H.toFlatObject(e,l,function(h){return h!==Error.prototype},d=>d!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=s==null&&e?e.code:s;return De.call(l,o,c,r,n,a),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const EN=null;function mm(e){return H.isPlainObject(e)||H.isArray(e)}function Py(e){return H.endsWith(e,"[]")?e.slice(0,-2):e}function Ex(e,s,r){return e?e.concat(s).map(function(a,i){return a=Py(a),!r&&i?"["+a+"]":a}).join(r?".":""):s}function MN(e){return H.isArray(e)&&!e.some(mm)}const TN=H.toFlatObject(H,{},null,function(s){return/^is[A-Z]/.test(s)});function Yc(e,s,r){if(!H.isObject(e))throw new TypeError("target must be an object");s=s||new FormData,r=H.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!H.isUndefined(y[g])});const n=r.metaTokens,a=r.visitor||h,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(s);if(!H.isFunction(a))throw new TypeError("visitor must be a function");function d(x){if(x===null)return"";if(H.isDate(x))return x.toISOString();if(H.isBoolean(x))return x.toString();if(!c&&H.isBlob(x))throw new De("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(x)||H.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function h(x,g,y){let b=x;if(x&&!y&&typeof x=="object"){if(H.endsWith(g,"{}"))g=n?g:g.slice(0,-2),x=JSON.stringify(x);else if(H.isArray(x)&&MN(x)||(H.isFileList(x)||H.endsWith(g,"[]"))&&(b=H.toArray(x)))return g=Py(g),b.forEach(function(v,w){!(H.isUndefined(v)||v===null)&&s.append(l===!0?Ex([g],w,i):l===null?g:g+"[]",d(v))}),!1}return mm(x)?!0:(s.append(Ex(y,g,i),d(x)),!1)}const u=[],p=Object.assign(TN,{defaultVisitor:h,convertValue:d,isVisitable:mm});function j(x,g){if(!H.isUndefined(x)){if(u.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));u.push(x),H.forEach(x,function(b,f){(!(H.isUndefined(b)||b===null)&&a.call(s,b,H.isString(f)?f.trim():f,g,p))===!0&&j(b,g?g.concat(f):[f])}),u.pop()}}if(!H.isObject(e))throw new TypeError("data must be an object");return j(e),s}function Mx(e){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return s[n]})}function Ah(e,s){this._pairs=[],e&&Yc(e,this,s)}const Ry=Ah.prototype;Ry.append=function(s,r){this._pairs.push([s,r])};Ry.toString=function(s){const r=s?function(n){return s.call(this,n,Mx)}:Mx;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function AN(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Ly(e,s,r){if(!s)return e;const n=r&&r.encode||AN;H.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(s,r):i=H.isURLSearchParams(s)?s.toString():new Ah(s,r).toString(n),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Tx{constructor(){this.handlers=[]}use(s,r,n){return this.handlers.push({fulfilled:s,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){H.forEach(this.handlers,function(n){n!==null&&s(n)})}}const $y={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},PN=typeof URLSearchParams<"u"?URLSearchParams:Ah,RN=typeof FormData<"u"?FormData:null,LN=typeof Blob<"u"?Blob:null,$N={isBrowser:!0,classes:{URLSearchParams:PN,FormData:RN,Blob:LN},protocols:["http","https","file","blob","url","data"]},Ph=typeof window<"u"&&typeof document<"u",hm=typeof navigator=="object"&&navigator||void 0,FN=Ph&&(!hm||["ReactNative","NativeScript","NS"].indexOf(hm.product)<0),IN=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ON=Ph&&window.location.href||"http://localhost",DN=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ph,hasStandardBrowserEnv:FN,hasStandardBrowserWebWorkerEnv:IN,navigator:hm,origin:ON},Symbol.toStringTag,{value:"Module"})),Zt={...DN,...$N};function zN(e,s){return Yc(e,new Zt.classes.URLSearchParams,{visitor:function(r,n,a,i){return Zt.isNode&&H.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...s})}function UN(e){return H.matchAll(/\w+|\[(\w*)]/g,e).map(s=>s[0]==="[]"?"":s[1]||s[0])}function HN(e){const s={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],s[i]=e[i];return s}function Fy(e){function s(r,n,a,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&H.isArray(a)?a.length:l,c?(H.hasOwnProp(a,l)?a[l]=[a[l],n]:a[l]=n,!o):((!a[l]||!H.isObject(a[l]))&&(a[l]=[]),s(r,n,a[l],i)&&H.isArray(a[l])&&(a[l]=HN(a[l])),!o)}if(H.isFormData(e)&&H.isFunction(e.entries)){const r={};return H.forEachEntry(e,(n,a)=>{s(UN(n),a,r,0)}),r}return null}function BN(e,s,r){if(H.isString(e))try{return(s||JSON.parse)(e),H.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Vl={transitional:$y,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=H.isObject(s);if(i&&H.isHTMLForm(s)&&(s=new FormData(s)),H.isFormData(s))return a?JSON.stringify(Fy(s)):s;if(H.isArrayBuffer(s)||H.isBuffer(s)||H.isStream(s)||H.isFile(s)||H.isBlob(s)||H.isReadableStream(s))return s;if(H.isArrayBufferView(s))return s.buffer;if(H.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return zN(s,this.formSerializer).toString();if((o=H.isFileList(s))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Yc(o?{"files[]":s}:s,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),BN(s)):s}],transformResponse:[function(s){const r=this.transitional||Vl.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(H.isResponse(s)||H.isReadableStream(s))return s;if(s&&H.isString(s)&&(n&&!this.responseType||a)){const l=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(s,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?De.from(o,De.ERR_BAD_RESPONSE,this,null,this.response):o}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zt.classes.FormData,Blob:Zt.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],e=>{Vl.headers[e]={}});const qN=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),WN=e=>{const s={};let r,n,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),r=l.substring(0,a).trim().toLowerCase(),n=l.substring(a+1).trim(),!(!r||s[r]&&qN[r])&&(r==="set-cookie"?s[r]?s[r].push(n):s[r]=[n]:s[r]=s[r]?s[r]+", "+n:n)}),s},Ax=Symbol("internals");function Ii(e){return e&&String(e).trim().toLowerCase()}function Bo(e){return e===!1||e==null?e:H.isArray(e)?e.map(Bo):String(e)}function KN(e){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)s[n[1]]=n[2];return s}const VN=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Fd(e,s,r,n,a){if(H.isFunction(n))return n.call(this,s,r);if(a&&(s=r),!!H.isString(s)){if(H.isString(n))return s.indexOf(n)!==-1;if(H.isRegExp(n))return n.test(s)}}function QN(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,n)=>r.toUpperCase()+n)}function GN(e,s){const r=H.toCamelCase(" "+s);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,l){return this[n].call(this,s,a,i,l)},configurable:!0})})}let ws=class{constructor(s){s&&this.set(s)}set(s,r,n){const a=this;function i(o,c,d){const h=Ii(c);if(!h)throw new Error("header name must be a non-empty string");const u=H.findKey(a,h);(!u||a[u]===void 0||d===!0||d===void 0&&a[u]!==!1)&&(a[u||c]=Bo(o))}const l=(o,c)=>H.forEach(o,(d,h)=>i(d,h,c));if(H.isPlainObject(s)||s instanceof this.constructor)l(s,r);else if(H.isString(s)&&(s=s.trim())&&!VN(s))l(WN(s),r);else if(H.isObject(s)&&H.isIterable(s)){let o={},c,d;for(const h of s){if(!H.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[d=h[0]]=(c=o[d])?H.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}l(o,r)}else s!=null&&i(r,s,n);return this}get(s,r){if(s=Ii(s),s){const n=H.findKey(this,s);if(n){const a=this[n];if(!r)return a;if(r===!0)return KN(a);if(H.isFunction(r))return r.call(this,a,n);if(H.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=Ii(s),s){const n=H.findKey(this,s);return!!(n&&this[n]!==void 0&&(!r||Fd(this,this[n],n,r)))}return!1}delete(s,r){const n=this;let a=!1;function i(l){if(l=Ii(l),l){const o=H.findKey(n,l);o&&(!r||Fd(n,n[o],o,r))&&(delete n[o],a=!0)}}return H.isArray(s)?s.forEach(i):i(s),a}clear(s){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!s||Fd(this,this[i],i,s,!0))&&(delete this[i],a=!0)}return a}normalize(s){const r=this,n={};return H.forEach(this,(a,i)=>{const l=H.findKey(n,i);if(l){r[l]=Bo(a),delete r[i];return}const o=s?QN(i):String(i).trim();o!==i&&delete r[i],r[o]=Bo(a),n[o]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return H.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=s&&H.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const n=new this(s);return r.forEach(a=>n.set(a)),n}static accessor(s){const n=(this[Ax]=this[Ax]={accessors:{}}).accessors,a=this.prototype;function i(l){const o=Ii(l);n[o]||(GN(a,l),n[o]=!0)}return H.isArray(s)?s.forEach(i):i(s),this}};ws.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(ws.prototype,({value:e},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>e,set(n){this[r]=n}}});H.freezeMethods(ws);function Id(e,s){const r=this||Vl,n=s||r,a=ws.from(n.headers);let i=n.data;return H.forEach(e,function(o){i=o.call(r,i,a.normalize(),s?s.status:void 0)}),a.normalize(),i}function Iy(e){return!!(e&&e.__CANCEL__)}function ki(e,s,r){De.call(this,e??"canceled",De.ERR_CANCELED,s,r),this.name="CanceledError"}H.inherits(ki,De,{__CANCEL__:!0});function Oy(e,s,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):s(new De("Request failed with status code "+r.status,[De.ERR_BAD_REQUEST,De.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function YN(e){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return s&&s[1]||""}function JN(e,s){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,l;return s=s!==void 0?s:1e3,function(c){const d=Date.now(),h=n[i];l||(l=d),r[a]=c,n[a]=d;let u=i,p=0;for(;u!==a;)p+=r[u++],u=u%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),d-l<s)return;const j=h&&d-h;return j?Math.round(p*1e3/j):void 0}}function XN(e,s){let r=0,n=1e3/s,a,i;const l=(d,h=Date.now())=>{r=h,a=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const h=Date.now(),u=h-r;u>=n?l(d,h):(a=d,i||(i=setTimeout(()=>{i=null,l(a)},n-u)))},()=>a&&l(a)]}const jc=(e,s,r=3)=>{let n=0;const a=JN(50,250);return XN(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-n,d=a(c),h=l<=o;n=l;const u={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&h?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[s?"download":"upload"]:!0};e(u)},r)},Px=(e,s)=>{const r=e!=null;return[n=>s[0]({lengthComputable:r,total:e,loaded:n}),s[1]]},Rx=e=>(...s)=>H.asap(()=>e(...s)),ZN=Zt.hasStandardBrowserEnv?((e,s)=>r=>(r=new URL(r,Zt.origin),e.protocol===r.protocol&&e.host===r.host&&(s||e.port===r.port)))(new URL(Zt.origin),Zt.navigator&&/(msie|trident)/i.test(Zt.navigator.userAgent)):()=>!0,ek=Zt.hasStandardBrowserEnv?{write(e,s,r,n,a,i,l){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(s)}`];H.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),H.isString(n)&&o.push(`path=${n}`),H.isString(a)&&o.push(`domain=${a}`),i===!0&&o.push("secure"),H.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function tk(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function sk(e,s){return s?e.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):e}function Dy(e,s,r){let n=!tk(s);return e&&(n||r==!1)?sk(e,s):s}const Lx=e=>e instanceof ws?{...e}:e;function xa(e,s){s=s||{};const r={};function n(d,h,u,p){return H.isPlainObject(d)&&H.isPlainObject(h)?H.merge.call({caseless:p},d,h):H.isPlainObject(h)?H.merge({},h):H.isArray(h)?h.slice():h}function a(d,h,u,p){if(H.isUndefined(h)){if(!H.isUndefined(d))return n(void 0,d,u,p)}else return n(d,h,u,p)}function i(d,h){if(!H.isUndefined(h))return n(void 0,h)}function l(d,h){if(H.isUndefined(h)){if(!H.isUndefined(d))return n(void 0,d)}else return n(void 0,h)}function o(d,h,u){if(u in s)return n(d,h);if(u in e)return n(void 0,d)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,h,u)=>a(Lx(d),Lx(h),u,!0)};return H.forEach(Object.keys({...e,...s}),function(h){const u=c[h]||a,p=u(e[h],s[h],h);H.isUndefined(p)&&u!==o||(r[h]=p)}),r}const zy=e=>{const s=xa({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:l,auth:o}=s;if(s.headers=l=ws.from(l),s.url=Ly(Dy(s.baseURL,s.url,s.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),H.isFormData(r)){if(Zt.hasStandardBrowserEnv||Zt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(H.isFunction(r.getHeaders)){const c=r.getHeaders(),d=["content-type","content-length"];Object.entries(c).forEach(([h,u])=>{d.includes(h.toLowerCase())&&l.set(h,u)})}}if(Zt.hasStandardBrowserEnv&&(n&&H.isFunction(n)&&(n=n(s)),n||n!==!1&&ZN(s.url))){const c=a&&i&&ek.read(i);c&&l.set(a,c)}return s},rk=typeof XMLHttpRequest<"u",nk=rk&&function(e){return new Promise(function(r,n){const a=zy(e);let i=a.data;const l=ws.from(a.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=a,h,u,p,j,x;function g(){j&&j(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let y=new XMLHttpRequest;y.open(a.method.toUpperCase(),a.url,!0),y.timeout=a.timeout;function b(){if(!y)return;const v=ws.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),N={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:v,config:e,request:y};Oy(function(z){r(z),g()},function(z){n(z),g()},N),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new De("Request aborted",De.ECONNABORTED,e,y)),y=null)},y.onerror=function(w){const N=w&&w.message?w.message:"Network Error",P=new De(N,De.ERR_NETWORK,e,y);P.event=w||null,n(P),y=null},y.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const N=a.transitional||$y;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),n(new De(w,N.clarifyTimeoutError?De.ETIMEDOUT:De.ECONNABORTED,e,y)),y=null},i===void 0&&l.setContentType(null),"setRequestHeader"in y&&H.forEach(l.toJSON(),function(w,N){y.setRequestHeader(N,w)}),H.isUndefined(a.withCredentials)||(y.withCredentials=!!a.withCredentials),o&&o!=="json"&&(y.responseType=a.responseType),d&&([p,x]=jc(d,!0),y.addEventListener("progress",p)),c&&y.upload&&([u,j]=jc(c),y.upload.addEventListener("progress",u),y.upload.addEventListener("loadend",j)),(a.cancelToken||a.signal)&&(h=v=>{y&&(n(!v||v.type?new ki(null,e,y):v),y.abort(),y=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const f=YN(a.url);if(f&&Zt.protocols.indexOf(f)===-1){n(new De("Unsupported protocol "+f+":",De.ERR_BAD_REQUEST,e));return}y.send(i||null)})},ak=(e,s)=>{const{length:r}=e=e?e.filter(Boolean):[];if(s||r){let n=new AbortController,a;const i=function(d){if(!a){a=!0,o();const h=d instanceof Error?d:this.reason;n.abort(h instanceof De?h:new ki(h instanceof Error?h.message:h))}};let l=s&&setTimeout(()=>{l=null,i(new De(`timeout ${s} of ms exceeded`,De.ETIMEDOUT))},s);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>H.asap(o),c}},ik=function*(e,s){let r=e.byteLength;if(r<s){yield e;return}let n=0,a;for(;n<r;)a=n+s,yield e.slice(n,a),n=a},lk=async function*(e,s){for await(const r of ok(e))yield*ik(r,s)},ok=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const s=e.getReader();try{for(;;){const{done:r,value:n}=await s.read();if(r)break;yield n}}finally{await s.cancel()}},$x=(e,s,r,n)=>{const a=lk(e,s);let i=0,l,o=c=>{l||(l=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:h}=await a.next();if(d){o(),c.close();return}let u=h.byteLength;if(r){let p=i+=u;r(p)}c.enqueue(new Uint8Array(h))}catch(d){throw o(d),d}},cancel(c){return o(c),a.return()}},{highWaterMark:2})},Fx=64*1024,{isFunction:jo}=H,ck=(({Request:e,Response:s})=>({Request:e,Response:s}))(H.global),{ReadableStream:Ix,TextEncoder:Ox}=H.global,Dx=(e,...s)=>{try{return!!e(...s)}catch{return!1}},dk=e=>{e=H.merge.call({skipUndefined:!0},ck,e);const{fetch:s,Request:r,Response:n}=e,a=s?jo(s):typeof fetch=="function",i=jo(r),l=jo(n);if(!a)return!1;const o=a&&jo(Ix),c=a&&(typeof Ox=="function"?(x=>g=>x.encode(g))(new Ox):async x=>new Uint8Array(await new r(x).arrayBuffer())),d=i&&o&&Dx(()=>{let x=!1;const g=new r(Zt.origin,{body:new Ix,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!g}),h=l&&o&&Dx(()=>H.isReadableStream(new n("").body)),u={stream:h&&(x=>x.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!u[x]&&(u[x]=(g,y)=>{let b=g&&g[x];if(b)return b.call(g);throw new De(`Response type '${x}' is not supported`,De.ERR_NOT_SUPPORT,y)})});const p=async x=>{if(x==null)return 0;if(H.isBlob(x))return x.size;if(H.isSpecCompliantForm(x))return(await new r(Zt.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(H.isArrayBufferView(x)||H.isArrayBuffer(x))return x.byteLength;if(H.isURLSearchParams(x)&&(x=x+""),H.isString(x))return(await c(x)).byteLength},j=async(x,g)=>{const y=H.toFiniteNumber(x.getContentLength());return y??p(g)};return async x=>{let{url:g,method:y,data:b,signal:f,cancelToken:v,timeout:w,onDownloadProgress:N,onUploadProgress:P,responseType:z,headers:E,withCredentials:X="same-origin",fetchOptions:T}=zy(x),F=s||fetch;z=z?(z+"").toLowerCase():"text";let Q=ak([f,v&&v.toAbortSignal()],w),Z=null;const xe=Q&&Q.unsubscribe&&(()=>{Q.unsubscribe()});let ve;try{if(P&&d&&y!=="get"&&y!=="head"&&(ve=await j(E,b))!==0){let ee=new r(g,{method:"POST",body:b,duplex:"half"}),ae;if(H.isFormData(b)&&(ae=ee.headers.get("content-type"))&&E.setContentType(ae),ee.body){const[ne,fe]=Px(ve,jc(Rx(P)));b=$x(ee.body,Fx,ne,fe)}}H.isString(X)||(X=X?"include":"omit");const ke=i&&"credentials"in r.prototype,q={...T,signal:Q,method:y.toUpperCase(),headers:E.normalize().toJSON(),body:b,duplex:"half",credentials:ke?X:void 0};Z=i&&new r(g,q);let R=await(i?F(Z,T):F(g,q));const G=h&&(z==="stream"||z==="response");if(h&&(N||G&&xe)){const ee={};["status","statusText","headers"].forEach(Le=>{ee[Le]=R[Le]});const ae=H.toFiniteNumber(R.headers.get("content-length")),[ne,fe]=N&&Px(ae,jc(Rx(N),!0))||[];R=new n($x(R.body,Fx,ne,()=>{fe&&fe(),xe&&xe()}),ee)}z=z||"text";let K=await u[H.findKey(u,z)||"text"](R,x);return!G&&xe&&xe(),await new Promise((ee,ae)=>{Oy(ee,ae,{data:K,headers:ws.from(R.headers),status:R.status,statusText:R.statusText,config:x,request:Z})})}catch(ke){throw xe&&xe(),ke&&ke.name==="TypeError"&&/Load failed|fetch/i.test(ke.message)?Object.assign(new De("Network Error",De.ERR_NETWORK,x,Z),{cause:ke.cause||ke}):De.from(ke,ke&&ke.code,x,Z)}}},uk=new Map,Uy=e=>{let s=e&&e.env||{};const{fetch:r,Request:n,Response:a}=s,i=[n,a,r];let l=i.length,o=l,c,d,h=uk;for(;o--;)c=i[o],d=h.get(c),d===void 0&&h.set(c,d=o?new Map:dk(s)),h=d;return d};Uy();const Rh={http:EN,xhr:nk,fetch:{get:Uy}};H.forEach(Rh,(e,s)=>{if(e){try{Object.defineProperty(e,"name",{value:s})}catch{}Object.defineProperty(e,"adapterName",{value:s})}});const zx=e=>`- ${e}`,mk=e=>H.isFunction(e)||e===null||e===!1;function hk(e,s){e=H.isArray(e)?e:[e];const{length:r}=e;let n,a;const i={};for(let l=0;l<r;l++){n=e[l];let o;if(a=n,!mk(n)&&(a=Rh[(o=String(n)).toLowerCase()],a===void 0))throw new De(`Unknown adapter '${o}'`);if(a&&(H.isFunction(a)||(a=a.get(s))))break;i[o||"#"+l]=a}if(!a){const l=Object.entries(i).map(([c,d])=>`adapter ${c} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(zx).join(`
`):" "+zx(l[0]):"as no adapter specified";throw new De("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a}const Hy={getAdapter:hk,adapters:Rh};function Od(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ki(null,e)}function Ux(e){return Od(e),e.headers=ws.from(e.headers),e.data=Id.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Hy.getAdapter(e.adapter||Vl.adapter,e)(e).then(function(n){return Od(e),n.data=Id.call(e,e.transformResponse,n),n.headers=ws.from(n.headers),n},function(n){return Iy(n)||(Od(e),n&&n.response&&(n.response.data=Id.call(e,e.transformResponse,n.response),n.response.headers=ws.from(n.response.headers))),Promise.reject(n)})}const By="1.13.2",Jc={};["object","boolean","number","function","string","symbol"].forEach((e,s)=>{Jc[e]=function(n){return typeof n===e||"a"+(s<1?"n ":" ")+e}});const Hx={};Jc.transitional=function(s,r,n){function a(i,l){return"[Axios v"+By+"] Transitional option '"+i+"'"+l+(n?". "+n:"")}return(i,l,o)=>{if(s===!1)throw new De(a(l," has been removed"+(r?" in "+r:"")),De.ERR_DEPRECATED);return r&&!Hx[l]&&(Hx[l]=!0,console.warn(a(l," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(i,l,o):!0}};Jc.spelling=function(s){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${s}`),!0)};function xk(e,s,r){if(typeof e!="object")throw new De("options must be an object",De.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],l=s[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new De("option "+i+" must be "+c,De.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new De("Unknown option "+i,De.ERR_BAD_OPTION)}}const qo={assertOptions:xk,validators:Jc},lr=qo.validators;let ia=class{constructor(s){this.defaults=s||{},this.interceptors={request:new Tx,response:new Tx}}async request(s,r){try{return await this._request(s,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=xa(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&qo.assertOptions(n,{silentJSONParsing:lr.transitional(lr.boolean),forcedJSONParsing:lr.transitional(lr.boolean),clarifyTimeoutError:lr.transitional(lr.boolean)},!1),a!=null&&(H.isFunction(a)?r.paramsSerializer={serialize:a}:qo.assertOptions(a,{encode:lr.function,serialize:lr.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),qo.assertOptions(r,{baseUrl:lr.spelling("baseURL"),withXsrfToken:lr.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&H.merge(i.common,i[r.method]);i&&H.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=ws.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let h,u=0,p;if(!c){const x=[Ux.bind(this),void 0];for(x.unshift(...o),x.push(...d),p=x.length,h=Promise.resolve(r);u<p;)h=h.then(x[u++],x[u++]);return h}p=o.length;let j=r;for(;u<p;){const x=o[u++],g=o[u++];try{j=x(j)}catch(y){g.call(this,y);break}}try{h=Ux.call(this,j)}catch(x){return Promise.reject(x)}for(u=0,p=d.length;u<p;)h=h.then(d[u++],d[u++]);return h}getUri(s){s=xa(this.defaults,s);const r=Dy(s.baseURL,s.url,s.allowAbsoluteUrls);return Ly(r,s.params,s.paramsSerializer)}};H.forEach(["delete","get","head","options"],function(s){ia.prototype[s]=function(r,n){return this.request(xa(n||{},{method:s,url:r,data:(n||{}).data}))}});H.forEach(["post","put","patch"],function(s){function r(n){return function(i,l,o){return this.request(xa(o||{},{method:s,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}ia.prototype[s]=r(),ia.prototype[s+"Form"]=r(!0)});let gk=class qy{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const l=new Promise(o=>{n.subscribe(o),i=o}).then(a);return l.cancel=function(){n.unsubscribe(i)},l},s(function(i,l,o){n.reason||(n.reason=new ki(i,l,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=n=>{s.abort(n)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new qy(function(a){s=a}),cancel:s}}};function fk(e){return function(r){return e.apply(null,r)}}function pk(e){return H.isObject(e)&&e.isAxiosError===!0}const xm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(xm).forEach(([e,s])=>{xm[s]=e});function Wy(e){const s=new ia(e),r=wy(ia.prototype.request,s);return H.extend(r,ia.prototype,s,{allOwnKeys:!0}),H.extend(r,s,null,{allOwnKeys:!0}),r.create=function(a){return Wy(xa(e,a))},r}const Nt=Wy(Vl);Nt.Axios=ia;Nt.CanceledError=ki;Nt.CancelToken=gk;Nt.isCancel=Iy;Nt.VERSION=By;Nt.toFormData=Yc;Nt.AxiosError=De;Nt.Cancel=Nt.CanceledError;Nt.all=function(s){return Promise.all(s)};Nt.spread=fk;Nt.isAxiosError=pk;Nt.mergeConfig=xa;Nt.AxiosHeaders=ws;Nt.formToJSON=e=>Fy(H.isHTMLForm(e)?new FormData(e):e);Nt.getAdapter=Hy.getAdapter;Nt.HttpStatusCode=xm;Nt.default=Nt;const{Axios:e_,AxiosError:t_,CanceledError:s_,isCancel:r_,CancelToken:n_,VERSION:a_,all:i_,Cancel:l_,isAxiosError:o_,spread:c_,toFormData:d_,AxiosHeaders:u_,HttpStatusCode:m_,formToJSON:h_,getAdapter:x_,mergeConfig:g_}=Nt,yk="https://dartmouth-os-worker.dartmouth.workers.dev",D=Nt.create({baseURL:yk,headers:{"Content-Type":"application/json"}});D.interceptors.request.use(e=>{const s=localStorage.getItem("auth-storage");if(s)try{const{state:r}=JSON.parse(s);r!=null&&r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}catch(r){console.error("Error parsing auth token:",r)}return e});D.interceptors.response.use(e=>e,e=>{var s;return((s=e.response)==null?void 0:s.status)===401&&(localStorage.removeItem("auth-storage"),window.location.href="/login"),Promise.reject(e)});const bk={login:(e,s)=>D.post("/api/auth/login",{email:e,password:s}),me:()=>D.get("/api/auth/me"),logout:()=>D.post("/api/auth/logout")},Oe={list:e=>D.get("/api/tickets",{params:e}),get:e=>D.get(`/api/tickets/${e}`),getById:e=>D.get(`/api/tickets/${e}`),getMessages:e=>D.get(`/api/tickets/${e}/messages`),assign:(e,s)=>D.put(`/api/tickets/${e}/assign`,{assignedTo:s}),updateStatus:(e,s)=>D.put(`/api/tickets/${e}/status`,{status:s}),reply:(e,s,r)=>D.post(`/api/tickets/${e}/reply`,{content:s,attachments:r}),addNote:(e,s,r,n)=>D.post(`/api/tickets/${e}/notes`,{content:s,noteType:r,attachments:n}),editNote:(e,s,r)=>D.put(`/api/tickets/${e}/notes/${s}`,{content:r}),deleteNote:(e,s)=>D.delete(`/api/tickets/${e}/notes/${s}`),snooze:(e,s,r)=>D.post(`/api/tickets/${e}/snooze`,{snoozedUntil:s,reason:r}),unsnooze:e=>D.post(`/api/tickets/${e}/unsnooze`),escalate:(e,s,r)=>D.post(`/api/tickets/${e}/escalate`,{staffIds:s,reason:r}),resolveEscalation:(e,s)=>D.post(`/api/tickets/${e}/resolve-escalation`,{escalationId:s}),scheduleReply:(e,s,r)=>D.post(`/api/tickets/${e}/schedule-reply`,{content:s,scheduledFor:r}),getScheduledMessages:e=>D.get(`/api/tickets/${e}/scheduled-messages`),updateScheduledMessage:(e,s,r)=>D.put(`/api/scheduled-messages/${e}`,{content:s,scheduledFor:r}),deleteScheduledMessage:e=>D.delete(`/api/scheduled-messages/${e}`),getAIDraft:e=>D.get(`/api/tickets/${e}/ai-draft`),approveAIDraft:e=>D.post(`/api/tickets/${e}/ai-draft/approve`),editAIDraft:(e,s)=>D.post(`/api/tickets/${e}/ai-draft/edit`,{editedContent:s}),rejectAIDraft:(e,s)=>D.post(`/api/tickets/${e}/ai-draft/reject`,{reason:s}),submitAIDraftFeedback:(e,s)=>D.post(`/api/tickets/${e}/ai-draft/feedback`,s),delete:e=>D.delete(`/api/tickets/${e}`),merge:(e,s)=>D.post(`/api/tickets/${e}/merge`,{secondaryTicketIds:s}),bulkAssign:(e,s)=>D.post("/api/tickets/bulk-assign",{ticketIds:e,assignedTo:s}),createManual:e=>D.post("/api/tickets/create-manual",e)},rt={list:()=>D.get("/api/staff"),get:e=>D.get(`/api/staff/${e}`),me:()=>D.get("/api/staff/me"),onlineCount:()=>D.get("/api/staff/online-count"),create:e=>D.post("/api/staff",e),update:(e,s)=>D.put(`/api/staff/${e}`,s),updatePresence:(e,s)=>D.put(`/api/staff/${e}/presence`,{isAvailable:s}),updateAvailability:(e,s)=>D.put(`/api/staff/${e}/availability`,{status:s}),uploadAvatar:(e,s)=>{const r=new FormData;return r.append("avatar",s),D.post(`/api/staff/${e}/avatar`,r,{headers:{"Content-Type":"multipart/form-data"}})},deleteAvatar:e=>D.delete(`/api/staff/${e}/avatar`),getAvatarUrl:e=>e?e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev${e}`:null},Rr={getSettings:()=>D.get("/api/chat/settings"),updateSettings:e=>D.put("/api/chat/settings",e),getBusinessHours:()=>D.get("/api/chat/business-hours"),updateBusinessHours:e=>D.put("/api/chat/business-hours",{hours:e}),getStatus:()=>D.get("/api/chat/status"),getEmbedCode:()=>D.get("/api/chat/embed-code")},wo={listDocuments:()=>D.get("/api/ai-agent/knowledge"),uploadDocument:(e,s)=>{const r=new FormData;return r.append("file",e),r.append("category",s),D.post("/api/ai-agent/knowledge/upload",r,{headers:{"Content-Type":"multipart/form-data"}})},deleteDocument:e=>D.delete(`/api/ai-agent/knowledge/${e}`),reprocessDocuments:()=>D.post("/api/ai-agent/knowledge/reprocess")},Dd={getConfig:()=>D.get("/api/ai-agent/system-message"),updateConfig:e=>D.put("/api/ai-agent/system-message",e),resetToDefault:()=>D.post("/api/ai-agent/system-message/reset")},Bx={getAIAgentStats:(e="7d")=>D.get("/api/analytics/ai-agent",{params:{timeRange:e}}),getLearningExamples:(e=10)=>D.get("/api/analytics/ai-agent/learning-examples",{params:{limit:e}})},No={getConfig:()=>D.get("/api/auto-assignment/config"),updateConfig:e=>D.put("/api/auto-assignment/config",e),runNow:()=>D.post("/api/auto-assignment/run"),getHistory:e=>D.get("/api/auto-assignment/history",{params:{limit:e}}),getStaffSettings:e=>D.get(`/api/auto-assignment/staff/${e}`),updateStaffSettings:(e,s)=>D.put(`/api/auto-assignment/staff/${e}`,s)},vk={getTicketData:e=>D.get("/api/shopify/ticket-data",{params:{email:e}}),getCustomer:e=>D.get("/api/shopify/customer",{params:{email:e}}),getCustomerOrders:(e,s)=>D.get(`/api/shopify/customer/${e}/orders`,{params:{limit:s}}),getOrdersByEmail:(e,s)=>D.get("/api/shopify/orders",{params:{email:e,limit:s}}),searchOrder:e=>D.get("/api/shopify/order",{params:{number:e}}),getOrder:e=>D.get(`/api/shopify/order/${e}`)},xt={listChannels:()=>D.get("/api/group-chat/channels"),createChannel:e=>D.post("/api/group-chat/channels",e),getChannel:e=>D.get(`/api/group-chat/channels/${e}`),updateChannel:(e,s)=>D.patch(`/api/group-chat/channels/${e}`,s),archiveChannel:e=>D.delete(`/api/group-chat/channels/${e}`),getMessages:(e,s)=>D.get(`/api/group-chat/channels/${e}/messages`,{params:s}),sendMessage:(e,s)=>D.post(`/api/group-chat/channels/${e}/messages`,s),pollMessages:(e,s)=>D.get(`/api/group-chat/channels/${e}/poll`,{params:{after:s}}),editMessage:(e,s,r)=>D.patch(`/api/group-chat/messages/${e}`,{content:s,deleteAttachment:r}),deleteMessage:e=>D.delete(`/api/group-chat/messages/${e}`),addReaction:(e,s)=>D.post(`/api/group-chat/messages/${e}/react`,{emoji:s}),getMembers:e=>D.get(`/api/group-chat/channels/${e}/members`),addMember:(e,s)=>D.post(`/api/group-chat/channels/${e}/members`,{staffId:s}),removeMember:(e,s)=>D.delete(`/api/group-chat/channels/${e}/members/${s}`),markAsRead:(e,s)=>D.post(`/api/group-chat/channels/${e}/read`,{messageId:s}),getUnreadCounts:()=>D.get("/api/group-chat/unread"),getTimeLimit:()=>D.get("/api/group-chat/settings/time-limit"),setTimeLimit:e=>D.put("/api/group-chat/settings/time-limit",{timeLimit:e}),getAutoArchiveHours:()=>D.get("/api/group-chat/settings/auto-archive"),setAutoArchiveHours:e=>D.put("/api/group-chat/settings/auto-archive",{hours:e})},Gi={getMemos:e=>D.get("/api/memos",{params:e}),createMemo:e=>D.post("/api/memos",e),editMemo:(e,s)=>D.patch(`/api/memos/${e}`,s),deleteMemo:e=>D.delete(`/api/memos/${e}`)},qx={getAllTags:e=>D.get("/api/tags",{params:e?{search:e}:{}}),searchTags:e=>D.get("/api/tags/search",{params:{search:e}})},ko={getGlobal:()=>D.get("/api/signatures/global"),setGlobal:e=>D.put("/api/signatures/global",{signatureHtml:e}),getPreview:()=>D.get("/api/signatures/preview"),getPlainText:()=>D.get("/api/signatures/plain-text"),uploadLogo:e=>D.post("/api/signatures/upload-logo",{attachment:e}),getSettings:()=>D.get("/api/signatures/settings"),saveSettings:e=>D.put("/api/signatures/settings",e),getPreviewFromSettings:e=>D.post("/api/signatures/preview-from-settings",e)},zn={getMentions:e=>D.get("/api/mentions",{params:e}),getMention:e=>D.get(`/api/mentions/${e}`),markAsRead:e=>D.patch(`/api/mentions/${e}/read`),markAsUnread:e=>D.patch(`/api/mentions/${e}/unread`),archiveMention:e=>D.patch(`/api/mentions/${e}/archive`),getUnreadCount:()=>D.get("/api/mentions/unread-count"),updateMention:(e,s)=>D.patch(`/api/mentions/${e}`,s),deleteMention:e=>D.delete(`/api/mentions/${e}`)};function jk(){const[e,s]=m.useState("john@dtf.com.au"),[r,n]=m.useState("changeme123"),[a,i]=m.useState(""),[l,o]=m.useState(!1),c=vr(),d=ts(u=>u.setAuth),h=async u=>{var p,j;u.preventDefault(),i(""),o(!0);try{const x=await bk.login(e,r);d(x.data.token,x.data.user),c("/tickets")}catch(x){i(((j=(p=x.response)==null?void 0:p.data)==null?void 0:j.error)||"Login failed")}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:t.jsxs("div",{className:"max-w-md w-full space-y-8",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Customer Service Dashboard"}),t.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your account"})]}),t.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h,children:[a&&t.jsx("div",{className:"rounded-md bg-red-50 p-4",children:t.jsx("div",{className:"text-sm text-red-800",children:a})}),t.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),t.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:u=>s(u.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),t.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",value:r,onChange:u=>n(u.target.value)})]})]}),t.jsx("div",{children:t.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:l?"Signing in...":"Sign in"})}),t.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[t.jsx("p",{children:"Test credentials:"}),t.jsx("p",{children:"Admin: john@dtf.com.au / changeme123"}),t.jsx("p",{children:"Agent: john+ted@dtf.com.au / changeme123"})]})]})]})})}var wk=Object.defineProperty,Nk=(e,s,r)=>s in e?wk(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,zd=(e,s,r)=>(Nk(e,typeof s!="symbol"?s+"":s,r),r);let kk=class{constructor(){zd(this,"current",this.detect()),zd(this,"handoffState","pending"),zd(this,"currentId",0)}set(s){this.current!==s&&(this.handoffState="pending",this.currentId=0,this.current=s)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},$r=new kk,Ut=(e,s)=>{$r.isServer?m.useEffect(e,s):m.useLayoutEffect(e,s)};function Fr(e){let s=m.useRef(e);return Ut(()=>{s.current=e},[e]),s}let Be=function(e){let s=Fr(e);return $e.useCallback((...r)=>s.current(...r),[s])};function Xc(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(s=>setTimeout(()=>{throw s}))}function tr(){let e=[],s={addEventListener(r,n,a,i){return r.addEventListener(n,a,i),s.add(()=>r.removeEventListener(n,a,i))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return s.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return s.requestAnimationFrame(()=>s.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return s.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return Xc(()=>{n.current&&r[0]()}),s.add(()=>{n.current=!1})},style(r,n,a){let i=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:a}),this.add(()=>{Object.assign(r.style,{[n]:i})})},group(r){let n=tr();return r(n),this.add(()=>n.dispose())},add(r){return e.push(r),()=>{let n=e.indexOf(r);if(n>=0)for(let a of e.splice(n,1))a()}},dispose(){for(let r of e.splice(0))r()}};return s}function Ql(){let[e]=m.useState(tr);return m.useEffect(()=>()=>e.dispose(),[e]),e}function Sk(){let e=typeof document>"u";return"useSyncExternalStore"in si?(s=>s.useSyncExternalStore)(si)(()=>()=>{},()=>!1,()=>!e):!1}function Si(){let e=Sk(),[s,r]=m.useState($r.isHandoffComplete);return s&&$r.isHandoffComplete===!1&&r(!1),m.useEffect(()=>{s!==!0&&r(!0)},[s]),m.useEffect(()=>$r.handoff(),[]),e?!1:s}var Wx;let qr=(Wx=$e.useId)!=null?Wx:function(){let e=Si(),[s,r]=$e.useState(e?()=>$r.nextId():null);return Ut(()=>{s===null&&r($r.nextId())},[s]),s!=null?""+s:void 0};function Dt(e,s,...r){if(e in s){let a=s[e];return typeof a=="function"?a(...r):a}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(s).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Dt),n}function Zc(e){return $r.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let gm=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var Tr=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(Tr||{}),Ky=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Ky||{}),Ck=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Ck||{});function Vy(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(gm)).sort((s,r)=>Math.sign((s.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Lh=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Lh||{});function $h(e,s=0){var r;return e===((r=Zc(e))==null?void 0:r.body)?!1:Dt(s,{0(){return e.matches(gm)},1(){let n=e;for(;n!==null;){if(n.matches(gm))return!0;n=n.parentElement}return!1}})}function Qy(e){let s=Zc(e);tr().nextFrame(()=>{s&&!$h(s.activeElement,0)&&En(e)})}var _k=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(_k||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function En(e){e==null||e.focus({preventScroll:!0})}let Ek=["textarea","input"].join(",");function Mk(e){var s,r;return(r=(s=e==null?void 0:e.matches)==null?void 0:s.call(e,Ek))!=null?r:!1}function Gy(e,s=r=>r){return e.slice().sort((r,n)=>{let a=s(r),i=s(n);if(a===null||i===null)return 0;let l=a.compareDocumentPosition(i);return l&Node.DOCUMENT_POSITION_FOLLOWING?-1:l&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Tk(e,s){return ol(Vy(),s,{relativeTo:e})}function ol(e,s,{sorted:r=!0,relativeTo:n=null,skipElements:a=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,l=Array.isArray(e)?r?Gy(e):e:Vy(e);a.length>0&&l.length>1&&(l=l.filter(j=>!a.includes(j))),n=n??i.activeElement;let o=(()=>{if(s&5)return 1;if(s&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(s&1)return 0;if(s&2)return Math.max(0,l.indexOf(n))-1;if(s&4)return Math.max(0,l.indexOf(n))+1;if(s&8)return l.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=s&32?{preventScroll:!0}:{},h=0,u=l.length,p;do{if(h>=u||h+u<=0)return 0;let j=c+h;if(s&16)j=(j+u)%u;else{if(j<0)return 3;if(j>=u)return 1}p=l[j],p==null||p.focus(d),h+=o}while(p!==i.activeElement);return s&6&&Mk(p)&&p.select(),2}function Yy(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Ak(){return/Android/gi.test(window.navigator.userAgent)}function Pk(){return Yy()||Ak()}function So(e,s,r){let n=Fr(s);m.useEffect(()=>{function a(i){n.current(i)}return document.addEventListener(e,a,r),()=>document.removeEventListener(e,a,r)},[e,r])}function Jy(e,s,r){let n=Fr(s);m.useEffect(()=>{function a(i){n.current(i)}return window.addEventListener(e,a,r),()=>window.removeEventListener(e,a,r)},[e,r])}function Xy(e,s,r=!0){let n=m.useRef(!1);m.useEffect(()=>{requestAnimationFrame(()=>{n.current=r})},[r]);function a(l,o){if(!n.current||l.defaultPrevented)return;let c=o(l);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let d=function h(u){return typeof u=="function"?h(u()):Array.isArray(u)||u instanceof Set?u:[u]}(e);for(let h of d){if(h===null)continue;let u=h instanceof HTMLElement?h:h.current;if(u!=null&&u.contains(c)||l.composed&&l.composedPath().includes(u))return}return!$h(c,Lh.Loose)&&c.tabIndex!==-1&&l.preventDefault(),s(l,c)}let i=m.useRef(null);So("pointerdown",l=>{var o,c;n.current&&(i.current=((c=(o=l.composedPath)==null?void 0:o.call(l))==null?void 0:c[0])||l.target)},!0),So("mousedown",l=>{var o,c;n.current&&(i.current=((c=(o=l.composedPath)==null?void 0:o.call(l))==null?void 0:c[0])||l.target)},!0),So("click",l=>{Pk()||i.current&&(a(l,()=>i.current),i.current=null)},!0),So("touchend",l=>a(l,()=>l.target instanceof HTMLElement?l.target:null),!0),Jy("blur",l=>a(l,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Ci(...e){return m.useMemo(()=>Zc(...e),[...e])}function Kx(e){var s;if(e.type)return e.type;let r=(s=e.as)!=null?s:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function Rk(e,s){let[r,n]=m.useState(()=>Kx(e));return Ut(()=>{n(Kx(e))},[e.type,e.as]),Ut(()=>{r||s.current&&s.current instanceof HTMLButtonElement&&!s.current.hasAttribute("type")&&n("button")},[r,s]),r}let Zy=Symbol();function Lk(e,s=!0){return Object.assign(e,{[Zy]:s})}function ms(...e){let s=m.useRef(e);m.useEffect(()=>{s.current=e},[e]);let r=Be(n=>{for(let a of s.current)a!=null&&(typeof a=="function"?a(n):a.current=n)});return e.every(n=>n==null||(n==null?void 0:n[Zy]))?void 0:r}function Vx(e){return[e.screenX,e.screenY]}function $k(){let e=m.useRef([-1,-1]);return{wasMoved(s){let r=Vx(s);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(s){e.current=Vx(s)}}}function Fk({container:e,accept:s,walk:r,enabled:n=!0}){let a=m.useRef(s),i=m.useRef(r);m.useEffect(()=>{a.current=s,i.current=r},[s,r]),Ut(()=>{if(!e||!n)return;let l=Zc(e);if(!l)return;let o=a.current,c=i.current,d=Object.assign(u=>o(u),{acceptNode:o}),h=l.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,d,!1);for(;h.nextNode();)c(h.currentNode)},[e,n,a,i])}function Fh(e,s){let r=m.useRef([]),n=Be(e);m.useEffect(()=>{let a=[...r.current];for(let[i,l]of s.entries())if(r.current[i]!==l){let o=n(s,a);return r.current=s,o}},[n,...s])}function wc(...e){return Array.from(new Set(e.flatMap(s=>typeof s=="string"?s.split(" "):[]))).filter(Boolean).join(" ")}var mi=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(mi||{}),fn=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(fn||{});function ss({ourProps:e,theirProps:s,slot:r,defaultTag:n,features:a,visible:i=!0,name:l,mergeRefs:o}){o=o??Ik;let c=eb(s,e);if(i)return Co(c,r,n,l,o);let d=a??0;if(d&2){let{static:h=!1,...u}=c;if(h)return Co(u,r,n,l,o)}if(d&1){let{unmount:h=!0,...u}=c;return Dt(h?0:1,{0(){return null},1(){return Co({...u,hidden:!0,style:{display:"none"}},r,n,l,o)}})}return Co(c,r,n,l,o)}function Co(e,s={},r,n,a){let{as:i=r,children:l,refName:o="ref",...c}=Ud(e,["unmount","static"]),d=e.ref!==void 0?{[o]:e.ref}:{},h=typeof l=="function"?l(s):l;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(s));let u={};if(s){let p=!1,j=[];for(let[x,g]of Object.entries(s))typeof g=="boolean"&&(p=!0),g===!0&&j.push(x);p&&(u["data-headlessui-state"]=j.join(" "))}if(i===m.Fragment&&Object.keys(Qx(c)).length>0){if(!m.isValidElement(h)||Array.isArray(h)&&h.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(c).map(g=>`  - ${g}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(g=>`  - ${g}`).join(`
`)].join(`
`));let p=h.props,j=typeof(p==null?void 0:p.className)=="function"?(...g)=>wc(p==null?void 0:p.className(...g),c.className):wc(p==null?void 0:p.className,c.className),x=j?{className:j}:{};return m.cloneElement(h,Object.assign({},eb(h.props,Qx(Ud(c,["ref"]))),u,d,{ref:a(h.ref,d.ref)},x))}return m.createElement(i,Object.assign({},Ud(c,["ref"]),i!==m.Fragment&&d,i!==m.Fragment&&u),h)}function Ik(...e){return e.every(s=>s==null)?void 0:s=>{for(let r of e)r!=null&&(typeof r=="function"?r(s):r.current=s)}}function eb(...e){if(e.length===0)return{};if(e.length===1)return e[0];let s={},r={};for(let n of e)for(let a in n)a.startsWith("on")&&typeof n[a]=="function"?(r[a]!=null||(r[a]=[]),r[a].push(n[a])):s[a]=n[a];if(s.disabled||s["aria-disabled"])return Object.assign(s,Object.fromEntries(Object.keys(r).map(n=>[n,void 0])));for(let n in r)Object.assign(s,{[n](a,...i){let l=r[n];for(let o of l){if((a instanceof Event||(a==null?void 0:a.nativeEvent)instanceof Event)&&a.defaultPrevented)return;o(a,...i)}}});return s}function Qt(e){var s;return Object.assign(m.forwardRef(e),{displayName:(s=e.displayName)!=null?s:e.name})}function Qx(e){let s=Object.assign({},e);for(let r in s)s[r]===void 0&&delete s[r];return s}function Ud(e,s=[]){let r=Object.assign({},e);for(let n of s)n in r&&delete r[n];return r}let Ok="div";var Nc=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Nc||{});function Dk(e,s){var r;let{features:n=1,...a}=e,i={ref:s,"aria-hidden":(n&2)===2?!0:(r=a["aria-hidden"])!=null?r:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return ss({ourProps:i,theirProps:a,slot:{},defaultTag:Ok,name:"Hidden"})}let fm=Qt(Dk),Ih=m.createContext(null);Ih.displayName="OpenClosedContext";var qt=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(qt||{});function ed(){return m.useContext(Ih)}function tb({value:e,children:s}){return $e.createElement(Ih.Provider,{value:e},s)}function zk(e){function s(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",s))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",s),s())}let sn=[];zk(()=>{function e(s){s.target instanceof HTMLElement&&s.target!==document.body&&sn[0]!==s.target&&(sn.unshift(s.target),sn=sn.filter(r=>r!=null&&r.isConnected),sn.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function sb(e){let s=e.parentElement,r=null;for(;s&&!(s instanceof HTMLFieldSetElement);)s instanceof HTMLLegendElement&&(r=s),s=s.parentElement;let n=(s==null?void 0:s.getAttribute("disabled"))==="";return n&&Uk(r)?!1:n}function Uk(e){if(!e)return!1;let s=e.previousElementSibling;for(;s!==null;){if(s instanceof HTMLLegendElement)return!1;s=s.previousElementSibling}return!0}function Hk(e){throw new Error("Unexpected object: "+e)}var Ys=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Ys||{});function Bk(e,s){let r=s.resolveItems();if(r.length<=0)return null;let n=s.resolveActiveIndex(),a=n??-1;switch(e.focus){case 0:{for(let i=0;i<r.length;++i)if(!s.resolveDisabled(r[i],i,r))return i;return n}case 1:{for(let i=a-1;i>=0;--i)if(!s.resolveDisabled(r[i],i,r))return i;return n}case 2:{for(let i=a+1;i<r.length;++i)if(!s.resolveDisabled(r[i],i,r))return i;return n}case 3:{for(let i=r.length-1;i>=0;--i)if(!s.resolveDisabled(r[i],i,r))return i;return n}case 4:{for(let i=0;i<r.length;++i)if(s.resolveId(r[i],i,r)===e.id)return i;return n}case 5:return null;default:Hk(e)}}var Ft=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Ft||{});function rb(e,s,r,n){let a=Fr(r);m.useEffect(()=>{e=e??window;function i(l){a.current(l)}return e.addEventListener(s,i,n),()=>e.removeEventListener(s,i,n)},[e,s,n])}function Gl(){let e=m.useRef(!1);return Ut(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function nb(e){let s=Be(e),r=m.useRef(!1);m.useEffect(()=>(r.current=!1,()=>{r.current=!0,Xc(()=>{r.current&&s()})}),[s])}var Yi=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Yi||{});function qk(){let e=m.useRef(0);return Jy("keydown",s=>{s.key==="Tab"&&(e.current=s.shiftKey?1:0)},!0),e}function ab(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let s=new Set;for(let r of e.current)r.current instanceof HTMLElement&&s.add(r.current);return s}let Wk="div";var ib=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(ib||{});function Kk(e,s){let r=m.useRef(null),n=ms(r,s),{initialFocus:a,containers:i,features:l=30,...o}=e;Si()||(l=1);let c=Ci(r);Gk({ownerDocument:c},!!(l&16));let d=Yk({ownerDocument:c,container:r,initialFocus:a},!!(l&2));Jk({ownerDocument:c,container:r,containers:i,previousActiveElement:d},!!(l&8));let h=qk(),u=Be(g=>{let y=r.current;y&&(b=>b())(()=>{Dt(h.current,{[Yi.Forwards]:()=>{ol(y,Tr.First,{skipElements:[g.relatedTarget]})},[Yi.Backwards]:()=>{ol(y,Tr.Last,{skipElements:[g.relatedTarget]})}})})}),p=Ql(),j=m.useRef(!1),x={ref:n,onKeyDown(g){g.key=="Tab"&&(j.current=!0,p.requestAnimationFrame(()=>{j.current=!1}))},onBlur(g){let y=ab(i);r.current instanceof HTMLElement&&y.add(r.current);let b=g.relatedTarget;b instanceof HTMLElement&&b.dataset.headlessuiFocusGuard!=="true"&&(lb(y,b)||(j.current?ol(r.current,Dt(h.current,{[Yi.Forwards]:()=>Tr.Next,[Yi.Backwards]:()=>Tr.Previous})|Tr.WrapAround,{relativeTo:g.target}):g.target instanceof HTMLElement&&En(g.target)))}};return $e.createElement($e.Fragment,null,!!(l&4)&&$e.createElement(fm,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:u,features:Nc.Focusable}),ss({ourProps:x,theirProps:o,defaultTag:Wk,name:"FocusTrap"}),!!(l&4)&&$e.createElement(fm,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:u,features:Nc.Focusable}))}let Vk=Qt(Kk),Oi=Object.assign(Vk,{features:ib});function Qk(e=!0){let s=m.useRef(sn.slice());return Fh(([r],[n])=>{n===!0&&r===!1&&Xc(()=>{s.current.splice(0)}),n===!1&&r===!0&&(s.current=sn.slice())},[e,sn,s]),Be(()=>{var r;return(r=s.current.find(n=>n!=null&&n.isConnected))!=null?r:null})}function Gk({ownerDocument:e},s){let r=Qk(s);Fh(()=>{s||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&En(r())},[s]),nb(()=>{s&&En(r())})}function Yk({ownerDocument:e,container:s,initialFocus:r},n){let a=m.useRef(null),i=Gl();return Fh(()=>{if(!n)return;let l=s.current;l&&Xc(()=>{if(!i.current)return;let o=e==null?void 0:e.activeElement;if(r!=null&&r.current){if((r==null?void 0:r.current)===o){a.current=o;return}}else if(l.contains(o)){a.current=o;return}r!=null&&r.current?En(r.current):ol(l,Tr.First)===Ky.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),a.current=e==null?void 0:e.activeElement})},[n]),a}function Jk({ownerDocument:e,container:s,containers:r,previousActiveElement:n},a){let i=Gl();rb(e==null?void 0:e.defaultView,"focus",l=>{if(!a||!i.current)return;let o=ab(r);s.current instanceof HTMLElement&&o.add(s.current);let c=n.current;if(!c)return;let d=l.target;d&&d instanceof HTMLElement?lb(o,d)?(n.current=d,En(d)):(l.preventDefault(),l.stopPropagation(),En(c)):En(n.current)},!0)}function lb(e,s){for(let r of e)if(r.contains(s))return!0;return!1}let ob=m.createContext(!1);function Xk(){return m.useContext(ob)}function pm(e){return $e.createElement(ob.Provider,{value:e.force},e.children)}function Zk(e){let s=Xk(),r=m.useContext(cb),n=Ci(e),[a,i]=m.useState(()=>{if(!s&&r!==null||$r.isServer)return null;let l=n==null?void 0:n.getElementById("headlessui-portal-root");if(l)return l;if(n===null)return null;let o=n.createElement("div");return o.setAttribute("id","headlessui-portal-root"),n.body.appendChild(o)});return m.useEffect(()=>{a!==null&&(n!=null&&n.body.contains(a)||n==null||n.body.appendChild(a))},[a,n]),m.useEffect(()=>{s||r!==null&&i(r.current)},[r,i,s]),a}let e5=m.Fragment;function t5(e,s){let r=e,n=m.useRef(null),a=ms(Lk(h=>{n.current=h}),s),i=Ci(n),l=Zk(n),[o]=m.useState(()=>{var h;return $r.isServer?null:(h=i==null?void 0:i.createElement("div"))!=null?h:null}),c=m.useContext(ym),d=Si();return Ut(()=>{!l||!o||l.contains(o)||(o.setAttribute("data-headlessui-portal",""),l.appendChild(o))},[l,o]),Ut(()=>{if(o&&c)return c.register(o)},[c,o]),nb(()=>{var h;!l||!o||(o instanceof Node&&l.contains(o)&&l.removeChild(o),l.childNodes.length<=0&&((h=l.parentElement)==null||h.removeChild(l)))}),d?!l||!o?null:Vp.createPortal(ss({ourProps:{ref:a},theirProps:r,defaultTag:e5,name:"Portal"}),o):null}let s5=m.Fragment,cb=m.createContext(null);function r5(e,s){let{target:r,...n}=e,a={ref:ms(s)};return $e.createElement(cb.Provider,{value:r},ss({ourProps:a,theirProps:n,defaultTag:s5,name:"Popover.Group"}))}let ym=m.createContext(null);function n5(){let e=m.useContext(ym),s=m.useRef([]),r=Be(i=>(s.current.push(i),e&&e.register(i),()=>n(i))),n=Be(i=>{let l=s.current.indexOf(i);l!==-1&&s.current.splice(l,1),e&&e.unregister(i)}),a=m.useMemo(()=>({register:r,unregister:n,portals:s}),[r,n,s]);return[s,m.useMemo(()=>function({children:i}){return $e.createElement(ym.Provider,{value:a},i)},[a])]}let a5=Qt(t5),i5=Qt(r5),bm=Object.assign(a5,{Group:i5});function l5(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}const o5=typeof Object.is=="function"?Object.is:l5,{useState:c5,useEffect:d5,useLayoutEffect:u5,useDebugValue:m5}=si;function h5(e,s,r){const n=s(),[{inst:a},i]=c5({inst:{value:n,getSnapshot:s}});return u5(()=>{a.value=n,a.getSnapshot=s,Hd(a)&&i({inst:a})},[e,n,s]),d5(()=>(Hd(a)&&i({inst:a}),e(()=>{Hd(a)&&i({inst:a})})),[e]),m5(n),n}function Hd(e){const s=e.getSnapshot,r=e.value;try{const n=s();return!o5(r,n)}catch{return!0}}function x5(e,s,r){return s()}const g5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",f5=!g5,p5=f5?x5:h5,y5="useSyncExternalStore"in si?(e=>e.useSyncExternalStore)(si):p5;function b5(e){return y5(e.subscribe,e.getSnapshot,e.getSnapshot)}function v5(e,s){let r=e(),n=new Set;return{getSnapshot(){return r},subscribe(a){return n.add(a),()=>n.delete(a)},dispatch(a,...i){let l=s[a].call(r,...i);l&&(r=l,n.forEach(o=>o()))}}}function j5(){let e;return{before({doc:s}){var r;let n=s.documentElement;e=((r=s.defaultView)!=null?r:window).innerWidth-n.clientWidth},after({doc:s,d:r}){let n=s.documentElement,a=n.clientWidth-n.offsetWidth,i=e-a;r.style(n,"paddingRight",`${i}px`)}}}function w5(){return Yy()?{before({doc:e,d:s,meta:r}){function n(a){return r.containers.flatMap(i=>i()).some(i=>i.contains(a))}s.microTask(()=>{var a;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let o=tr();o.style(e.documentElement,"scrollBehavior","auto"),s.add(()=>s.microTask(()=>o.dispose()))}let i=(a=window.scrollY)!=null?a:window.pageYOffset,l=null;s.addEventListener(e,"click",o=>{if(o.target instanceof HTMLElement)try{let c=o.target.closest("a");if(!c)return;let{hash:d}=new URL(c.href),h=e.querySelector(d);h&&!n(h)&&(l=h)}catch{}},!0),s.addEventListener(e,"touchstart",o=>{if(o.target instanceof HTMLElement)if(n(o.target)){let c=o.target;for(;c.parentElement&&n(c.parentElement);)c=c.parentElement;s.style(c,"overscrollBehavior","contain")}else s.style(o.target,"touchAction","none")}),s.addEventListener(e,"touchmove",o=>{if(o.target instanceof HTMLElement)if(n(o.target)){let c=o.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&o.preventDefault()}else o.preventDefault()},{passive:!1}),s.add(()=>{var o;let c=(o=window.scrollY)!=null?o:window.pageYOffset;i!==c&&window.scrollTo(0,i),l&&l.isConnected&&(l.scrollIntoView({block:"nearest"}),l=null)})})}}:{}}function N5(){return{before({doc:e,d:s}){s.style(e.documentElement,"overflow","hidden")}}}function k5(e){let s={};for(let r of e)Object.assign(s,r(s));return s}let Qn=v5(()=>new Map,{PUSH(e,s){var r;let n=(r=this.get(e))!=null?r:{doc:e,count:0,d:tr(),meta:new Set};return n.count++,n.meta.add(s),this.set(e,n),this},POP(e,s){let r=this.get(e);return r&&(r.count--,r.meta.delete(s)),this},SCROLL_PREVENT({doc:e,d:s,meta:r}){let n={doc:e,d:s,meta:k5(r)},a=[w5(),j5(),N5()];a.forEach(({before:i})=>i==null?void 0:i(n)),a.forEach(({after:i})=>i==null?void 0:i(n))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});Qn.subscribe(()=>{let e=Qn.getSnapshot(),s=new Map;for(let[r]of e)s.set(r,r.documentElement.style.overflow);for(let r of e.values()){let n=s.get(r.doc)==="hidden",a=r.count!==0;(a&&!n||!a&&n)&&Qn.dispatch(r.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",r),r.count===0&&Qn.dispatch("TEARDOWN",r)}});function S5(e,s,r){let n=b5(Qn),a=e?n.get(e):void 0,i=a?a.count>0:!1;return Ut(()=>{if(!(!e||!s))return Qn.dispatch("PUSH",e,r),()=>Qn.dispatch("POP",e,r)},[s,e]),i}let Bd=new Map,Di=new Map;function Gx(e,s=!0){Ut(()=>{var r;if(!s)return;let n=typeof e=="function"?e():e.current;if(!n)return;function a(){var l;if(!n)return;let o=(l=Di.get(n))!=null?l:1;if(o===1?Di.delete(n):Di.set(n,o-1),o!==1)return;let c=Bd.get(n);c&&(c["aria-hidden"]===null?n.removeAttribute("aria-hidden"):n.setAttribute("aria-hidden",c["aria-hidden"]),n.inert=c.inert,Bd.delete(n))}let i=(r=Di.get(n))!=null?r:0;return Di.set(n,i+1),i!==0||(Bd.set(n,{"aria-hidden":n.getAttribute("aria-hidden"),inert:n.inert}),n.setAttribute("aria-hidden","true"),n.inert=!0),a},[e,s])}function C5({defaultContainers:e=[],portals:s,mainTreeNodeRef:r}={}){var n;let a=m.useRef((n=r==null?void 0:r.current)!=null?n:null),i=Ci(a),l=Be(()=>{var o,c,d;let h=[];for(let u of e)u!==null&&(u instanceof HTMLElement?h.push(u):"current"in u&&u.current instanceof HTMLElement&&h.push(u.current));if(s!=null&&s.current)for(let u of s.current)h.push(u);for(let u of(o=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?o:[])u!==document.body&&u!==document.head&&u instanceof HTMLElement&&u.id!=="headlessui-portal-root"&&(u.contains(a.current)||u.contains((d=(c=a.current)==null?void 0:c.getRootNode())==null?void 0:d.host)||h.some(p=>u.contains(p))||h.push(u));return h});return{resolveContainers:l,contains:Be(o=>l().some(c=>c.contains(o))),mainTreeNodeRef:a,MainTreeNode:m.useMemo(()=>function(){return r!=null?null:$e.createElement(fm,{features:Nc.Hidden,ref:a})},[a,r])}}let Oh=m.createContext(()=>{});Oh.displayName="StackContext";var vm=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(vm||{});function _5(){return m.useContext(Oh)}function E5({children:e,onUpdate:s,type:r,element:n,enabled:a}){let i=_5(),l=Be((...o)=>{s==null||s(...o),i(...o)});return Ut(()=>{let o=a===void 0||a===!0;return o&&l(0,r,n),()=>{o&&l(1,r,n)}},[l,r,n,a]),$e.createElement(Oh.Provider,{value:l},e)}let db=m.createContext(null);function ub(){let e=m.useContext(db);if(e===null){let s=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(s,ub),s}return e}function M5(){let[e,s]=m.useState([]);return[e.length>0?e.join(" "):void 0,m.useMemo(()=>function(r){let n=Be(i=>(s(l=>[...l,i]),()=>s(l=>{let o=l.slice(),c=o.indexOf(i);return c!==-1&&o.splice(c,1),o}))),a=m.useMemo(()=>({register:n,slot:r.slot,name:r.name,props:r.props}),[n,r.slot,r.name,r.props]);return $e.createElement(db.Provider,{value:a},r.children)},[s])]}let T5="p";function A5(e,s){let r=qr(),{id:n=`headlessui-description-${r}`,...a}=e,i=ub(),l=ms(s);Ut(()=>i.register(n),[n,i.register]);let o={ref:l,...i.props,id:n};return ss({ourProps:o,theirProps:a,slot:i.slot||{},defaultTag:T5,name:i.name||"Description"})}let P5=Qt(A5),R5=Object.assign(P5,{});var L5=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(L5||{}),$5=(e=>(e[e.SetTitleId=0]="SetTitleId",e))($5||{});let F5={0(e,s){return e.titleId===s.id?e:{...e,titleId:s.id}}},kc=m.createContext(null);kc.displayName="DialogContext";function Yl(e){let s=m.useContext(kc);if(s===null){let r=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Yl),r}return s}function I5(e,s,r=()=>[document.body]){S5(e,s,n=>{var a;return{containers:[...(a=n.containers)!=null?a:[],r]}})}function O5(e,s){return Dt(s.type,F5,e,s)}let D5="div",z5=mi.RenderStrategy|mi.Static;function U5(e,s){let r=qr(),{id:n=`headlessui-dialog-${r}`,open:a,onClose:i,initialFocus:l,role:o="dialog",__demoMode:c=!1,...d}=e,[h,u]=m.useState(0),p=m.useRef(!1);o=function(){return o==="dialog"||o==="alertdialog"?o:(p.current||(p.current=!0,console.warn(`Invalid role [${o}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let j=ed();a===void 0&&j!==null&&(a=(j&qt.Open)===qt.Open);let x=m.useRef(null),g=ms(x,s),y=Ci(x),b=e.hasOwnProperty("open")||j!==null,f=e.hasOwnProperty("onClose");if(!b&&!f)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!b)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!f)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof a!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${a}`);if(typeof i!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${i}`);let v=a?0:1,[w,N]=m.useReducer(O5,{titleId:null,descriptionId:null,panelRef:m.createRef()}),P=Be(()=>i(!1)),z=Be(W=>N({type:0,id:W})),E=Si()?c?!1:v===0:!1,X=h>1,T=m.useContext(kc)!==null,[F,Q]=n5(),Z={get current(){var W;return(W=w.panelRef.current)!=null?W:x.current}},{resolveContainers:xe,mainTreeNodeRef:ve,MainTreeNode:ke}=C5({portals:F,defaultContainers:[Z]}),q=X?"parent":"leaf",R=j!==null?(j&qt.Closing)===qt.Closing:!1,G=T||R?!1:E,K=m.useCallback(()=>{var W,J;return(J=Array.from((W=y==null?void 0:y.querySelectorAll("body > *"))!=null?W:[]).find(B=>B.id==="headlessui-portal-root"?!1:B.contains(ve.current)&&B instanceof HTMLElement))!=null?J:null},[ve]);Gx(K,G);let ee=X?!0:E,ae=m.useCallback(()=>{var W,J;return(J=Array.from((W=y==null?void 0:y.querySelectorAll("[data-headlessui-portal]"))!=null?W:[]).find(B=>B.contains(ve.current)&&B instanceof HTMLElement))!=null?J:null},[ve]);Gx(ae,ee),Xy(xe,W=>{W.preventDefault(),P()},!(!E||X));let fe=!(X||v!==0);rb(y==null?void 0:y.defaultView,"keydown",W=>{fe&&(W.defaultPrevented||W.key===Ft.Escape&&(W.preventDefault(),W.stopPropagation(),P()))}),I5(y,!(R||v!==0||T),xe),m.useEffect(()=>{if(v!==0||!x.current)return;let W=new ResizeObserver(J=>{for(let B of J){let me=B.target.getBoundingClientRect();me.x===0&&me.y===0&&me.width===0&&me.height===0&&P()}});return W.observe(x.current),()=>W.disconnect()},[v,x,P]);let[L,ye]=M5(),_e=m.useMemo(()=>[{dialogState:v,close:P,setTitleId:z},w],[v,w,P,z]),_=m.useMemo(()=>({open:v===0}),[v]),Y={ref:g,id:n,role:o,"aria-modal":v===0?!0:void 0,"aria-labelledby":w.titleId,"aria-describedby":L};return $e.createElement(E5,{type:"Dialog",enabled:v===0,element:x,onUpdate:Be((W,J)=>{J==="Dialog"&&Dt(W,{[vm.Add]:()=>u(B=>B+1),[vm.Remove]:()=>u(B=>B-1)})})},$e.createElement(pm,{force:!0},$e.createElement(bm,null,$e.createElement(kc.Provider,{value:_e},$e.createElement(bm.Group,{target:x},$e.createElement(pm,{force:!1},$e.createElement(ye,{slot:_,name:"Dialog.Description"},$e.createElement(Oi,{initialFocus:l,containers:xe,features:E?Dt(q,{parent:Oi.features.RestoreFocus,leaf:Oi.features.All&~Oi.features.FocusLock}):Oi.features.None},$e.createElement(Q,null,ss({ourProps:Y,theirProps:d,slot:_,defaultTag:D5,features:z5,visible:v===0,name:"Dialog"}))))))))),$e.createElement(ke,null))}let H5="div";function B5(e,s){let r=qr(),{id:n=`headlessui-dialog-overlay-${r}`,...a}=e,[{dialogState:i,close:l}]=Yl("Dialog.Overlay"),o=ms(s),c=Be(h=>{if(h.target===h.currentTarget){if(sb(h.currentTarget))return h.preventDefault();h.preventDefault(),h.stopPropagation(),l()}}),d=m.useMemo(()=>({open:i===0}),[i]);return ss({ourProps:{ref:o,id:n,"aria-hidden":!0,onClick:c},theirProps:a,slot:d,defaultTag:H5,name:"Dialog.Overlay"})}let q5="div";function W5(e,s){let r=qr(),{id:n=`headlessui-dialog-backdrop-${r}`,...a}=e,[{dialogState:i},l]=Yl("Dialog.Backdrop"),o=ms(s);m.useEffect(()=>{if(l.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[l.panelRef]);let c=m.useMemo(()=>({open:i===0}),[i]);return $e.createElement(pm,{force:!0},$e.createElement(bm,null,ss({ourProps:{ref:o,id:n,"aria-hidden":!0},theirProps:a,slot:c,defaultTag:q5,name:"Dialog.Backdrop"})))}let K5="div";function V5(e,s){let r=qr(),{id:n=`headlessui-dialog-panel-${r}`,...a}=e,[{dialogState:i},l]=Yl("Dialog.Panel"),o=ms(s,l.panelRef),c=m.useMemo(()=>({open:i===0}),[i]),d=Be(h=>{h.stopPropagation()});return ss({ourProps:{ref:o,id:n,onClick:d},theirProps:a,slot:c,defaultTag:K5,name:"Dialog.Panel"})}let Q5="h2";function G5(e,s){let r=qr(),{id:n=`headlessui-dialog-title-${r}`,...a}=e,[{dialogState:i,setTitleId:l}]=Yl("Dialog.Title"),o=ms(s);m.useEffect(()=>(l(n),()=>l(null)),[n,l]);let c=m.useMemo(()=>({open:i===0}),[i]);return ss({ourProps:{ref:o,id:n},theirProps:a,slot:c,defaultTag:Q5,name:"Dialog.Title"})}let Y5=Qt(U5),J5=Qt(W5),X5=Qt(V5),Z5=Qt(B5),e4=Qt(G5),Yx=Object.assign(Y5,{Backdrop:J5,Panel:X5,Overlay:Z5,Title:e4,Description:R5}),Jx=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Xx(e){var s,r;let n=(s=e.innerText)!=null?s:"",a=e.cloneNode(!0);if(!(a instanceof HTMLElement))return n;let i=!1;for(let o of a.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),i=!0;let l=i?(r=a.innerText)!=null?r:"":n;return Jx.test(l)&&(l=l.replace(Jx,"")),l}function t4(e){let s=e.getAttribute("aria-label");if(typeof s=="string")return s.trim();let r=e.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(a=>{let i=document.getElementById(a);if(i){let l=i.getAttribute("aria-label");return typeof l=="string"?l.trim():Xx(i).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return Xx(e).trim()}function s4(e){let s=m.useRef(""),r=m.useRef("");return Be(()=>{let n=e.current;if(!n)return"";let a=n.innerText;if(s.current===a)return r.current;let i=t4(n).trim().toLowerCase();return s.current=a,r.current=i,i})}var r4=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(r4||{}),n4=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(n4||{}),a4=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(a4||{});function qd(e,s=r=>r){let r=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=Gy(s(e.items.slice()),i=>i.dataRef.current.domRef.current),a=r?n.indexOf(r):null;return a===-1&&(a=null),{items:n,activeItemIndex:a}}let i4={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,s)=>{var r;let n=qd(e),a=Bk(s,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeItemIndex:a,activationTrigger:(r=s.trigger)!=null?r:1}},3:(e,s)=>{let r=e.searchQuery!==""?0:1,n=e.searchQuery+s.value.toLowerCase(),a=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(l=>{var o;return((o=l.dataRef.current.textValue)==null?void 0:o.startsWith(n))&&!l.dataRef.current.disabled}),i=a?e.items.indexOf(a):-1;return i===-1||i===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:i,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,s)=>{let r=qd(e,n=>[...n,{id:s.id,dataRef:s.dataRef}]);return{...e,...r}},6:(e,s)=>{let r=qd(e,n=>{let a=n.findIndex(i=>i.id===s.id);return a!==-1&&n.splice(a,1),n});return{...e,...r,activationTrigger:1}}},Dh=m.createContext(null);Dh.displayName="MenuContext";function td(e){let s=m.useContext(Dh);if(s===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,td),r}return s}function l4(e,s){return Dt(s.type,i4,e,s)}let o4=m.Fragment;function c4(e,s){let{__demoMode:r=!1,...n}=e,a=m.useReducer(l4,{__demoMode:r,menuState:r?0:1,buttonRef:m.createRef(),itemsRef:m.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:i,itemsRef:l,buttonRef:o},c]=a,d=ms(s);Xy([o,l],(j,x)=>{var g;c({type:1}),$h(x,Lh.Loose)||(j.preventDefault(),(g=o.current)==null||g.focus())},i===0);let h=Be(()=>{c({type:1})}),u=m.useMemo(()=>({open:i===0,close:h}),[i,h]),p={ref:d};return $e.createElement(Dh.Provider,{value:a},$e.createElement(tb,{value:Dt(i,{0:qt.Open,1:qt.Closed})},ss({ourProps:p,theirProps:n,slot:u,defaultTag:o4,name:"Menu"})))}let d4="button";function u4(e,s){var r;let n=qr(),{id:a=`headlessui-menu-button-${n}`,...i}=e,[l,o]=td("Menu.Button"),c=ms(l.buttonRef,s),d=Ql(),h=Be(g=>{switch(g.key){case Ft.Space:case Ft.Enter:case Ft.ArrowDown:g.preventDefault(),g.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Ys.First}));break;case Ft.ArrowUp:g.preventDefault(),g.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Ys.Last}));break}}),u=Be(g=>{switch(g.key){case Ft.Space:g.preventDefault();break}}),p=Be(g=>{if(sb(g.currentTarget))return g.preventDefault();e.disabled||(l.menuState===0?(o({type:1}),d.nextFrame(()=>{var y;return(y=l.buttonRef.current)==null?void 0:y.focus({preventScroll:!0})})):(g.preventDefault(),o({type:0})))}),j=m.useMemo(()=>({open:l.menuState===0}),[l]),x={ref:c,id:a,type:Rk(e,l.buttonRef),"aria-haspopup":"menu","aria-controls":(r=l.itemsRef.current)==null?void 0:r.id,"aria-expanded":l.menuState===0,onKeyDown:h,onKeyUp:u,onClick:p};return ss({ourProps:x,theirProps:i,slot:j,defaultTag:d4,name:"Menu.Button"})}let m4="div",h4=mi.RenderStrategy|mi.Static;function x4(e,s){var r,n;let a=qr(),{id:i=`headlessui-menu-items-${a}`,...l}=e,[o,c]=td("Menu.Items"),d=ms(o.itemsRef,s),h=Ci(o.itemsRef),u=Ql(),p=ed(),j=p!==null?(p&qt.Open)===qt.Open:o.menuState===0;m.useEffect(()=>{let f=o.itemsRef.current;f&&o.menuState===0&&f!==(h==null?void 0:h.activeElement)&&f.focus({preventScroll:!0})},[o.menuState,o.itemsRef,h]),Fk({container:o.itemsRef.current,enabled:o.menuState===0,accept(f){return f.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:f.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(f){f.setAttribute("role","none")}});let x=Be(f=>{var v,w;switch(u.dispose(),f.key){case Ft.Space:if(o.searchQuery!=="")return f.preventDefault(),f.stopPropagation(),c({type:3,value:f.key});case Ft.Enter:if(f.preventDefault(),f.stopPropagation(),c({type:1}),o.activeItemIndex!==null){let{dataRef:N}=o.items[o.activeItemIndex];(w=(v=N.current)==null?void 0:v.domRef.current)==null||w.click()}Qy(o.buttonRef.current);break;case Ft.ArrowDown:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:Ys.Next});case Ft.ArrowUp:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:Ys.Previous});case Ft.Home:case Ft.PageUp:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:Ys.First});case Ft.End:case Ft.PageDown:return f.preventDefault(),f.stopPropagation(),c({type:2,focus:Ys.Last});case Ft.Escape:f.preventDefault(),f.stopPropagation(),c({type:1}),tr().nextFrame(()=>{var N;return(N=o.buttonRef.current)==null?void 0:N.focus({preventScroll:!0})});break;case Ft.Tab:f.preventDefault(),f.stopPropagation(),c({type:1}),tr().nextFrame(()=>{Tk(o.buttonRef.current,f.shiftKey?Tr.Previous:Tr.Next)});break;default:f.key.length===1&&(c({type:3,value:f.key}),u.setTimeout(()=>c({type:4}),350));break}}),g=Be(f=>{switch(f.key){case Ft.Space:f.preventDefault();break}}),y=m.useMemo(()=>({open:o.menuState===0}),[o]),b={"aria-activedescendant":o.activeItemIndex===null||(r=o.items[o.activeItemIndex])==null?void 0:r.id,"aria-labelledby":(n=o.buttonRef.current)==null?void 0:n.id,id:i,onKeyDown:x,onKeyUp:g,role:"menu",tabIndex:0,ref:d};return ss({ourProps:b,theirProps:l,slot:y,defaultTag:m4,features:h4,visible:j,name:"Menu.Items"})}let g4=m.Fragment;function f4(e,s){let r=qr(),{id:n=`headlessui-menu-item-${r}`,disabled:a=!1,...i}=e,[l,o]=td("Menu.Item"),c=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===n:!1,d=m.useRef(null),h=ms(s,d);Ut(()=>{if(l.__demoMode||l.menuState!==0||!c||l.activationTrigger===0)return;let N=tr();return N.requestAnimationFrame(()=>{var P,z;(z=(P=d.current)==null?void 0:P.scrollIntoView)==null||z.call(P,{block:"nearest"})}),N.dispose},[l.__demoMode,d,c,l.menuState,l.activationTrigger,l.activeItemIndex]);let u=s4(d),p=m.useRef({disabled:a,domRef:d,get textValue(){return u()}});Ut(()=>{p.current.disabled=a},[p,a]),Ut(()=>(o({type:5,id:n,dataRef:p}),()=>o({type:6,id:n})),[p,n]);let j=Be(()=>{o({type:1})}),x=Be(N=>{if(a)return N.preventDefault();o({type:1}),Qy(l.buttonRef.current)}),g=Be(()=>{if(a)return o({type:2,focus:Ys.Nothing});o({type:2,focus:Ys.Specific,id:n})}),y=$k(),b=Be(N=>y.update(N)),f=Be(N=>{y.wasMoved(N)&&(a||c||o({type:2,focus:Ys.Specific,id:n,trigger:0}))}),v=Be(N=>{y.wasMoved(N)&&(a||c&&o({type:2,focus:Ys.Nothing}))}),w=m.useMemo(()=>({active:c,disabled:a,close:j}),[c,a,j]);return ss({ourProps:{id:n,ref:h,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,disabled:void 0,onClick:x,onFocus:g,onPointerEnter:b,onMouseEnter:b,onPointerMove:f,onMouseMove:f,onPointerLeave:v,onMouseLeave:v},theirProps:i,slot:w,defaultTag:g4,name:"Menu.Item"})}let p4=Qt(c4),y4=Qt(u4),b4=Qt(x4),v4=Qt(f4),zi=Object.assign(p4,{Button:y4,Items:b4,Item:v4});function j4(e=0){let[s,r]=m.useState(e),n=Gl(),a=m.useCallback(c=>{n.current&&r(d=>d|c)},[s,n]),i=m.useCallback(c=>!!(s&c),[s]),l=m.useCallback(c=>{n.current&&r(d=>d&~c)},[r,n]),o=m.useCallback(c=>{n.current&&r(d=>d^c)},[r]);return{flags:s,addFlag:a,hasFlag:i,removeFlag:l,toggleFlag:o}}function w4(e){let s={called:!1};return(...r)=>{if(!s.called)return s.called=!0,e(...r)}}function Wd(e,...s){e&&s.length>0&&e.classList.add(...s)}function Kd(e,...s){e&&s.length>0&&e.classList.remove(...s)}function N4(e,s){let r=tr();if(!e)return r.dispose;let{transitionDuration:n,transitionDelay:a}=getComputedStyle(e),[i,l]=[n,a].map(c=>{let[d=0]=c.split(",").filter(Boolean).map(h=>h.includes("ms")?parseFloat(h):parseFloat(h)*1e3).sort((h,u)=>u-h);return d}),o=i+l;if(o!==0){r.group(d=>{d.setTimeout(()=>{s(),d.dispose()},o),d.addEventListener(e,"transitionrun",h=>{h.target===h.currentTarget&&d.dispose()})});let c=r.addEventListener(e,"transitionend",d=>{d.target===d.currentTarget&&(s(),c())})}else s();return r.add(()=>s()),r.dispose}function k4(e,s,r,n){let a=r?"enter":"leave",i=tr(),l=n!==void 0?w4(n):()=>{};a==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let o=Dt(a,{enter:()=>s.enter,leave:()=>s.leave}),c=Dt(a,{enter:()=>s.enterTo,leave:()=>s.leaveTo}),d=Dt(a,{enter:()=>s.enterFrom,leave:()=>s.leaveFrom});return Kd(e,...s.base,...s.enter,...s.enterTo,...s.enterFrom,...s.leave,...s.leaveFrom,...s.leaveTo,...s.entered),Wd(e,...s.base,...o,...d),i.nextFrame(()=>{Kd(e,...s.base,...o,...d),Wd(e,...s.base,...o,...c),N4(e,()=>(Kd(e,...s.base,...o),Wd(e,...s.base,...s.entered),l()))}),i.dispose}function S4({immediate:e,container:s,direction:r,classes:n,onStart:a,onStop:i}){let l=Gl(),o=Ql(),c=Fr(r);Ut(()=>{e&&(c.current="enter")},[e]),Ut(()=>{let d=tr();o.add(d.dispose);let h=s.current;if(h&&c.current!=="idle"&&l.current)return d.dispose(),a.current(c.current),d.add(k4(h,n.current,c.current==="enter",()=>{d.dispose(),i.current(c.current)})),d.dispose},[r])}function Vr(e=""){return e.split(/\s+/).filter(s=>s.length>1)}let sd=m.createContext(null);sd.displayName="TransitionContext";var C4=(e=>(e.Visible="visible",e.Hidden="hidden",e))(C4||{});function _4(){let e=m.useContext(sd);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function E4(){let e=m.useContext(rd);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let rd=m.createContext(null);rd.displayName="NestingContext";function nd(e){return"children"in e?nd(e.children):e.current.filter(({el:s})=>s.current!==null).filter(({state:s})=>s==="visible").length>0}function mb(e,s){let r=Fr(e),n=m.useRef([]),a=Gl(),i=Ql(),l=Be((j,x=fn.Hidden)=>{let g=n.current.findIndex(({el:y})=>y===j);g!==-1&&(Dt(x,{[fn.Unmount](){n.current.splice(g,1)},[fn.Hidden](){n.current[g].state="hidden"}}),i.microTask(()=>{var y;!nd(n)&&a.current&&((y=r.current)==null||y.call(r))}))}),o=Be(j=>{let x=n.current.find(({el:g})=>g===j);return x?x.state!=="visible"&&(x.state="visible"):n.current.push({el:j,state:"visible"}),()=>l(j,fn.Unmount)}),c=m.useRef([]),d=m.useRef(Promise.resolve()),h=m.useRef({enter:[],leave:[],idle:[]}),u=Be((j,x,g)=>{c.current.splice(0),s&&(s.chains.current[x]=s.chains.current[x].filter(([y])=>y!==j)),s==null||s.chains.current[x].push([j,new Promise(y=>{c.current.push(y)})]),s==null||s.chains.current[x].push([j,new Promise(y=>{Promise.all(h.current[x].map(([b,f])=>f)).then(()=>y())})]),x==="enter"?d.current=d.current.then(()=>s==null?void 0:s.wait.current).then(()=>g(x)):g(x)}),p=Be((j,x,g)=>{Promise.all(h.current[x].splice(0).map(([y,b])=>b)).then(()=>{var y;(y=c.current.shift())==null||y()}).then(()=>g(x))});return m.useMemo(()=>({children:n,register:o,unregister:l,onStart:u,onStop:p,wait:d,chains:h}),[o,l,n,u,p,h,d])}function M4(){}let T4=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Zx(e){var s;let r={};for(let n of T4)r[n]=(s=e[n])!=null?s:M4;return r}function A4(e){let s=m.useRef(Zx(e));return m.useEffect(()=>{s.current=Zx(e)},[e]),s}let P4="div",hb=mi.RenderStrategy;function R4(e,s){var r,n;let{beforeEnter:a,afterEnter:i,beforeLeave:l,afterLeave:o,enter:c,enterFrom:d,enterTo:h,entered:u,leave:p,leaveFrom:j,leaveTo:x,...g}=e,y=m.useRef(null),b=ms(y,s),f=(r=g.unmount)==null||r?fn.Unmount:fn.Hidden,{show:v,appear:w,initial:N}=_4(),[P,z]=m.useState(v?"visible":"hidden"),E=E4(),{register:X,unregister:T}=E;m.useEffect(()=>X(y),[X,y]),m.useEffect(()=>{if(f===fn.Hidden&&y.current){if(v&&P!=="visible"){z("visible");return}return Dt(P,{hidden:()=>T(y),visible:()=>X(y)})}},[P,y,X,T,v,f]);let F=Fr({base:Vr(g.className),enter:Vr(c),enterFrom:Vr(d),enterTo:Vr(h),entered:Vr(u),leave:Vr(p),leaveFrom:Vr(j),leaveTo:Vr(x)}),Q=A4({beforeEnter:a,afterEnter:i,beforeLeave:l,afterLeave:o}),Z=Si();m.useEffect(()=>{if(Z&&P==="visible"&&y.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[y,P,Z]);let xe=N&&!w,ve=w&&v&&N,ke=!Z||xe?"idle":v?"enter":"leave",q=j4(0),R=Be(fe=>Dt(fe,{enter:()=>{q.addFlag(qt.Opening),Q.current.beforeEnter()},leave:()=>{q.addFlag(qt.Closing),Q.current.beforeLeave()},idle:()=>{}})),G=Be(fe=>Dt(fe,{enter:()=>{q.removeFlag(qt.Opening),Q.current.afterEnter()},leave:()=>{q.removeFlag(qt.Closing),Q.current.afterLeave()},idle:()=>{}})),K=mb(()=>{z("hidden"),T(y)},E),ee=m.useRef(!1);S4({immediate:ve,container:y,classes:F,direction:ke,onStart:Fr(fe=>{ee.current=!0,K.onStart(y,fe,R)}),onStop:Fr(fe=>{ee.current=!1,K.onStop(y,fe,G),fe==="leave"&&!nd(K)&&(z("hidden"),T(y))})});let ae=g,ne={ref:b};return ve?ae={...ae,className:wc(g.className,...F.current.enter,...F.current.enterFrom)}:ee.current&&(ae.className=wc(g.className,(n=y.current)==null?void 0:n.className),ae.className===""&&delete ae.className),$e.createElement(rd.Provider,{value:K},$e.createElement(tb,{value:Dt(P,{visible:qt.Open,hidden:qt.Closed})|q.flags},ss({ourProps:ne,theirProps:ae,defaultTag:P4,features:hb,visible:P==="visible",name:"Transition.Child"})))}function L4(e,s){let{show:r,appear:n=!1,unmount:a=!0,...i}=e,l=m.useRef(null),o=ms(l,s);Si();let c=ed();if(r===void 0&&c!==null&&(r=(c&qt.Open)===qt.Open),![!0,!1].includes(r))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,h]=m.useState(r?"visible":"hidden"),u=mb(()=>{h("hidden")}),[p,j]=m.useState(!0),x=m.useRef([r]);Ut(()=>{p!==!1&&x.current[x.current.length-1]!==r&&(x.current.push(r),j(!1))},[x,r]);let g=m.useMemo(()=>({show:r,appear:n,initial:p}),[r,n,p]);m.useEffect(()=>{if(r)h("visible");else if(!nd(u))h("hidden");else{let v=l.current;if(!v)return;let w=v.getBoundingClientRect();w.x===0&&w.y===0&&w.width===0&&w.height===0&&h("hidden")}},[r,u]);let y={unmount:a},b=Be(()=>{var v;p&&j(!1),(v=e.beforeEnter)==null||v.call(e)}),f=Be(()=>{var v;p&&j(!1),(v=e.beforeLeave)==null||v.call(e)});return $e.createElement(rd.Provider,{value:u},$e.createElement(sd.Provider,{value:g},ss({ourProps:{...y,as:m.Fragment,children:$e.createElement(xb,{ref:o,...y,...i,beforeEnter:b,beforeLeave:f})},theirProps:{},defaultTag:m.Fragment,features:hb,visible:d==="visible",name:"Transition"})))}function $4(e,s){let r=m.useContext(sd)!==null,n=ed()!==null;return $e.createElement($e.Fragment,null,!r&&n?$e.createElement(jm,{ref:s,...e}):$e.createElement(xb,{ref:s,...e}))}let jm=Qt(L4),xb=Qt(R4),F4=Qt($4),Ji=Object.assign(jm,{Child:F4,Root:jm});/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),O4=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,r,n)=>n?n.toUpperCase():r.toLowerCase()),eg=e=>{const s=O4(e);return s.charAt(0).toUpperCase()+s.slice(1)},gb=(...e)=>e.filter((s,r,n)=>!!s&&s.trim()!==""&&n.indexOf(s)===r).join(" ").trim(),D4=e=>{for(const s in e)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var z4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=m.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...o},c)=>m.createElement("svg",{ref:c,...z4,width:s,height:s,stroke:e,strokeWidth:n?Number(r)*24/Number(s):r,className:gb("lucide",a),...!i&&!D4(o)&&{"aria-hidden":"true"},...o},[...l.map(([d,h])=>m.createElement(d,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=(e,s)=>{const r=m.forwardRef(({className:n,...a},i)=>m.createElement(U4,{ref:i,iconNode:s,className:gb(`lucide-${I4(eg(e))}`,`lucide-${e}`,n),...a}));return r.displayName=eg(e),r};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H4=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],B4=oe("activity",H4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],fb=oe("archive",q4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],K4=oe("arrow-down",W4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Q4=oe("arrow-left",V4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]],Ui=oe("at-sign",G4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],J4=oe("book-open",Y4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X4=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Z4=oe("bot",X4);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],pb=oe("building-2",e3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],s3=oe("building",t3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],yb=oe("calendar",r3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],a3=oe("camera",n3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wm=oe("check",i3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ws=oe("chevron-down",l3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Jl=oe("chevron-right",o3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],hi=oe("chevron-left",c3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],dr=oe("chevron-up",d3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Xl=oe("circle-alert",u3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],lt=oe("circle-check-big",m3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],yr=oe("circle-x",h3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],gr=oe("clipboard",x3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ga=oe("clock",g3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],p3=oe("cloud",f3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],bb=oe("code",y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],vb=oe("copy",b3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],j3=oe("dollar-sign",v3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Sc=oe("download",w3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],cl=oe("external-link",N3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],zh=oe("facebook",k3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],C3=oe("eye",S3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tg=oe("file-text",_3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],Wo=oe("file",E3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],jb=oe("funnel",M3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],sg=oe("git-merge",T3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Uh=oe("globe",A3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ot=oe("hash",P3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Cc=oe("image",R3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],wb=oe("inbox",L3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Nm=oe("info",$3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],Hh=oe("instagram",F3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],O3=oe("languages",I3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Nb=oe("loader-circle",D3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],sr=oe("mail",z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],H3=oe("message-circle",U3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Hr=oe("message-square",B3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],kb=oe("package",q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],St=oe("paperclip",W3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Bh=oe("pen",K3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Sb=oe("pencil",V3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ya=oe("phone",Q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ad=oe("plus",G3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Xi=oe("refresh-cw",Y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Cb=oe("rotate-ccw",J3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Z3=oe("ruler",X3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Zl=oe("save",eS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],xi=oe("search",tS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],id=oe("send",sS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gi=oe("settings",rS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],aS=oe("shield",nS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],dl=oe("shopping-bag",iS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],oS=oe("smile",lS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Zs=oe("sparkles",cS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],uS=oe("star",dS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],_c=oe("sticky-note",mS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],_b=oe("store",hS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],rg=oe("tag",xS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],fS=oe("ticket",gS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],fi=oe("trash-2",pS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],bS=oe("trending-up",yS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],jS=oe("triangle-alert",vS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Eb=oe("upload",wS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Pl=oe("user-plus",NS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],pn=oe("user",kS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],_i=oe("users",SS);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],_t=oe("x",CS);function _S({ticketCounts:e={all:0,myTickets:0,pending:0,unassigned:0,snoozed:0,resolved:0,escalated:0,escalatedToMe:0,vip:0,allAssigned:0,staffCounts:{}},isCollapsed:s,onToggle:r}){var _e;const{data:n}=ue({queryKey:["staff-list-sidebar"],queryFn:async()=>(await D.get("/api/staff")).data,staleTime:6e4}),a=(n==null?void 0:n.staff)||[],i=$n(),l=vr(),[o,c]=m.useState(!1),[d,h]=m.useState(!1),[u,p]=m.useState(!1),[j,x]=m.useState(!1),[g,y]=m.useState(!1),[b,f]=m.useState(!1),[v,w]=m.useState(!1),[N,P]=m.useState(!1),[z,E]=m.useState(!1),[X,T]=m.useState(!1),[F,Q]=m.useState(!1),[Z,xe]=m.useState(!1),[ve,ke]=m.useState(!1),q=_=>i.pathname===_,R=({title:_,icon:Y,isExpanded:W,onToggle:J,children:B,hasSubmenu:me=!0})=>t.jsxs("div",{className:"mb-2",children:[t.jsxs("button",{onClick:J,className:"w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg hover:bg-gray-50 transition-colors",children:[t.jsxs("span",{className:"flex items-center text-gray-700 font-medium",children:[Y,t.jsx("span",{className:Y?"ml-2":"",children:_})]}),me&&(W?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"}))]}),W&&B&&t.jsx("div",{className:"ml-6 mt-1 space-y-1",children:B})]}),G=({to:_,children:Y,count:W})=>{const J=()=>{const[B,me]=_.split("?"),Ie=i.pathname,pe=i.search;return me?Ie===B&&pe.includes(me):Ie===B&&!pe};return t.jsxs(Je,{to:_,preventScrollReset:!0,className:`flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${J()?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[t.jsx("span",{children:Y}),W!==void 0&&t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-200 text-gray-700",children:W})]})},K=({to:_,children:Y})=>t.jsx(Je,{to:_,preventScrollReset:!0,className:`block px-3 py-1.5 text-sm rounded-lg transition-colors ${q(_)?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-500 hover:bg-gray-50 hover:text-gray-700"}`,children:Y}),ee=()=>t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),ae=()=>t.jsxs("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),ne=()=>t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),fe=()=>t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Le=()=>t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),L=()=>t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),ye=()=>t.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});return t.jsxs("div",{className:`bg-white border-r border-gray-200 h-screen flex flex-col transition-all duration-300 ${s?"w-16":"w-64"}`,children:[t.jsx("div",{className:"flex-shrink-0 h-14 flex items-center px-4 border-b border-gray-200",children:t.jsx("button",{onClick:r,className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:s?"Expand Navigation":"Collapse Navigation",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),s?t.jsxs("div",{className:"flex flex-col items-center py-4 space-y-3",children:[t.jsx("button",{onClick:()=>{r(),l("/tickets"),c(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname==="/tickets"||i.pathname.startsWith("/tickets/")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Tickets",children:t.jsx(ee,{})}),t.jsx("button",{onClick:()=>{r(),l("/chat")},className:`p-2 rounded-lg transition-colors ${i.pathname==="/chat"?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"AI Chat",children:t.jsx(ae,{})}),t.jsx("button",{onClick:()=>{r(),l("/group-chat"),x(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/group-chat")||i.pathname==="/notifications"||i.pathname==="/mentions"?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Group Chat",children:t.jsx(ne,{})}),t.jsx("button",{onClick:()=>{r(),l("/task-manager"),y(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/task-manager")||i.pathname==="/task-digest"?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Task Manager",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),t.jsx("button",{onClick:()=>{r(),l("/staff"),p(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/staff")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Staff",children:t.jsx(fe,{})}),t.jsx("button",{onClick:()=>{r(),l("/customers"),h(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/customers")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Customers",children:t.jsx(Le,{})}),t.jsx("button",{onClick:()=>{r(),l("/analytics/ai-agent")},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/analytics")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Analytics",children:t.jsx(L,{})}),t.jsx("button",{onClick:()=>{r(),l("/settings"),f(!0)},className:`p-2 rounded-lg transition-colors ${i.pathname.startsWith("/settings")||i.pathname.startsWith("/ai-agent")?"bg-indigo-50 text-indigo-600":"text-gray-600 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Settings",children:t.jsx(ye,{})})]}):t.jsxs("div",{className:"overflow-y-auto flex-1 p-3",children:[t.jsxs(R,{title:"Tickets",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),isExpanded:o,onToggle:()=>c(!o),children:[t.jsx(G,{to:"/tickets",count:e.all,children:"All Tickets"}),t.jsx(G,{to:"/tickets?filter=my",count:e.myTickets,children:"My Tickets"}),t.jsx(G,{to:"/tickets?status=open",count:e.pending,children:"Open (in-progress)"}),t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>w(!v),className:"w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg hover:bg-gray-50 transition-colors",children:[t.jsx("span",{className:"text-gray-600",children:"Assigned"}),v?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),v&&t.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[t.jsx(G,{to:"/tickets?filter=all-assigned",count:e.allAssigned,children:"All"}),a.filter(_=>_.id!=="ai-agent-001").map(_=>{var Y;return t.jsx(G,{to:`/tickets?assigned=${_.id}`,count:((Y=e.staffCounts)==null?void 0:Y[_.id])||0,children:_.first_name},_.id)}),t.jsx(G,{to:"/tickets?assigned=ai-agent-001",count:((_e=e.staffCounts)==null?void 0:_e["ai-agent-001"])||0,children:"McCarthy AI"})]})]}),t.jsx(G,{to:"/tickets?filter=unassigned",count:e.unassigned,children:"Unassigned"}),t.jsx(G,{to:"/tickets?status=snoozed",count:e.snoozed,children:"Snoozed"}),t.jsx(G,{to:"/tickets?filter=vip",count:e.vip,children:"VIP"}),t.jsx(G,{to:"/tickets?status=resolved",count:e.resolved,children:"Resolved"})]}),t.jsxs(Je,{to:"/chat",className:`flex items-center px-3 py-2 mb-2 text-sm rounded-lg transition-colors ${q("/chat")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[t.jsxs("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),"AI Chat"]}),t.jsxs(R,{title:"Group Chat",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})}),isExpanded:j,onToggle:()=>x(!j),children:[t.jsx(K,{to:"/group-chat",children:"All Chats"}),t.jsx(K,{to:"/mentions",children:"@Mentions"}),t.jsx(K,{to:"/memo",children:"@Memos"}),t.jsx(K,{to:"/tags",children:"Tags"})]}),t.jsxs(R,{title:"Task Manager",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),isExpanded:g,onToggle:()=>y(!g),children:[t.jsx(K,{to:"/task-manager",children:"Dashboard"}),t.jsx(K,{to:"/task-digest",children:"Daily Digest"})]}),t.jsx(R,{title:"Staff",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),isExpanded:u,onToggle:()=>p(!u),children:t.jsx(K,{to:"/staff",children:"List"})}),t.jsxs(R,{title:"Customers",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),isExpanded:d,onToggle:()=>h(!d),children:[t.jsx(K,{to:"/customers",children:"All Customers"}),t.jsx(K,{to:"/customers/vip",children:"VIP Customers"})]}),t.jsxs(Je,{to:"/analytics/ai-agent",className:`flex items-center px-3 py-2 mb-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/analytics")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics"]}),t.jsxs(R,{title:"Settings",icon:t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),isExpanded:b,onToggle:()=>f(!b),children:[t.jsx(K,{to:"/settings/dartmouth-os",children:"Dartmouth OS"}),t.jsxs("div",{className:"mb-1",children:[t.jsxs("button",{onClick:()=>xe(!Z),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/business")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[t.jsx("span",{children:"Business"}),Z?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),Z&&t.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[t.jsx(K,{to:"/settings/business-hours",children:"Operational Hours"}),t.jsx(K,{to:"/settings/auto-assignment",children:"Auto-Assignment"})]})]}),t.jsxs("div",{className:"mb-1",children:[t.jsxs("button",{onClick:()=>ke(!ve),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/ai-agent")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[t.jsx("span",{children:"AI Agent"}),ve?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),ve&&t.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[t.jsx(K,{to:"/ai-agent/widget",children:"Widget & Embed"}),t.jsx(K,{to:"/ai-agent/knowledge",children:"RAG Knowledge"}),t.jsx(K,{to:"/ai-agent/system-message",children:"System Message"}),t.jsx(K,{to:"/ai-agent/regional-overrides",children:"Regional Overrides"})]})]}),t.jsx(K,{to:"/settings/group-chat",children:"Group Chat"}),t.jsx(K,{to:"/settings/task-manager",children:"Task Manager"}),t.jsxs("div",{className:"mb-1",children:[t.jsxs("button",{onClick:()=>P(!N),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/integrations")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[t.jsx("span",{children:"Integrations"}),N?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),N&&t.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[t.jsx(K,{to:"/settings/integrations/perp",children:"Print ERP"}),t.jsx(K,{to:"/settings/integrations/shopify",children:"Shopify"})]})]}),t.jsxs("div",{className:"mb-1",children:[t.jsxs("button",{onClick:()=>E(!z),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/meta")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[t.jsx("span",{children:"Meta"}),z?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),z&&t.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[t.jsx(K,{to:"/settings/meta/facebook",children:"Facebook"}),t.jsx(K,{to:"/settings/meta/instagram",children:"Instagram"}),t.jsx(K,{to:"/settings/meta/messenger",children:"Messenger"}),t.jsx(K,{to:"/settings/meta/whatsapp",children:"WhatsApp"})]})]}),t.jsxs("div",{className:"mb-1",children:[t.jsxs("button",{onClick:()=>T(!X),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/general")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[t.jsx("span",{children:"General"}),X?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),X&&t.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[t.jsx(K,{to:"/settings/general/auth",children:"Auth & Security"}),t.jsx(K,{to:"/settings/email",children:"Email"}),t.jsx(K,{to:"/settings/general/templates",children:"Templates"}),t.jsx(K,{to:"/settings/tags",children:"Tags"})]})]}),t.jsxs("div",{className:"mb-1",children:[t.jsxs("button",{onClick:()=>Q(!F),className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${i.pathname.startsWith("/settings/billing")?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-600 hover:bg-gray-50"}`,children:[t.jsx("span",{children:"Billing"}),F?t.jsx(dr,{className:"w-4 h-4 text-gray-400"}):t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),F&&t.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[t.jsx(K,{to:"/settings/billing/subscription",children:"Subscription"}),t.jsx(K,{to:"/settings/billing/transactions",children:"Transactions"})]})]})]})]})]})}function ES({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const ng=m.forwardRef(ES);function MS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const TS=m.forwardRef(MS);function AS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const PS=m.forwardRef(AS);function RS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const LS=m.forwardRef(RS);function $S({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const FS=m.forwardRef($S);function IS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const OS=m.forwardRef(IS);function DS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Ec=m.forwardRef(DS);function zS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const km=m.forwardRef(zS);function US({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Sm=m.forwardRef(US);function HS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Ko=m.forwardRef(HS);function BS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const Mb=m.forwardRef(BS);function qS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const WS=m.forwardRef(qS);function KS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const VS=m.forwardRef(KS);function QS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"}))}const GS=m.forwardRef(QS);function YS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const JS=m.forwardRef(YS);function XS({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const ZS=m.forwardRef(XS);function e6({title:e,titleId:s,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},r),e?m.createElement("title",{id:s},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const t6=m.forwardRef(e6),Vd={online:{color:"bg-green-500",ringColor:"ring-green-400",label:"Online"},away:{color:"bg-yellow-500",ringColor:"ring-yellow-400",label:"Away"},offline:{color:"bg-gray-400",ringColor:"ring-gray-400",label:"Offline"}};function s6(){var d,h,u,p,j,x;const e=vr(),{user:s,logout:r}=ts(),n=ct(),{data:a}=ue({queryKey:["currentStaff"],queryFn:()=>rt.me().then(g=>g.data.staff),enabled:!!s,refetchInterval:3e4}),i=Ne({mutationFn:g=>rt.updateAvailability((s==null?void 0:s.id)||"",g),onSuccess:()=>{n.invalidateQueries({queryKey:["currentStaff"]})}}),l=(a==null?void 0:a.availability_status)||"offline",o=Vd[l],c=()=>{r(),e("/login")};return t.jsxs(zi,{as:"div",className:"relative",children:[t.jsxs(zi.Button,{className:"flex items-center gap-2 rounded-lg p-1.5 hover:bg-gray-100 transition-colors",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${o.color}`}),l==="online"&&t.jsx("div",{className:`absolute inset-0 w-2.5 h-2.5 rounded-full ${o.color} animate-ping opacity-50`})]}),t.jsx("div",{className:"relative",children:a!=null&&a.avatar_url?t.jsx("img",{src:rt.getAvatarUrl(a.avatar_url)||"",alt:`${a.first_name} ${a.last_name}`,className:"w-8 h-8 rounded-full object-cover"}):t.jsxs("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-sm font-semibold",children:[((d=a==null?void 0:a.first_name)==null?void 0:d[0])||((h=s==null?void 0:s.firstName)==null?void 0:h[0])||"U",((u=a==null?void 0:a.last_name)==null?void 0:u[0])||((p=s==null?void 0:s.lastName)==null?void 0:p[0])||""]})})]}),t.jsx(Ji,{as:m.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:t.jsxs(zi.Items,{className:"absolute right-0 mt-2 w-64 origin-top-right rounded-xl bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:t.jsxs("div",{className:"flex items-center gap-3",children:[a!=null&&a.avatar_url?t.jsx("img",{src:rt.getAvatarUrl(a.avatar_url)||"",alt:`${a.first_name} ${a.last_name}`,className:"w-10 h-10 rounded-full object-cover"}):t.jsxs("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:[(j=a==null?void 0:a.first_name)==null?void 0:j[0],(x=a==null?void 0:a.last_name)==null?void 0:x[0]]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:a==null?void 0:a.email})]})]})}),t.jsxs("div",{className:"px-2 py-2 border-b border-gray-100",children:[t.jsx("p",{className:"px-2 py-1 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),Object.keys(Vd).map(g=>{const y=Vd[g],b=g===l;return t.jsxs("button",{onClick:()=>i.mutate(g),disabled:i.isPending,className:`w-full flex items-center gap-3 px-2 py-2 rounded-lg text-left transition-colors ${b?"bg-indigo-50 text-indigo-700":"hover:bg-gray-50 text-gray-700"}`,children:[t.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${y.color}`}),t.jsx("span",{className:"text-sm font-medium flex-1",children:y.label}),b&&t.jsx(Ec,{className:"w-4 h-4 text-indigo-600"})]},g)})]}),t.jsx("div",{className:"px-2 py-2",children:t.jsx(zi.Item,{children:({active:g})=>t.jsxs("button",{onClick:()=>e("/account"),className:`${g?"bg-gray-50":""} flex items-center gap-3 w-full px-2 py-2 text-sm text-gray-700 rounded-lg`,children:[t.jsx(ZS,{className:"w-5 h-5 text-gray-400"}),"My Account"]})})}),t.jsx("div",{className:"px-2 py-2 border-t border-gray-100",children:t.jsx(zi.Item,{children:({active:g})=>t.jsxs("button",{onClick:c,className:`${g?"bg-red-50":""} flex items-center gap-3 w-full px-2 py-2 text-sm text-red-600 rounded-lg`,children:[t.jsx(TS,{className:"w-5 h-5"}),"Sign Out"]})})})]})})]})}const r6=[{name:"Tickets",href:"/tickets",icon:GS},{name:"Mentions",href:"/mentions",icon:LS},{name:"Task Digest",href:"/task-digest",icon:km},{name:"Settings",href:"/settings",icon:Ko}];function n6(){const[e,s]=m.useState(!1),[r,n]=m.useState(!0),a=$n(),{user:i}=ts(),{data:l}=ue({queryKey:["tickets-all"],queryFn:async()=>(await Oe.list({limit:1e3})).data.tickets,refetchInterval:3e4}),o=l||[];console.log("DashboardLayout - All tickets:",o.map(d=>({id:d.ticket_number,assigned:d.assigned_to,status:d.status,channel:d.channel})));const c={all:o.filter(d=>d.status!=="resolved"&&d.status!=="closed").length,myTickets:o.filter(d=>(d.assigned_to===(i==null?void 0:i.id)||d.is_escalated_to_me===1)&&d.status!=="resolved"&&d.status!=="closed").length,pending:o.filter(d=>(d.status==="open"||d.status==="in-progress")&&d.assigned_to&&d.assigned_to!==null&&d.status!=="resolved"&&d.status!=="closed").length,unassigned:o.filter(d=>(!d.assigned_to||d.assigned_to===null)&&d.status!=="resolved"&&d.status!=="closed").length,snoozed:o.filter(d=>d.status==="snoozed").length,resolved:o.filter(d=>d.status==="resolved"||d.status==="closed").length,escalated:o.filter(d=>d.has_escalation===1).length,escalatedToMe:o.filter(d=>d.is_escalated_to_me===1).length,vip:o.filter(d=>d.vip===1&&d.status!=="resolved"&&d.status!=="closed").length,allAssigned:o.filter(d=>d.assigned_to&&d.assigned_to!==null&&d.status!=="resolved"&&d.status!=="closed").length,staffCounts:o.filter(d=>d.assigned_to&&d.status!=="resolved"&&d.status!=="closed").reduce((d,h)=>(d[h.assigned_to]=(d[h.assigned_to]||0)+1,d),{})};return console.log("DashboardLayout - Staff counts:",c.staffCounts),console.log("DashboardLayout - McCarthy AI count:",c.staffCounts["ai-agent-001"]),m.useEffect(()=>{const d=h=>{(h.ctrlKey||h.metaKey)&&h.key==="b"&&(h.preventDefault(),n(u=>!u))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[]),t.jsxs("div",{children:[t.jsx(Ji.Root,{show:e,as:m.Fragment,children:t.jsxs(Yx,{as:"div",className:"relative z-50 lg:hidden",onClose:s,children:[t.jsx(Ji.Child,{as:m.Fragment,enter:"transition-opacity ease-linear duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity ease-linear duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-gray-900/80"})}),t.jsx("div",{className:"fixed inset-0 flex",children:t.jsx(Ji.Child,{as:m.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"-translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",children:t.jsxs(Yx.Panel,{className:"relative mr-16 flex w-full max-w-xs flex-1",children:[t.jsx(Ji.Child,{as:m.Fragment,enter:"ease-in-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"absolute left-full top-0 flex w-16 justify-center pt-5",children:t.jsxs("button",{type:"button",className:"-m-2.5 p-2.5",onClick:()=>s(!1),children:[t.jsx("span",{className:"sr-only",children:"Close sidebar"}),t.jsx(t6,{className:"h-6 w-6 text-white","aria-hidden":"true"})]})})}),t.jsxs("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-white px-6 pb-2",children:[t.jsx("div",{className:"flex h-16 shrink-0 items-center",children:t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"CS Dashboard"})}),t.jsx("nav",{className:"flex flex-1 flex-col",children:t.jsx("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:t.jsx("li",{children:t.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:r6.map(d=>{const h=a.pathname.startsWith(d.href);return t.jsx("li",{children:t.jsxs(Je,{to:d.href,className:ag(h?"bg-gray-50 text-primary-600":"text-gray-700 hover:text-primary-600 hover:bg-gray-50","group flex gap-x-3 rounded-md p-2 text-sm leading-6 font-semibold"),children:[t.jsx(d.icon,{className:ag(h?"text-primary-600":"text-gray-400 group-hover:text-primary-600","h-6 w-6 shrink-0"),"aria-hidden":"true"}),d.name]})},d.name)})})})})})]})]})})})]})}),t.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:flex-col",children:t.jsx(_S,{ticketCounts:c,isCollapsed:r,onToggle:()=>n(!r)})}),t.jsx("div",{className:`fixed top-0 right-0 z-40 transition-all duration-300 ${r?"lg:left-16":"lg:left-64"} left-0`,children:t.jsxs("div",{className:"flex items-center justify-between h-14 px-4 bg-white border-b border-gray-200 shadow-sm",children:[t.jsxs("button",{type:"button",className:"-m-2.5 p-2.5 text-gray-700 lg:hidden",onClick:()=>s(!0),children:[t.jsx("span",{className:"sr-only",children:"Open sidebar"}),t.jsx(PS,{className:"h-6 w-6","aria-hidden":"true"})]}),t.jsx("div",{className:"hidden lg:block"}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(s6,{})})]})}),t.jsx("main",{className:`transition-all duration-300 pt-14 ${r?"lg:pl-16":"lg:pl-64"}`,children:t.jsx(V1,{})})]})}function ag(...e){return e.filter(Boolean).join(" ")}function Wt(e){const s=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&s==="[object Date]"?new e.constructor(+e):typeof e=="number"||s==="[object Number]"||typeof e=="string"||s==="[object String]"?new Date(e):new Date(NaN)}function a6(e,s){return e instanceof Date?new e.constructor(s):new Date(s)}const _o=43200,ig=1440;let i6={};function l6(){return i6}function lg(e){const s=Wt(e),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+e-+r}function Vo(e,s){const r=Wt(e),n=Wt(s),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function o6(e){return a6(e,Date.now())}function c6(e,s){const r=Wt(e),n=Wt(s),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}function d6(e){return s=>{const n=(e?Math[e]:Math.trunc)(s);return n===0?0:n}}function u6(e,s){return+Wt(e)-+Wt(s)}function m6(e){const s=Wt(e);return s.setHours(23,59,59,999),s}function h6(e){const s=Wt(e),r=s.getMonth();return s.setFullYear(s.getFullYear(),r+1,0),s.setHours(23,59,59,999),s}function x6(e){const s=Wt(e);return+m6(s)==+h6(s)}function g6(e,s){const r=Wt(e),n=Wt(s),a=Vo(r,n),i=Math.abs(c6(r,n));let l;if(i<1)l=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let o=Vo(r,n)===-a;x6(Wt(e))&&i===1&&Vo(e,n)===1&&(o=!1),l=a*(i-Number(o))}return l===0?0:l}function f6(e,s,r){const n=u6(e,s)/1e3;return d6(r==null?void 0:r.roundingMethod)(n)}const p6={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},y6=(e,s,r)=>{let n;const a=p6[e];return typeof a=="string"?n=a:s===1?n=a.one:n=a.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Qd(e){return(s={})=>{const r=s.width?String(s.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const b6={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},v6={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},j6={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},w6={date:Qd({formats:b6,defaultWidth:"full"}),time:Qd({formats:v6,defaultWidth:"full"}),dateTime:Qd({formats:j6,defaultWidth:"full"})},N6={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},k6=(e,s,r,n)=>N6[e];function Hi(e){return(s,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):l;a=e.formattingValues[o]||e.formattingValues[l]}else{const l=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[l]}const i=e.argumentCallback?e.argumentCallback(s):s;return a[i]}}const S6={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},C6={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},_6={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},E6={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},M6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},T6={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},A6=(e,s)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},P6={ordinalNumber:A6,era:Hi({values:S6,defaultWidth:"wide"}),quarter:Hi({values:C6,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Hi({values:_6,defaultWidth:"wide"}),day:Hi({values:E6,defaultWidth:"wide"}),dayPeriod:Hi({values:M6,defaultWidth:"wide",formattingValues:T6,defaultFormattingWidth:"wide"})};function Bi(e){return(s,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=s.match(a);if(!i)return null;const l=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?L6(o,u=>u.test(l)):R6(o,u=>u.test(l));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const h=s.slice(l.length);return{value:d,rest:h}}}function R6(e,s){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&s(e[r]))return r}function L6(e,s){for(let r=0;r<e.length;r++)if(s(e[r]))return r}function $6(e){return(s,r={})=>{const n=s.match(e.matchPattern);if(!n)return null;const a=n[0],i=s.match(e.parsePattern);if(!i)return null;let l=e.valueCallback?e.valueCallback(i[0]):i[0];l=r.valueCallback?r.valueCallback(l):l;const o=s.slice(a.length);return{value:l,rest:o}}}const F6=/^(\d+)(th|st|nd|rd)?/i,I6=/\d+/i,O6={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},D6={any:[/^b/i,/^(a|c)/i]},z6={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},U6={any:[/1/i,/2/i,/3/i,/4/i]},H6={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},B6={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},q6={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},W6={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},K6={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},V6={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Q6={ordinalNumber:$6({matchPattern:F6,parsePattern:I6,valueCallback:e=>parseInt(e,10)}),era:Bi({matchPatterns:O6,defaultMatchWidth:"wide",parsePatterns:D6,defaultParseWidth:"any"}),quarter:Bi({matchPatterns:z6,defaultMatchWidth:"wide",parsePatterns:U6,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Bi({matchPatterns:H6,defaultMatchWidth:"wide",parsePatterns:B6,defaultParseWidth:"any"}),day:Bi({matchPatterns:q6,defaultMatchWidth:"wide",parsePatterns:W6,defaultParseWidth:"any"}),dayPeriod:Bi({matchPatterns:K6,defaultMatchWidth:"any",parsePatterns:V6,defaultParseWidth:"any"})},G6={code:"en-US",formatDistance:y6,formatLong:w6,formatRelative:k6,localize:P6,match:Q6,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Y6(e,s,r){const n=l6(),a=(r==null?void 0:r.locale)??n.locale??G6,i=2520,l=Vo(e,s);if(isNaN(l))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:l});let c,d;l>0?(c=Wt(s),d=Wt(e)):(c=Wt(e),d=Wt(s));const h=f6(d,c),u=(lg(d)-lg(c))/1e3,p=Math.round((h-u)/60);let j;if(p<2)return r!=null&&r.includeSeconds?h<5?a.formatDistance("lessThanXSeconds",5,o):h<10?a.formatDistance("lessThanXSeconds",10,o):h<20?a.formatDistance("lessThanXSeconds",20,o):h<40?a.formatDistance("halfAMinute",0,o):h<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):p===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",p,o);if(p<45)return a.formatDistance("xMinutes",p,o);if(p<90)return a.formatDistance("aboutXHours",1,o);if(p<ig){const x=Math.round(p/60);return a.formatDistance("aboutXHours",x,o)}else{if(p<i)return a.formatDistance("xDays",1,o);if(p<_o){const x=Math.round(p/ig);return a.formatDistance("xDays",x,o)}else if(p<_o*2)return j=Math.round(p/_o),a.formatDistance("aboutXMonths",j,o)}if(j=g6(d,c),j<12){const x=Math.round(p/_o);return a.formatDistance("xMonths",x,o)}else{const x=j%12,g=Math.trunc(j/12);return x<3?a.formatDistance("aboutXYears",g,o):x<9?a.formatDistance("overXYears",g,o):a.formatDistance("almostXYears",g+1,o)}}function Os(e,s){return Y6(e,o6(e),s)}function Tb({isOpen:e,onClose:s,onReassign:r,currentAssignment:n,bulkMode:a,selectedTickets:i}){const[l,o]=m.useState(""),[c,d]=m.useState(""),[h,u]=m.useState([]),{data:p}=ue({queryKey:["staff-list"],queryFn:async()=>{var v;return((v=(await D.get("/api/staff")).data)==null?void 0:v.staff)||[]},enabled:e}),{data:j}=ue({queryKey:["tickets-for-reassign"],queryFn:async()=>{var v;return((v=(await Oe.list({limit:1e3})).data)==null?void 0:v.tickets)||[]},enabled:e});if(m.useEffect(()=>{if(p&&j){const f=p.map(v=>{const w=j.filter(N=>N.assigned_to===v.id&&(N.status==="open"||N.status==="in-progress")).length;return{id:v.id,name:`${v.first_name} ${v.last_name}`,role:v.title||"Staff",online:v.availability_status==="online",availability_status:v.availability_status||"offline",openTickets:w}});u(f)}},[p,j]),m.useEffect(()=>{e&&(o(""),d(""))},[e]),!e)return null;const g=h.filter(f=>f.online).length===1,y=()=>{if(l){if(l==="unassigned")r(null,"Unassigned",c||void 0);else{const f=h.find(v=>v.id===l);f&&r(f.id,f.name,c||void 0)}s()}},b=a&&i?i.length:1;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a?`Reassign ${b} Ticket${b>1?"s":""}`:"Reassign Ticket"})}),t.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[a&&i&&i.length>0?t.jsxs("div",{className:"mb-4",children:[t.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Reassign the following ticket",b>1?"s":""," to another staff member:"]}),t.jsx("div",{className:"bg-gray-50 rounded-lg p-3 max-h-32 overflow-y-auto",children:t.jsx("ul",{className:"space-y-1",children:i.map(f=>t.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"font-medium text-gray-900",children:f.ticket_number}),t.jsxs("span",{className:"text-gray-500 truncate",children:["- ",f.subject]})]},f.ticket_id))})})]}):t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reassign ticket #",n||"Unassigned"," to another staff member:"]}),g&&t.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:t.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),t.jsxs("div",{className:"space-y-2",children:[h.filter(f=>f.id==="ai-agent-001").map(f=>t.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l===f.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[t.jsx("input",{type:"radio",name:"staff",value:f.id,checked:l===f.id,onChange:v=>o(v.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-green-500"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[t.jsx(Zs,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),t.jsx("p",{className:"text-xs text-gray-500",children:"Return to AI handling"})]}),t.jsx("div",{className:"text-right min-w-[60px]",children:t.jsxs("p",{className:"text-xs text-gray-500",children:[f.openTickets," open"]})})]},f.id)),h.filter(f=>f.id!=="ai-agent-001").map(f=>t.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l===f.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[t.jsx("input",{type:"radio",name:"staff",value:f.id,checked:l===f.id,onChange:v=>o(v.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${f.availability_status==="online"?"bg-green-500":f.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.name}),t.jsx("p",{className:"text-xs text-gray-500 capitalize",children:f.availability_status||"Offline"})]}),t.jsx("div",{className:"text-right min-w-[60px]",children:t.jsxs("p",{className:"text-xs text-gray-500",children:[f.openTickets," open"]})})]},f.id))]}),t.jsx("div",{className:"mt-2",children:t.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${l==="unassigned"?"border-amber-500 bg-amber-50":"border-gray-300"}`,children:[t.jsx("input",{type:"radio",name:"staff",value:"unassigned",checked:l==="unassigned",onChange:f=>o(f.target.value),className:"h-4 w-4 text-amber-600 focus:ring-amber-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-gray-400"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Remove Assignment"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Ticket will be unassigned"})]})]})}),t.jsxs("div",{className:"mt-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),t.jsx("textarea",{value:c,onChange:f=>d(f.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[t.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:y,disabled:!l,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:a?`Reassign ${b} Ticket${b>1?"s":""}`:"Reassign Ticket"})]})]})})}function Ab({isOpen:e,onClose:s,parentTaskId:r,parentTaskNumber:n}){const a=ct(),{user:i}=ts(),[l,o]=m.useState("email"),[c,d]=m.useState(""),[h,u]=m.useState(""),[p,j]=m.useState(""),[x,g]=m.useState(""),[y,b]=m.useState(""),[f,v]=m.useState(""),[w,N]=m.useState("normal"),[P,z]=m.useState(""),[E,X]=m.useState(""),[T,F]=m.useState("17"),[Q,Z]=m.useState("00");m.useEffect(()=>{i!=null&&i.id&&z(i.id)},[i==null?void 0:i.id,l]);const{data:xe}=ue({queryKey:["staff-users"],queryFn:async()=>(await rt.list()).data}),ve=(xe==null?void 0:xe.staff)||[],ke=Ne({mutationFn:async ne=>(await Oe.createManual(ne)).data,onSuccess:()=>{a.invalidateQueries({queryKey:["tickets"]}),s(),q()}}),q=()=>{d(""),u(""),j(""),g(""),b(""),v(""),N("normal"),X(""),F("17"),Z("00"),i!=null&&i.id&&z(i.id)},R=ne=>{ne.preventDefault();let fe=null;K==="task"&&E&&(fe=`${E}T${T}:${Q}:00`);let Le=(x==null?void 0:x.trim())||null;Le&&Le.startsWith("@")&&(Le=`TKT-${Le.substring(1)}`),ke.mutate({customer_name:c||(K==="task"?"Internal Task":""),customer_email:h||(K==="task"?"task@internal":""),customer_phone:p,subject:y,message:f,channel:K,priority:w,assign_to:P==="auto"?null:P,related_ticket:Le,deadline:fe,parent_task_id:r||null})};if(!e)return null;const G=!!r,K=G?"task":l,ee=Array.from({length:24},(ne,fe)=>fe.toString().padStart(2,"0")),ae=["00","15","30","45"];return t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:[t.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:s}),t.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl",children:t.jsxs("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold leading-6 text-gray-900",children:G?`Create Sub-Task for ${n}`:K==="email"?"Create Email Ticket":"Create Task"}),t.jsx("button",{onClick:s,className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",children:t.jsx(_t,{className:"h-6 w-6"})})]}),!G&&t.jsxs("div",{className:"flex border-b border-gray-200 mb-4",children:[t.jsxs("button",{type:"button",onClick:()=>o("email"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors ${l==="email"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.jsx(sr,{className:"w-4 h-4 text-gray-500"}),"Email"]}),t.jsxs("button",{type:"button",onClick:()=>o("task"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors ${l==="task"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.jsx(gr,{className:"w-4 h-4 text-gray-500"}),"Task"]})]}),t.jsxs("form",{onSubmit:R,className:"space-y-4",children:[K==="email"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700",children:"Customer Name *"}),t.jsx("input",{type:"text",id:"customerName",required:!0,value:c,onChange:ne=>d(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"John Smith"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"customerEmail",className:"block text-sm font-medium text-gray-700",children:"Customer Email *"}),t.jsx("input",{type:"email",id:"customerEmail",required:!0,value:h,onChange:ne=>u(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"john@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"customerPhone",className:"block text-sm font-medium text-gray-700",children:"Customer Phone"}),t.jsx("input",{type:"tel",id:"customerPhone",value:p,onChange:ne=>j(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"0412 345 678"})]})]})]}),K==="task"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700",children:"Customer (optional)"}),t.jsx("input",{type:"text",id:"customerName",value:c,onChange:ne=>d(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"Customer name"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"relatedTicket",className:"block text-sm font-medium text-gray-700",children:"Ticket Number (optional)"}),t.jsx("input",{type:"text",id:"relatedTicket",value:x,onChange:ne=>g(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:"TKT-123 or @123"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deadline (optional)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"date",value:E,onChange:ne=>X(ne.target.value),className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("select",{value:T,onChange:ne=>F(ne.target.value),className:"w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-2 py-2 border",children:ee.map(ne=>t.jsx("option",{value:ne,children:ne},ne))}),t.jsx("span",{className:"text-gray-500 font-medium",children:":"}),t.jsx("select",{value:Q,onChange:ne=>Z(ne.target.value),className:"w-16 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-2 py-2 border",children:ae.map(ne=>t.jsx("option",{value:ne,children:ne},ne))})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700",children:"Priority *"}),t.jsxs("select",{id:"priority",value:w,onChange:ne=>N(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",children:[t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"urgent",children:"Urgent"}),t.jsx("option",{value:"critical",children:"Critical"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"assignTo",className:"block text-sm font-medium text-gray-700",children:"Assign To"}),t.jsxs("select",{id:"assignTo",value:P,onChange:ne=>z(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",children:[ve.filter(ne=>ne.id!=="ai-agent-001").map(ne=>t.jsxs("option",{value:ne.id,children:[ne.first_name," ",ne.last_name]},ne.id)),t.jsx("option",{value:"ai-agent-001",children:"McCarthy AI"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700",children:K==="email"?"Subject *":"Task Subject Title *"}),t.jsx("input",{type:"text",id:"subject",required:!0,value:y,onChange:ne=>b(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:K==="email"?"Order status inquiry":"Update shipping info for order #12345"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:K==="email"?"Email Message *":"Task Description *"}),t.jsx("textarea",{id:"message",required:!0,rows:6,value:f,onChange:ne=>v(ne.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border",placeholder:K==="email"?"Your email message to the customer...":"Describe what needs to be done..."})]}),K==="email"&&t.jsxs("div",{className:"rounded-md bg-blue-50 p-3 flex items-center gap-2",children:[t.jsx(sr,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),t.jsx("p",{className:"text-sm text-blue-800",children:"This will send an email to the customer and create a ticket."})]}),ke.isError&&t.jsx("div",{className:"rounded-md bg-red-50 p-4",children:t.jsxs("p",{className:"text-sm text-red-800",children:["Failed to create ",K==="email"?"ticket":"task",". Please try again."]})}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:s,className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:ke.isPending,className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed",children:ke.isPending?"Creating...":K==="email"?"Send Email & Create Ticket":"Create Task"})]})]})]})})]})})}const Gd=[{value:"all",label:"All Platforms",icon:null},{value:"email",label:"Email",icon:sr},{value:"chat",label:"Live Chat",icon:Hr},{value:"phone",label:"Phone",icon:ya},{value:"whatsapp",label:"WhatsApp",icon:Hr},{value:"instagram",label:"Instagram",icon:Hh},{value:"facebook",label:"Messenger",icon:zh}];function J6({value:e,onChange:s}){const[r,n]=m.useState(!1),a=m.useRef(null),i=Gd.find(o=>o.value===e)||Gd[0],l=i.icon;return m.useEffect(()=>{function o(c){a.current&&!a.current.contains(c.target)&&n(!1)}return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]),t.jsxs("div",{className:"relative",ref:a,children:[t.jsxs("button",{type:"button",onClick:()=>n(!r),className:"w-full flex items-center justify-between gap-2 rounded-lg border-2 border-gray-300 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[l&&t.jsx(l,{className:"w-4 h-4 text-gray-500"}),t.jsx("span",{children:i.label})]}),t.jsx(Ws,{className:"w-4 h-4 text-gray-400"})]}),r&&t.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-lg border border-gray-200 bg-white shadow-lg",children:Gd.map(o=>{const c=o.icon;return t.jsxs("button",{type:"button",onClick:()=>{s(o.value),n(!1)},className:`w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg ${o.value===e?"bg-indigo-50 text-indigo-700":"text-gray-700"}`,children:[c&&t.jsx(c,{className:"w-4 h-4"}),t.jsx("span",{children:o.label})]},o.value)})})]})}const og={open:"bg-green-50 text-green-700 ring-green-600/20",pending:"bg-yellow-50 text-yellow-700 ring-yellow-600/20","in-progress":"bg-blue-50 text-blue-700 ring-blue-600/20",resolved:"bg-gray-50 text-gray-700 ring-gray-600/20",closed:"bg-gray-50 text-gray-700 ring-gray-600/20",snoozed:"bg-purple-50 text-purple-700 ring-purple-600/20"},X6=({platform:e,className:s="w-4 h-4"})=>{switch(e){case"task":return t.jsx(gr,{className:`${s} text-amber-600`});case"chat":return t.jsx(Hr,{className:`${s} text-indigo-500`});case"phone":return t.jsx(ya,{className:`${s} text-red-500`});case"whatsapp":return t.jsx(Hr,{className:`${s} text-green-600`});case"facebook":return t.jsx(zh,{className:`${s} text-blue-600`});case"instagram":return t.jsx(Hh,{className:`${s} text-pink-500`});case"email":default:return t.jsx(sr,{className:`${s} text-gray-500`})}},cg={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},dg={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},Z6={positive:"",neutral:"",negative:"",angry:""},Yd={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson","00000000-0000-0000-0000-000000000004":"Gaille Hutchison","ai-agent-001":"McCarthy AI"},eC=e=>{const s=e.match(/^([A-Z]+)-?(\d+)-(\d+)$/);if(s){const l=s[1],o=parseInt(s[2],10),c=parseInt(s[3],10);return`${l}-${o}-${c}`}const r=e.match(/^([A-Z]+)-?/),n=e.match(/\d+/);if(!n)return e;const a=r?r[1]:"TKT",i=parseInt(n[0],10);return`${a}-${i}`};function tC(){const[e]=Bl(),{user:s}=ts(),[r,n]=m.useState("all"),[a,i]=m.useState("all"),[l,o]=m.useState("created_at"),[c,d]=m.useState("desc"),[h,u]=m.useState("all"),[p,j]=m.useState("all"),[x,g]=m.useState("all"),[y,b]=m.useState("all"),[f,v]=m.useState(!1),[w,N]=m.useState(!1),[P,z]=m.useState(""),[E,X]=m.useState([]),[T,F]=m.useState(!1),[Q,Z]=m.useState(!1),[xe,ve]=m.useState(!1),[ke,q]=m.useState(!1),[R,G]=m.useState(!1),[K,ee]=m.useState(!1);m.useEffect(()=>{const _=e.get("filter"),Y=e.get("assigned"),W=e.get("status"),J=()=>{n("all"),b("all"),i("all"),u("all"),j("all"),g("all"),v(!1)};W==="open"?(J(),n("open-in-progress")):W==="resolved"?(J(),n("resolved")):W==="snoozed"?(J(),n("snoozed")):_==="my"?(J(),b((s==null?void 0:s.id)||"00000000-0000-0000-0000-000000000001")):_==="vip"?(J(),v(!0)):_==="unassigned"?(J(),b("unassigned")):_==="all-escalated"?(J(),b("all-escalated")):_==="all-assigned"?(J(),b("all-assigned")):Y==="ted"?(J(),b("00000000-0000-0000-0000-000000000002")):Y==="sam"?(J(),b("00000000-0000-0000-0000-000000000003")):Y?(J(),b(Y)):!_&&!W&&!Y&&J()},[e,s==null?void 0:s.id]),m.useEffect(()=>{const _=e.get("search");_&&(z(_),N(!0))},[e]);const{data:ae,isLoading:ne}=ue({queryKey:["tickets-all"],queryFn:async()=>{const _={limit:1e3};return(await Oe.list(_)).data.tickets},refetchInterval:3e4});m.useEffect(()=>{if(P.trim()&&ae&&ae.length>0){const _=P.trim();let Y=ae.filter(W=>{if(!W.ticket_number)return!1;const J=W.ticket_number.toLowerCase(),B=_.toLowerCase();if(J===B)return!0;const me=W.ticket_number.replace(/\D/g,"").replace(/^0+/,""),Ie=_.replace(/\D/g,"").replace(/^0+/,"");return!!(me===Ie&&Ie.length>0||J.includes(B))});if(Y.length===1&&Y[0].id){const W=Y[0];console.log("[TicketsPage] Auto-navigating to ticket:",W.ticket_number,W.id),setTimeout(()=>{window.location.href=`/tickets/${W.id}`},1e3)}else Y.length===0?console.log("[TicketsPage] No tickets found for search:",_):Y.length>1&&console.log("[TicketsPage] Multiple tickets found:",Y.length,"- showing list")}},[P,ae]);const{data:fe}=ue({queryKey:["staff-list"],queryFn:async()=>(await D.get("/api/staff")).data,staleTime:6e4}),Le=(fe==null?void 0:fe.staff)||[];if(ne)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"Loading tickets..."})});let L=ae||[];if(r==="open-in-progress"?L=L.filter(_=>_.status==="open"||_.status==="in-progress"||_.status==="pending"):r==="snoozed"?L=L.filter(_=>_.status==="snoozed"):r==="resolved"?L=L.filter(_=>_.status==="resolved"||_.status==="closed"):L=L.filter(_=>_.status!=="resolved"&&_.status!=="closed"),y!=="all"&&(y==="unassigned"?L=L.filter(_=>!_.assigned_to||_.assigned_to===null):y==="all-assigned"?L=L.filter(_=>_.assigned_to&&_.assigned_to!==null):y==="all-escalated"?L=L.filter(_=>_.has_escalation===1):y==="resolved"?L=(ae||[]).filter(_=>_.status==="resolved"||_.status==="closed"):L=L.filter(_=>_.assigned_to===y||_.is_escalated_to_me===1)),f&&(L=L.filter(_=>_.vip===1)),a!=="all"&&(L=L.filter(_=>_.priority===a)),h!=="all"&&(L=L.filter(_=>_.sentiment===h)),p!=="all"&&(L=L.filter(_=>_.channel===p)),x!=="all"){const _=new Date;let Y;x==="today"?Y=new Date(_.getFullYear(),_.getMonth(),_.getDate()):x==="week"?Y=new Date(_.getTime()-7*24*60*60*1e3):x==="month"?Y=new Date(_.getTime()-30*24*60*60*1e3):Y=new Date(0),L=L.filter(W=>new Date(W.created_at)>=Y)}if(P.trim()){const _=P.trim();if(/^(TKT-|TSK-)?[\d,\s-]+$/.test(_)){const W=_.replace(/TKT-/gi,"").replace(/TSK-/gi,"").split(",").map(J=>J.trim().replace(/\D/g,"")).filter(J=>J.length>0);L=L.filter(J=>{var me;const B=((me=J.ticket_number)==null?void 0:me.replace(/\D/g,"").replace(/^0+/,""))||"";return W.some(Ie=>{var ie;const pe=Ie.replace(/^0+/,"");return B===pe||B.endsWith(pe)||((ie=J.ticket_number)==null?void 0:ie.toLowerCase().includes(Ie.toLowerCase()))})})}else{const W=_.toLowerCase();L=L.filter(J=>{var B,me,Ie,pe,ie;return((B=J.ticket_number)==null?void 0:B.toLowerCase().includes(W))||((me=J.customer_name)==null?void 0:me.toLowerCase().includes(W))||((Ie=J.customer_email)==null?void 0:Ie.toLowerCase().includes(W))||((pe=J.subject)==null?void 0:pe.toLowerCase().includes(W))||((ie=J.description)==null?void 0:ie.toLowerCase().includes(W))})}}const ye=_=>{l===_?d(c==="asc"?"desc":"asc"):(o(_),d("asc"))};L=L.sort((_,Y)=>{var B,me,Ie,pe;let W=_[l],J=Y[l];return l==="created_at"?(W=new Date(_.created_at).getTime(),J=new Date(Y.created_at).getTime()):l==="customer_name"?(W=((B=_.customer_name)==null?void 0:B.toLowerCase())||"",J=((me=Y.customer_name)==null?void 0:me.toLowerCase())||""):l==="subject"?(W=((Ie=_.subject)==null?void 0:Ie.toLowerCase())||"",J=((pe=Y.subject)==null?void 0:pe.toLowerCase())||""):l==="assigned_to"&&(W=Yd[_.assigned_to]||"Unassigned",J=Yd[Y.assigned_to]||"Unassigned"),c==="asc"?W>J?1:W<J?-1:0:W<J?1:W>J?-1:0});const _e=()=>{if(y===(s==null?void 0:s.id))return"My Tickets";if(y==="unassigned")return"Unassigned";if(y==="all-escalated")return" All Escalated Tickets";if(y==="all-assigned")return"All Assigned";if(y==="ai-agent-001")return"McCarthy AI";const _=Le.find(Y=>Y.id===y);return _?`${_.first_name} ${_.last_name}`:r==="snoozed"?"Snoozed":r==="resolved"?"Resolved":r==="open-in-progress"?"Open (in-progress)":f?"VIP":"All Tickets"};return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"sticky top-0 z-10 bg-white pb-4 -mx-6 px-6 -mt-6 pt-6 border-b border-gray-200 mb-4",children:[t.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"sm:flex-auto",children:[t.jsxs("h1",{className:"text-2xl font-semibold leading-6 text-gray-900 flex items-center gap-3",children:[_e(),t.jsx("span",{className:"inline-flex items-center rounded-full bg-indigo-100 px-3 py-1 text-sm font-semibold text-indigo-700 ring-1 ring-inset ring-indigo-600/20",children:L.length}),t.jsx("button",{onClick:()=>N(!w),className:`p-1.5 rounded-lg transition-colors ${w?"bg-indigo-100 text-indigo-600":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,title:"Search tickets",children:t.jsx(xi,{className:"w-5 h-5"})})]}),t.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"A list of all customer service tickets including their status, priority, and assignment."})]}),t.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:t.jsxs("button",{type:"button",onClick:()=>q(!0),className:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:[t.jsx(ad,{className:"w-4 h-4"}),"Create Ticket"]})})]}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[t.jsxs("select",{value:y,onChange:_=>{const Y=_.target.value;b(Y),v(Y==="vip")},className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[t.jsx("option",{value:"all",children:"All Tickets"}),t.jsx("option",{value:(s==null?void 0:s.id)||"",children:"My Tickets"}),Le.filter(_=>_.id!=="ai-agent-001"&&_.id!==(s==null?void 0:s.id)).map(_=>t.jsxs("option",{value:_.id,children:[_.first_name," ",_.last_name]},_.id)),t.jsx("option",{value:"ai-agent-001",children:"McCarthy AI"}),t.jsx("option",{value:"all-assigned",children:"Assigned All"}),t.jsx("option",{value:"unassigned",children:"Unassigned"}),t.jsx("option",{value:"resolved",children:"Resolved"})]}),t.jsx(J6,{value:p,onChange:j}),t.jsxs("select",{value:r,onChange:_=>n(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[t.jsx("option",{value:"all",children:"All Statuses"}),t.jsx("option",{value:"open-in-progress",children:"Open (in-progress)"}),t.jsx("option",{value:"snoozed",children:"Snoozed"}),t.jsx("option",{value:"resolved",children:"Resolved"})]}),t.jsxs("select",{value:a,onChange:_=>i(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[t.jsx("option",{value:"all",children:"All Priorities"}),t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"urgent",children:"Urgent"}),t.jsx("option",{value:"critical",children:"Critical"})]}),t.jsxs("select",{value:h,onChange:_=>u(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[t.jsx("option",{value:"all",children:"All Sentiments"}),t.jsx("option",{value:"positive",children:" Positive"}),t.jsx("option",{value:"neutral",children:" Neutral"}),t.jsx("option",{value:"negative",children:" Negative"}),t.jsx("option",{value:"angry",children:" Angry"})]}),t.jsxs("select",{value:x,onChange:_=>g(_.target.value),className:"block w-full rounded-lg border-2 text-sm focus:border-indigo-500 focus:ring-indigo-500 px-3 py-2 bg-white border-gray-300",children:[t.jsx("option",{value:"all",children:"All Time"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"week",children:"This Week"}),t.jsx("option",{value:"month",children:"This Month"})]})]}),w&&t.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1 max-w-lg",children:[t.jsx(xi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",value:P,onChange:_=>z(_.target.value),placeholder:"Search by ticket #, name, email, description... or enter ticket numbers: 112, 119, 122",className:"w-full pl-10 pr-10 py-2 rounded-lg border-2 border-indigo-300 text-sm focus:border-indigo-500 focus:ring-indigo-500 bg-white",autoFocus:!0}),P&&t.jsx("button",{onClick:()=>z(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t.jsx(_t,{className:"w-4 h-4"})})]}),t.jsx("button",{onClick:()=>{N(!1),z("")},className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Close"})]}),E.length>0&&(()=>{const _=E.map(J=>L.find(B=>B.ticket_id===J)).filter(Boolean),Y=new Set(_.map(J=>J==null?void 0:J.customer_email)),W=E.length>=2&&Y.size===1;return t.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-indigo-50 border border-indigo-200 rounded-lg px-4 py-2",children:[t.jsxs("span",{className:"text-sm font-medium text-indigo-700 mr-2",children:[E.length," ticket",E.length>1?"s":""," selected"]}),E.length>=2&&t.jsxs("button",{onClick:()=>W?F(!0):alert("Can only merge tickets from the same customer email address"),className:`flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-lg ${W?"text-white bg-indigo-600 hover:bg-indigo-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,title:W?"Merge selected tickets":"Can only merge tickets from the same customer email",children:[t.jsx(sg,{className:"w-4 h-4"}),t.jsx("span",{children:"Merge"}),!W&&t.jsx("span",{className:"text-xs",children:"(different emails)"})]}),t.jsxs("button",{onClick:()=>ve(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t.jsx("span",{children:"Reassign"})]}),(s==null?void 0:s.role)==="admin"&&t.jsxs("button",{onClick:()=>G(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg",children:[t.jsx(fi,{className:"w-4 h-4"}),t.jsx("span",{children:"Delete"})]}),t.jsx("button",{onClick:()=>X([]),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-white rounded-lg border border-gray-300",children:"Clear"})]})})()]})]}),t.jsx("div",{className:"mt-4",children:t.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg",children:t.jsxs("table",{className:"w-full divide-y divide-gray-300",style:{tableLayout:"fixed"},children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"py-3.5 w-14 text-center",children:t.jsx("input",{type:"checkbox",checked:E.length>0&&E.length===L.length,onChange:_=>{_.target.checked?X(L.map(Y=>Y.ticket_id)):X([])},className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"})}),t.jsx("th",{scope:"col",className:"py-3.5 pl-2 pr-2 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100 whitespace-nowrap",onClick:()=>ye("ticket_number"),style:{width:"9%",minWidth:"90px"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Ticket #",l==="ticket_number"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),t.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ye("created_at"),style:{width:"10%"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Created",l==="created_at"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),t.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ye("customer_name"),style:{width:"14%"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Customer",l==="customer_name"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),t.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ye("subject"),style:{width:"22%"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Subject",l==="subject"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),t.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ye("priority"),style:{width:"8%"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Priority",l==="priority"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),t.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ye("status"),style:{width:"9%"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Status",l==="status"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),t.jsx("th",{scope:"col",className:"px-2 py-3.5 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ye("assigned_to"),style:{width:"10%"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Assignment",l==="assigned_to"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})}),t.jsx("th",{scope:"col",className:"px-2 py-3.5 pr-2 text-left text-xs font-semibold text-gray-900 cursor-pointer hover:bg-gray-100",onClick:()=>ye("sentiment"),style:{width:"10%"},children:t.jsxs("div",{className:"flex items-center gap-1",children:["Sentiment",l==="sentiment"&&t.jsx("span",{className:"text-xs",children:c==="asc"?"":""})]})})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:L.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:10,className:"py-8 text-center text-sm text-gray-500",children:"No tickets found"})}):L.map(_=>{let Y;if(_.channel==="chat")Y=`/chat-ticket/${_.ticket_id}`;else{const me=new URLSearchParams;f?me.set("filter","vip"):y!=="all"&&y!=="vip"&&me.set("from",y),Y=me.toString()?`/tickets/${_.ticket_id}?${me.toString()}`:`/tickets/${_.ticket_id}`}const W=_.has_escalation===1?"bg-orange-50":_.status==="snoozed"?"bg-purple-100":_.merged_from?"bg-cyan-50":"",J=E.includes(_.ticket_id),B=E.indexOf(_.ticket_id);return t.jsxs("tr",{className:`${W} ${J?"bg-indigo-50":""}`,children:[t.jsxs("td",{className:"py-3 w-14 text-center relative",children:[t.jsx("input",{type:"checkbox",checked:J,onChange:me=>{me.target.checked?X([...E,_.ticket_id]):X(E.filter(Ie=>Ie!==_.ticket_id))},className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),J&&B===0&&t.jsx("span",{className:"absolute -right-1 top-1/2 -translate-y-1/2 text-xs font-bold text-indigo-600",title:"Primary ticket (will be kept)",children:""})]}),t.jsx("td",{className:"py-3 pl-2 pr-2 text-sm font-medium",children:t.jsxs(Je,{to:Y,className:"text-indigo-600 hover:text-indigo-900 font-medium flex items-center gap-1.5",children:[t.jsx(X6,{platform:_.channel||"email",className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{className:"text-xs whitespace-nowrap",children:eC(_.ticket_number)})]})}),t.jsxs("td",{className:"px-2 py-3 text-sm text-gray-500",children:[t.jsx("div",{className:"text-xs truncate",children:new Date(_.created_at).toLocaleString()}),t.jsx("div",{className:"text-xs text-gray-400 truncate",children:Os(new Date(_.created_at),{addSuffix:!0})})]}),t.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:t.jsx(Je,{to:`/tickets?customer=${encodeURIComponent(_.customer_email)}`,className:"block hover:bg-gray-50 -m-1 p-1 rounded transition-colors",children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-gray-900 hover:text-indigo-600 font-medium text-xs truncate",children:_.customer_name}),_.vip===1&&t.jsx("span",{className:"text-yellow-500 text-xs flex-shrink-0",title:"VIP Customer",children:""})]}),t.jsx("div",{className:"text-gray-500 hover:text-indigo-500 text-xs truncate",children:_.customer_email})]})})}),t.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:t.jsx("div",{className:"truncate text-xs",children:_.subject||_.description||"No subject"})}),t.jsx("td",{className:"px-2 py-3 text-sm",children:t.jsx("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${cg[_.priority]||cg.normal}`,children:_.priority})}),t.jsx("td",{className:"px-2 py-3 text-sm",children:t.jsxs("div",{className:"relative inline-block",children:[t.jsx("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${og[_.status]||og.open}`,children:_.status}),_.is_escalated_to_me===1&&t.jsx("span",{className:"absolute -top-1 -right-1 text-xs leading-none",title:"Escalated - You've been asked for help",children:""})]})}),t.jsx("td",{className:"px-2 py-3 text-sm text-gray-500",children:_.assigned_to?t.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-1.5 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 truncate",children:Yd[_.assigned_to]||_.assigned_staff_name||_.assigned_to}):t.jsx("span",{className:"inline-flex items-center rounded-md bg-gray-50 px-1.5 py-0.5 text-xs font-medium text-gray-500 ring-1 ring-inset ring-gray-300",children:"Unassigned"})}),t.jsx("td",{className:"px-2 py-3 pr-2 text-sm",children:t.jsxs("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset ${dg[_.sentiment]||dg.neutral}`,children:[Z6[_.sentiment]||""," ",_.sentiment||"neutral"]})})]},_.ticket_id)})})]})})}),T&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:t.jsx(sg,{className:"w-6 h-6 text-indigo-600"})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Merge Tickets"})]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["You are about to merge ",t.jsxs("span",{className:"font-semibold",children:[E.length," tickets"]})," into one."]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Tickets to merge:"}),t.jsx("ul",{className:"space-y-1",children:E.map((_,Y)=>{const W=L.find(J=>J.ticket_id===_);return t.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[Y===0?t.jsx("span",{className:"text-xs font-bold text-indigo-600 bg-indigo-100 px-1.5 py-0.5 rounded",children:"PRIMARY"}):t.jsx("span",{className:"text-xs text-gray-400 bg-gray-200 px-1.5 py-0.5 rounded",children:"merge"}),t.jsx("span",{className:"font-medium",children:W==null?void 0:W.ticket_number}),t.jsxs("span",{className:"text-gray-500 truncate",children:["- ",W==null?void 0:W.subject]})]},_)})})]}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:t.jsxs("p",{className:"text-xs text-yellow-800",children:[t.jsx("strong",{children:"What will happen:"}),t.jsx("br",{})," All messages will be merged into the PRIMARY ticket in chronological order",t.jsx("br",{})," Secondary tickets will be closed with a note",t.jsx("br",{})," This action cannot be undone"]})}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:Q,children:"Cancel"}),t.jsx("button",{onClick:async()=>{var _,Y;Z(!0);try{const[W,...J]=E;await Oe.merge(W,J),F(!1),X([]),window.location.reload()}catch(W){console.error("Failed to merge tickets:",W),alert(`Failed to merge tickets: ${((Y=(_=W.response)==null?void 0:_.data)==null?void 0:Y.error)||W.message||"Unknown error"}`)}finally{Z(!1)}},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",disabled:Q,children:Q?"Merging...":"Merge Tickets"})]})]})}),t.jsx(Tb,{isOpen:xe,onClose:()=>ve(!1),onReassign:async(_,Y,W)=>{var J,B;try{await Oe.bulkAssign(E,_),W&&console.log("Bulk reassignment reason:",W),ve(!1),X([]),window.location.reload()}catch(me){console.error("Failed to reassign tickets:",me),alert(`Failed to reassign tickets: ${((B=(J=me.response)==null?void 0:J.data)==null?void 0:B.error)||me.message||"Unknown error"}`)}},bulkMode:!0,selectedTickets:E.map(_=>{const Y=L.find(W=>W.ticket_id===_);return{ticket_id:_,ticket_number:(Y==null?void 0:Y.ticket_number)||"",subject:(Y==null?void 0:Y.subject)||""}})}),R&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:t.jsx(fi,{className:"w-6 h-6 text-red-600"})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Tickets"})]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Are you sure you want to delete ",t.jsxs("span",{className:"font-semibold",children:[E.length," ticket",E.length>1?"s":""]}),"?"]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 max-h-48 overflow-y-auto",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Tickets to delete:"}),t.jsx("ul",{className:"space-y-1",children:E.map(_=>{const Y=L.find(W=>W.ticket_id===_);return t.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"font-medium text-red-600",children:Y==null?void 0:Y.ticket_number}),t.jsxs("span",{className:"text-gray-500 truncate",children:["- ",Y==null?void 0:Y.subject]})]},_)})})]}),t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:t.jsxs("p",{className:"text-xs text-red-800",children:[t.jsx("strong",{children:" Warning:"})," This action cannot be undone. All selected tickets and their messages will be permanently deleted."]})}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>G(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",disabled:K,children:"Cancel"}),t.jsx("button",{onClick:async()=>{var _,Y;ee(!0);try{for(const W of E)await Oe.delete(W);G(!1),X([]),window.location.reload()}catch(W){console.error("Failed to delete tickets:",W),alert(`Failed to delete tickets: ${((Y=(_=W.response)==null?void 0:_.data)==null?void 0:Y.error)||W.message||"Unknown error"}`)}finally{ee(!1)}},className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50",disabled:K,children:K?"Deleting...":`Delete ${E.length} Ticket${E.length>1?"s":""}`})]})]})}),t.jsx(Ab,{isOpen:ke,onClose:()=>q(!1)})]})}const sC=["open","pending","in-progress","resolved","closed","escalated"];function rC({currentStatus:e,onClose:s,onSave:r}){const[n,a]=m.useState(e),[i,l]=m.useState(!1),o=async()=>{l(!0);try{await r(n),s()}catch(c){console.error("Failed to update status:",c),alert("Failed to update status")}finally{l(!1)}};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Change Status"}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:t.jsx(_t,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"space-y-2",children:sC.map(c=>t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"radio",value:c,checked:n===c,onChange:d=>a(d.target.value),className:"text-indigo-600"}),t.jsx("span",{className:"capitalize",children:c})]},c))}),t.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[t.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:o,disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:i?"Saving...":"Save"})]})]})})}const ug=[{id:"00000000-0000-0000-0000-000000000001",name:"John Hutchison",role:"Admin",online:!0},{id:"00000000-0000-0000-0000-000000000002",name:"Ted Smith",role:"Team Lead",online:!1},{id:"00000000-0000-0000-0000-000000000003",name:"Sam Johnson",role:"Manager",online:!1}];function nC({isOpen:e,onClose:s,onConfirm:r,ticketNumber:n}){const[a,i]=m.useState(""),[l,o]=m.useState("");if(!e)return null;const c=u=>{const p=ug.find(j=>j.id===u);if(p){i(u);const j=p.name.split(" ")[0];o(x=>{const g=x.replace(/@\w+\s*/g,"").trim();return g?`@${j} ${g}`:`@${j} `})}},d=()=>{!a||!l.trim()||(r("escalation",[a],l),i(""),o(""),s())},h=()=>{i(""),o(""),s()};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center mr-3",children:t.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),t.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Escalate Ticket #",n]})]})}),t.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Request assistance from other staff members to help resolve this ticket."}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Notify Staff Members: ",t.jsx("span",{className:"text-gray-500 font-normal",children:"(Select one or more)"})]}),t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3",children:ug.map(u=>t.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${a===u.id?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("input",{type:"radio",name:"escalate-staff",value:u.id,checked:a===u.id,onChange:()=>c(u.id),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${u.online?"bg-green-500":"bg-gray-400"}`}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:u.name}),t.jsxs("p",{className:"text-xs text-gray-500",children:[u.role,"  ",u.online?"Online":"Offline"]})]})]},u.id))}),t.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[a?"1":"0"," staff member selected"]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Your Message: ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:l,onChange:u=>o(u.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"@mention message asking for help or advice on this ticket..."}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will be sent as an @mention linked to this ticket"})]}),t.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:t.jsxs("div",{className:"flex",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Note:"}),t.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Selected staff will receive an alert notification and this will appear in their @mentions with higher priority (at the top, in a different color)."})]})]})})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[t.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:d,disabled:!a||!l.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send Escalation"})]})]})})}const mg=[{id:"30-mins",title:"30 Minutes",description:"Quick snooze - resume in 30 mins",value:"30m"},{id:"later-today",title:"Later Today",description:"Resume in 3 hours",value:"3h"},{id:"tomorrow",title:"Tomorrow",description:"Next business day at 9:00 AM",value:"1d"},{id:"this-week",title:"This Week",description:"Friday at 9:00 AM",value:"friday"},{id:"next-week",title:"Next Week",description:"Following Monday at 9:00 AM",value:"1w"},{id:"custom",title:"Custom Date & Time",description:"Pick specific date and time",value:"custom"}];function aC({isOpen:e,onClose:s,onConfirm:r,onRemoveSnooze:n,ticketNumber:a,isSnoozed:i}){const[l,o]=m.useState(""),[c,d]=m.useState("");if(!e)return null;const h=()=>{if(!l)return;if(l==="custom"&&!c){alert("Please select a custom date and time");return}const p=mg.find(j=>j.id===l);p&&r(p.value,l==="custom"?c:void 0),o(""),d(""),s()},u=()=>{o(""),d(""),s()};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] flex flex-col",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center mr-3",children:t.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Snooze Ticket #",a]})]})}),t.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Temporarily hide this ticket and automatically resume it later."}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Snooze until:"}),t.jsx("div",{className:"space-y-2",children:mg.map(p=>t.jsxs("div",{children:[t.jsxs("label",{className:`flex items-start p-4 border rounded-lg cursor-pointer transition-colors ${l===p.id?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("input",{type:"radio",name:"snooze",value:p.id,checked:l===p.id,onChange:j=>o(j.target.value),className:"mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),t.jsxs("div",{className:"ml-3 flex-1",children:[t.jsx("p",{className:"text-sm font-semibold text-gray-900",children:p.title}),t.jsx("p",{className:"text-xs text-gray-600 mt-1",children:p.description})]})]}),p.id==="custom"&&l==="custom"&&t.jsxs("div",{className:"mt-2 ml-7 p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Select Date & Time:"}),t.jsx("input",{type:"datetime-local",value:c,onChange:j=>d(j.target.value),min:new Date().toISOString().slice(0,16),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]},p.id))})]})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-between gap-3 border-t border-gray-200 flex-shrink-0",children:[t.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:h,disabled:!l||l==="custom"&&!c,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Snooze Ticket"}),i&&n&&t.jsx("button",{onClick:()=>{n(),u()},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:"Remove Snooze"})]})]})]})})}function iC({isOpen:e,onClose:s,onConfirm:r}){const[n,a]=m.useState(""),[i,l]=m.useState("09"),[o,c]=m.useState("00"),d=()=>{const x=new Date,g=x.getFullYear(),y=(x.getMonth()+1).toString().padStart(2,"0"),b=x.getDate().toString().padStart(2,"0");return`${g}-${y}-${b}`},h=()=>{const g=new Date().getHours()+1;return g>=24?"09":g.toString().padStart(2,"0")};if(m.useEffect(()=>{e&&(a(d()),l(h()),c("00"))},[e]),!e)return null;const u=()=>{if(!n||!i||!o){alert("Please select date and time");return}const x=`${i}:${o}`;r(n,x),s()},p=()=>{s()},j=d();return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center mr-3",children:t.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Reply"})]}),t.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"px-6 py-4",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Schedule when this message will be sent to the customer. Scheduled messages are only visible to staff until the scheduled time."}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),t.jsx("input",{type:"date",value:n,onChange:x=>a(x.target.value),min:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("select",{value:i,onChange:x=>l(x.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:24},(x,g)=>{const y=g.toString().padStart(2,"0");return t.jsx("option",{value:y,children:y},y)})}),t.jsx("span",{className:"flex items-center text-gray-500 font-semibold",children:":"}),t.jsx("select",{value:o,onChange:x=>c(x.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:60},(x,g)=>{const y=g.toString().padStart(2,"0");return t.jsx("option",{value:y,children:y},y)})})]})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Note:"})," This message will be sent automatically at the scheduled time during business hours (9 AM - 6 PM)."]})})]})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200",children:[t.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:u,disabled:!n,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Schedule Reply"})]})]})})}function lC({isOpen:e,onClose:s,onConfirm:r,onRemove:n,message:a}){const[i,l]=m.useState(""),[o,c]=m.useState(""),[d,h]=m.useState("09"),[u,p]=m.useState("00");if(m.useEffect(()=>{if(e&&a){l(a.content);const y=new Date(a.scheduled_for);c(y.toISOString().split("T")[0]),h(y.getHours().toString().padStart(2,"0")),p(y.getMinutes().toString().padStart(2,"0"))}},[e,a]),!e)return null;const j=()=>{if(!i.trim()){alert("Message content cannot be empty");return}if(!o){alert("Please select a date");return}const y=`${d}:${u}`;r(i,o,y),s()},x=()=>{l(""),c(""),h("09"),p("00"),s()},g=new Date().toISOString().split("T")[0];return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Scheduled Message"})]}),t.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"px-6 py-4",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Edit the message content and scheduled time for this reply."}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Content"}),t.jsx("textarea",{value:i,onChange:y=>l(y.target.value),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none",placeholder:"Enter your message..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Date"}),t.jsx("input",{type:"date",value:o,onChange:y=>c(y.target.value),min:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled Time"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("select",{value:d,onChange:y=>h(y.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:24},(y,b)=>{const f=b.toString().padStart(2,"0");return t.jsx("option",{value:f,children:f},f)})}),t.jsx("span",{className:"flex items-center text-gray-500 font-semibold",children:":"}),t.jsx("select",{value:u,onChange:y=>p(y.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:Array.from({length:60},(y,b)=>{const f=b.toString().padStart(2,"0");return t.jsx("option",{value:f,children:f},f)})})]})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Note:"})," This message will be sent automatically at the scheduled time."]})})]})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-between gap-3 border-t border-gray-200",children:[t.jsx("button",{onClick:x,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:j,disabled:!i.trim()||!o,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Changes"}),n&&t.jsx("button",{onClick:()=>{confirm("Are you sure you want to remove this scheduled message? It will not be sent.")&&(n(),x())},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:"Remove"})]})]})]})})}const oC=({draft:e,loading:s,onApprove:r,onEdit:n,onReject:a})=>{const[i,l]=m.useState(!1),[o,c]=m.useState(""),[d,h]=m.useState(""),[u,p]=m.useState(!1),[j,x]=m.useState(!1);if(s)return t.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Zs,{className:"w-5 h-5 text-blue-500 animate-pulse"}),t.jsx("span",{className:"text-gray-600",children:"AI is analyzing this ticket..."})]})});if(!e)return null;const g=Math.round(e.confidence_score*100),y=g>=85?"text-green-600 bg-green-50":g>=70?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",b=async()=>{x(!0);try{await r()}finally{x(!1)}},f=async()=>{if(!i){c(e.draft_content),l(!0);return}x(!0);try{await n(o),l(!1)}finally{x(!1)}},v=async()=>{x(!0);try{await a(d),p(!1),h("")}finally{x(!1)}};return t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg shadow-lg p-6 border-2 border-blue-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Zs,{className:"w-6 h-6 text-blue-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Draft Response"}),t.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y}`,children:[g,"% Confidence"]})]}),e.processing_time_ms&&e.processing_time_ms>0&&t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[t.jsx(ga,{className:"w-4 h-4"}),t.jsxs("span",{children:[e.processing_time_ms,"ms"]})]})]}),e.should_escalate===!0&&t.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(jS,{className:"w-5 h-5 text-yellow-600 mt-0.5 mr-3"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Escalation Recommended"}),t.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:e.escalation_reason})]})]})}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Draft Response:"}),i?t.jsx("textarea",{value:o,onChange:w=>c(w.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:8}):t.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 whitespace-pre-wrap",children:e.draft_content})]}),t.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"AI Reasoning:"}),t.jsx("p",{className:"text-sm text-gray-600",children:e.reasoning}),t.jsx("div",{className:"mt-3",children:t.jsxs("p",{className:"text-xs text-gray-500",children:["Intent: ",t.jsx("span",{className:"font-medium",children:e.intent})," | Handler: ",t.jsx("span",{className:"font-medium",children:e.handler_used})]})})]}),e.suggested_actions&&e.suggested_actions.length>0&&t.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Suggested Actions:"}),t.jsx("ul",{className:"space-y-1",children:e.suggested_actions.map((w,N)=>t.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[t.jsx("span",{className:"text-blue-500 mr-2",children:""}),w]},N))})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("button",{onClick:b,disabled:j||i,className:"flex-1 flex items-center justify-center px-4 py-2 bg-green-50 text-green-700 border border-green-200 rounded-lg hover:bg-green-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[t.jsx(lt,{className:"w-4 h-4 mr-2"}),j?"Sending...":"Approve & Send"]}),t.jsxs("button",{onClick:f,disabled:j,className:"flex-1 flex items-center justify-center px-4 py-2 bg-yellow-50 text-yellow-700 border border-yellow-200 rounded-lg hover:bg-yellow-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[t.jsx(Bh,{className:"w-4 h-4 mr-2"}),i?j?"Sending...":"Send Edited":"Edit & Send"]}),t.jsxs("button",{onClick:()=>p(!0),disabled:j||i,className:"flex-1 flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:[t.jsx(yr,{className:"w-4 h-4 mr-2"}),"Reject"]})]}),i&&t.jsx("button",{onClick:()=>{l(!1),c("")},className:"mt-2 w-full px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel Editing"}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject AI Draft"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this draft (optional):"}),t.jsx("textarea",{value:d,onChange:w=>h(w.target.value),placeholder:"e.g., Incorrect information, wrong tone, missing details...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",rows:3}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>{p(!1),h("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsx("button",{onClick:v,disabled:j,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:j?"Rejecting...":"Reject Draft"})]})]})})]})};function cC({isOpen:e,onClose:s,onSubmit:r}){const[n,a]=m.useState(0),[i,l]=m.useState(null),[o,c]=m.useState(""),[d,h]=m.useState(!1),[u,p]=m.useState(0);if(!e)return null;const j=async()=>{if(n===0||i===null){alert("Please rate the draft and indicate if it was helpful");return}h(!0);try{await r({qualityScore:n,wasHelpful:i,improvementNotes:o}),s()}catch(g){console.error("Failed to submit feedback:",g),alert("Failed to submit feedback. Please try again.")}finally{h(!1)}},x=()=>{s()};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" Help Improve the AI"}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx(_t,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"How good was the AI draft?"}),t.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(g=>t.jsx("button",{onClick:()=>a(g),onMouseEnter:()=>p(g),onMouseLeave:()=>p(0),className:"transition-transform hover:scale-110",children:t.jsx(uS,{className:`w-8 h-8 ${g<=(u||n)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},g)),t.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:[n===0&&"Click to rate",n===1&&"Poor",n===2&&"Fair",n===3&&"Good",n===4&&"Very Good",n===5&&"Excellent"]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Did the AI draft save you time?"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>l(!0),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${i===!0?"border-green-500 bg-green-50 text-green-700":"border-gray-300 text-gray-700 hover:border-green-300"}`,children:" Yes"}),t.jsx("button",{onClick:()=>l(!1),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-all ${i===!1?"border-red-500 bg-red-50 text-red-700":"border-gray-300 text-gray-700 hover:border-red-300"}`,children:" No"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What could be improved? (Optional)"}),t.jsx("textarea",{value:o,onChange:g=>c(g.target.value),placeholder:"e.g., Too formal, missing product details, wrong tone...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-xs text-blue-800",children:[" ",t.jsx("strong",{children:"Your feedback helps the AI learn!"})," Every rating makes the AI smarter and more helpful for future tickets."]})})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50",children:[t.jsx("button",{onClick:x,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",disabled:d,children:"Skip for now"}),t.jsx("button",{onClick:j,disabled:d||n===0||i===null,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium",children:d?"Submitting...":"Submit Feedback"})]})]})})}function eo(e){return e?e.split(",").map(s=>s.trim()).filter(s=>s.length>0):[]}const Pb="Use #keyword to add tags (e.g., #james-scott, #artwork-issue)",hg={open:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200","in-progress":"bg-blue-100 text-blue-800 border-blue-200",resolved:"bg-gray-100 text-gray-800 border-gray-200",closed:"bg-gray-100 text-gray-800 border-gray-200",snoozed:"bg-purple-100 text-purple-800 border-purple-200"},xg={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},gg={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},dC={positive:"",neutral:"",negative:"",angry:""},fg={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson"},ka=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"",or=e=>{const s=e.match(/^([A-Z]+)-?(\d+)-(\d+)$/);if(s){const l=s[1],o=parseInt(s[2],10),c=parseInt(s[3],10);return`${l}-${o}-${c}`}const r=e.match(/^([A-Z]+)-?/),n=e.match(/\d+/);if(!n)return e;const a=r?r[1]:"TKT",i=parseInt(n[0],10);return`${a}-${i}`};function uC(){var qh,Wh,Kh,Vh;const{id:e}=uy(),s=vr(),[r]=Bl(),n=ct(),{user:a}=ts(),[i,l]=m.useState(!1),[o,c]=m.useState(!1),[d,h]=m.useState(!1),[u,p]=m.useState(0),[j,x]=m.useState(null),[g,y]=m.useState(""),[b,f]=m.useState(!1),[v,w]=m.useState([]),N=m.useRef(null),P=m.useRef(null),z=m.useRef(null),[E,X]=m.useState(!1),[T,F]=m.useState(!1),[Q,Z]=m.useState(!1),[xe,ve]=m.useState(!1),[ke,q]=m.useState(!1),[R,G]=m.useState(!1),[K,ee]=m.useState(!1),[ae,ne]=m.useState(null),[fe,Le]=m.useState(!1),[L,ye]=m.useState(!1),[_e,_]=m.useState(!1),[Y,W]=m.useState(!1),[J,B]=m.useState(null),[me,Ie]=m.useState(!1),[pe,ie]=m.useState(!1),[U,Me]=m.useState("approve"),[Te,$]=m.useState(""),[se,le]=m.useState(250),[Ce,Ee]=m.useState(250),[We,et]=m.useState(!1),[it,kt]=m.useState(!1),[Gt,rs]=m.useState([]),[Et,ns]=m.useState(null),[Hs,Ns]=m.useState(""),[jr,As]=m.useState(null),[de,wr]=m.useState(null),[hs,Ps]=m.useState(!1),[nr,ks]=m.useState(null),{data:Ze,isLoading:I,refetch:ge}=ue({queryKey:["ticket",e],queryFn:async()=>(await Oe.get(e)).data,enabled:!!e}),{data:Fe}=ue({queryKey:["tickets"],queryFn:async()=>(await Oe.list()).data}),{data:ze,refetch:at}=ue({queryKey:["scheduledMessages",e],queryFn:async()=>(await Oe.getScheduledMessages(e)).data,enabled:!!e}),{data:Rt,isLoading:Fn,refetch:M}=ue({queryKey:["aiDraft",e],queryFn:async()=>{var k;try{return(await Oe.getAIDraft(e)).data}catch(V){if(((k=V.response)==null?void 0:k.status)===404)return null;throw V}},enabled:!!e,retry:!1}),A=Ze==null?void 0:Ze.ticket,Ae=(Ze==null?void 0:Ze.messages)||[],Pe=(Ze==null?void 0:Ze.notes)||[],Ge=(ze==null?void 0:ze.scheduledMessages)||[];let yt=(Fe==null?void 0:Fe.tickets)||[];const Ei=r.get("filter"),In=r.get("from");Ei==="my"||In==="my"?yt=yt.filter(k=>k.assigned_to==="00000000-0000-0000-0000-000000000001"):Ei==="vip"||In==="vip"?yt=yt.filter(k=>k.vip===1):In&&(yt=yt.filter(k=>k.assigned_to===In));const Wr=yt.findIndex(k=>k.ticket_id===e),S=Wr>0,je=Wr>=0&&Wr<yt.length-1,be=()=>{if(S){const k=yt[Wr-1],V=new URLSearchParams(r);k.channel==="chat"?s(`/chat-ticket/${k.ticket_id}?${V.toString()}`):s(`/tickets/${k.ticket_id}?${V.toString()}`)}},Re=()=>{if(je){const k=yt[Wr+1],V=new URLSearchParams(r);k.channel==="chat"?s(`/chat-ticket/${k.ticket_id}?${V.toString()}`):s(`/tickets/${k.ticket_id}?${V.toString()}`)}};m.useEffect(()=>{if(A&&A.channel==="chat"){const k=new URLSearchParams(r);s(`/chat-ticket/${A.ticket_id}?${k.toString()}`,{replace:!0})}},[A,s,r]),m.useEffect(()=>{p(0)},[e,d]),m.useEffect(()=>{A&&z.current&&setTimeout(()=>{var k;(k=z.current)==null||k.scrollIntoView({behavior:"smooth"})},100)},[A==null?void 0:A.ticket_id]),m.useEffect(()=>{d&&(A!=null&&A.customer_email)&&!de&&(Ps(!0),ks(null),vk.getTicketData(A.customer_email).then(k=>{wr(k.data)}).catch(k=>{var V,O;console.error("Failed to fetch Shopify data:",k),ks(((O=(V=k.response)==null?void 0:V.data)==null?void 0:O.error)||"Failed to load Shopify data")}).finally(()=>{Ps(!1)}))},[d,A==null?void 0:A.customer_email,de]);const He=k=>{const V=k.target.files;V&&(Array.from(V).forEach(O=>{if(O.size>10*1024*1024){alert(`File ${O.name} is too large. Maximum size is 10MB.`);return}const re=new FileReader;re.onload=we=>{var Ht;const Ve=(Ht=we.target)==null?void 0:Ht.result;w(On=>[...On,{name:O.name,content:Ve,type:O.type,size:O.size}])},re.readAsDataURL(O)}),N.current&&(N.current.value=""))},st=k=>{w(V=>V.filter((O,re)=>re!==k))},dt=k=>new Promise((V,O)=>{const re=new FileReader;re.readAsDataURL(k),re.onload=()=>V(re.result),re.onerror=we=>O(we)}),Lt=async k=>{const V=Array.from(k.target.files||[]);for(const O of V)if(O.size>10*1024*1024){alert(`File ${O.name} is too large. Maximum size is 10MB.`),k.target.value="";return}rs(O=>[...O,...V]),k.target.value=""},ar=k=>{rs(V=>V.filter((O,re)=>re!==k))},Ke=async()=>{var k,V,O;if(!(!g.trim()&&v.length===0||!A)){f(!0);try{console.log("Sending reply to ticket:",A.ticket_id,"with",v.length,"attachments");const re=await Oe.reply(A.ticket_id,g,v);console.log("Reply sent successfully:",re),y(""),w([]),ge()}catch(re){console.error("Failed to send reply:",re),console.error("Error details:",((k=re.response)==null?void 0:k.data)||re.message),alert(`Failed to send reply: ${((O=(V=re.response)==null?void 0:V.data)==null?void 0:O.error)||re.message||"Unknown error"}`)}finally{f(!1)}}},Mt=async()=>{var k,V;if(A)try{await Oe.delete(A.ticket_id),console.log("Ticket deleted successfully"),_(!1),s("/tickets")}catch(O){console.error("Failed to delete ticket:",O),alert(`Failed to delete ticket: ${((V=(k=O.response)==null?void 0:k.data)==null?void 0:V.error)||O.message||"Unknown error"}`)}},ba=async k=>{A&&(await Oe.updateStatus(A.ticket_id,k),ge())},Rb=async(k,V,O)=>{var re,we;if(A)try{await Oe.assign(A.ticket_id,k||""),O&&console.log("Reassignment reason:",O),F(!1),ge()}catch(Ve){console.error("Failed to reassign ticket:",Ve),alert(`Failed to reassign ticket: ${((we=(re=Ve.response)==null?void 0:re.data)==null?void 0:we.error)||Ve.message||"Unknown error"}`)}},Lb=async(k,V,O)=>{var re,we;if(A){console.log("Escalating ticket:",{level:k,staffIds:V,reason:O});try{await Oe.escalate(A.ticket_id,V,O),console.log("Ticket escalated successfully"),Z(!1),ge()}catch(Ve){console.error("Failed to escalate ticket:",Ve),alert(`Failed to escalate ticket: ${((we=(re=Ve.response)==null?void 0:re.data)==null?void 0:we.error)||Ve.message||"Unknown error"}`)}}},$b=async(k,V)=>{var we,Ve;if(!A)return;console.log("Snoozing ticket:",{duration:k,customDate:V});let O;const re=new Date;switch(k){case"30m":O=new Date(re.getTime()+30*60*1e3);break;case"3h":O=new Date(re.getTime()+3*60*60*1e3);break;case"1d":O=new Date(re.getTime()+24*60*60*1e3),O.setHours(9,0,0,0);break;case"friday":O=new Date(re);const Ht=(5-re.getDay()+7)%7||7;O.setDate(re.getDate()+Ht),O.setHours(9,0,0,0);break;case"1w":O=new Date(re.getTime()+7*24*60*60*1e3),O.setHours(9,0,0,0);break;case"custom":if(!V)return;O=new Date(V);break;default:return}try{await Oe.snooze(A.ticket_id,O.toISOString(),`Snoozed until ${O.toLocaleString()}`),console.log("Ticket snoozed successfully"),ve(!1),ge()}catch(Ht){console.error("Failed to snooze ticket:",Ht),alert(`Failed to snooze ticket: ${((Ve=(we=Ht.response)==null?void 0:we.data)==null?void 0:Ve.error)||Ht.message||"Unknown error"}`)}},Fb=async()=>{var k,V;if(A)try{await Oe.unsnooze(A.ticket_id),console.log("Snooze removed successfully"),ve(!1),ge()}catch(O){console.error("Failed to remove snooze:",O),alert(`Failed to remove snooze: ${((V=(k=O.response)==null?void 0:k.data)==null?void 0:V.error)||O.message||"Unknown error"}`)}},va=((Fe==null?void 0:Fe.tickets)||[]).filter(k=>k.customer_email===(A==null?void 0:A.customer_email)&&k.ticket_id!==(A==null?void 0:A.ticket_id)&&(k.status==="open"||k.status==="in-progress"||k.status==="snoozed")),Ib=async()=>{var k,V;if(!(!A||!J)){Ie(!0);try{await Oe.merge(A.ticket_id,[J]),console.log("Tickets merged successfully"),W(!1),B(null),ge()}catch(O){console.error("Failed to merge tickets:",O),alert(`Failed to merge tickets: ${((V=(k=O.response)==null?void 0:k.data)==null?void 0:V.error)||O.message||"Unknown error"}`)}finally{Ie(!1)}}},Ob=async()=>{var k,V;if(A&&confirm("Mark this ticket as resolved and close it?"))try{await Oe.updateStatus(A.ticket_id,"resolved"),s("/tickets")}catch(O){console.error("Failed to resolve ticket:",O),alert(`Failed to resolve ticket: ${((V=(k=O.response)==null?void 0:k.data)==null?void 0:V.error)||O.message||"Unknown error"}`)}},Db=()=>{if(!g.trim()||!A){alert("Please write a response first");return}q(!0)},zb=async(k,V)=>{var O,re;if(A)try{const we=`${k}T${V}:00`,Ve=new Date(we),Ht=Ve.toISOString();console.log("Scheduling reply:",{input:we,localDate:Ve.toString(),utcDate:Ht,serverNow:new Date().toISOString()}),await Oe.scheduleReply(A.ticket_id,g,Ht),y(""),q(!1),ge(),at()}catch(we){console.error("Failed to schedule reply:",we),alert(`Failed to schedule reply: ${((re=(O=we.response)==null?void 0:O.data)==null?void 0:re.error)||we.message||"Unknown error"}`)}},Ub=k=>{ne(k),G(!0)},Hb=async()=>{var k,V;if(ae)try{await Oe.deleteScheduledMessage(ae.id),console.log("[handleRemoveScheduledMessage] Deleted successfully"),G(!1),ne(null),ge()}catch(O){console.error("[handleRemoveScheduledMessage] Error:",O),alert(`Failed to remove scheduled message: ${((V=(k=O.response)==null?void 0:k.data)==null?void 0:V.error)||O.message||"Unknown error"}`)}},Bb=async()=>{var k,V;if(e)try{await Oe.approveAIDraft(e),ge(),M(),Me("approve"),ie(!0)}catch(O){console.error("Failed to approve AI draft:",O),alert(`Failed to approve AI draft: ${((V=(k=O.response)==null?void 0:k.data)==null?void 0:V.error)||O.message||"Unknown error"}`)}},qb=async k=>{var V,O;if(e)try{await Oe.editAIDraft(e,k),ge(),M(),Me("edit"),ie(!0)}catch(re){console.error("Failed to edit AI draft:",re),alert(`Failed to edit AI draft: ${((O=(V=re.response)==null?void 0:V.data)==null?void 0:O.error)||re.message||"Unknown error"}`)}},Wb=async k=>{var V,O;if(e)try{await Oe.rejectAIDraft(e,k),M()}catch(re){console.error("Failed to reject AI draft:",re),alert(`Failed to reject AI draft: ${((O=(V=re.response)==null?void 0:V.data)==null?void 0:O.error)||re.message||"Unknown error"}`)}},Kb=async k=>{if(e)try{await Oe.submitAIDraftFeedback(e,{...k,action:U}),console.log("Feedback submitted successfully")}catch(V){console.error("Failed to submit feedback:",V)}},Vb=async(k,V,O)=>{var re,we;if(console.log("[handleEditScheduledMessageConfirm] Called with:",{newContent:k,scheduledDate:V,scheduledTime:O,messageToEdit:ae}),!ae){console.error("[handleEditScheduledMessageConfirm] No message to edit!");return}try{const Ve=`${V}T${O}:00`,Ht=new Date(Ve),On=Ht.toISOString();console.log("[handleEditScheduledMessageConfirm] Updating:",{messageId:ae.id,input:Ve,localDate:Ht.toString(),utcDate:On,serverNow:new Date().toISOString()});const Dn=await Oe.updateScheduledMessage(ae.id,k,On);console.log("[handleEditScheduledMessageConfirm] Response:",Dn),G(!1),ne(null),ge(),at()}catch(Ve){console.error("[handleEditScheduledMessageConfirm] Error:",Ve),alert(`Failed to update message: ${((we=(re=Ve.response)==null?void 0:re.data)==null?void 0:we.error)||Ve.message||"Unknown error"}`)}},ja=k=>{var we,Ve,Ht,On;if(!A)return;let V="";const O=de==null?void 0:de.latestOrder,re=de==null?void 0:de.customer;switch(k){case"order-status":if(O){const Dn=((we=O.lineItems)==null?void 0:we.slice(0,3).map(wa=>`- ${wa.quantity}x ${wa.title}`).join(`
`))||"";V=`Hi ${A.customer_name||"there"},

I can see your order details:

Order #${O.orderNumber}
Status: ${O.fulfillmentStatus||"Unfulfilled"}
Payment: ${O.financialStatus||"Pending"}
Total: $${(Ve=O.totalPrice)==null?void 0:Ve.toFixed(2)} ${O.currency||"AUD"}
Ordered: ${new Date(O.createdAt).toLocaleDateString()}

Items:
${Dn}

Is there anything else I can help you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else V=`Hi ${A.customer_name||"there"},

I'm checking on your order status now. Let me look that up for you.

Order #: [ORDER_NUMBER]
Status: [STATUS]

Is there anything else I can help you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"tracking":O!=null&&O.trackingNumber?V=`Hi ${A.customer_name||"there"},

Here's your tracking information:

Order #${O.orderNumber}
Tracking #: ${O.trackingNumber}
${O.trackingCompany?`Carrier: ${O.trackingCompany}
`:""}${O.trackingUrl?`
Track your package: ${O.trackingUrl}`:""}

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`:O?V=`Hi ${A.customer_name||"there"},

I can see your order #${O.orderNumber} is currently ${O.fulfillmentStatus||"unfulfilled"}. Once it ships, I'll send you the tracking information right away.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`:V=`Hi ${A.customer_name||"there"},

Let me look up your tracking information for you.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"vip-wallet":if(re){const Dn=re.totalSpent>=1e3?"Platinum":re.totalSpent>=500?"Gold":re.totalSpent>=100?"Silver":"Bronze";V=`Hi ${A.customer_name||"there"},

Thank you for being a valued customer!

Customer Stats:
- Total Orders: ${re.ordersCount||0}
- Total Spent: $${((Ht=re.totalSpent)==null?void 0:Ht.toFixed(2))||"0.00"}
- VIP Tier: ${Dn}
- Member Since: ${re.createdAt?new Date(re.createdAt).toLocaleDateString():"N/A"}

Is there anything else I can assist you with?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else V=`Hi ${A.customer_name||"there"},

Let me check your customer account details.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"artwork":V=`Hi ${A.customer_name||"there"},

I've reviewed your artwork file. Here's what I found:

 Resolution: [DPI]
 Color mode: [COLOR_MODE]
 File format: [FORMAT]

Recommendations:
[RECOMMENDATIONS]

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"quote":V=`Hi ${A.customer_name||"there"},

Thank you for your quote request. Here are the details:

Product: [PRODUCT]
Quantity: [QUANTITY]
Price per unit: $[PRICE]
Total: $[TOTAL]

This quote is valid for 30 days. Would you like to proceed with the order?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;case"products":if(O!=null&&O.lineItems&&O.lineItems.length>0){const Dn=O.lineItems.map(wa=>{var Qh;return`- ${wa.title}
  Quantity: ${wa.quantity}
  Price: $${((Qh=wa.price)==null?void 0:Qh.toFixed(2))||"0.00"} each`}).join(`

`);V=`Hi ${A.customer_name||"there"},

Here are the products from your order #${O.orderNumber}:

${Dn}

Total: $${(On=O.totalPrice)==null?void 0:On.toFixed(2)} ${O.currency||"AUD"}

Is there anything else you'd like to know about these products?

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`}else V=`Hi ${A.customer_name||"there"},

Let me look up your product details for you.

Best regards,
${a?`${a.firstName} ${a.lastName}`:"Support Team"}`;break;default:return}y(V)};return m.useEffect(()=>{const k=V=>{(V.ctrlKey||V.metaKey)&&V.key==="y"&&(V.preventDefault(),Le(O=>(O||ye(!1),!O))),(V.ctrlKey||V.metaKey)&&V.key==="r"&&(V.preventDefault(),ye(O=>(O||Le(!1),!O)))};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[]),m.useEffect(()=>{const k=O=>{if(!We)return;const re=se+(window.innerHeight-O.clientY-se),we=150,Ve=window.innerHeight*.6;re>=we&&re<=Ve&&le(re)},V=()=>{et(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return We&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",k),window.addEventListener("mouseup",V)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",V)}},[We,se]),m.useEffect(()=>{const k=O=>{if(!it)return;const re=Ce+(window.innerHeight-O.clientY-Ce),we=150,Ve=window.innerHeight*.6;re>=we&&re<=Ve&&Ee(re)},V=()=>{kt(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return it&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",k),window.addEventListener("mouseup",V)),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",V)}},[it,Ce]),I?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"Loading ticket..."})}):A?t.jsxs("div",{className:"flex h-[calc(100vh-4rem)] bg-gray-50",children:[t.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[t.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Je,{to:"/tickets",className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{className:"flex items-center gap-2",children:[A.channel==="task"?t.jsx(gr,{className:"w-4 h-4 text-amber-600"}):A.channel==="phone"||(qh=A.subject)!=null&&qh.toLowerCase().includes("callback request")?t.jsx(ya,{className:"w-4 h-4 text-red-600"}):A.channel==="chat"?t.jsx(Hr,{className:"w-4 h-4 text-indigo-500"}):A.channel==="whatsapp"?t.jsx(Hr,{className:"w-4 h-4 text-green-600"}):A.channel==="facebook"?t.jsx(zh,{className:"w-4 h-4 text-blue-600"}):A.channel==="instagram"?t.jsx(Hh,{className:"w-4 h-4 text-pink-500"}):t.jsx(sr,{className:"w-4 h-4 text-gray-500"}),t.jsx("h1",{className:"text-base font-semibold text-gray-900",children:or(A.ticket_number)})]}),A.vip===1&&t.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 rounded-lg text-xs border border-yellow-200 font-medium",children:" VIP"}),t.jsx("button",{onClick:()=>X(!0),className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium hover:opacity-80 ${hg[A.status]||hg.open}`,children:A.status}),t.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${xg[A.priority]||xg.normal}`,children:A.priority}),t.jsxs("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${gg[A.sentiment]||gg.neutral}`,children:[dC[A.sentiment]||""," ",A.sentiment||"neutral"]}),A.channel==="task"&&A.sla_due_at&&t.jsxs("span",{className:`inline-flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${new Date(A.sla_due_at)<new Date?"bg-red-50 text-red-700 ring-red-600/20":"bg-amber-50 text-amber-700 ring-amber-600/20"}`,children:[t.jsx(ga,{className:"w-3 h-3"}),new Date(A.sla_due_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]}),A.related_ticket_id&&(()=>{let k=A.related_ticket_id,V=A.related_ticket_id;if(k.startsWith("@"))V=`TKT-${k.substring(1)}`;else if(!k.includes("-"))V=`TKT-${k}`,k=`@${k}`;else{const O=k.match(/^[A-Z]+-(\d+)$/);O&&(k=`@${O[1]}`)}return t.jsx(Je,{to:`/tickets?search=${V}`,className:"inline-flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-indigo-50 text-indigo-700 ring-indigo-600/20 hover:bg-indigo-100",children:k})})()]}),t.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:A.assigned_to?fg[A.assigned_to]||A.assigned_to:"Unassigned"})]}),t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:A.customer_name||A.customer_email}),t.jsx("span",{className:"text-xs text-gray-500",children:new Date(A.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[t.jsx("span",{className:"font-medium",children:"Subject:"})," ",A.subject]}),t.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[A.channel==="task"&&t.jsxs("button",{onClick:()=>ee(!0),className:"text-xs px-2 py-1 bg-amber-50 border border-amber-300 rounded-lg hover:bg-amber-100 flex items-center gap-1 text-amber-900",children:[t.jsx(gr,{className:"w-3 h-3"}),t.jsx("span",{children:"Create Sub-Task"})]}),t.jsxs("button",{onClick:()=>F(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t.jsx("span",{children:"Reassign"})]}),t.jsxs("button",{onClick:()=>Z(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsx("span",{children:"Escalate"})]}),t.jsxs("button",{onClick:()=>ve(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Snooze"})]}),t.jsxs("button",{onClick:()=>W(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",title:va.length===0?"No other tickets from this customer":`${va.length} other ticket(s) from this customer`,children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),t.jsx("span",{children:"Merge"}),va.length>0&&t.jsx("span",{className:"bg-indigo-100 text-indigo-700 px-1 rounded text-xs",children:va.length})]}),(a==null?void 0:a.role)==="admin"&&t.jsxs("button",{onClick:()=>_(!0),className:"text-xs px-2 py-1 bg-white border border-red-300 text-red-600 rounded-lg hover:bg-red-50 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsx("span",{children:"Delete"})]})]})]})]}),t.jsxs("div",{className:"p-4 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>l(!i),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[t.jsx(pn,{className:"w-3 h-3"}),t.jsx("span",{children:"Customer Info"})]}),t.jsxs("button",{onClick:()=>c(!o),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[t.jsx(kb,{className:"w-3 h-3"}),t.jsx("span",{children:"Order History"})]}),t.jsxs("button",{onClick:()=>h(!d),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${d?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[t.jsx(dl,{className:"w-3 h-3"}),t.jsx("span",{children:"Shopify"})]}),A.merged_from&&t.jsxs("div",{className:"h-7 text-xs px-2 py-1 bg-indigo-50 border border-indigo-200 rounded-lg flex items-center gap-1.5 text-indigo-900",children:[t.jsx("svg",{className:"w-3 h-3 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),t.jsxs("span",{children:[t.jsx("strong",{children:"Merged:"})," ",or(A.ticket_number)," and ",or(A.merged_from||"")]})]}),(Ze==null?void 0:Ze.relatedTasks)&&Ze.relatedTasks.length>0&&t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Ze.relatedTasks.map(k=>t.jsxs(Je,{to:`/tickets?search=${k.ticket_number}`,className:"h-7 text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[t.jsx(gr,{className:"w-3 h-3 text-amber-600"}),t.jsxs("span",{children:[or(k.ticket_number),": ",k.subject]})]},k.ticket_number))}),A.channel==="task"&&(Ze==null?void 0:Ze.subTasks)&&Ze.subTasks.length>0&&t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Ze.subTasks.map(k=>t.jsxs(Je,{to:`/tickets?search=${k.ticket_number}`,className:"h-7 text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[t.jsx(gr,{className:"w-3 h-3 text-amber-600"}),t.jsxs("span",{children:[or(k.ticket_number),": ",k.subject]})]},k.ticket_number))}),A.channel==="task"&&A.parent_task_id&&(Ze==null?void 0:Ze.parentTask)&&t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.jsxs(Je,{to:`/tickets?search=${Ze.parentTask.ticket_number}`,className:"h-7 text-xs px-2 py-1 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-1.5 text-amber-900 hover:bg-amber-100",children:[t.jsx(gr,{className:"w-3 h-3 text-amber-600"}),t.jsxs("span",{children:[or(Ze.parentTask.ticket_number),": ",Ze.parentTask.subject]})]})})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[Ge.length>0&&t.jsxs("div",{className:"h-7 text-xs px-2 py-1 bg-yellow-100 border border-yellow-300 rounded-lg flex items-center gap-1.5 font-medium text-yellow-900",title:`${Ge.length} scheduled message${Ge.length>1?"s":""}`,children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("span",{children:[Ge.length," Scheduled"]})]}),t.jsx("button",{onClick:be,disabled:!S,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(hi,{className:"w-3.5 h-3.5"})}),t.jsx("button",{onClick:Re,disabled:!je,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(Jl,{className:"w-3.5 h-3.5"})})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[i&&t.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:t.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[t.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Name:"}),t.jsx("span",{className:"ml-2 font-medium",children:A.customer_name})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"VIP:"}),t.jsx("span",{className:"ml-2 font-medium text-amber-600",children:A.vip?"Yes":"No"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Email:"}),t.jsx("span",{className:"ml-2 font-medium",children:A.customer_email})]})]})]})}),o&&t.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:t.jsxs("div",{className:"bg-white rounded-lg p-3",children:[t.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),t.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[t.jsxs("div",{className:"p-4 rounded-lg bg-gray-100",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-gray-300",children:t.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"font-medium text-sm text-gray-900",children:A.customer_name}),t.jsx("span",{className:"text-xs text-gray-400",children:A.created_at&&typeof A.created_at=="string"?Os(new Date(A.created_at.includes("Z")?A.created_at:A.created_at+"Z"),{addSuffix:!0}):""})]}),t.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:A.description})]}),Ae.map(k=>{var we;const V=k.sender_type==="customer",O=k.sender_id==="ai-agent-001",re=k.was_scheduled===!0||k.was_scheduled===1;return t.jsxs("div",{className:`p-4 rounded-lg ${V?"bg-gray-100":O?"bg-purple-50":"bg-blue-50"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${V?"bg-gray-300":O?"bg-purple-200":"bg-blue-200"}`,children:V?t.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}):O?t.jsx(Zs,{className:"w-3 h-3 text-purple-600"}):t.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"font-medium text-sm text-gray-900",children:V?k.sender_name||"Customer":O?"McCarthy AI":k.sender_name?k.sender_name.split(" ")[0]:"Staff"}),t.jsx("span",{className:"text-xs text-gray-400",children:k.created_at&&typeof k.created_at=="string"?Os(new Date(k.created_at.includes("Z")?k.created_at:k.created_at+"Z"),{addSuffix:!0}):""}),re&&!V&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-blue-100 text-blue-600 text-xs rounded",title:"This message was scheduled",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Scheduled"]})]}),t.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:k.content}),k.attachment_url&&t.jsx("div",{className:"mt-2 ml-8",children:(we=k.attachment_type)!=null&&we.startsWith("image/")?t.jsxs("a",{href:ka(k.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[t.jsx("img",{src:ka(k.attachment_url),alt:k.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300 hover:opacity-90 transition-opacity cursor-pointer"}),t.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:k.attachment_name})]}):t.jsxs("a",{href:ka(k.attachment_url),download:k.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:k.attachment_name}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",(k.attachment_size/1024).toFixed(1)," KB)"]})]})})]},k.id)}),Ge.map(k=>t.jsxs("div",{className:"p-4 rounded-lg bg-yellow-50 border border-yellow-200",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-yellow-200",children:t.jsx("svg",{className:"w-3 h-3 text-yellow-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"font-medium text-sm text-gray-900",children:k.first_name}),t.jsxs("button",{onClick:()=>Ub(k),className:"inline-flex items-center gap-1 px-2 py-0.5 bg-yellow-100 border border-yellow-300 text-yellow-800 text-xs font-medium rounded hover:bg-yellow-200 transition-colors",title:"Click to edit message and scheduled time",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Scheduled: ",new Date(k.scheduled_for).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]})]}),t.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:k.content})]},k.id)),Rt!=null&&Rt.draft?t.jsx("div",{className:"mt-4",children:t.jsx(oC,{ticketId:e,draft:Rt.draft,loading:Fn,onApprove:Bb,onEdit:qb,onReject:Wb})}):null,t.jsx("div",{ref:z})]})]}),t.jsxs("div",{className:"flex-shrink-0",children:[t.jsxs("div",{className:"border-t border-gray-200 bg-white",children:[L&&t.jsx("div",{className:"h-1 bg-gray-200 hover:bg-purple-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>et(!0),children:t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-purple-500 transition-colors"})})}),t.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-purple-50 to-purple-100 border-b border-purple-200 flex items-center gap-2 cursor-pointer hover:from-purple-100 hover:to-purple-150 transition-colors",onClick:()=>{ye(k=>(k||Le(!1),!k))},children:[t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Response Area"}),t.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+R"})]}),L&&t.jsxs("div",{className:"p-4 flex flex-col",style:{height:`${se}px`},children:[v.length>0&&t.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:v.map((k,V)=>t.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-gray-100 rounded-lg text-xs",children:[t.jsx(St,{className:"w-3 h-3 text-gray-500"}),t.jsx("span",{className:"max-w-[150px] truncate",children:k.name}),t.jsx("button",{onClick:()=>st(V),className:"text-gray-400 hover:text-red-500",children:t.jsx(_t,{className:"w-3 h-3"})})]},V))}),t.jsx("div",{className:"flex-1 mb-2 min-h-0",children:t.jsx("textarea",{value:g,onChange:k=>y(k.target.value),placeholder:"Type your response...",className:"w-full h-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-indigo-500 resize-none min-h-0"})}),t.jsxs("div",{className:"space-y-3 flex-shrink-0",children:[t.jsx("input",{type:"file",ref:N,onChange:He,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>{var k;return(k=N.current)==null?void 0:k.click()},className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx(St,{className:"w-3 h-3"}),"Attach File"]}),t.jsx("button",{className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" All Templates"}),t.jsx("button",{onClick:()=>ja("order-status"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @order-status"}),t.jsx("button",{onClick:()=>ja("tracking"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @tracking"}),t.jsx("button",{onClick:()=>ja("vip-wallet"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @vip-wallet"}),t.jsx("button",{onClick:()=>ja("artwork"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @artwork"}),t.jsx("button",{onClick:()=>ja("quote"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" @quote"}),t.jsx("button",{onClick:()=>ja("products"),className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" Products"}),t.jsx("button",{className:"text-xs px-2.5 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" Generate Invoice"})]}),t.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[t.jsxs("button",{onClick:Ke,disabled:!g.trim()&&v.length===0||b,className:"px-4 py-2 text-sm bg-purple-200 text-purple-800 border border-purple-300 rounded-lg hover:bg-purple-300 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),b?"Sending...":`Send Reply${v.length>0?` (${v.length})`:""}`]}),t.jsxs("button",{onClick:Db,className:"px-4 py-2 text-sm bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 font-medium flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Schedule Reply"]}),t.jsxs("button",{onClick:Ob,className:"px-4 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 font-medium flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Resolve & Close"]})]})]})]})]}),t.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[fe&&t.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>kt(!0),children:t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),t.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>{Le(k=>(k||ye(!1),!k))},children:[t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),t.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),t.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),fe&&t.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${Ce}px`},children:[Pe&&Pe.length>0&&t.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:Pe.map(k=>{var V;return t.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-xs font-medium text-gray-800",children:k.first_name||"Staff"}),t.jsx("span",{className:"text-xs text-gray-500",children:k.created_at&&typeof k.created_at=="string"?Os(new Date(k.created_at.includes("Z")?k.created_at:k.created_at+"Z"),{addSuffix:!0}):""}),k.edited_at&&t.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[(k.staff_id===(a==null?void 0:a.id)||(a==null?void 0:a.role)==="admin")&&Et!==k.id&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{ns(k.id),Ns(k.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),t.jsx("button",{onClick:()=>As(k.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]}),k.note_type==="escalation"&&k.escalated_to===(a==null?void 0:a.id)&&(k.escalation_status==="pending"?t.jsx("button",{type:"button",onClick:async()=>{var O,re;if(!(!A||!k.escalation_id))try{await Oe.resolveEscalation(A.ticket_id,k.escalation_id),ge()}catch(we){console.error("Failed to resolve escalation:",we),alert(`Failed to resolve escalation: ${((re=(O=we.response)==null?void 0:O.data)==null?void 0:re.error)||we.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Resolve"}):k.escalation_status==="resolved"&&k.resolved_at?t.jsxs("span",{className:"text-xs text-green-600 font-medium",children:["Resolved: ",new Date(k.resolved_at).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})]}):null)]})]}),Et===k.id?t.jsxs("div",{className:"space-y-2",children:[t.jsx("textarea",{value:Hs,onChange:O=>Ns(O.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:async()=>{var O,re;if(!(!A||!Hs.trim()))try{await Oe.editNote(A.ticket_id,k.id,Hs),ns(null),Ns(""),n.invalidateQueries({queryKey:["ticket",e]})}catch(we){console.error("Failed to edit note:",we),alert(`Failed to edit note: ${((re=(O=we.response)==null?void 0:O.data)==null?void 0:re.error)||we.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),t.jsx("button",{onClick:()=>{ns(null),Ns("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):t.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:(()=>{let O=k.content||"";return O.includes("MERGE_TIMESTAMP:")&&(O=O.replace(/MERGE_TIMESTAMP:([^\n]+)\n?/g,(re,we)=>{try{return new Date(we.trim()).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})+`
`}catch{return""}})),O.includes("SCHEDULE_TIME:")&&(O=O.replace(/SCHEDULE_TIME:([^\s]+)/g,(re,we)=>{try{return new Date(we.trim()).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return we}})),O.includes("SNOOZE_TIME:")&&(O=O.replace(/SNOOZE_TIME:(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?)/g,(re,we)=>{try{return new Date(we.trim()).toLocaleString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return we}})),O.includes("BULK_REASSIGN_TIME:")&&(O=O.replace(/BULK_REASSIGN_TIME:(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?)/g,(re,we)=>{try{return new Date(we.trim()).toLocaleString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return we}})),O})()}),k.tags&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(k.tags).map((O,re)=>t.jsxs(Je,{to:`/tags?search=${encodeURIComponent(O)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[t.jsx(Ot,{className:"w-3 h-3 mr-1"}),O]},re))}),k.attachment_url&&t.jsx("div",{className:"mt-2",children:(V=k.attachment_type)!=null&&V.startsWith("image/")?t.jsxs("a",{href:ka(k.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[t.jsx("img",{src:ka(k.attachment_url),alt:k.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),t.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:k.attachment_name})]}):t.jsxs("a",{href:ka(k.attachment_url),download:k.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:k.attachment_name}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",(k.attachment_size/1024).toFixed(1)," KB)"]})]})})]},k.id)})}),jr&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),t.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[t.jsx("button",{onClick:()=>As(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),t.jsx("button",{onClick:async()=>{var k,V;if(A)try{await Oe.deleteNote(A.ticket_id,jr),As(null),n.invalidateQueries({queryKey:["ticket",e]})}catch(O){console.error("Failed to delete note:",O),alert(`Failed to delete note: ${((V=(k=O.response)==null?void 0:k.data)==null?void 0:V.error)||O.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),t.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[Gt.length>0&&t.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:Gt.map((k,V)=>t.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[t.jsx(St,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-[150px] truncate",children:k.name}),t.jsx("button",{onClick:()=>ar(V),className:"text-red-500 hover:text-red-700",children:t.jsx(_t,{className:"w-3 h-3"})})]},V))}),t.jsx("textarea",{value:Te,onChange:k=>$(k.target.value),onKeyDown:async k=>{var V,O;if(k.key==="Enter"&&!k.shiftKey&&Te.trim()&&A){k.preventDefault(),console.log("[Staff Notes] Submitting note");try{const re=await Promise.all(Gt.map(async we=>({name:we.name,content:await dt(we),type:we.type,size:we.size})));await Oe.addNote(A.ticket_id,Te,void 0,re.length>0?re:void 0),$(""),rs([]),ge()}catch(re){console.error("Failed to add note:",re),alert(`Failed to add note: ${((O=(V=re.response)==null?void 0:V.data)==null?void 0:O.error)||re.message||"Unknown error"}`)}}},placeholder:"Add internal notes... Use @to mention staff, #keyword to add tags (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),t.jsx("input",{type:"file",ref:P,onChange:Lt,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),t.jsxs("button",{onClick:()=>{var k;return(k=P.current)==null?void 0:k.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[t.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]})]}),t.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${d?"w-96":"w-0"}`,children:d&&t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(dl,{className:"w-5 h-5 text-green-600"}),t.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),t.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),hs&&t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}),nr&&t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:[t.jsx("p",{className:"text-sm text-red-600",children:nr}),t.jsx("button",{onClick:()=>{wr(null),ks(null)},className:"text-xs text-red-700 underline mt-2",children:"Try again"})]}),de&&!de.configured&&t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:t.jsx("p",{className:"text-sm text-yellow-700",children:de.message})}),de&&de.configured&&!de.customer&&t.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:t.jsx("p",{className:"text-sm text-gray-600",children:de.message||"Customer not found in Shopify"})}),de&&de.customer&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[de.customer.firstName," ",de.customer.lastName]}),t.jsx("p",{className:"text-xs text-gray-500",children:de.customer.email}),de.customer.phone&&t.jsx("p",{className:"text-xs text-gray-500",children:de.customer.phone}),de.customer.isVIP&&t.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),t.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),t.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((Wh=de.customer.totalSpent)==null?void 0:Wh.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),t.jsx("span",{className:"font-semibold text-gray-900",children:de.customer.ordersCount||0})]}),de.customer.lastOrderDate&&t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{className:"text-gray-500",children:"Last Order:"}),t.jsx("span",{className:"text-gray-900",children:new Date(de.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),de.orders&&de.orders.length>0?t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",u+1," OF ",de.orders.length]}),de.orders.length>1&&t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:()=>p(Math.max(0,u-1)),disabled:u===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("button",{onClick:()=>p(Math.min(de.orders.length-1,u+1)),disabled:u===de.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",de.orders[u].orderNumber]}),t.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${de.orders[u].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":de.orders[u].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:de.orders[u].fulfillmentStatus||"Unfulfilled"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",t.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(Kh=de.orders[u].totalPrice)==null?void 0:Kh.toFixed(2)," ",de.orders[u].currency]})]})]})]}),t.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Created:"}),t.jsx("span",{className:"text-gray-900",children:new Date(de.orders[u].createdAt).toLocaleDateString()})]}),t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Payment:"}),t.jsx("span",{className:`font-medium ${de.orders[u].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:de.orders[u].financialStatus||"Pending"})]})]}),de.orders[u].lineItems&&de.orders[u].lineItems.length>0&&t.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),t.jsx("div",{className:"space-y-2",children:de.orders[u].lineItems.map((k,V)=>{var O;return t.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[t.jsxs("button",{onClick:()=>x(j===k.id?null:k.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:k.title}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("span",{className:"text-xs text-gray-500",children:["x",k.quantity]}),t.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${j===k.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),j===k.id&&t.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Price:"}),t.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(O=k.price)==null?void 0:O.toFixed(2)]})]}),k.sku&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"SKU:"}),t.jsx("span",{className:"text-gray-900 font-mono",children:k.sku})]}),k.variantTitle&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Variant:"}),t.jsx("span",{className:"text-gray-900",children:k.variantTitle})]}),k.customAttributes&&k.customAttributes.length>0&&t.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[t.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),k.customAttributes.map((re,we)=>t.jsxs("div",{className:"flex justify-between py-0.5",children:[t.jsxs("span",{className:"text-gray-500",children:[re.key.replace("_",""),":"]}),re.key.includes("Link")||re.key.includes("link")?t.jsx("a",{href:re.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:Ve=>Ve.stopPropagation(),children:"View "}):t.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:re.value})]},we))]})]})]},k.id||V)})})]})]})]}):t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),t.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),de.orders&&((Vh=de.orders[u])==null?void 0:Vh.trackingNumber)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),t.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:de.orders[u].trackingNumber}),de.orders[u].trackingCompany&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",t.jsx("span",{className:"text-gray-900",children:de.orders[u].trackingCompany})]})]}),de.orders[u].trackingUrl&&t.jsx("a",{href:de.orders[u].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]}),!hs&&!nr&&!de&&t.jsxs("div",{className:"text-center py-8",children:[t.jsx(dl,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})]})]})}),E&&t.jsx(rC,{currentStatus:A.status,onClose:()=>X(!1),onSave:ba}),t.jsx(Tb,{isOpen:T,onClose:()=>F(!1),onReassign:Rb,currentAssignment:A.assigned_to?fg[A.assigned_to]:void 0}),t.jsx(nC,{isOpen:Q,onClose:()=>Z(!1),onConfirm:Lb,ticketNumber:A.ticket_number}),t.jsx(aC,{isOpen:xe,onClose:()=>ve(!1),onConfirm:$b,onRemoveSnooze:Fb,ticketNumber:A.ticket_number,isSnoozed:A.status==="snoozed"}),t.jsx(iC,{isOpen:ke,onClose:()=>q(!1),onConfirm:zb}),t.jsx(lC,{isOpen:R,onClose:()=>{G(!1),ne(null)},onConfirm:Vb,onRemove:Hb,message:ae}),_e&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Ticket"}),t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Are you sure you want to delete ticket ",t.jsx("span",{className:"font-medium",children:or(A.ticket_number)}),"? This action cannot be undone."]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:Mt,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Delete Ticket"})]})]})}),t.jsx(cC,{isOpen:pe,onClose:()=>ie(!1),onSubmit:Kb}),Y&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Merge Tickets"}),t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Select a ticket to merge into ",t.jsx("span",{className:"font-medium",children:or(A.ticket_number)})," (primary).",t.jsx("br",{}),t.jsxs("span",{className:"text-xs text-gray-500",children:["Only showing tickets from: ",A.customer_email]})]}),va.length===0?t.jsxs("div",{className:"py-8 text-center text-gray-500",children:[t.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm",children:"No other open tickets from this customer"})]}):t.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 mb-4",children:va.map(k=>t.jsxs("label",{className:`flex items-start p-3 rounded-lg border cursor-pointer transition-colors ${J===k.ticket_id?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"}`,children:[t.jsx("input",{type:"radio",name:"mergeTicket",value:k.ticket_id,checked:J===k.ticket_id,onChange:()=>B(k.ticket_id),className:"mt-1 mr-3 text-purple-600 focus:ring-purple-500"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"font-medium text-sm text-gray-900",children:or(k.ticket_number)}),t.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${k.status==="snoozed"?"bg-purple-100 text-purple-700":k.status==="in-progress"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:k.status}),t.jsx("span",{className:"text-xs text-gray-400",children:Os(new Date(k.created_at),{addSuffix:!0})})]}),t.jsx("p",{className:"text-sm text-gray-600 truncate",children:k.subject})]})]},k.ticket_id))}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[t.jsx("button",{onClick:()=>{W(!1),B(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:Ib,disabled:!J||me,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:me?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Merging..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Merge into ",or(A.ticket_number)]})})]})]})}),t.jsx(Ab,{isOpen:K,onClose:()=>{ee(!1),ge()},parentTaskId:A==null?void 0:A.ticket_id,parentTaskNumber:A==null?void 0:A.ticket_number})]}):t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"Ticket not found"})})}function mC(){var U,Me,Te;const e=vr(),s=ct(),r=ts($=>$.user),[n,a]=m.useState(null),[i,l]=m.useState(!1),[o,c]=m.useState([]),[d,h]=m.useState(null),u=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager",[p,j]=m.useState("my-mentions"),[x,g]=m.useState(""),[y,b]=m.useState(""),[f,v]=m.useState(""),[w,N]=m.useState(""),[P,z]=m.useState("all"),[E,X]=m.useState("active"),[T,F]=m.useState(""),[Q,Z]=m.useState(""),[xe,ve]=m.useState(""),{data:ke}=ue({queryKey:["staff-users"],queryFn:async()=>(await rt.list()).data}),q=$e.useMemo(()=>[...(ke==null?void 0:ke.staff)||[],{id:"ai-agent-001",firstName:"McCarthy",lastName:"AI",email:"mccarthy@dartmouth.ai"}],[ke]),{data:R,isLoading:G}=ue({queryKey:["mentions",p,x,y,f,w,P,E,T,Q],queryFn:async()=>{const $={};return p==="my-mentions"||(p==="all-mentions"&&u?$.view_all=!0:p==="by-staff"&&x?$.mentioned_staff_id=x:p==="by-ticket"&&y&&($.ticket_number=y)),f&&($.channel_id=f),w&&w!=="all"&&($.time_filter=w),P==="unread"&&($.is_read=!1),P==="read"&&($.is_read=!0),E==="archived"&&($.is_archived=!0),E==="active"&&($.is_archived=!1),T&&($.start_date=T),Q&&($.end_date=Q),(await zn.getMentions($)).data},refetchInterval:3e4,refetchOnWindowFocus:!1}),K=(R==null?void 0:R.mentions)||[],ee=$e.useMemo(()=>{if(!xe.trim())return K;const $=xe.toLowerCase().trim();return K.filter(se=>{var Ee,We,et,it;const le=(Ee=$.match(/\d+/))==null?void 0:Ee[0];if(le&&se.message_content){const kt=se.message_content.toLowerCase();if([`@${le}`,`#${le}`,`*${le}`,`ticket ${le}`,`tkt-${le}`,`tkt-000${le}`,`tsk-${le}`,`tsk-000${le}`].some(rs=>kt.includes(rs))||kt.includes(le))return!0}return!!(le&&se.ticket_number&&((We=se.ticket_number.match(/\d+/))==null?void 0:We[0])===le||`${se.mentioning_first_name} ${se.mentioning_last_name}`.toLowerCase().includes($)||(et=se.message_content)!=null&&et.toLowerCase().includes($)||(it=se.channel_name)!=null&&it.toLowerCase().includes($))})},[K,xe]);$e.useEffect(()=>{ee.length>0&&!n&&a(ee[0])},[ee]),$e.useEffect(()=>{n&&ee.find($=>$.id===n.id)},[n]);const ae=()=>{if(!n||ee.length===0)return;const $=ee.findIndex(se=>se.id===n.id);if($>0){const se=ee[$-1];a(se)}},ne=()=>{if(!n||ee.length===0)return;const $=ee.findIndex(se=>se.id===n.id);if($<ee.length-1){const se=ee[$+1];a(se)}},fe=n?ee.findIndex($=>$.id===n.id):-1,{data:Le}=ue({queryKey:["mentions-unread-count"],queryFn:async()=>(await zn.getUnreadCount()).data,refetchInterval:5e3}),L=(Le==null?void 0:Le.count)||0,{data:ye}=ue({queryKey:["group-chat-channels"],queryFn:async()=>(await xt.listChannels()).data}),_e=(ye==null?void 0:ye.channels)||[],_=Ne({mutationFn:async $=>{console.log("[Mentions] Marking as read:",$);const se=await zn.markAsRead($);return console.log("[Mentions] Mark as read response:",se),se},onMutate:async $=>{console.log("[Mentions] onMutate - marking as read:",$);const se=["mentions",p,x,y,f,w,P,E,T,Q];await s.cancelQueries({queryKey:se});const le=s.getQueryData(se);return s.setQueryData(se,Ce=>Ce!=null&&Ce.mentions?{...Ce,mentions:Ce.mentions.map(Ee=>Ee.id===$?{...Ee,is_read:1,read_at:new Date().toISOString()}:Ee)}:Ce),n&&n.id===$&&a({...n,is_read:1,read_at:new Date().toISOString()}),{previousMentions:le,currentQueryKey:se}},onError:($,se,le)=>{console.error("[Mentions] Error marking as read:",$),s.setQueryData(le.currentQueryKey,le.previousMentions),s.invalidateQueries({queryKey:le.currentQueryKey}),s.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{console.log("[Mentions] Successfully marked as read"),s.invalidateQueries({queryKey:["mentions-unread-count"]})}}),Y=Ne({mutationFn:async $=>{console.log("[Mentions] Marking as unread:",$);const se=await zn.markAsUnread($);return console.log("[Mentions] Mark as unread response:",se),se},onMutate:async $=>{const se=["mentions",p,x,y,f,w,P,E,T,Q];await s.cancelQueries({queryKey:se});const le=s.getQueryData(se);return s.setQueryData(se,Ce=>Ce!=null&&Ce.mentions?{...Ce,mentions:Ce.mentions.map(Ee=>Ee.id===$?{...Ee,is_read:0,read_at:null}:Ee)}:Ce),n&&n.id===$&&a({...n,is_read:0,read_at:null}),{previousMentions:le,currentQueryKey:se}},onError:($,se,le)=>{s.setQueryData(le.currentQueryKey,le.previousMentions),s.invalidateQueries({queryKey:le.currentQueryKey}),s.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{s.invalidateQueries({queryKey:["mentions-unread-count"]})}}),W=Ne({mutationFn:async $=>{const se=$.mentionIds.map(le=>$.isRead?zn.markAsRead(le):zn.markAsUnread(le));return Promise.all(se)},onMutate:async $=>{const se=["mentions",p,x,y,f,w,P,E,T,Q];await s.cancelQueries({queryKey:se});const le=s.getQueryData(se);return s.setQueryData(se,Ce=>Ce!=null&&Ce.mentions?{...Ce,mentions:Ce.mentions.map(Ee=>$.mentionIds.includes(Ee.id)?{...Ee,is_read:$.isRead?1:0,read_at:$.isRead?new Date().toISOString():null}:Ee)}:Ce),{previousMentions:le,currentQueryKey:se}},onError:($,se,le)=>{s.setQueryData(le.currentQueryKey,le.previousMentions),s.invalidateQueries({queryKey:le.currentQueryKey}),s.invalidateQueries({queryKey:["mentions-unread-count"]})},onSuccess:()=>{c([]),s.invalidateQueries({queryKey:["mentions-unread-count"]})}}),J=Ne({mutationFn:async()=>{const se=K.filter(le=>le.is_read===1&&le.is_archived===0).map(le=>zn.archiveMention(le.id));return Promise.all(se)},onSuccess:()=>{s.invalidateQueries({queryKey:["mentions"]})}}),B=($,se)=>{if(console.log("[MentionsPage] Clicking mention:",$.id),se!=null&&se.shiftKey&&d!==null){const le=ee.findIndex(et=>et.id===$.id),Ce=Math.min(d,le),Ee=Math.max(d,le),We=ee.slice(Ce,Ee+1).map(et=>et.id);c(We)}else se!=null&&se.ctrlKey||se!=null&&se.metaKey?(c(le=>le.includes($.id)?le.filter(Ce=>Ce!==$.id):[...le,$.id]),h(ee.findIndex(le=>le.id===$.id))):(c([]),h(ee.findIndex(le=>le.id===$.id)),a($))},me=()=>{n&&(n.context_type==="group_chat"?e(`/group-chat?channel=${n.context_id}&message=${n.message_id}`):n.ticket_id&&e(`/tickets/${n.ticket_id}`))},Ie=$=>{if(!$)return"";const se=$.match(/\d+/);return se?`@${parseInt(se[0],10)}`:$},pe=($,se="w-3 h-3")=>{switch($){case"email":return t.jsx(sr,{className:se});case"phone":case"callback":return t.jsx(ya,{className:`${se} text-red-600`});case"chat":return t.jsx(Hr,{className:se});case"whatsapp":case"facebook":case"instagram":return t.jsx(H3,{className:se});default:return t.jsx(Hr,{className:se})}},ie=$=>{if(!$)return null;const se=/(@(\d+)|TKT-(\d+)|ticket\s+(\d+)|#(\d+)|\*(\d+)(?:-(\d+))?|TSK-(\d+)(?:-(\d+))?)/gi,le=[];let Ce=0,Ee;for(;(Ee=se.exec($))!==null;){Ee.index>Ce&&le.push({text:$.substring(Ce,Ee.index),isTicket:!1});const We=Ee[2]||Ee[3]||Ee[4]||Ee[5],et=Ee[6]||Ee[8],it=Ee[7]||Ee[9],kt=et!==void 0,Gt=kt?et:We;le.push({text:Ee[0],isTicket:!kt,ticketNumber:Gt,isTask:kt,subTaskNumber:it}),Ce=Ee.index+Ee[0].length}return Ce<$.length&&le.push({text:$.substring(Ce),isTicket:!1}),le.length===0?t.jsx("span",{children:$}):t.jsx("span",{children:le.map((We,et)=>We.isTicket||We.isTask?t.jsx("a",{href:We.isTask?`/tickets?search=${We.subTaskNumber?`TSK-${We.ticketNumber}-${We.subTaskNumber}`:`TSK-${We.ticketNumber}`}`:`/tickets?search=TKT-${We.ticketNumber}`,target:"_blank",rel:"noopener noreferrer",className:We.isTask?"text-amber-600 hover:text-amber-800 hover:underline font-medium cursor-pointer":"text-blue-600 hover:text-blue-800 hover:underline font-medium cursor-pointer",onClick:it=>{it.stopPropagation()},children:We.text},et):t.jsx("span",{children:We.text},et))})};return t.jsxs("div",{className:"flex h-full",children:[t.jsxs("div",{className:"w-96 bg-white flex flex-col h-full border-r border-gray-200",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(Ui,{className:"w-6 h-6"}),"Mentions",p==="all-mentions"&&u&&t.jsx("span",{title:"Admin View",children:t.jsx(aS,{className:"w-5 h-5 text-blue-600"})})]}),L>0&&p==="my-mentions"&&t.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:L})]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[p==="my-mentions"&&"Messages where you were mentioned",p==="all-mentions"&&u&&"All mentions (Admin view)",p==="by-staff"&&x&&`Mentions for ${((U=q.find($=>$.id===x))==null?void 0:U.firstName)||"staff member"}`,p==="by-staff"&&!x&&"Select a staff member to view their mentions",p==="by-ticket"&&y&&`Mentions in ${y}`,p==="by-ticket"&&!y&&"Enter a ticket number to view mentions"]}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[xe?`${ee.length} of ${K.length}`:`${K.length}`," mention",K.length!==1?"s":""," ",xe?"matching":"found"]})]}),t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-white",children:t.jsxs("div",{className:"relative",children:[t.jsx(xi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",value:xe,onChange:$=>ve($.target.value),placeholder:"Search by ticket (@261), task (*123), staff name, or message...",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),xe&&t.jsx("button",{onClick:()=>ve(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:"Clear search",children:t.jsx(_t,{className:"w-4 h-4"})})]})}),t.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 text-sm font-semibold text-gray-700 hover:text-gray-900",children:[t.jsx(jb,{className:"w-4 h-4"}),"Filters ",i?"":""]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsxs("button",{onClick:()=>{o.length>0?W.mutate({mentionIds:o,isRead:!1}):z("unread")},className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors ${P==="unread"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:o.length>0?`Mark ${o.length} as unread`:"Show unread only",children:["Unread (",K.filter($=>$.is_read===0&&$.is_archived===0).length,")"]}),t.jsxs("button",{onClick:()=>{o.length>0?W.mutate({mentionIds:o,isRead:!0}):z("read")},className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors ${P==="read"?"bg-gray-100 text-gray-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:o.length>0?`Mark ${o.length} as read`:"Show read only",children:["Read (",K.filter($=>$.is_read===1&&$.is_archived===0).length,")"]}),t.jsx("button",{onClick:()=>{E==="archived"?X("active"):J.mutate()},disabled:J.isPending,className:"px-2 py-0.5 text-xs font-medium rounded-full transition-colors bg-pink-100 text-pink-700 hover:bg-pink-200 disabled:opacity-50",title:"Archive all Read mentions",children:"Archive"})]})]}),o.length>0?t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[" ",o.length," selected  Click pill to toggle read/unread"]}):t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:" Shift+Click: Select range  Ctrl/Cmd+Click: Toggle selection"}),!i&&t.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[p!==(u?"all-mentions":"my-mentions")&&t.jsxs("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:[p==="my-mentions"&&"My Mentions",p==="all-mentions"&&"All Mentions",p==="by-staff"&&x&&`Staff: ${(Me=q.find($=>$.id===x))==null?void 0:Me.firstName}`,p==="by-ticket"&&y&&`Ticket: ${y}`]}),f&&t.jsxs("span",{className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full",children:["#",((Te=_e.find($=>$.id===f))==null?void 0:Te.name)||"Channel"]}),P!=="all"&&t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${P==="unread"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:P==="unread"?"Unread":"Read"}),w&&w!==""&&t.jsxs("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded-full",children:[w==="hour"&&"Last hour",w==="12hours"&&"Last 12h",w==="24hours"&&"Last 24h",w==="custom"&&"Custom dates"]}),!f&&P==="all"&&!w&&p===(u?"all-mentions":"my-mentions")&&t.jsx("span",{className:"text-xs text-gray-500 italic",children:"No filters applied"})]}),i&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"View"}),t.jsxs("select",{value:p,onChange:$=>{j($.target.value),g(""),b("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"my-mentions",children:"My Mentions"}),u&&t.jsx("option",{value:"all-mentions",children:"All Mentions (Admin)"}),t.jsx("option",{value:"by-staff",children:"By Staff Member"}),t.jsx("option",{value:"by-ticket",children:"By Ticket Number"})]})]}),p==="by-staff"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Staff Member"}),t.jsxs("select",{value:x,onChange:$=>g($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Select staff member..."}),q.map($=>t.jsxs("option",{value:$.id,children:[$.firstName," ",$.lastName]},$.id))]})]}),p==="by-ticket"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Ticket Number"}),t.jsx("input",{type:"text",value:y,onChange:$=>b($.target.value),placeholder:"e.g., TKT-000261",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Channel"}),t.jsxs("select",{value:f,onChange:$=>v($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All channels"}),_e.map($=>t.jsxs("option",{value:$.id,children:["#",$.name]},$.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Status"}),t.jsxs("select",{value:P,onChange:$=>z($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"unread",children:"Unread only"}),t.jsx("option",{value:"read",children:"Read only"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Archive"}),t.jsxs("select",{value:E,onChange:$=>X($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"active",children:"Active mentions"}),t.jsx("option",{value:"archived",children:"All Archived"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Time Range"}),t.jsxs("select",{value:w,onChange:$=>N($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All time"}),t.jsx("option",{value:"hour",children:"Last hour"}),t.jsx("option",{value:"12hours",children:"Last 12 hours"}),t.jsx("option",{value:"24hours",children:"Last 24 hours"}),t.jsx("option",{value:"custom",children:"Custom date range"})]})]}),w==="custom"&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"From"}),t.jsx("input",{type:"date",value:T,onChange:$=>F($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"To"}),t.jsx("input",{type:"date",value:Q,onChange:$=>Z($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsx("button",{onClick:()=>{j(u?"all-mentions":"my-mentions"),g(""),b(""),v(""),N(""),z("all"),F(""),Z("")},className:"w-full px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg border border-gray-300",children:"Clear All Filters"})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:G?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("div",{className:"text-gray-500",children:"Loading mentions..."})}):ee.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[t.jsx(Ui,{className:"w-16 h-16 text-gray-300 mb-4"}),t.jsx("p",{className:"text-gray-500 font-medium",children:"No mentions yet"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"When someone mentions you with @yourname, it will appear here"})]}):t.jsx("div",{className:"divide-y divide-gray-200",children:ee.map($=>{const se=(n==null?void 0:n.id)===$.id,le=o.includes($.id),Ce=$.is_read===0;let Ee="",We="";return le?(Ee="bg-indigo-100",We="border-indigo-500"):se?(Ee=Ce?"bg-blue-100":"bg-gray-100",We=Ce?"border-blue-500":"border-gray-500",console.log("[MentionsPage] Selected mention:",$.id,"border:",We)):(Ee=Ce?"bg-blue-50":"bg-white",We="border-transparent"),t.jsxs("button",{onClick:et=>B($,et),style:{borderLeft:le?"6px solid #6366f1":se?Ce?"6px solid #3b82f6":"6px solid #6b7280":"6px solid transparent"},className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${Ee} relative`,children:[le&&t.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-indigo-600 rounded flex items-center justify-center",children:t.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[$.context_type==="group_chat"?t.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-indigo-100 text-indigo-700 rounded-full",children:[t.jsx(Ot,{className:"w-3 h-3"}),$.channel_name]}):t.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-purple-100 text-purple-700 rounded-full",children:[pe($.ticket_channel),Ie($.ticket_number)]}),t.jsxs("span",{className:"inline-flex items-center gap-0.5 px-2 py-0.5 text-xs font-medium bg-orange-50 text-orange-600 rounded-full",children:[t.jsx(Ui,{className:"w-3 h-3"}),"Mention by ",$.mentioning_first_name]}),t.jsx("span",{className:"text-xs text-gray-600",children:new Date($.created_at).toLocaleString()}),$.is_read===0?t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-semibold bg-blue-100 text-blue-700 rounded-full",children:[t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Unread"]}):t.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-emerald-100 text-emerald-700 rounded-full",children:" Read"})]}),$.message_content&&t.jsx("div",{className:`text-sm line-clamp-2 ${$.is_read===0?"text-gray-900 font-medium":"text-gray-600"}`,children:ie($.message_content)}),$.attachment_url&&t.jsxs("div",{onClick:et=>{et.stopPropagation(),$.context_type==="group_chat"&&e(`/group-chat?channel=${$.context_id}&message=${$.message_id}`)},className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 mt-1 cursor-pointer",children:[t.jsx(St,{className:"w-3 h-3"}),t.jsx("span",{className:"hover:underline",children:$.attachment_name||"Attachment"})]})]})]},$.id)})})})]}),t.jsx("div",{className:"flex-1 bg-white flex flex-col h-full",children:n?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.context_type==="group_chat"?t.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-700 rounded-full",children:[t.jsx(Ot,{className:"w-3.5 h-3.5"}),n.channel_name]}):t.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-purple-100 text-purple-700 rounded-full",children:[pe(n.ticket_channel,"w-3.5 h-3.5"),Ie(n.ticket_number)]}),t.jsxs("span",{className:"inline-flex items-center gap-0.5 px-3 py-1 text-sm font-medium bg-orange-50 text-orange-600 rounded-full",children:[t.jsx(Ui,{className:"w-3.5 h-3.5"}),"Mention by ",n.mentioning_first_name]}),t.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-medium bg-slate-100 text-slate-700 rounded-full",children:[t.jsx(yb,{className:"w-3.5 h-3.5"}),new Date(n.created_at).toLocaleString()]}),n.is_read===0?t.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-semibold bg-blue-100 text-blue-700 rounded-full",children:[t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Unread"]}):t.jsx("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-medium bg-emerald-100 text-emerald-700 rounded-full",children:" Read"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:ae,disabled:fe===0,className:"p-1.5 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",title:"Previous mention",children:t.jsx(hi,{className:"w-4 h-4"})}),t.jsx("button",{onClick:ne,disabled:fe===ee.length-1,className:"p-1.5 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",title:"Next mention",children:t.jsx(Jl,{className:"w-4 h-4"})}),n.is_read===1?t.jsx("button",{onClick:()=>Y.mutate(n.id),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg border border-gray-300",children:"Mark as Unread"}):t.jsx("button",{onClick:()=>_.mutate(n.id),className:"px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded-lg border border-blue-300",children:"Mark as Read"}),t.jsxs("button",{onClick:me,className:"px-3 py-1.5 text-sm bg-blue-600 text-white hover:bg-blue-700 rounded-lg flex items-center gap-1",children:[t.jsx(cl,{className:"w-4 h-4"}),"Go to Chat"]})]})]})}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t.jsxs("div",{className:"max-w-3xl",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Message"}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[t.jsx("div",{className:"text-gray-900 whitespace-pre-wrap text-base leading-relaxed",children:n.message_content?ie(n.message_content):"No message content available"}),n.attachment_url&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[t.jsxs("button",{onClick:()=>{n.context_type==="group_chat"&&e(`/group-chat?channel=${n.context_id}&message=${n.message_id}`)},className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 hover:underline",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:n.attachment_name||"Attachment"}),n.attachment_size&&t.jsxs("span",{className:"text-xs text-gray-500",children:["(",(n.attachment_size/1024).toFixed(1)," KB)"]})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-1 ml-6",children:"Click to view in Group Chat"})]})]})]})})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Ui,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 font-medium",children:"Select a mention to view details"})]})})})]})}function hC(){const e=ct(),s=m.useRef(null),r=m.useRef(null),[n,a]=m.useState(""),[i,l]=m.useState(null),[o,c]=m.useState(null),[d,h]=m.useState(""),[u,p]=m.useState(!1),[j,x]=m.useState(null),[g,y]=m.useState(""),[b,f]=m.useState([]),[v,w]=m.useState(0),[N,P]=m.useState(!1),[z,E]=m.useState(null),{data:X}=ue({queryKey:["memos"],queryFn:async()=>(await Gi.getMemos()).data,refetchInterval:1e4}),T=(X==null?void 0:X.memos)||[];m.useEffect(()=>{r.current&&r.current.scrollIntoView({behavior:"smooth",block:"end"})},[T]),m.useEffect(()=>{const L=setTimeout(()=>{r.current&&r.current.scrollIntoView({behavior:"auto",block:"end"})},100);return()=>clearTimeout(L)},[]);const F=Ne({mutationFn:async L=>Gi.createMemo(L),onSuccess:()=>{a(""),l(null),e.invalidateQueries({queryKey:["memos"]})}}),Q=Ne({mutationFn:({memoId:L,content:ye,deleteAttachment:_e})=>Gi.editMemo(L,{content:ye,deleteAttachment:_e}),onSuccess:()=>{c(null),p(!1),h(""),e.invalidateQueries({queryKey:["memos"]})}}),Z=Ne({mutationFn:L=>Gi.deleteMemo(L),onSuccess:()=>{x(null),e.invalidateQueries({queryKey:["memos"]})}}),xe=L=>{if(y(L),!L.trim()||!T.length){f([]),w(0);return}const ye=L.toLowerCase(),_e=[];[...T].reverse().forEach(_=>{let Y=!1;_.content.toLowerCase().includes(ye)&&(Y=!0),_.tags&&_.tags.split(",").map(J=>J.trim().toLowerCase()).some(J=>J.includes(ye))&&(Y=!0),Y&&_e.push(_.id)}),f(_e),w(0),_e.length>0&&ve(_e[0])},ve=L=>{E(L),setTimeout(()=>{const ye=document.getElementById(`memo-${L}`);ye&&ye.scrollIntoView({behavior:"smooth",block:"center"})},100),setTimeout(()=>{E(null)},5e3)},ke=()=>{if(b.length===0)return;const L=(v+1)%b.length;w(L),ve(b[L])},q=()=>{if(b.length===0)return;const L=v===0?b.length-1:v-1;w(L),ve(b[L])},R=L=>{var _e;const ye=(_e=L.target.files)==null?void 0:_e[0];ye&&l(ye)},G=L=>new Promise((ye,_e)=>{const _=new FileReader;_.readAsDataURL(L),_.onload=()=>ye(_.result),_.onerror=Y=>_e(Y)}),K=async()=>{if(!n.trim()&&!i||F.isPending)return;let L=null;i&&(L={data:await G(i),name:i.name,type:i.type,size:i.size}),F.mutate({content:n.trim()||"(Attachment)",attachment:L})},ee=L=>{c(L.id),h(L.content),p(!1)},ae=()=>{!o||!d.trim()||Q.mutate({memoId:o,content:d,deleteAttachment:u})},ne=async(L,ye)=>{try{const _=await(await fetch(L)).blob(),Y=URL.createObjectURL(_),W=document.createElement("a");W.href=Y,W.download=ye,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(Y)}catch(_e){console.error("Error downloading file:",_e)}},fe=L=>L.split(/(@\w+|@\d+|#\d+|TKT-\d+|ticket\s+\d+|\*\d+(?:-\d+)?|TSK-\d+(?:-\d+)?)/gi).map((_e,_)=>{if(_e.match(/^@\w+$/)&&!_e.match(/^@\d+$/))return t.jsx("span",{className:"bg-blue-100 text-blue-700 font-semibold px-1 rounded",children:_e},_);const Y=_e.match(/^@(\d+)$|^#(\d+)$|^TKT-(\d+)$|^ticket\s+(\d+)$/i);if(Y){const J=Y[1]||Y[2]||Y[3]||Y[4];return t.jsx(Je,{to:`/tickets?search=TKT-${J}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",onClick:B=>{B.stopPropagation()},children:_e},_)}const W=_e.match(/^\*(\d+)(?:-(\d+))?$|^TSK-(\d+)(?:-(\d+))?$/i);if(W){const J=W[1]||W[3],B=W[2]||W[4],me=B?`TSK-${J}-${B}`:`TSK-${J}`;return t.jsx(Je,{to:`/tickets?search=${me}`,target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800 hover:underline font-medium",onClick:Ie=>{Ie.stopPropagation()},children:_e},_)}return _e}),Le=L=>L.startsWith("http")?L:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${L}`;return t.jsxs("div",{className:"flex flex-col overflow-hidden bg-gray-50",style:{height:"calc(100vh - 3.5rem)"},children:[t.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(_c,{className:"w-6 h-6 text-yellow-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"@Memos"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Personal notes to yourself"})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>P(!N),className:`p-2 rounded-lg ${N?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Search memos",children:t.jsx(xi,{className:"w-5 h-5"})}),t.jsxs("div",{className:"text-sm text-gray-500",children:[T.length," memo",T.length!==1?"s":""]})]})]}),N&&t.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("input",{type:"text",value:g,onChange:L=>xe(L.target.value),placeholder:"Search memos and tags... (e.g., James Scott, #james-scott)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),b.length>0&&t.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2 bg-white px-2",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:[v+1," / ",b.length]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:q,className:"p-1 hover:bg-gray-100 rounded",title:"Previous result",children:t.jsx(dr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:ke,className:"p-1 hover:bg-gray-100 rounded",title:"Next result",children:t.jsx(Ws,{className:"w-4 h-4"})})]})]})]}),t.jsx("button",{onClick:()=>{P(!1),y(""),f([]),w(0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Close search",children:t.jsx(_t,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[T.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(_c,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"No @Memos yet. Create your first note below!"})]}):T.map(L=>{var _e;const ye=z===L.id;return t.jsx("div",{id:`memo-${L.id}`,className:`bg-white rounded-lg shadow-sm border border-gray-200 p-4 transition-colors duration-500 ${ye?"bg-yellow-100 border-yellow-400":""}`,children:o===L.id?t.jsxs("div",{className:"space-y-3",children:[t.jsx("textarea",{value:d,onChange:_=>h(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3}),L.attachment_url&&!u&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:L.attachment_name}),t.jsx("button",{onClick:()=>p(!0),className:"text-red-600 hover:text-red-700 text-xs",children:"Remove"})]}),u&&t.jsx("div",{className:"text-sm text-red-600",children:"Attachment will be removed when you save"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:ae,disabled:!d.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:"Save"}),t.jsx("button",{onClick:()=>{c(null),p(!1)},className:"px-3 py-1.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm",children:"Cancel"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-gray-900 whitespace-pre-wrap break-words",children:fe(L.content)}),L.tags&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(L.tags).map((_,Y)=>t.jsxs(Je,{to:`/tags?tag=${encodeURIComponent(_)}`,className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-sm rounded hover:bg-blue-200 transition-colors",children:[t.jsx(Ot,{className:"w-3 h-3"}),_]},Y))}),L.attachment_url&&t.jsx("div",{className:"mt-3",children:(_e=L.attachment_type)!=null&&_e.startsWith("image/")?t.jsxs("div",{className:"relative group inline-block",children:[t.jsx("img",{src:Le(L.attachment_url),alt:L.attachment_name||"Attachment",className:"max-w-md max-h-64 rounded-lg border border-gray-200"}),t.jsx("div",{className:"absolute top-2 right-2 bg-white rounded-full shadow-md p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:t.jsx("button",{onClick:()=>ne(Le(L.attachment_url),L.attachment_name||"download"),className:"text-gray-500 hover:text-blue-600",title:"Download image",children:t.jsx(Sc,{className:"w-4 h-4"})})})]}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("a",{href:Le(L.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:L.attachment_name}),L.attachment_size&&t.jsxs("span",{className:"text-xs text-gray-500",children:["(",(L.attachment_size/1024).toFixed(1)," KB)"]})]}),t.jsx("button",{onClick:()=>ne(Le(L.attachment_url),L.attachment_name||"download"),className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Download file",children:t.jsx(Sc,{className:"w-4 h-4"})})]})})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>ee(L),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Edit memo",children:t.jsx(Bh,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>x(L.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete memo",children:t.jsx(fi,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-500",children:[t.jsx("span",{children:new Date(L.created_at).toLocaleString()}),L.edited_at&&t.jsxs("span",{className:"italic",children:["(edited ",new Date(L.edited_at).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),")"]})]})]})},L.id)}),t.jsx("div",{ref:r})]}),t.jsxs("div",{className:"bg-white p-4 flex-shrink-0",children:[i&&t.jsxs("div",{className:"mb-3 flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-2",children:[i.type.startsWith("image/")?t.jsx(Cc,{className:"w-4 h-4 text-gray-600"}):t.jsx(Wo,{className:"w-4 h-4 text-gray-600"}),t.jsx("span",{className:"text-sm text-gray-700",children:i.name}),t.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600 ml-auto",children:t.jsx(_t,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"file",ref:s,onChange:R,className:"hidden"}),t.jsx("button",{onClick:()=>{var L;return(L=s.current)==null?void 0:L.click()},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:t.jsx(St,{className:"w-5 h-5"})}),t.jsx("input",{value:n,onChange:L=>a(L.target.value),onKeyDown:L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),K())},placeholder:"Write a note... Use #keyword to add tags (e.g., #james-scott, #artwork-issue)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"absolute -top-6 left-0 text-xs text-gray-500",children:Pb}),t.jsx("button",{onClick:K,disabled:!n.trim()&&!i||F.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:F.isPending?t.jsxs(t.Fragment,{children:[t.jsx(Nb,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):t.jsxs(t.Fragment,{children:[t.jsx(id,{className:"w-4 h-4"}),"Add"]})})]})]}),j&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Memo?"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this memo? This action cannot be undone."}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>x(null),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:()=>j&&Z.mutate(j),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})})]})}function pg({rating:e,size:s="sm"}){const r={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return t.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(n=>t.jsx("svg",{className:`${r[s]} ${n<=e?"text-yellow-400 fill-yellow-400":"text-gray-300"}`,viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},n))})}function Eo({title:e,value:s,subtitle:r,trend:n,icon:a,color:i="indigo"}){const l={indigo:"bg-indigo-50 text-indigo-600",green:"bg-green-50 text-green-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600",blue:"bg-blue-50 text-blue-600"};return t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:`p-2 rounded-lg ${l[i]}`,children:a}),n&&t.jsxs("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${n.positive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[n.positive?"":""," ",n.value]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:e}),t.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:s}),r&&t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:r})]})]})}function xC(){var c,d;const[e,s]=m.useState("7d"),{data:r,isLoading:n}=ue({queryKey:["ai-agent-analytics",e],queryFn:async()=>(await Bx.getAIAgentStats(e)).data.data}),{data:a}=ue({queryKey:["ai-learning-examples"],queryFn:async()=>(await Bx.getLearningExamples(10)).data.data}),i=(r==null?void 0:r.stats)||{totalDrafts:0,avgQualityScore:0,helpfulRate:0,approvalRate:0,editRate:0,rejectRate:0},l=(r==null?void 0:r.qualityDistribution)||[],o=(r==null?void 0:r.intentPerformance)||[];return n?t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(h=>t.jsx("div",{className:"h-32 bg-gray-200 rounded-lg"},h))})]})}):t.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"AI Agent Analytics"}),t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Monitor AI performance, quality scores, and learning progress"})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("select",{value:e,onChange:h=>s(h.target.value),className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"24h",children:"Last 24 hours"}),t.jsx("option",{value:"7d",children:"Last 7 days"}),t.jsx("option",{value:"30d",children:"Last 30 days"}),t.jsx("option",{value:"all",children:"All time"})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[t.jsx(Eo,{title:"Total AI Drafts",value:i.totalDrafts,subtitle:"Responses generated",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),color:"indigo"}),t.jsx(Eo,{title:"Average Quality",value:`${i.avgQualityScore.toFixed(1)}/5`,subtitle:"Staff rating",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),color:"yellow"}),t.jsx(Eo,{title:"Helpful Rate",value:`${i.helpfulRate.toFixed(0)}%`,subtitle:"Saved staff time",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),color:"green"}),t.jsx(Eo,{title:"Approval Rate",value:`${i.approvalRate.toFixed(0)}%`,subtitle:"Sent without edits",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"blue"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quality Score Distribution"}),t.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(h=>{const u=l.find(p=>p.score===h)||{count:0,percentage:0};return t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-1 w-20",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:h}),t.jsx("svg",{className:"w-4 h-4 text-yellow-400 fill-yellow-400",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})]}),t.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-4 overflow-hidden",children:t.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${h>=4?"bg-green-500":h===3?"bg-yellow-500":"bg-red-500"}`,style:{width:`${u.percentage}%`}})}),t.jsxs("span",{className:"text-sm text-gray-600 w-16 text-right",children:[u.count," (",u.percentage.toFixed(0),"%)"]})]},h)})})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Response Actions"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:t.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Approved (No Edits)"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Sent exactly as AI generated"})]})]}),t.jsxs("span",{className:"text-lg font-semibold text-green-700",children:[i.approvalRate.toFixed(0),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:t.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Edited Before Sending"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Modified by staff"})]})]}),t.jsxs("span",{className:"text-lg font-semibold text-yellow-700",children:[i.editRate.toFixed(0),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:t.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Rejected"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Staff wrote new response"})]})]}),t.jsxs("span",{className:"text-lg font-semibold text-red-700",children:[i.rejectRate.toFixed(0),"%"]})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm mb-8",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance by Intent"}),o.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Intent"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Volume"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Quality"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Helpful %"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trend"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map(h=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 capitalize",children:h.intent.replace(/_/g," ")}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:h.count}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(pg,{rating:Math.round(h.avgQuality),size:"sm"}),t.jsx("span",{className:"text-sm text-gray-600",children:h.avgQuality.toFixed(1)})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${h.helpfulRate>=80?"bg-green-100 text-green-800":h.helpfulRate>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[h.helpfulRate.toFixed(0),"%"]})}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:h.trend>0?t.jsx("span",{className:"text-green-600",children:" Improving"}):h.trend<0?t.jsx("span",{className:"text-red-600",children:" Declining"}):t.jsx("span",{className:"text-gray-500",children:" Stable"})})]},h.intent))})]})}):t.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No intent data available yet. Start approving AI drafts to see performance by intent."})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Learning Examples"}),t.jsx("p",{className:"text-sm text-gray-500",children:"High-quality responses (4-5 stars) used to improve AI"})]}),t.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[((c=a==null?void 0:a.examples)==null?void 0:c.length)||0," examples"]})]}),((d=a==null?void 0:a.examples)==null?void 0:d.length)>0?t.jsx("div",{className:"space-y-4",children:a.examples.slice(0,5).map(h=>{var u;return t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs font-medium text-gray-500 capitalize px-2 py-1 bg-gray-100 rounded",children:((u=h.intent)==null?void 0:u.replace(/_/g," "))||"General"}),t.jsx(pg,{rating:h.quality_score,size:"sm"})]}),t.jsx("span",{className:"text-xs text-gray-500",children:h.created_at?Os(new Date(h.created_at),{addSuffix:!0}):""})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Customer Message"}),t.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:h.customer_message})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"AI Response"}),t.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:h.ai_response})]})]})]},h.id)})}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),t.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No learning examples yet"}),t.jsx("p",{className:"text-xs text-gray-400",children:"Rate AI responses 4-5 stars to add them as learning examples"})]})]})]})}const gC=[1,2,3,4,5,6,0],yg=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function fC(){const e=ct(),[s,r]=m.useState(yg.map((x,g)=>({day_of_week:g,day_name:x,is_open:g>=1&&g<=5,open_time:"09:00",close_time:"17:00"}))),[n,a]=m.useState("Australia/Sydney"),[i,l]=m.useState("idle"),[o,c]=m.useState(""),{data:d,isLoading:h}=ue({queryKey:["businessHours"],queryFn:()=>Rr.getBusinessHours().then(x=>x.data.businessHours)}),{data:u}=ue({queryKey:["chatSettings"],queryFn:()=>Rr.getSettings().then(x=>x.data.settings)});m.useEffect(()=>{d&&r(d)},[d]),m.useEffect(()=>{u!=null&&u.timezone&&a(u.timezone)},[u]);const p=Ne({mutationFn:async()=>{await Rr.updateBusinessHours(s.map(x=>({day_of_week:x.day_of_week,is_open:x.is_open,open_time:x.is_open?x.open_time:null,close_time:x.is_open?x.close_time:null}))),await Rr.updateSettings({timezone:n})},onSuccess:()=>{e.invalidateQueries({queryKey:["businessHours"]}),e.invalidateQueries({queryKey:["chatSettings"]}),l("success"),setTimeout(()=>l("idle"),3e3)},onError:x=>{l("error"),c(x.message),setTimeout(()=>l("idle"),5e3)}}),j=(x,g,y)=>{r(b=>b.map(f=>f.day_of_week===x?{...f,[g]:y}:f))};return h?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):t.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Business Hours"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Set your operating hours for live chat availability"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),t.jsxs("select",{value:n,onChange:x=>a(x.target.value),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[t.jsx("option",{value:"Australia/Sydney",children:"Australia/Sydney (AEST/AEDT)"}),t.jsx("option",{value:"Australia/Melbourne",children:"Australia/Melbourne"}),t.jsx("option",{value:"Australia/Brisbane",children:"Australia/Brisbane"}),t.jsx("option",{value:"Australia/Perth",children:"Australia/Perth (AWST)"}),t.jsx("option",{value:"Pacific/Auckland",children:"New Zealand (NZST/NZDT)"}),t.jsx("option",{value:"America/New_York",children:"US Eastern (EST/EDT)"}),t.jsx("option",{value:"America/Los_Angeles",children:"US Pacific (PST/PDT)"}),t.jsx("option",{value:"Europe/London",children:"UK (GMT/BST)"})]})]}),t.jsx("div",{className:"space-y-3",children:gC.map(x=>{const g=s.find(y=>y.day_of_week===x)||{day_of_week:x,day_name:yg[x],is_open:!1,open_time:"09:00",close_time:"17:00"};return t.jsxs("div",{className:"flex items-center gap-4 py-3 border-b border-gray-100 last:border-0",children:[t.jsx("div",{className:"w-28",children:t.jsx("span",{className:"font-medium text-gray-900",children:g.day_name})}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer min-w-[80px]",children:[t.jsx("input",{type:"checkbox",checked:g.is_open,onChange:y=>j(g.day_of_week,"is_open",y.target.checked),className:"h-4 w-4 text-indigo-600 rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-600",children:g.is_open?"Open":"Closed"})]}),g.is_open?t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("input",{type:"time",value:g.open_time||"09:00",onChange:y=>j(g.day_of_week,"open_time",y.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm"}),t.jsx("span",{className:"text-gray-500",children:"to"}),t.jsx("input",{type:"time",value:g.close_time||"17:00",onChange:y=>j(g.day_of_week,"close_time",y.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm"})]}):t.jsx("span",{className:"text-sm text-gray-400 italic flex-1",children:"Closed all day"})]},g.day_of_week)})}),t.jsxs("div",{className:"flex gap-2 pt-6 mt-4 border-t border-gray-200",children:[t.jsx("button",{onClick:()=>r(x=>x.map(g=>({...g,is_open:g.day_of_week>=1&&g.day_of_week<=5,open_time:"09:00",close_time:"17:00"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"Mon-Fri 9am-5pm"}),t.jsx("button",{onClick:()=>r(x=>x.map(g=>({...g,is_open:g.day_of_week>=1&&g.day_of_week<=6,open_time:"08:00",close_time:"18:00"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"Mon-Sat 8am-6pm"}),t.jsx("button",{onClick:()=>r(x=>x.map(g=>({...g,is_open:!0,open_time:"00:00",close_time:"23:59"}))),className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg border border-indigo-200",children:"24/7"})]}),t.jsxs("div",{className:"flex justify-end pt-6 mt-6 border-t border-gray-200",children:[i==="success"&&t.jsxs("span",{className:"text-green-600 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),i==="error"&&t.jsx("span",{className:"text-red-600 text-sm",children:o||"Failed to save"}),t.jsx("button",{onClick:()=>p.mutate(),disabled:p.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:p.isPending?"Saving...":"Save Business Hours"})]})]})]})}function pC(){const e=ct(),[s,r]=m.useState({is_enabled:!0,primary_color:"#1e40af",secondary_color:"#ffffff",button_text:"Chat with us",welcome_message:"Hi! How can we help you today?",offline_message:"Our team is currently offline. Please leave a message.",show_business_hours:!0,require_email_when_offline:!0}),[n,a]=m.useState("idle"),[i,l]=m.useState(""),{data:o,isLoading:c}=ue({queryKey:["chatSettings"],queryFn:()=>Rr.getSettings().then(h=>h.data.settings)});m.useEffect(()=>{o&&r(o)},[o]);const d=Ne({mutationFn:()=>Rr.updateSettings(s),onSuccess:()=>{e.invalidateQueries({queryKey:["chatSettings"]}),a("success"),setTimeout(()=>a("idle"),3e3)},onError:h=>{a("error"),l(h.message),setTimeout(()=>a("idle"),5e3)}});return c?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):t.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AI Chat Widget"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Configure the chat widget appearance and behavior"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Enable Chat Widget"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Show the chat widget on your website"})]}),t.jsx("button",{onClick:()=>r(h=>({...h,is_enabled:!h.is_enabled})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${s.is_enabled?"bg-indigo-600":"bg-gray-200"}`,children:t.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${s.is_enabled?"translate-x-5":"translate-x-0"}`})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Color"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[t.jsx("input",{type:"color",value:s.primary_color,onChange:h=>r(u=>({...u,primary_color:h.target.value})),className:"sr-only"}),t.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm",style:{backgroundColor:s.primary_color}})]}),t.jsx("input",{type:"text",value:s.primary_color,onChange:h=>r(u=>({...u,primary_color:h.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[t.jsx("input",{type:"color",value:s.secondary_color,onChange:h=>r(u=>({...u,secondary_color:h.target.value})),className:"sr-only"}),t.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm",style:{backgroundColor:s.secondary_color}})]}),t.jsx("input",{type:"text",value:s.secondary_color,onChange:h=>r(u=>({...u,secondary_color:h.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),t.jsx("input",{type:"text",value:s.button_text,onChange:h=>r(u=>({...u,button_text:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Chat with us"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),t.jsx("textarea",{value:s.welcome_message,onChange:h=>r(u=>({...u,welcome_message:h.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Hi! How can we help you today?"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"First message shown when chat opens"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Offline Message"}),t.jsx("textarea",{value:s.offline_message,onChange:h=>r(u=>({...u,offline_message:h.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Our team is currently offline..."}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown when no staff are online"})]}),t.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Business Hours"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Display hours in the widget"})]}),t.jsx("button",{onClick:()=>r(h=>({...h,show_business_hours:!h.show_business_hours})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${s.show_business_hours?"bg-indigo-600":"bg-gray-200"}`,children:t.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${s.show_business_hours?"translate-x-5":"translate-x-0"}`})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Require Email When Offline"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Collect email for follow-up"})]}),t.jsx("button",{onClick:()=>r(h=>({...h,require_email_when_offline:!h.require_email_when_offline})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${s.require_email_when_offline?"bg-indigo-600":"bg-gray-200"}`,children:t.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${s.require_email_when_offline?"translate-x-5":"translate-x-0"}`})})]})]}),t.jsxs("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:[n==="success"&&t.jsxs("span",{className:"text-green-600 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),n==="error"&&t.jsx("span",{className:"text-red-600 text-sm",children:i||"Failed to save"}),t.jsx("button",{onClick:()=>d.mutate(),disabled:d.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:d.isPending?"Saving...":"Save Settings"})]})]})}),t.jsxs("div",{className:"bg-gray-100 rounded-lg p-6",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Preview"}),t.jsxs("div",{className:"bg-white rounded-lg shadow-inner h-96 relative overflow-hidden",children:[t.jsxs("div",{className:"absolute inset-0 p-4",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),t.jsx("div",{className:"h-24 bg-gray-100 rounded mb-4"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),t.jsx("div",{className:"absolute bottom-4 right-4",children:t.jsxs("div",{className:"inline-flex items-center gap-2 px-5 py-3 rounded-full shadow-lg cursor-pointer transform hover:scale-105 transition-transform",style:{backgroundColor:s.primary_color,color:s.secondary_color},children:[t.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),t.jsx("span",{className:"font-medium",children:s.button_text})]})})]})]})]})]})}const Jd={email:"",first_name:"",last_name:"",role:"agent",job_title:"",phone:"",department:"Customer Service",password:""};function yC(){const e=ct(),{user:s}=ts(),r=(s==null?void 0:s.role)==="admin",[n,a]=m.useState(!1),[i,l]=m.useState(null),[o,c]=m.useState(Jd),[d,h]=m.useState(""),[u,p]=m.useState(null),j=m.useRef(null),[x,g]=m.useState(null),{data:y,isLoading:b}=ue({queryKey:["staffUsers"],queryFn:()=>rt.list().then(q=>{const R=q.data.staff;return!r&&(s!=null&&s.id)?R.filter(G=>G.id===s.id):R})}),{data:f}=ue({queryKey:["tickets","all"],queryFn:()=>Oe.list({limit:1e3}).then(q=>q.data.tickets)}),v=q=>f?f.filter(R=>R.assigned_to===q&&R.status!=="resolved"&&R.status!=="closed").length:0,w=Ne({mutationFn:({staffId:q,status:R})=>rt.updateAvailability(q,R),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]})}}),N=Ne({mutationFn:q=>rt.create({...q,password:q.password||""}),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),ve()},onError:q=>{var R,G;h(((G=(R=q.response)==null?void 0:R.data)==null?void 0:G.error)||"Failed to create staff member")}}),P=Ne({mutationFn:({id:q,data:R})=>rt.update(q,R),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),ve()},onError:q=>{var R,G;h(((G=(R=q.response)==null?void 0:R.data)==null?void 0:G.error)||"Failed to update staff member")}}),z=Ne({mutationFn:({staffId:q,file:R})=>rt.uploadAvatar(q,R),onSuccess:()=>{e.invalidateQueries({queryKey:["staffUsers"]}),e.invalidateQueries({queryKey:["currentStaff"]}),p(null)},onError:q=>{var R,G;h(((G=(R=q.response)==null?void 0:R.data)==null?void 0:G.error)||"Failed to upload photo"),p(null)}}),E=q=>{var R;!r&&q!==(s==null?void 0:s.id)||(g(q),(R=j.current)==null||R.click())},X=q=>{var G;const R=(G=q.target.files)==null?void 0:G[0];if(R&&x){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(R.type)){h("Invalid file type. Please use JPEG, PNG, GIF, or WebP");return}if(R.size>5*1024*1024){h("File too large. Maximum size is 5MB");return}p(x),z.mutate({staffId:x,file:R})}j.current&&(j.current.value=""),g(null)},T={online:{color:"bg-green-500",label:"Available",badgeClass:"bg-green-100 text-green-700 border-green-200"},offline:{color:"bg-gray-400",label:"Offline",badgeClass:"bg-gray-100 text-gray-600 border-gray-200"},away:{color:"bg-amber-500",label:"Away",badgeClass:"bg-amber-100 text-amber-700 border-amber-200"}},F=q=>{if(q.job_title)return q.job_title;switch(q.role){case"admin":return"Administrator";case"manager":return"Customer Service Manager";default:return"Support Agent"}},Q=q=>new Date(q).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}),Z=()=>{l(null),c(Jd),h(""),a(!0)},xe=q=>{!r&&q.id!==(s==null?void 0:s.id)||(l(q),c({email:q.email,first_name:q.first_name,last_name:q.last_name,role:q.role,job_title:q.job_title||"",phone:q.phone||"",department:q.department||"Customer Service",password:""}),h(""),a(!0))},ve=()=>{a(!1),l(null),c(Jd),h("")},ke=q=>{if(q.preventDefault(),h(""),!o.email||!o.first_name){h("Email and First Name are required");return}if(i){const R={first_name:o.first_name,last_name:o.last_name,job_title:o.job_title,phone:o.phone,department:o.department};r&&(R.role=o.role,R.email=o.email),o.password&&(R.password=o.password),P.mutate({id:i.id,data:R})}else{if(!o.password){h("Password is required for new staff members");return}N.mutate(o)}};return b?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Members"}),t.jsx("p",{className:"text-gray-600 mt-1",children:r?"Manage your support team and their availability":"View and edit your profile"})]}),r&&t.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[t.jsx(ad,{className:"w-5 h-5"}),"Add Staff Member"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y==null?void 0:y.map(q=>{const R=q.availability_status||"offline",G=T[R],K=v(q.id),ee=q.id===(s==null?void 0:s.id),ae=r||ee;return t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[t.jsx("div",{className:"p-5 pb-4",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"relative group",children:[q.avatar_url?t.jsx("img",{src:rt.getAvatarUrl(q.avatar_url)||"",alt:`${q.first_name} ${q.last_name}`,className:"w-12 h-12 rounded-full object-cover"}):t.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-gray-500",children:t.jsx(_i,{className:"w-6 h-6"})}),t.jsx("span",{className:`absolute bottom-0 right-0 w-3.5 h-3.5 rounded-full border-2 border-white ${G.color}`}),(r||ee)&&t.jsx("button",{onClick:()=>E(q.id),className:"absolute inset-0 rounded-full bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",title:"Upload photo",children:u===q.id?t.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):t.jsx(a3,{className:"w-5 h-5 text-white"})})]}),t.jsxs("div",{children:[t.jsxs("h3",{className:"font-semibold text-gray-900",children:[ee?"You":`${q.first_name}`,q.last_name&&!ee&&` ${q.last_name}`]}),t.jsx("p",{className:"text-sm text-gray-500",children:F(q)})]})]}),r||ee?t.jsxs("select",{value:R,onChange:ne=>w.mutate({staffId:q.id,status:ne.target.value}),className:`text-xs font-medium px-3 py-1 rounded-full border cursor-pointer ${G.badgeClass}`,children:[t.jsx("option",{value:"online",children:"Available"}),t.jsx("option",{value:"away",children:"Away"}),t.jsx("option",{value:"offline",children:"Offline"})]}):t.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full border ${G.badgeClass}`,children:G.label})]})}),t.jsxs("div",{className:"px-5 pb-4 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(sr,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"truncate",children:q.email})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(ya,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{children:q.phone||"Not set"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(pb,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{children:q.department||"Customer Service"})]})]}),t.jsxs("div",{className:"px-5 py-3 bg-gray-50 border-t border-gray-100 flex items-center justify-between text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Active Tickets: "}),t.jsx("span",{className:`font-medium ${K>0?"text-indigo-600":"text-gray-900"}`,children:K})]}),ae?t.jsxs("button",{onClick:()=>xe(q),className:"flex items-center gap-1 text-indigo-600 hover:text-indigo-800 font-medium",children:[t.jsx(Sb,{className:"w-4 h-4"}),"Edit"]}):t.jsxs("div",{className:"text-gray-500",children:["Joined: ",t.jsx("span",{className:"font-medium text-gray-700",children:Q(q.created_at)})]})]})]},q.id)})}),(!y||y.length===0)&&t.jsx("div",{className:"text-center py-12 text-gray-500 bg-white rounded-lg border border-gray-200",children:"No team members found"}),t.jsx("input",{ref:j,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:X,className:"hidden"}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i?"Edit Staff Member":"Add Staff Member"}),t.jsx("button",{onClick:ve,className:"text-gray-400 hover:text-gray-600",children:t.jsx(_t,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:ke,className:"p-6 space-y-4",children:[d&&t.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:o.first_name,onChange:q=>c(R=>({...R,first_name:q.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),t.jsx("input",{type:"text",value:o.last_name,onChange:q=>c(R=>({...R,last_name:q.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"email",value:o.email,onChange:q=>c(R=>({...R,email:q.target.value})),disabled:!!i&&!r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:text-gray-500",required:!0}),i&&!r&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Contact an admin to change your email"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),t.jsx("input",{type:"tel",value:o.phone,onChange:q=>c(R=>({...R,phone:q.target.value})),placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title"}),t.jsx("input",{type:"text",value:o.job_title,onChange:q=>c(R=>({...R,job_title:q.target.value})),placeholder:"e.g., Senior Support Agent",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),t.jsx("input",{type:"text",value:o.department,onChange:q=>c(R=>({...R,department:q.target.value})),placeholder:"e.g., Customer Service",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})]}),r&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),t.jsxs("select",{value:o.role,onChange:q=>c(R=>({...R,role:q.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[t.jsx("option",{value:"agent",children:"Support Agent"}),t.jsx("option",{value:"manager",children:"Manager"}),t.jsx("option",{value:"admin",children:"Administrator"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i?"New Password":"Password",!i&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"password",value:o.password,onChange:q=>c(R=>({...R,password:q.target.value})),placeholder:i?"Leave blank to keep current password":"Enter password",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!i})]}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:ve,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:N.isPending||P.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:N.isPending||P.isPending?"Saving...":i?"Save Changes":"Add Staff Member"})]})]})]})})]})}function bC(){const{data:e,isLoading:s}=ue({queryKey:["staffUsers"],queryFn:()=>rt.list().then(r=>r.data.staff)});return s?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Staff Performance"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Track team productivity and response metrics"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Performance Analytics Coming Soon"}),t.jsx("p",{className:"text-gray-600 max-w-md mx-auto mb-6",children:"We're building detailed performance metrics including response times, ticket resolution rates, customer satisfaction scores, and more."}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto mt-8",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Avg Response Time"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Tickets Resolved"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"--"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Satisfaction Score"})]})]}),t.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-8",children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-4",children:["Team Members (",(e==null?void 0:e.length)||0,")"]}),t.jsx("div",{className:"flex justify-center gap-2 flex-wrap",children:e==null?void 0:e.map(r=>{var n,a;return t.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 rounded-full px-3 py-1.5",children:[t.jsxs("div",{className:"w-6 h-6 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 text-xs font-medium",children:[(n=r.first_name)==null?void 0:n[0],(a=r.last_name)==null?void 0:a[0]]}),t.jsx("span",{className:"text-sm text-gray-700",children:r.first_name})]},r.id)})})]})]})]})}const Qr={listConversations:async e=>(await D.get(`/api/chat/conversations?tab=${e}`)).data,getConversation:async e=>(await D.get(`/api/chat/conversation/${e}`)).data,takeoverConversation:async e=>(await D.post(`/api/chat/conversation/${e}/takeover`)).data,replyToConversation:async(e,s)=>(await D.post(`/api/chat/conversation/${e}/reply`,{message:s})).data,closeConversation:async(e,s)=>(await D.post(`/api/chat/conversation/${e}/close`,{resolution_type:s})).data,pickupFromQueue:async e=>(await D.post(`/api/chat/conversation/${e}/pickup`)).data,reassignConversation:async(e,s,r)=>(await D.post(`/api/chat/conversation/${e}/reassign`,{assignTo:s,reason:r})).data,getStaffList:async()=>(await D.get("/api/staff")).data},bg=[{key:"ai",label:"AI",icon:t.jsx(Zs,{className:"w-4 h-4"}),description:"Active chats with AI"},{key:"staff",label:"Staff",icon:t.jsx(_i,{className:"w-4 h-4"}),description:"Escalated to staff"},{key:"queued",label:"Queued",icon:t.jsx(wb,{className:"w-4 h-4"}),description:"Awaiting staff"},{key:"closed",label:"Closed",icon:t.jsx(fb,{className:"w-4 h-4"}),description:"Resolved & inactive"}],Xd=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"";function vC(){var Fe,ze,at,Rt,Fn;const{user:e}=ts(),s=ct(),[r,n]=Bl(),[a,i]=m.useState("ai"),[l,o]=m.useState(null),[c,d]=m.useState(""),[h,u]=m.useState(!1),[p,j]=m.useState(!1),[x,g]=m.useState(""),[y,b]=m.useState(""),[f,v]=m.useState(!1),[w,N]=m.useState(""),[P,z]=m.useState(250),[E,X]=m.useState(null),[T,F]=m.useState(""),[Q,Z]=m.useState(null),[xe,ve]=m.useState(!1),[ke,q]=m.useState([]),[R,G]=m.useState(!1),[K,ee]=m.useState(!1),[ae,ne]=m.useState(!1),[fe,Le]=m.useState("all"),[L,ye]=m.useState(0),[_e,_]=m.useState(null),Y=m.useRef(null),W=m.useRef(null);m.useEffect(()=>{ye(0)},[l,ae]),m.useEffect(()=>{const M=A=>{(A.ctrlKey||A.metaKey)&&A.key==="y"&&(A.preventDefault(),v(Ae=>!Ae))};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[]),m.useEffect(()=>{const M=r.get("conversation"),A=r.get("ticket");M?(o(M),r.delete("conversation"),n(r,{replace:!0})):A&&(D.get(`/api/chat/conversation/by-ticket/${A}`).then(Ae=>{if(Ae.data.conversation){o(Ae.data.conversation.id);const Pe=Ae.data.conversation;Pe.status==="closed"||Pe.resolution_type?i("closed"):Pe.status==="queued"?i("queued"):Pe.status==="ai_handling"?i("ai"):Pe.status==="assigned"||Pe.status==="staff_handling"?i("staff"):i("ai")}}).catch(Ae=>console.error("Failed to find conversation for ticket:",Ae)),r.delete("ticket"),n(r,{replace:!0}))},[r,n]);const{data:J,isLoading:B}=ue({queryKey:["chat-conversations",a],queryFn:()=>Qr.listConversations(a),refetchInterval:5e3}),{data:me}=ue({queryKey:["chat-tab-counts"],queryFn:async()=>{const[M,A,Ae,Pe]=await Promise.all([D.get("/api/chat/conversations?tab=ai&count_only=true"),D.get("/api/chat/conversations?tab=staff&count_only=true"),D.get("/api/chat/conversations?tab=queued&count_only=true"),D.get("/api/chat/conversations?tab=closed&count_only=true")]);return{ai:M.data.count||0,staff:A.data.count||0,queued:Ae.data.count||0,closed:Pe.data.count||0}},refetchInterval:1e4}),{data:Ie,isLoading:pe}=ue({queryKey:["chat-conversation",l],queryFn:()=>Qr.getConversation(l),enabled:!!l,refetchInterval:3e3}),ie=(Ie==null?void 0:Ie.messages)||[],U=Ie==null?void 0:Ie.conversation,{data:Me,isLoading:Te}=ue({queryKey:["shopify-data",U==null?void 0:U.customer_email],queryFn:async()=>U!=null&&U.customer_email?(await D.get(`/api/shopify/ticket-data?email=${encodeURIComponent(U.customer_email)}`)).data:null,enabled:!!(U!=null&&U.customer_email)&&ae}),{data:$,refetch:se}=ue({queryKey:["ticket-notes",U==null?void 0:U.ticket_id],queryFn:async()=>U!=null&&U.ticket_id?(await Oe.get(U.ticket_id)).data:null,enabled:!!(U!=null&&U.ticket_id)}),le=($==null?void 0:$.notes)||[],Ce=Ne({mutationFn:M=>Qr.takeoverConversation(M),onSuccess:()=>{s.invalidateQueries({queryKey:["chat-conversations"]}),s.invalidateQueries({queryKey:["chat-conversation"]}),s.invalidateQueries({queryKey:["chat-tab-counts"]})}}),Ee=Ne({mutationFn:M=>Qr.pickupFromQueue(M),onSuccess:()=>{s.invalidateQueries({queryKey:["chat-conversations"]}),s.invalidateQueries({queryKey:["chat-conversation"]}),s.invalidateQueries({queryKey:["chat-tab-counts"]}),i("staff")}}),We=Ne({mutationFn:({id:M,message:A})=>Qr.replyToConversation(M,A),onSuccess:()=>{d(""),s.invalidateQueries({queryKey:["chat-conversation"]})}}),et=Ne({mutationFn:({id:M,resolutionType:A})=>Qr.closeConversation(M,A),onSuccess:()=>{o(null),u(!1),s.invalidateQueries({queryKey:["chat-conversations"]}),s.invalidateQueries({queryKey:["chat-tab-counts"]})}}),it=Ne({mutationFn:({id:M,assignTo:A,reason:Ae})=>Qr.reassignConversation(M,A,Ae),onSuccess:()=>{j(!1),g(""),b(""),s.invalidateQueries({queryKey:["chat-conversations"]}),s.invalidateQueries({queryKey:["chat-conversation"]}),s.invalidateQueries({queryKey:["chat-tab-counts"]})}}),{data:kt}=ue({queryKey:["staff-list"],queryFn:()=>Qr.getStaffList(),enabled:p||a==="staff"}),Gt=(kt==null?void 0:kt.staff)||[],rs=(J==null?void 0:J.conversations)||[];m.useEffect(()=>{!l&&rs.length>0&&!B&&o(rs[0].id)},[rs,l,B]);const Et=rs.filter(M=>fe==="all"||M.assigned_to===fe),ns=()=>{if(!l||Et.length===0)return;const M=Et.findIndex(A=>A.id===l);M>0&&o(Et[M-1].id)},Hs=()=>{if(!l||Et.length===0)return;const M=Et.findIndex(A=>A.id===l);M<Et.length-1&&o(Et[M+1].id)},Ns=l?Et.findIndex(M=>M.id===l):-1,jr=Ns>0,As=Ns>=0&&Ns<Et.length-1;m.useEffect(()=>{const M=Ae=>{if(!xe)return;const Pe=P+(window.innerHeight-Ae.clientY-P),Ge=150,yt=window.innerHeight*.6;Pe>=Ge&&Pe<=yt&&z(Pe)},A=()=>{ve(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return xe&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",M),window.addEventListener("mouseup",A)),()=>{window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",A)}},[xe,P]);const de=M=>new Promise((A,Ae)=>{const Pe=new FileReader;Pe.readAsDataURL(M),Pe.onload=()=>A(Pe.result),Pe.onerror=Ge=>Ae(Ge)}),wr=async M=>{const A=Array.from(M.target.files||[]);for(const Ae of A)if(Ae.size>10*1024*1024){alert(`File ${Ae.name} is too large. Maximum size is 10MB.`),M.target.value="";return}q(Ae=>[...Ae,...A]),M.target.value=""},hs=M=>{q(A=>A.filter((Ae,Pe)=>Pe!==M))},Ps=()=>{!l||!c.trim()||(We.mutate({id:l,message:c.trim()}),setTimeout(()=>{var M;(M=W.current)==null||M.scrollIntoView({behavior:"smooth"})},100))},nr=M=>new Date(M).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"}),ks=M=>{if(!M)return null;const A=new Date(M),Pe=new Date().getTime()-A.getTime(),Ge=Math.floor(Pe/6e4);return Ge<1?"Just now":Ge===1?"1 min":`${Ge} mins`},Ze=M=>{switch(M){case"urgent":case"critical":return t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700",children:M});case"high":return t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-orange-100 text-orange-700",children:"high"});default:return null}},I=M=>{switch(M){case"angry":return t.jsx("span",{className:"text-xs",children:""});case"negative":return t.jsx("span",{className:"text-xs",children:""});case"positive":return t.jsx("span",{className:"text-xs",children:""});default:return null}},ge=M=>{switch(M){case"ai_resolved":return t.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-100 text-green-700 flex items-center gap-1",children:[t.jsx(lt,{className:"w-3 h-3"})," AI Resolved"]});case"staff_resolved":return t.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 flex items-center gap-1",children:[t.jsx(lt,{className:"w-3 h-3"})," Staff Resolved"]});case"inactive_closed":return t.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600 flex items-center gap-1",children:[t.jsx(yr,{className:"w-3 h-3"})," Inactive"]});default:return null}};return t.jsxs("div",{className:"h-[calc(100vh-4rem)] flex",children:[t.jsxs("div",{className:"w-80 border-r border-gray-200 bg-white flex flex-col",children:[t.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-2",children:[t.jsx(Je,{to:"/tickets",className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",title:"Back to Tickets",children:t.jsx(hi,{className:"w-5 h-5 text-gray-500"})}),t.jsxs("svg",{className:"w-5 h-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),"Live Chats"]}),t.jsx("div",{className:"flex gap-1 mb-2",children:bg.map(M=>t.jsxs("button",{onClick:()=>{i(M.key),o(null)},className:`flex-1 flex flex-col items-center px-2 py-1.5 text-xs rounded-lg transition-colors ${a===M.key?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:M.description,children:[M.icon,t.jsx("span",{className:"mt-0.5",children:M.label}),me&&me[M.key]>0&&t.jsx("span",{className:`mt-0.5 px-1.5 py-0.5 text-xs rounded-full ${a===M.key?"bg-white/20 text-white":"bg-indigo-100 text-indigo-700"}`,children:me[M.key]})]},M.key))}),t.jsxs("select",{value:a==="staff"?fe:"all",onChange:M=>Le(M.target.value),disabled:a!=="staff",className:`w-full h-7 text-xs border rounded-lg px-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a==="staff"?"border-indigo-300 bg-white":"border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[t.jsx("option",{value:"all",children:"All Staff"}),Gt.filter(M=>M.id!=="ai-agent-001").map(M=>t.jsxs("option",{value:M.id,children:[M.first_name," ",M.last_name," (",M.availability_status==="online"?"Online":M.availability_status==="away"?"Away":"Offline",")"]},M.id))]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:B?t.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading..."}):Et.length===0?t.jsxs("div",{className:"p-4 text-center text-gray-500",children:[t.jsxs("div",{className:"text-gray-300 mb-2",children:[a==="ai"&&t.jsx(Z4,{className:"w-8 h-8 mx-auto"}),a==="staff"&&t.jsx(_i,{className:"w-8 h-8 mx-auto"}),a==="queued"&&t.jsx(wb,{className:"w-8 h-8 mx-auto"}),a==="closed"&&t.jsx(fb,{className:"w-8 h-8 mx-auto"})]}),fe!=="all"?"No chats for selected staff member":`No ${(Fe=bg.find(M=>M.key===a))==null?void 0:Fe.label.toLowerCase()} chats`]}):Et.map(M=>t.jsxs("div",{onClick:()=>o(M.id),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${l===M.id?"bg-indigo-50 border-l-4 border-l-indigo-600":""}`,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center",children:t.jsx(pn,{className:"w-4 h-4 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 text-sm",children:M.customer_name}),t.jsx("p",{className:"text-xs text-gray-500",children:M.customer_email})]})]}),t.jsx("span",{className:"text-xs text-gray-400",children:nr(M.last_message_at)})]}),t.jsx("p",{className:"mt-2 text-sm text-gray-600 truncate",children:M.last_message==="__SHOW_CALLBACK_FORM__"?"CALL BACK REQUEST":M.last_message||"No messages yet"}),t.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[Ze(M.priority),I(M.sentiment),a==="ai"&&t.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-purple-100 text-purple-700 flex items-center gap-1",children:[t.jsx(Zs,{className:"w-3 h-3"})," McCarthy AI"]}),a==="staff"&&M.assigned_staff_first_name&&t.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-700",children:[" ",M.assigned_staff_first_name]}),a==="queued"&&t.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 flex items-center gap-1",children:[t.jsx(ga,{className:"w-3 h-3"})," ",ks(M.queue_entered_at)||"Waiting"]}),a==="closed"&&ge(M.resolution_type),t.jsxs("span",{className:"text-xs text-gray-400",children:[M.message_count," msgs"]})]})]},M.id))})]}),t.jsx("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden",children:l?pe?t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Loading conversation..."}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[(ze=U==null?void 0:U.subject)!=null&&ze.toLowerCase().includes("callback request")?t.jsx(ya,{className:"w-4 h-4 text-red-600 fill-current"}):t.jsxs("svg",{className:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),U!=null&&U.ticket_number?t.jsx(Je,{to:`/tickets?search=${encodeURIComponent(U.ticket_number)}`,className:"text-base font-semibold text-blue-600 hover:text-blue-800 hover:underline",title:"View in All Tickets",children:U.ticket_number}):t.jsx("h1",{className:"text-base font-semibold text-gray-900",children:"Chat"})]}),t.jsx("button",{className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium ${(U==null?void 0:U.status)==="ai_handling"?"bg-green-100 text-green-800 border-green-200":(U==null?void 0:U.status)==="staff_handling"||(U==null?void 0:U.status)==="assigned"?"bg-blue-100 text-blue-800 border-blue-200":(U==null?void 0:U.status)==="queued"?"bg-green-100 text-green-800 border-green-200":(U==null?void 0:U.status)==="closed"?"bg-gray-100 text-gray-800 border-gray-200":"bg-green-100 text-green-800 border-green-200"}`,children:(U==null?void 0:U.status)==="ai_handling"?"open":(U==null?void 0:U.status)==="staff_handling"||(U==null?void 0:U.status)==="assigned"?"in-progress":(U==null?void 0:U.status)==="queued"?"open":(U==null?void 0:U.status)==="closed"?"resolved":U==null?void 0:U.status}),t.jsx("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-blue-50 text-blue-700 ring-blue-600/20",children:(U==null?void 0:U.priority)||"normal"}),t.jsxs("span",{className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset bg-gray-50 text-gray-600 ring-gray-500/20",children:[(U==null?void 0:U.sentiment)==="positive"?"":(U==null?void 0:U.sentiment)==="negative"?"":(U==null?void 0:U.sentiment)==="angry"?"":""," ",(U==null?void 0:U.sentiment)||"neutral"]})]}),t.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(U==null?void 0:U.assigned_to)==="ai-agent-001"?"McCarthy AI":U!=null&&U.assigned_staff_first_name?`${U.assigned_staff_first_name} ${U.assigned_staff_last_name||""}`:"Unassigned"})]}),t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:(U==null?void 0:U.customer_name)||(U==null?void 0:U.customer_email)}),t.jsx("span",{className:"text-xs text-gray-500",children:(U==null?void 0:U.started_at)&&new Date(U.started_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[t.jsx("span",{className:"font-medium",children:"Subject:"})," Live Chat Conversation"]}),t.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(U==null?void 0:U.status)==="queued"&&t.jsxs("button",{onClick:()=>Ee.mutate(l),disabled:Ee.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[t.jsx(Pl,{className:"w-3 h-3"}),t.jsx("span",{children:"Pick Up"})]}),(U==null?void 0:U.status)==="ai_handling"&&(U==null?void 0:U.assigned_to)==="ai-agent-001"&&t.jsxs("button",{onClick:()=>Ce.mutate(l),disabled:Ce.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[t.jsx(Pl,{className:"w-3 h-3"}),t.jsx("span",{children:"Take Over"})]}),t.jsxs("button",{onClick:()=>j(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t.jsx("span",{children:"Reassign"})]}),(U==null?void 0:U.status)!=="closed"&&t.jsxs("button",{onClick:()=>u(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx(lt,{className:"w-3 h-3"}),t.jsx("span",{children:"Close Chat"})]})]})]})]}),t.jsxs("div",{className:"px-4 py-3 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>G(!R),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[t.jsx(pn,{className:"w-3 h-3"}),t.jsx("span",{children:"Customer Info"})]}),t.jsxs("button",{onClick:()=>ee(!K),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[t.jsx(ga,{className:"w-3 h-3"}),t.jsx("span",{children:"Order History"})]}),t.jsxs("button",{onClick:()=>ne(!ae),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${ae?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[t.jsx(lt,{className:"w-3 h-3"}),t.jsx("span",{children:"Shopify"})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:ns,disabled:!jr,className:`p-1 border border-gray-200 rounded ${jr?"text-gray-400 hover:text-gray-600 hover:bg-gray-50":"text-gray-200 cursor-not-allowed"}`,children:t.jsx(hi,{className:"w-4 h-4"})}),t.jsx("button",{onClick:Hs,disabled:!As,className:`p-1 border border-gray-200 rounded ${As?"text-gray-400 hover:text-gray-600 hover:bg-gray-50":"text-gray-200 cursor-not-allowed"}`,children:t.jsx(Jl,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[R&&t.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:t.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[t.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Name:"}),t.jsx("span",{className:"ml-2 font-medium",children:U==null?void 0:U.customer_name})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"VIP:"}),t.jsx("span",{className:"ml-2 font-medium text-amber-600",children:"No"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Email:"}),t.jsx("span",{className:"ml-2 font-medium",children:U==null?void 0:U.customer_email})]})]})]})}),K&&t.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:t.jsxs("div",{className:"bg-white rounded-lg p-3",children:[t.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),t.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[ie.map(M=>{const A=M.sender_type==="customer",Ae=M.sender_type==="system",Pe=M.sender_type==="ai";if(Ae){const Ge=M.content==="__SHOW_CALLBACK_FORM__"?"CALL BACK REQUEST":M.content;return t.jsx("div",{className:"py-3 text-center",children:t.jsx("span",{className:"inline-block px-3 py-1 text-xs text-gray-500 bg-gray-100 rounded-full",children:Ge})},M.id)}return t.jsxs("div",{className:`p-4 rounded-lg ${A?"bg-gray-100":Pe?"bg-purple-50":"bg-blue-50"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${A?"bg-gray-300":Pe?"bg-purple-200":"bg-blue-200"}`,children:A?t.jsx(pn,{className:"w-3 h-3 text-gray-600"}):Pe?t.jsx(Zs,{className:"w-3 h-3 text-purple-600"}):t.jsx(pn,{className:"w-3 h-3 text-blue-600"})}),t.jsx("span",{className:"font-medium text-sm text-gray-900",children:M.sender_name||(A?U==null?void 0:U.customer_name:Pe?"McCarthy AI":"Staff")}),t.jsx("span",{className:"text-xs text-gray-400",children:M.created_at&&Os(new Date(M.created_at),{addSuffix:!0})})]}),t.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:M.content})]},M.id)}),t.jsx("div",{ref:W})]})]}),(a==="staff"||a==="ai"&&(U==null?void 0:U.assigned_to)!=="ai-agent-001")&&(U==null?void 0:U.status)!=="closed"&&t.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-t border-gray-200 p-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("textarea",{value:c,onChange:M=>d(M.target.value),onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),Ps())},placeholder:"Type your reply... (Press Enter to send, Shift+Enter for new line)",className:"flex-1 border border-gray-300 rounded-lg px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white",rows:3}),t.jsxs("button",{onClick:Ps,disabled:!c.trim()||We.isPending,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium transition-colors self-end",children:[t.jsx(id,{className:"w-4 h-4"}),"Send"]})]})}),(U==null?void 0:U.status)==="closed"&&t.jsxs("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:[t.jsx(lt,{className:"w-5 h-5 inline-block mr-2"}),t.jsx("span",{className:"text-sm",children:"This chat has been closed"})]}),t.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[f&&t.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>ve(!0),children:t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),t.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>v(!f),children:[t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),t.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),t.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),f&&t.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${P}px`},children:[le&&le.length>0&&t.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:le.map(M=>{var A;return t.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-xs font-medium text-gray-800",children:M.first_name||"Staff"}),t.jsx("span",{className:"text-xs text-gray-500",children:M.created_at&&typeof M.created_at=="string"?Os(new Date(M.created_at.includes("Z")?M.created_at:M.created_at+"Z"),{addSuffix:!0}):""}),M.edited_at&&t.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),t.jsx("div",{className:"flex items-center gap-2",children:(M.staff_id===(e==null?void 0:e.id)||(e==null?void 0:e.role)==="admin")&&E!==M.id&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{X(M.id),F(M.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),t.jsx("button",{onClick:()=>Z(M.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]})})]}),E===M.id?t.jsxs("div",{className:"space-y-2",children:[t.jsx("textarea",{value:T,onChange:Ae=>F(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:async()=>{var Ae,Pe;if(!(!($!=null&&$.ticket)||!T.trim()))try{await Oe.editNote($.ticket.ticket_id,M.id,T),X(null),F(""),s.invalidateQueries({queryKey:["ticket-notes",U==null?void 0:U.ticket_id]})}catch(Ge){console.error("Failed to edit note:",Ge),alert(`Failed to edit note: ${((Pe=(Ae=Ge.response)==null?void 0:Ae.data)==null?void 0:Pe.error)||Ge.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),t.jsx("button",{onClick:()=>{X(null),F("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):t.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:M.content}),M.tags&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(M.tags).map((Ae,Pe)=>t.jsxs(Je,{to:`/tags?search=${encodeURIComponent(Ae)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[t.jsx(Ot,{className:"w-3 h-3 mr-1"}),Ae]},Pe))}),M.attachment_url&&t.jsx("div",{className:"mt-2",children:(A=M.attachment_type)!=null&&A.startsWith("image/")?t.jsxs("a",{href:Xd(M.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[t.jsx("img",{src:Xd(M.attachment_url),alt:M.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),t.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:M.attachment_name})]}):t.jsxs("a",{href:Xd(M.attachment_url),download:M.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:M.attachment_name}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",(M.attachment_size/1024).toFixed(1)," KB)"]})]})})]},M.id)})}),Q&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),t.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[t.jsx("button",{onClick:()=>Z(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),t.jsx("button",{onClick:async()=>{var M,A;if($!=null&&$.ticket)try{await Oe.deleteNote($.ticket.ticket_id,Q),Z(null),s.invalidateQueries({queryKey:["ticket-notes",U==null?void 0:U.ticket_id]})}catch(Ae){console.error("Failed to delete note:",Ae),alert(`Failed to delete note: ${((A=(M=Ae.response)==null?void 0:M.data)==null?void 0:A.error)||Ae.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),t.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[ke.length>0&&t.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:ke.map((M,A)=>t.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[t.jsx(St,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-[150px] truncate",children:M.name}),t.jsx("button",{onClick:()=>hs(A),className:"text-red-500 hover:text-red-700",children:t.jsx(_t,{className:"w-3 h-3"})})]},A))}),t.jsx("textarea",{value:w,onChange:M=>N(M.target.value),onKeyDown:async M=>{var A,Ae;if(M.key==="Enter"&&!M.shiftKey){M.preventDefault();const Pe=M.currentTarget.value.trim();if(Pe&&U){console.log("[DASHBOARD STAFF NOTES] Submitting note:",Pe);try{const Ge=await Promise.all(ke.map(async yt=>({name:yt.name,content:await de(yt),type:yt.type,size:yt.size})));await Oe.addNote(U.ticket_id,Pe,void 0,Ge.length>0?Ge:void 0),N(""),q([]),se(),console.log("[DASHBOARD STAFF NOTES] Note saved successfully")}catch(Ge){console.error("Failed to add note:",Ge),alert(`Failed to add note: ${((Ae=(A=Ge.response)==null?void 0:A.data)==null?void 0:Ae.error)||Ge.message||"Unknown error"}`)}}}},placeholder:"Add internal notes for other staff members... (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),t.jsx("input",{type:"file",ref:Y,onChange:wr,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),t.jsxs("button",{onClick:()=>{var M;return(M=Y.current)==null?void 0:M.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[t.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:t.jsxs("div",{className:"text-center",children:[t.jsxs("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),t.jsx("p",{children:"Select a conversation to view"})]})})}),t.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${ae?"w-96":"w-0"}`,children:ae&&U&&t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600"}),t.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),t.jsx("button",{onClick:()=>ne(!1),className:"text-gray-400 hover:text-gray-600",children:t.jsx(yr,{className:"w-5 h-5"})})]}),Te&&t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})}),Me&&Me.customer&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Me.customer.firstName," ",Me.customer.lastName]}),t.jsx("p",{className:"text-xs text-gray-500",children:Me.customer.email}),Me.customer.phone&&t.jsx("p",{className:"text-xs text-gray-500",children:Me.customer.phone}),Me.customer.isVIP&&t.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),t.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),t.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((at=Me.customer.totalSpent)==null?void 0:at.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),t.jsx("span",{className:"font-semibold text-gray-900",children:Me.customer.ordersCount||0})]}),Me.customer.lastOrderDate&&t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{className:"text-gray-500",children:"Last Order:"}),t.jsx("span",{className:"text-gray-900",children:new Date(Me.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),Me.orders&&Me.orders.length>0?t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",L+1," OF ",Me.orders.length]}),Me.orders.length>1&&t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:()=>ye(Math.max(0,L-1)),disabled:L===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("button",{onClick:()=>ye(Math.min(Me.orders.length-1,L+1)),disabled:L===Me.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",Me.orders[L].orderNumber]}),t.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${Me.orders[L].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":Me.orders[L].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Me.orders[L].fulfillmentStatus||"Unfulfilled"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",t.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(Rt=Me.orders[L].totalPrice)==null?void 0:Rt.toFixed(2)," ",Me.orders[L].currency]})]})]})]}),t.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Created:"}),t.jsx("span",{className:"text-gray-900",children:new Date(Me.orders[L].createdAt).toLocaleDateString()})]}),t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Payment:"}),t.jsx("span",{className:`font-medium ${Me.orders[L].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:Me.orders[L].financialStatus||"Pending"})]})]}),Me.orders[L].lineItems&&Me.orders[L].lineItems.length>0&&t.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),t.jsx("div",{className:"space-y-2",children:Me.orders[L].lineItems.map((M,A)=>{var Ae;return t.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[t.jsxs("button",{onClick:()=>_(_e===M.id?null:M.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:M.title}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("span",{className:"text-xs text-gray-500",children:["x",M.quantity]}),t.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${_e===M.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),_e===M.id&&t.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Price:"}),t.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(Ae=M.price)==null?void 0:Ae.toFixed(2)]})]}),M.sku&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"SKU:"}),t.jsx("span",{className:"text-gray-900 font-mono",children:M.sku})]}),M.variantTitle&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Variant:"}),t.jsx("span",{className:"text-gray-900",children:M.variantTitle})]}),M.customAttributes&&M.customAttributes.length>0&&t.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[t.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),M.customAttributes.map((Pe,Ge)=>t.jsxs("div",{className:"flex justify-between py-0.5",children:[t.jsxs("span",{className:"text-gray-500",children:[Pe.key.replace("_",""),":"]}),Pe.key.includes("Link")||Pe.key.includes("link")?t.jsx("a",{href:Pe.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:yt=>yt.stopPropagation(),children:"View "}):t.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:Pe.value})]},Ge))]})]})]},M.id||A)})})]})]})]}):t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),t.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),Me.orders&&((Fn=Me.orders[L])==null?void 0:Fn.trackingNumber)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),t.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:Me.orders[L].trackingNumber}),Me.orders[L].trackingCompany&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",t.jsx("span",{className:"text-gray-900",children:Me.orders[L].trackingCompany})]})]}),Me.orders[L].trackingUrl&&t.jsx("a",{href:Me.orders[L].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]})]})}),h&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Close Chat"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"How would you like to close this chat?"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:()=>et.mutate({id:l,resolutionType:"resolved"}),disabled:et.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[t.jsx(lt,{className:"w-6 h-6 text-green-600"}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"font-medium text-gray-900",children:"Mark as Resolved"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Customer's issue was solved"})]})]}),t.jsxs("button",{onClick:()=>et.mutate({id:l,resolutionType:"closed"}),disabled:et.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[t.jsx(yr,{className:"w-6 h-6 text-gray-500"}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"font-medium text-gray-900",children:"Close as Inactive"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Customer stopped responding"})]})]})]}),t.jsx("button",{onClick:()=>u(!1),className:"w-full mt-4 px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reassign Chat"})}),t.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Reassign this chat to another staff member:"}),Gt.filter(M=>M.availability_status==="online").length===1&&t.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:t.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${x==="ai-agent-001"?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[t.jsx("input",{type:"radio",name:"staff",value:"ai-agent-001",checked:x==="ai-agent-001",onChange:M=>g(M.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-purple-500"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[t.jsx(Zs,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),t.jsx("p",{className:"text-xs text-gray-500",children:"Return to McCarthy AI"})]})]}),Gt.filter(M=>M.id!=="ai-agent-001").map(M=>t.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${x===M.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[t.jsx("input",{type:"radio",name:"staff",value:M.id,checked:x===M.id,onChange:A=>g(A.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${M.availability_status==="online"?"bg-green-500":M.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[M.first_name," ",M.last_name]}),t.jsx("p",{className:"text-xs text-gray-500 capitalize",children:M.availability_status||"Offline"})]})]},M.id))]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),t.jsx("textarea",{value:y,onChange:M=>b(M.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[t.jsx("button",{onClick:()=>{j(!1),g(""),b("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:()=>{x&&l&&it.mutate({id:l,assignTo:x,reason:y||void 0})},disabled:!x||it.isPending,className:"flex-1 px-4 py-2 text-sm text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:it.isPending?"Reassigning...":"Reassign"})]})]})})]})}const jC={"in-progress":"bg-blue-100 text-blue-800 border-blue-200"},vg={low:"bg-gray-50 text-gray-700 ring-gray-600/20",normal:"bg-blue-50 text-blue-700 ring-blue-600/20",high:"bg-orange-50 text-orange-700 ring-orange-600/20",critical:"bg-red-50 text-red-700 ring-red-600/20",urgent:"bg-red-100 text-red-800 ring-red-700/30"},jg={positive:"bg-green-50 text-green-700 ring-green-600/20",neutral:"bg-gray-50 text-gray-600 ring-gray-500/20",negative:"bg-orange-50 text-orange-700 ring-orange-600/20",angry:"bg-red-50 text-red-700 ring-red-600/20"},wC={positive:"",neutral:"",negative:"",angry:""},NC={"00000000-0000-0000-0000-000000000001":"John Hutchison","00000000-0000-0000-0000-000000000002":"Ted Smith","00000000-0000-0000-0000-000000000003":"Sam Johnson","ai-agent-001":"McCarthy AI"},Gr={getConversationByTicket:async e=>(await D.get(`/api/chat/conversation/by-ticket/${e}`)).data,getConversation:async e=>(await D.get(`/api/chat/conversation/${e}`)).data,takeoverConversation:async e=>(await D.post(`/api/chat/conversation/${e}/takeover`)).data,replyToConversation:async(e,s)=>(await D.post(`/api/chat/conversation/${e}/reply`,{message:s})).data,closeConversation:async(e,s)=>(await D.post(`/api/chat/conversation/${e}/close`,{resolution_type:s})).data,pickupFromQueue:async e=>(await D.post(`/api/chat/conversation/${e}/pickup`)).data,reassignConversation:async(e,s,r)=>(await D.post(`/api/chat/conversation/${e}/reassign`,{assignTo:s,reason:r})).data,getStaffList:async()=>(await D.get("/api/staff")).data},Sa=e=>e?e.startsWith("data:")||e.startsWith("http")?e:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${e}`:"";function kC(){var Ps,nr,ks,Ze;const{id:e}=uy(),s=vr(),r=ct(),[n]=Bl(),{user:a}=ts(),[i,l]=m.useState(!1),[o,c]=m.useState(!1),[d,h]=m.useState(!1),[u,p]=m.useState(0),[j,x]=m.useState(null),[g,y]=m.useState(""),[b,f]=m.useState(!1),[v,w]=m.useState(""),[N,P]=m.useState(250),[z,E]=m.useState(null),[X,T]=m.useState(""),[F,Q]=m.useState(null),[Z,xe]=m.useState(!1),[ve,ke]=m.useState(!1),[q,R]=m.useState([]),[G,K]=m.useState(!1),[ee,ae]=m.useState(""),[ne,fe]=m.useState(""),Le=m.useRef(null),L=m.useRef(null),{data:ye,isLoading:_e}=ue({queryKey:["ticket",e],queryFn:async()=>(await Oe.get(e)).data,enabled:!!e}),{data:_,isLoading:Y}=ue({queryKey:["chat-conversation-by-ticket",e],queryFn:async()=>{const I=await Gr.getConversationByTicket(e);return I.conversation?await Gr.getConversation(I.conversation.id):null},enabled:!!e,refetchInterval:3e3}),{data:W}=ue({queryKey:["tickets"],queryFn:async()=>(await Oe.list()).data}),{data:J}=ue({queryKey:["staff-list"],queryFn:()=>Gr.getStaffList(),enabled:G}),B=(J==null?void 0:J.staff)||[],{data:me,refetch:Ie}=ue({queryKey:["ticket-notes",e],queryFn:async()=>(await Oe.get(e)).data,enabled:!!e}),pe=ye==null?void 0:ye.ticket,ie=_==null?void 0:_.conversation,U=(_==null?void 0:_.messages)||[],Me=(me==null?void 0:me.notes)||[],{data:Te,isLoading:$}=ue({queryKey:["shopify-data",pe==null?void 0:pe.customer_email],queryFn:async()=>pe!=null&&pe.customer_email?(await D.get(`/api/shopify/ticket-data?email=${encodeURIComponent(pe.customer_email)}`)).data:null,enabled:!!(pe!=null&&pe.customer_email)&&d});let se=(W==null?void 0:W.tickets)||[];const le=n.get("filter"),Ce=n.get("from");le==="my"||Ce==="my"?se=se.filter(I=>I.assigned_to==="00000000-0000-0000-0000-000000000001"):le==="vip"||Ce==="vip"?se=se.filter(I=>I.vip===1):Ce&&(se=se.filter(I=>I.assigned_to===Ce));const Ee=se.findIndex(I=>I.ticket_id===e),We=Ee>0,et=Ee>=0&&Ee<se.length-1,it=()=>{if(We){const I=se[Ee-1],ge=new URLSearchParams(n);I.channel==="chat"?s(`/chat-ticket/${I.ticket_id}?${ge.toString()}`):s(`/tickets/${I.ticket_id}?${ge.toString()}`)}},kt=()=>{if(et){const I=se[Ee+1],ge=new URLSearchParams(n);I.channel==="chat"?s(`/chat-ticket/${I.ticket_id}?${ge.toString()}`):s(`/tickets/${I.ticket_id}?${ge.toString()}`)}},Gt=Ne({mutationFn:()=>Gr.takeoverConversation(ie.id),onSuccess:()=>{r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),rs=Ne({mutationFn:()=>Gr.pickupFromQueue(ie.id),onSuccess:()=>{r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),Et=Ne({mutationFn:I=>Gr.replyToConversation(ie.id,I),onSuccess:()=>{y(""),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),ns=Ne({mutationFn:I=>Gr.closeConversation(ie.id,I),onSuccess:()=>{ke(!1),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]}),r.invalidateQueries({queryKey:["tickets"]})}}),Hs=Ne({mutationFn:({assignTo:I,reason:ge})=>Gr.reassignConversation(ie.id,I,ge),onSuccess:()=>{K(!1),ae(""),fe(""),r.invalidateQueries({queryKey:["chat-conversation-by-ticket"]})}}),Ns=()=>{!g.trim()||!ie||(Et.mutate(g.trim()),setTimeout(()=>{var I;(I=L.current)==null||I.scrollIntoView({behavior:"smooth"})},100))};m.useEffect(()=>{p(0)},[e,d]),m.useEffect(()=>{const I=ge=>{(ge.ctrlKey||ge.metaKey)&&ge.key==="y"&&(ge.preventDefault(),f(Fe=>!Fe))};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[]);const jr=I=>new Promise((ge,Fe)=>{const ze=new FileReader;ze.readAsDataURL(I),ze.onload=()=>ge(ze.result),ze.onerror=at=>Fe(at)}),As=async I=>{const ge=Array.from(I.target.files||[]);for(const Fe of ge)if(Fe.size>10*1024*1024){alert(`File ${Fe.name} is too large. Maximum size is 10MB.`),I.target.value="";return}R(Fe=>[...Fe,...ge]),I.target.value=""},de=I=>{R(ge=>ge.filter((Fe,ze)=>ze!==I))};if(m.useEffect(()=>{const I=Fe=>{if(!Z)return;const ze=N+(window.innerHeight-Fe.clientY-N),at=150,Rt=window.innerHeight*.6;ze>=at&&ze<=Rt&&P(ze)},ge=()=>{xe(!1),document.body.style.cursor="default",document.body.style.userSelect="auto"};return Z&&(document.body.style.cursor="ns-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",I),window.addEventListener("mouseup",ge)),()=>{window.removeEventListener("mousemove",I),window.removeEventListener("mouseup",ge)}},[Z,N]),_e||Y)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})});if(!pe)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"Ticket not found"})});const hs=ie&&(ie.status==="staff_handling"||ie.status==="assigned"||ie.status==="ai_handling"&&ie.assigned_to!=="ai-agent-001");return t.jsxs("div",{className:"flex h-[calc(100vh-4rem)] bg-gray-50",children:[t.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[t.jsxs("div",{className:"bg-white border-b border-gray-200 p-3 flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Je,{to:"/tickets",className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{className:"flex items-center gap-2",children:[(Ps=pe.subject)!=null&&Ps.toLowerCase().includes("callback request")?t.jsx(ya,{className:"w-4 h-4 text-red-600 fill-current"}):t.jsxs("svg",{className:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),t.jsx(Je,{to:`/tickets?search=${encodeURIComponent(pe.ticket_number)}`,className:"text-base font-semibold text-blue-600 hover:text-blue-800 hover:underline",title:"View in All Tickets",children:pe.ticket_number})]}),pe.vip===1&&t.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 rounded-lg text-xs border border-yellow-200 font-medium",children:" VIP"}),t.jsx("button",{className:`px-1.5 py-0.5 rounded-lg text-xs border font-medium ${jC["in-progress"]}`,children:(ie==null?void 0:ie.status)==="ai_handling"?"open":(ie==null?void 0:ie.status)==="staff_handling"||(ie==null?void 0:ie.status)==="assigned"?"in-progress":(ie==null?void 0:ie.status)==="queued"?"open":(ie==null?void 0:ie.status)==="closed"?"resolved":pe.status}),t.jsx("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${vg[pe.priority]||vg.normal}`,children:pe.priority}),t.jsxs("span",{className:`inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset ${jg[pe.sentiment]||jg.neutral}`,children:[wC[pe.sentiment]||""," ",pe.sentiment||"neutral"]})]}),t.jsx("button",{className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:(ie==null?void 0:ie.assigned_to)==="ai-agent-001"?"McCarthy AI":ie!=null&&ie.assigned_staff_first_name?`${ie.assigned_staff_first_name} ${ie.assigned_staff_last_name||""}`:pe.assigned_to?NC[pe.assigned_to]||pe.assigned_to:"Unassigned"})]}),t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:pe.customer_name||pe.customer_email}),t.jsx("span",{className:"text-xs text-gray-500",children:new Date(pe.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("p",{className:"text-sm text-gray-600 flex-1 truncate mr-4",children:[t.jsx("span",{className:"font-medium",children:"Subject:"})," ",pe.subject||"Live Chat Conversation"]}),t.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(ie==null?void 0:ie.status)==="queued"&&t.jsxs("button",{onClick:()=>rs.mutate(),disabled:rs.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[t.jsx(Pl,{className:"w-3 h-3"}),t.jsx("span",{children:"Pick Up"})]}),(ie==null?void 0:ie.status)==="ai_handling"&&(ie==null?void 0:ie.assigned_to)==="ai-agent-001"&&t.jsxs("button",{onClick:()=>Gt.mutate(),disabled:Gt.isPending,className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1 disabled:opacity-50",children:[t.jsx(Pl,{className:"w-3 h-3"}),t.jsx("span",{children:"Take Over"})]}),t.jsxs("button",{onClick:()=>K(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t.jsx("span",{children:"Reassign"})]}),(ie==null?void 0:ie.status)!=="closed"&&t.jsxs("button",{onClick:()=>ke(!0),className:"text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1",children:[t.jsx(lt,{className:"w-3 h-3"}),t.jsx("span",{children:"Close Chat"})]})]})]})]}),t.jsxs("div",{className:"p-4 bg-white border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>l(!i),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[t.jsx(pn,{className:"w-3 h-3"}),t.jsx("span",{children:"Customer Info"})]}),t.jsxs("button",{onClick:()=>c(!o),className:"h-7 text-xs px-2 py-1 bg-white border border-indigo-200 rounded-lg hover:bg-indigo-50 transition-colors flex items-center justify-center space-x-1",children:[t.jsx(kb,{className:"w-3 h-3"}),t.jsx("span",{children:"Order History"})]}),t.jsxs("button",{onClick:()=>h(!d),className:`h-7 text-xs px-2 py-1 border rounded-lg hover:opacity-80 transition-colors flex items-center justify-center space-x-1 font-medium ${d?"bg-green-600 text-white border-green-700":"bg-white text-green-700 border-green-300"}`,children:[t.jsx(dl,{className:"w-3 h-3"}),t.jsx("span",{children:"Shopify"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:it,disabled:!We,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(hi,{className:"w-3.5 h-3.5"})}),t.jsx("button",{onClick:kt,disabled:!et,className:"h-7 text-xs px-2 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(Jl,{className:"w-3.5 h-3.5"})})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[i&&t.jsx("div",{className:"p-3 bg-blue-50 border-b border-blue-100 flex-shrink-0",children:t.jsxs("div",{className:"bg-white rounded-lg p-3 text-xs",children:[t.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Customer Profile"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Name:"}),t.jsx("span",{className:"ml-2 font-medium",children:pe.customer_name})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"VIP:"}),t.jsx("span",{className:"ml-2 font-medium text-amber-600",children:pe.vip?"Yes":"No"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-gray-500",children:"Email:"}),t.jsx("span",{className:"ml-2 font-medium",children:pe.customer_email})]})]})]})}),o&&t.jsx("div",{className:"p-3 bg-green-50 border-b border-green-100 flex-shrink-0",children:t.jsxs("div",{className:"bg-white rounded-lg p-3",children:[t.jsx("h4",{className:"font-semibold text-gray-800 mb-2 text-xs",children:"Order History"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Order history will be loaded from Shopify"})]})}),t.jsxs("div",{className:"p-4 space-y-4 bg-gray-50",children:[U.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsxs("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12z"}),t.jsx("path",{d:"M7 9h10v2H7zm0-3h10v2H7z"})]}),t.jsx("p",{children:"No messages yet"})]}):U.map(I=>{var at;const ge=I.sender_type==="customer",Fe=I.sender_type==="system",ze=I.sender_type==="ai";return Fe?t.jsx("div",{className:"text-center py-2",children:t.jsx("span",{className:"inline-block px-3 py-1 text-xs text-gray-500 bg-gray-100 rounded-full",children:I.content})},I.id):t.jsxs("div",{className:`p-4 rounded-lg ${ge?"bg-gray-100":ze?"bg-purple-50":"bg-blue-50"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${ge?"bg-gray-300":ze?"bg-purple-200":"bg-blue-200"}`,children:ge?t.jsx(pn,{className:"w-3 h-3 text-gray-600"}):ze?t.jsx(Zs,{className:"w-3 h-3 text-purple-600"}):t.jsx(pn,{className:"w-3 h-3 text-blue-600"})}),t.jsx("span",{className:"font-medium text-sm text-gray-900",children:ge?I.sender_name||pe.customer_name||"Customer":ze?"McCarthy AI":I.sender_name?I.sender_name.split(" ")[0]:"Staff"}),t.jsx("span",{className:"text-xs text-gray-400",children:I.created_at&&typeof I.created_at=="string"?Os(new Date(I.created_at.includes("Z")?I.created_at:I.created_at+"Z"),{addSuffix:!0}):""})]}),t.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-wrap ml-8",children:I.content}),I.attachment_url&&t.jsx("div",{className:"mt-2 ml-8",children:(at=I.attachment_type)!=null&&at.startsWith("image/")?t.jsxs("a",{href:Sa(I.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[t.jsx("img",{src:Sa(I.attachment_url),alt:I.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300 hover:opacity-90 transition-opacity cursor-pointer"}),t.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:I.attachment_name})]}):t.jsxs("a",{href:Sa(I.attachment_url),download:I.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:I.attachment_name}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",((I.attachment_size||0)/1024).toFixed(1)," KB)"]})]})})]},I.id)}),t.jsx("div",{ref:L})]})]}),hs&&t.jsx("div",{className:"flex-shrink-0 bg-gray-50 border-t border-gray-200 p-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("textarea",{value:g,onChange:I=>y(I.target.value),onKeyDown:I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),Ns())},placeholder:"Type your reply... (Press Enter to send, Shift+Enter for new line)",className:"flex-1 border border-gray-300 rounded-lg px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none bg-white",rows:3}),t.jsxs("button",{onClick:Ns,disabled:!g.trim()||Et.isPending,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium transition-colors self-end",children:[t.jsx(id,{className:"w-4 h-4"}),"Send"]})]})}),!hs&&(ie==null?void 0:ie.status)!=="closed"&&t.jsx("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:(ie==null?void 0:ie.status)==="ai_handling"?'AI is handling this chat. Click "Take Over" to respond.':(ie==null?void 0:ie.status)==="queued"?'This chat is in queue. Click "Pick Up" to respond.':"Unable to respond to this chat."})}),(ie==null?void 0:ie.status)==="closed"&&t.jsxs("div",{className:"flex-shrink-0 bg-gray-100 border-t border-gray-200 p-4 text-center text-gray-500",children:[t.jsx(lt,{className:"w-5 h-5 inline-block mr-2"}),t.jsx("span",{className:"text-sm",children:"This chat has been closed"})]}),t.jsxs("div",{className:"border-t border-gray-200 bg-white flex-shrink-0",children:[b&&t.jsx("div",{className:"h-1 bg-gray-200 hover:bg-yellow-400 cursor-ns-resize transition-colors flex-shrink-0 relative group",onMouseDown:()=>xe(!0),children:t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"w-12 h-1 bg-gray-400 rounded-full group-hover:bg-yellow-500 transition-colors"})})}),t.jsxs("div",{className:"px-4 py-2.5 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b border-yellow-200 flex items-center gap-2 cursor-pointer hover:from-yellow-100 hover:to-yellow-150 transition-colors",onClick:()=>f(!b),children:[t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),t.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:" Staff Notes (Internal Only)"}),t.jsx("span",{className:"text-xs text-gray-500 bg-white px-2 py-0.5 rounded border border-gray-300",children:"Ctrl+Y"})]}),b&&t.jsxs("div",{className:"flex flex-col bg-yellow-50",style:{height:`${N}px`},children:[Me&&Me.length>0&&t.jsx("div",{className:"p-4 space-y-2 overflow-y-auto flex-shrink-0",style:{maxHeight:"60%"},children:Me.map(I=>{var ge;return t.jsxs("div",{className:"bg-yellow-100 rounded-lg p-3 border border-yellow-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-xs font-medium text-gray-800",children:I.first_name||"Staff"}),t.jsx("span",{className:"text-xs text-gray-500",children:I.created_at&&typeof I.created_at=="string"?Os(new Date(I.created_at.includes("Z")?I.created_at:I.created_at+"Z"),{addSuffix:!0}):""}),I.edited_at&&t.jsx("span",{className:"text-xs text-gray-400 italic",children:"(edited)"})]}),t.jsx("div",{className:"flex items-center gap-2",children:(I.staff_id===(a==null?void 0:a.id)||(a==null?void 0:a.role)==="admin")&&z!==I.id&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{E(I.id),T(I.content)},className:"text-xs px-2 py-1 text-gray-600 hover:text-blue-600 hover:bg-white rounded transition-colors",title:"Edit note",children:"Edit"}),t.jsx("button",{onClick:()=>Q(I.id),className:"text-xs px-2 py-1 text-gray-600 hover:text-red-600 hover:bg-white rounded transition-colors",title:"Delete note",children:"Delete"})]})})]}),z===I.id?t.jsxs("div",{className:"space-y-2",children:[t.jsx("textarea",{value:X,onChange:Fe=>T(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",rows:3}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:async()=>{var Fe,ze;if(!(!pe||!X.trim()))try{await Oe.editNote(pe.ticket_id,I.id,X),E(null),T(""),r.invalidateQueries({queryKey:["ticket",e]})}catch(at){console.error("Failed to edit note:",at),alert(`Failed to edit note: ${((ze=(Fe=at.response)==null?void 0:Fe.data)==null?void 0:ze.error)||at.message||"Unknown error"}`)}},className:"text-xs px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"}),t.jsx("button",{onClick:()=>{E(null),T("")},className:"text-xs px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}):t.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:I.content}),I.tags&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(I.tags).map((Fe,ze)=>t.jsxs(Je,{to:`/tags?search=${encodeURIComponent(Fe)}`,className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200",children:[t.jsx(Ot,{className:"w-3 h-3 mr-1"}),Fe]},ze))}),I.attachment_url&&t.jsx("div",{className:"mt-2",children:(ge=I.attachment_type)!=null&&ge.startsWith("image/")?t.jsxs("a",{href:Sa(I.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:[t.jsx("img",{src:Sa(I.attachment_url),alt:I.attachment_name||"Attachment",className:"max-w-xs rounded border border-yellow-300 hover:opacity-90 transition-opacity cursor-pointer"}),t.jsx("span",{className:"text-xs text-gray-600 mt-1 block",children:I.attachment_name})]}):t.jsxs("a",{href:Sa(I.attachment_url),download:I.attachment_name||"file",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-yellow-300 rounded-lg hover:bg-yellow-50 text-sm",children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:I.attachment_name}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",(I.attachment_size/1024).toFixed(1)," KB)"]})]})})]},I.id)})}),F&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete Note?"}),t.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this note? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[t.jsx("button",{onClick:()=>Q(null),className:"px-4 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),t.jsx("button",{onClick:async()=>{var I,ge;if(pe)try{await Oe.deleteNote(pe.ticket_id,F),Q(null),r.invalidateQueries({queryKey:["ticket",e]})}catch(Fe){console.error("Failed to delete note:",Fe),alert(`Failed to delete note: ${((ge=(I=Fe.response)==null?void 0:I.data)==null?void 0:ge.error)||Fe.message||"Unknown error"}`)}},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),t.jsxs("div",{className:"p-4 flex-1 flex flex-col min-h-0 border-t border-yellow-200",children:[q.length>0&&t.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:q.map((I,ge)=>t.jsxs("div",{className:"flex items-center gap-1 bg-white border border-yellow-300 rounded px-2 py-1 text-xs",children:[t.jsx(St,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-[150px] truncate",children:I.name}),t.jsx("button",{onClick:()=>de(ge),className:"text-red-500 hover:text-red-700",children:t.jsx(_t,{className:"w-3 h-3"})})]},ge))}),t.jsx("textarea",{"data-test":"chat-staff-notes-textarea",value:v,onChange:I=>{console.log("[CHAT STAFF NOTES] onChange fired:",I.target.value),w(I.target.value)},onKeyDown:async I=>{var ge,Fe;if(console.log("[CHAT STAFF NOTES] onKeyDown fired - key:",I.key),I.key==="Enter"&&!I.shiftKey){I.preventDefault();const ze=I.currentTarget.value.trim();if(ze&&pe){console.log("[CHAT STAFF NOTES] Submitting note:",ze);try{const at=await Promise.all(q.map(async Rt=>({name:Rt.name,content:await jr(Rt),type:Rt.type,size:Rt.size})));await Oe.addNote(pe.ticket_id,ze,void 0,at.length>0?at:void 0),w(""),R([]),Ie()}catch(at){console.error("Failed to add note:",at),alert(`Failed to add note: ${((Fe=(ge=at.response)==null?void 0:ge.data)==null?void 0:Fe.error)||at.message||"Unknown error"}`)}}else console.log("[CHAT STAFF NOTES] Cannot submit - noteText:",ze,"ticket:",!!pe)}},onFocus:()=>console.log("[CHAT STAFF NOTES] onFocus fired"),onBlur:()=>console.log("[CHAT STAFF NOTES] onBlur fired"),placeholder:"Add internal notes... Use @to mention staff, #keyword to add tags (Press Enter to save, Shift+Enter for new line)",className:"w-full flex-1 border border-yellow-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-yellow-500 resize-none bg-white min-h-0"}),t.jsx("input",{type:"file",ref:Le,onChange:As,className:"hidden",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt,.xls,.xlsx"}),t.jsxs("button",{onClick:()=>{var I;return(I=Le.current)==null?void 0:I.click()},className:"mt-2 text-xs px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 self-start flex-shrink-0 flex items-center gap-1",children:[t.jsx(St,{className:"w-3 h-3"}),"Attach File"]})]})]})]})]}),t.jsx("div",{className:`bg-white border-l border-gray-200 transition-all duration-300 ease-in-out overflow-y-auto ${d?"w-96":"w-0"}`,children:d&&t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(dl,{className:"w-5 h-5 text-green-600"}),t.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Shopify"})]}),t.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),$&&t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"text-sm text-gray-500",children:"Loading Shopify data..."})}),Te&&Te.customer&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"CUSTOMER"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Te.customer.firstName," ",Te.customer.lastName]}),t.jsx("p",{className:"text-xs text-gray-500",children:Te.customer.email}),Te.customer.phone&&t.jsx("p",{className:"text-xs text-gray-500",children:Te.customer.phone}),Te.customer.isVIP&&t.jsx("span",{className:"inline-flex items-center mt-1 text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded-full font-medium",children:" VIP Customer"})]}),t.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{className:"text-gray-500",children:"Total Spent:"}),t.jsxs("span",{className:"font-semibold text-indigo-600",children:["$",((nr=Te.customer.totalSpent)==null?void 0:nr.toLocaleString("en-US",{minimumFractionDigits:2}))||"0.00"]})]}),t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Total Orders:"}),t.jsx("span",{className:"font-semibold text-gray-900",children:Te.customer.ordersCount||0})]}),Te.customer.lastOrderDate&&t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{className:"text-gray-500",children:"Last Order:"}),t.jsx("span",{className:"text-gray-900",children:new Date(Te.customer.lastOrderDate).toLocaleDateString()})]})]})]})]}),Te.orders&&Te.orders.length>0?t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"text-xs font-semibold text-gray-500 uppercase",children:["ORDER ",u+1," OF ",Te.orders.length]}),Te.orders.length>1&&t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:()=>p(Math.max(0,u-1)),disabled:u===0,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Previous order",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("button",{onClick:()=>p(Math.min(Te.orders.length-1,u+1)),disabled:u===Te.orders.length-1,className:"p-1 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",title:"Next order",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Order ",Te.orders[u].orderNumber]}),t.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${Te.orders[u].fulfillmentStatus==="fulfilled"?"bg-green-100 text-green-800":Te.orders[u].fulfillmentStatus==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Te.orders[u].fulfillmentStatus||"Unfulfilled"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["Total: ",t.jsxs("span",{className:"font-semibold text-gray-900",children:["$",(ks=Te.orders[u].totalPrice)==null?void 0:ks.toFixed(2)," ",Te.orders[u].currency]})]})]})]}),t.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Created:"}),t.jsx("span",{className:"text-gray-900",children:new Date(Te.orders[u].createdAt).toLocaleDateString()})]}),t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Payment:"}),t.jsx("span",{className:`font-medium ${Te.orders[u].financialStatus==="paid"?"text-green-600":"text-yellow-600"}`,children:Te.orders[u].financialStatus||"Pending"})]})]}),Te.orders[u].lineItems&&Te.orders[u].lineItems.length>0&&t.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Items:"}),t.jsx("div",{className:"space-y-2",children:Te.orders[u].lineItems.map((I,ge)=>{var Fe;return t.jsxs("div",{className:"border border-gray-200 rounded-md overflow-hidden",children:[t.jsxs("button",{onClick:()=>x(j===I.id?null:I.id),className:"w-full text-left px-2 py-1.5 hover:bg-gray-50 transition-colors flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-700 truncate flex-1",children:I.title}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("span",{className:"text-xs text-gray-500",children:["x",I.quantity]}),t.jsx("svg",{className:`w-3 h-3 text-gray-400 transition-transform ${j===I.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),j===I.id&&t.jsxs("div",{className:"px-2 py-2 bg-gray-50 border-t border-gray-200 text-xs space-y-1.5",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Price:"}),t.jsxs("span",{className:"text-gray-900 font-medium",children:["$",(Fe=I.price)==null?void 0:Fe.toFixed(2)]})]}),I.sku&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"SKU:"}),t.jsx("span",{className:"text-gray-900 font-mono",children:I.sku})]}),I.variantTitle&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Variant:"}),t.jsx("span",{className:"text-gray-900",children:I.variantTitle})]}),I.customAttributes&&I.customAttributes.length>0&&t.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[t.jsx("p",{className:"text-gray-500 font-medium mb-1.5",children:"Product Details:"}),I.customAttributes.map((ze,at)=>t.jsxs("div",{className:"flex justify-between py-0.5",children:[t.jsxs("span",{className:"text-gray-500",children:[ze.key.replace("_",""),":"]}),ze.key.includes("Link")||ze.key.includes("link")?t.jsx("a",{href:ze.value,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline truncate max-w-[180px]",onClick:Rt=>Rt.stopPropagation(),children:"View "}):t.jsx("span",{className:"text-gray-900 font-mono text-right truncate max-w-[180px]",children:ze.value})]},at))]})]})]},I.id||ge)})})]})]})]}):t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"ORDERS"}),t.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-gray-500",children:"No orders found"})})]}),Te.orders&&((Ze=Te.orders[u])==null?void 0:Ze.trackingNumber)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"FULFILLMENT & TRACKING"}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Tracking:"}),t.jsx("p",{className:"text-sm font-mono font-semibold text-gray-900",children:Te.orders[u].trackingNumber}),Te.orders[u].trackingCompany&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Carrier: ",t.jsx("span",{className:"text-gray-900",children:Te.orders[u].trackingCompany})]})]}),Te.orders[u].trackingUrl&&t.jsx("a",{href:Te.orders[u].trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-green-600 hover:text-green-700 font-medium",children:"Track Package "})]})]})]})]})}),ve&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Close Chat"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"How would you like to close this chat?"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:()=>ns.mutate("resolved"),disabled:ns.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[t.jsx(lt,{className:"w-6 h-6 text-green-600"}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"font-medium text-gray-900",children:"Mark as Resolved"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Customer's issue was solved"})]})]}),t.jsxs("button",{onClick:()=>ns.mutate("closed"),disabled:ns.isPending,className:"w-full flex items-center gap-3 p-3 border-2 border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[t.jsx(yr,{className:"w-6 h-6 text-gray-500"}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"font-medium text-gray-900",children:"Close as Inactive"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Customer stopped responding"})]})]})]}),t.jsx("button",{onClick:()=>ke(!1),className:"w-full mt-4 px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})}),G&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] flex flex-col",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reassign Chat"})}),t.jsxs("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reassign chat #",pe==null?void 0:pe.ticket_number," to another staff member:"]}),B.filter(I=>I.availability_status==="online").length===1&&t.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:t.jsx("p",{className:"text-sm text-amber-800",children:" You're the only staff member online"})}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${ee==="ai-agent-001"?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[t.jsx("input",{type:"radio",name:"staff",value:"ai-agent-001",checked:ee==="ai-agent-001",onChange:I=>ae(I.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:"w-2 h-2 rounded-full mr-3 bg-purple-500"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900 flex items-center gap-1.5",children:[t.jsx(Zs,{className:"w-4 h-4 text-purple-600"}),"McCarthy AI"]}),t.jsx("p",{className:"text-xs text-gray-500",children:"Return to McCarthy AI"})]})]}),B.filter(I=>I.id!=="ai-agent-001").map(I=>t.jsxs("label",{className:`flex items-center p-3 border rounded-lg transition-colors cursor-pointer hover:bg-gray-50 ${ee===I.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[t.jsx("input",{type:"radio",name:"staff",value:I.id,checked:ee===I.id,onChange:ge=>ae(ge.target.value),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 mr-3"}),t.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${I.availability_status==="online"?"bg-green-500":I.availability_status==="away"?"bg-yellow-500":"bg-gray-400"}`}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[I.first_name," ",I.last_name]}),t.jsx("p",{className:"text-xs text-gray-500 capitalize",children:I.availability_status||"Offline"})]})]},I.id))]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason (optional)"}),t.jsx("textarea",{value:ne,onChange:I=>fe(I.target.value),placeholder:"e.g., Sales inquiry, needs technical support...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-50 rounded-b-lg flex justify-end gap-3 border-t border-gray-200 flex-shrink-0",children:[t.jsx("button",{onClick:()=>{K(!1),ae(""),fe("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:()=>{ee&&Hs.mutate({assignTo:ee,reason:ne||void 0})},disabled:!ee||Hs.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:Hs.isPending?"Reassigning...":"Reassign Chat"})]})]})})]})}function SC(){const[e,s]=m.useState(!1),{data:r,isLoading:n,error:a}=ue({queryKey:["chat-embed-code"],queryFn:async()=>(await D.get("/api/chat/embed-code")).data}),i=async()=>{r!=null&&r.embedCode&&(await navigator.clipboard.writeText(r.embedCode),s(!0),setTimeout(()=>s(!1),2e3))};return n?t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):a?t.jsx("div",{className:"p-8",children:t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:"Failed to load embed code. Please try again."})}):t.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[t.jsx(bb,{className:"w-7 h-7 text-indigo-600"}),"Chat Widget Embed Code"]}),t.jsx("p",{className:"mt-2 text-gray-600",children:"Add the McCarthy AI chat widget to your website with a simple code snippet."})]}),t.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-6 mb-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-indigo-900 mb-3",children:"Installation Instructions"}),t.jsx("ol",{className:"list-decimal list-inside space-y-2 text-indigo-800",children:r==null?void 0:r.instructions.map((l,o)=>t.jsx("li",{children:l},o))})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[t.jsx("span",{className:"font-medium text-gray-700",children:"Embed Code"}),t.jsx("button",{onClick:i,className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${e?"bg-green-100 text-green-700":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:e?t.jsxs(t.Fragment,{children:[t.jsx(wm,{className:"w-4 h-4"}),"Copied!"]}):t.jsxs(t.Fragment,{children:[t.jsx(vb,{className:"w-4 h-4"}),"Copy Code"]})})]}),t.jsx("div",{className:"p-4 bg-gray-900 overflow-x-auto",children:t.jsx("pre",{className:"text-sm text-gray-100 whitespace-pre-wrap font-mono",children:r==null?void 0:r.embedCode})})]}),t.jsxs("div",{className:"mt-6 bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Widget Settings"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-gray-500",children:"Primary Color"}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx("div",{className:"w-6 h-6 rounded border border-gray-200",style:{backgroundColor:(r==null?void 0:r.settings.primary_color)||"#4F46E5"}}),t.jsx("span",{className:"font-mono text-sm",children:(r==null?void 0:r.settings.primary_color)||"#4F46E5"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-gray-500",children:"Button Text"}),t.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.button_text)||"Chat with us"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"text-sm text-gray-500",children:"Welcome Message"}),t.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.welcome_message)||"Hi!  I'm McCarthy AI. How can I help you today?"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"text-sm text-gray-500",children:"Offline Message"}),t.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(r==null?void 0:r.settings.offline_message)||"We're currently offline. Please leave a message!"})]})]}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:t.jsxs("a",{href:"/settings/chat-widget",className:"inline-flex items-center gap-2 text-indigo-600 hover:text-indigo-800 font-medium",children:[t.jsx(cl,{className:"w-4 h-4"}),"Customize Widget Settings"]})})]}),t.jsxs("div",{className:"mt-6 bg-amber-50 border border-amber-200 rounded-lg p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-amber-900 mb-2",children:"Test Your Widget"}),t.jsx("p",{className:"text-amber-800 mb-4",children:"After adding the embed code to your website, test the widget to ensure it's working correctly:"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-amber-800",children:[t.jsx("li",{children:"Check that the chat bubble appears in the bottom-right corner"}),t.jsx("li",{children:"Click the bubble to open the chat window"}),t.jsx("li",{children:"Enter your name and email to start a conversation"}),t.jsx("li",{children:"Send a test message and verify you receive an AI response"}),t.jsx("li",{children:"Check the Chat Dashboard to see the conversation appear"})]})]})]})}function CC(){const e=ct(),[s,r]=m.useState("widget"),[n,a]=m.useState(!1),[i,l]=m.useState("idle"),[o,c]=m.useState(""),[d,h]=m.useState({is_enabled:!0,primary_color:"#4F46E5",secondary_color:"#FFFFFF",button_text:"Chat with us",welcome_message:"Hi!  I'm McCarthy AI. How can I help you today?",offline_message:"We're currently offline. Please leave a message and we'll get back to you!",show_business_hours:!0,require_email_when_offline:!0}),{data:u,isLoading:p}=ue({queryKey:["chatSettings"],queryFn:()=>Rr.getSettings().then(y=>y.data)}),{data:j}=ue({queryKey:["embedCode"],queryFn:()=>Rr.getEmbedCode().then(y=>y.data)});m.useEffect(()=>{u!=null&&u.settings&&h({is_enabled:u.settings.is_enabled??!0,primary_color:u.settings.primary_color||"#4F46E5",secondary_color:u.settings.secondary_color||"#FFFFFF",button_text:u.settings.button_text||"Chat with us",welcome_message:u.settings.welcome_message||"Hi!  I'm McCarthy AI. How can I help you today?",offline_message:u.settings.offline_message||"We're currently offline. Please leave a message!",show_business_hours:u.settings.show_business_hours??!0,require_email_when_offline:u.settings.require_email_when_offline??!0})},[u]);const x=Ne({mutationFn:()=>Rr.updateSettings(d),onSuccess:()=>{l("success"),e.invalidateQueries({queryKey:["chatSettings"]}),e.invalidateQueries({queryKey:["embedCode"]}),setTimeout(()=>l("idle"),3e3)},onError:y=>{l("error"),c(y.message||"Failed to save settings"),setTimeout(()=>l("idle"),5e3)}}),g=()=>{j!=null&&j.embedCode&&(navigator.clipboard.writeText(j.embedCode),a(!0),setTimeout(()=>a(!1),2e3))};return p?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):t.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AI Chat Widget"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Configure and embed the McCarthy AI chat widget on your website"})]}),t.jsx("div",{className:"border-b border-gray-200 mb-6",children:t.jsxs("nav",{className:"-mb-px flex space-x-8",children:[t.jsxs("button",{onClick:()=>r("widget"),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${s==="widget"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.jsx(gi,{className:"w-4 h-4"}),"Widget Settings"]}),t.jsxs("button",{onClick:()=>r("embed"),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${s==="embed"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.jsx(bb,{className:"w-4 h-4"}),"Embed Code"]})]})}),s==="widget"&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Enable Chat Widget"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Show the chat widget on your website"})]}),t.jsx("button",{onClick:()=>h(y=>({...y,is_enabled:!y.is_enabled})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.is_enabled?"bg-indigo-600":"bg-gray-200"}`,children:t.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.is_enabled?"translate-x-5":"translate-x-0"}`})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Color"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[t.jsx("input",{type:"color",value:d.primary_color,onChange:y=>h(b=>({...b,primary_color:y.target.value})),className:"sr-only"}),t.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm cursor-pointer",style:{backgroundColor:d.primary_color}})]}),t.jsx("input",{type:"text",value:d.primary_color,onChange:y=>h(b=>({...b,primary_color:y.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("label",{className:"flex-shrink-0 cursor-pointer",children:[t.jsx("input",{type:"color",value:d.secondary_color,onChange:y=>h(b=>({...b,secondary_color:y.target.value})),className:"sr-only"}),t.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-gray-400 shadow-sm cursor-pointer",style:{backgroundColor:d.secondary_color}})]}),t.jsx("input",{type:"text",value:d.secondary_color,onChange:y=>h(b=>({...b,secondary_color:y.target.value})),className:"w-24 px-2 py-2 border border-gray-300 rounded-lg text-sm font-mono"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),t.jsx("input",{type:"text",value:d.button_text,onChange:y=>h(b=>({...b,button_text:y.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Chat with us"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Welcome Message"}),t.jsx("textarea",{value:d.welcome_message,onChange:y=>h(b=>({...b,welcome_message:y.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Hi! How can we help you today?"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"First message shown when chat opens"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Offline Message"}),t.jsx("textarea",{value:d.offline_message,onChange:y=>h(b=>({...b,offline_message:y.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Our team is currently offline..."}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown when no staff are online"})]}),t.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Show Business Hours"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Display hours in the widget"})]}),t.jsx("button",{onClick:()=>h(y=>({...y,show_business_hours:!y.show_business_hours})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.show_business_hours?"bg-indigo-600":"bg-gray-200"}`,children:t.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.show_business_hours?"translate-x-5":"translate-x-0"}`})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Require Email When Offline"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Collect email for follow-up"})]}),t.jsx("button",{onClick:()=>h(y=>({...y,require_email_when_offline:!y.require_email_when_offline})),className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none ${d.require_email_when_offline?"bg-indigo-600":"bg-gray-200"}`,children:t.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${d.require_email_when_offline?"translate-x-5":"translate-x-0"}`})})]})]}),t.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[i==="success"&&t.jsxs("span",{className:"text-green-600 flex items-center gap-2 text-sm",children:[t.jsx(wm,{className:"w-4 h-4"})," Saved"]}),i==="error"&&t.jsx("span",{className:"text-red-600 text-sm",children:o||"Failed to save"}),t.jsx("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:x.isPending?"Saving...":"Save Settings"})]})]})}),t.jsxs("div",{className:"bg-gray-100 rounded-lg p-6",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Preview"}),t.jsxs("div",{className:"bg-white rounded-lg shadow-inner h-96 relative overflow-hidden",children:[t.jsxs("div",{className:"absolute inset-0 p-4",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),t.jsx("div",{className:"h-24 bg-gray-100 rounded mb-4"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),t.jsx("div",{className:"absolute bottom-4 right-4",children:t.jsxs("div",{className:"inline-flex items-center gap-2 px-5 py-3 rounded-full shadow-lg cursor-pointer transform hover:scale-105 transition-transform",style:{backgroundColor:d.primary_color,color:d.secondary_color},children:[t.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M12 3l1.5 4.5L18 9l-4.5 1.5L12 15l-1.5-4.5L6 9l4.5-1.5L12 3z"}),t.jsx("path",{d:"M5 19l1 3 1-3 3-1-3-1-1-3-1 3-3 1 3 1z"})]}),t.jsx("span",{className:"font-medium",children:d.button_text})]})})]})]})]}),s==="embed"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Embed Code"}),t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Copy and paste this code into your website, just before the closing ",t.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"</body>"})," tag."]}),t.jsxs("div",{className:"relative bg-gray-800 rounded-lg p-4 text-sm font-mono text-green-400 overflow-x-auto",children:[t.jsx("pre",{className:"whitespace-pre-wrap",children:(j==null?void 0:j.embedCode)||"Loading..."}),t.jsx("button",{onClick:g,className:"absolute top-2 right-2 p-2 rounded-md bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors",title:"Copy to clipboard",children:n?t.jsx(wm,{className:"w-5 h-5 text-green-400"}):t.jsx(vb,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Widget Settings"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[t.jsxs("div",{children:[t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Enabled:"})," ",d.is_enabled?"Yes":"No"]}),t.jsxs("p",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium",children:"Button Color:"})," ",t.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:d.primary_color}})," ",d.primary_color]}),t.jsxs("p",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium",children:"Text Color:"})," ",t.jsx("span",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:d.secondary_color}})," ",d.secondary_color]}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Button Text:"}),' "',d.button_text,'"']})]}),t.jsxs("div",{children:[t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Welcome Message:"}),' "',d.welcome_message,'"']}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Offline Message:"}),' "',d.offline_message,'"']}),t.jsxs("p",{children:[t.jsx("span",{className:"font-medium",children:"Show Business Hours:"})," ",d.show_business_hours?"Yes":"No"]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Testing Checklist"}),t.jsxs("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-700",children:[t.jsx("li",{children:"Ensure the widget appears on your website"}),t.jsx("li",{children:"Test starting a new chat when online"}),t.jsx("li",{children:"Verify custom colors and messages are applied"}),t.jsx("li",{children:"Check responsiveness on mobile devices"}),t.jsx("li",{children:"Test the AI responses"}),t.jsx("li",{children:"Test escalation to human staff"})]})]})]})]})}const _C=[{value:"policies",label:"Policies",description:"Returns, shipping, terms, privacy"},{value:"products",label:"Products",description:"Product information and specs"},{value:"faq",label:"FAQ",description:"Frequently asked questions"},{value:"general",label:"General",description:"Company info, ordering process"},{value:"other",label:"Other",description:"Miscellaneous documents"}];function EC(){const e=ct(),[s,r]=m.useState("general"),[n,a]=m.useState(!1),[i,l]=m.useState("idle"),[o,c]=m.useState(""),{data:d,isLoading:h}=ue({queryKey:["rag-documents"],queryFn:()=>wo.listDocuments().then(N=>N.data)}),u=(d==null?void 0:d.documents)||[],p=Ne({mutationFn:({file:N,category:P})=>wo.uploadDocument(N,P).then(z=>z.data),onSuccess:N=>{l("success"),c(N.message||"Document uploaded successfully"),e.invalidateQueries({queryKey:["rag-documents"]}),setTimeout(()=>l("idle"),3e3)},onError:N=>{var P,z;l("error"),c(((z=(P=N.response)==null?void 0:P.data)==null?void 0:z.error)||N.message||"Failed to upload document"),setTimeout(()=>l("idle"),5e3)}}),j=Ne({mutationFn:N=>wo.deleteDocument(N),onSuccess:()=>{e.invalidateQueries({queryKey:["rag-documents"]})}}),x=Ne({mutationFn:()=>wo.reprocessDocuments(),onSuccess:()=>{e.invalidateQueries({queryKey:["rag-documents"]})}}),g=N=>{N.preventDefault(),N.stopPropagation(),N.type==="dragenter"||N.type==="dragover"?a(!0):N.type==="dragleave"&&a(!1)},y=N=>{N.preventDefault(),N.stopPropagation(),a(!1),N.dataTransfer.files&&N.dataTransfer.files[0]&&f(N.dataTransfer.files[0])},b=N=>{N.target.files&&N.target.files[0]&&f(N.target.files[0])},f=N=>{var E;const P=[".md",".txt",".pdf"],z="."+((E=N.name.split(".").pop())==null?void 0:E.toLowerCase());if(!P.includes(z)){l("error"),c("Invalid file type. Please upload .md, .txt, or .pdf files."),setTimeout(()=>l("idle"),5e3);return}if(N.size>5*1024*1024){l("error"),c("File too large. Maximum size is 5MB."),setTimeout(()=>l("idle"),5e3);return}l("uploading"),p.mutate({file:N,category:s})},v=N=>{switch(N){case"active":return t.jsx(lt,{className:"w-4 h-4 text-green-500"});case"processing":return t.jsx(Xi,{className:"w-4 h-4 text-yellow-500 animate-spin"});case"error":return t.jsx(yr,{className:"w-4 h-4 text-red-500"});default:return t.jsx(Xl,{className:"w-4 h-4 text-gray-400"})}},w=N=>({policies:"bg-blue-100 text-blue-700",products:"bg-green-100 text-green-700",faq:"bg-purple-100 text-purple-700",general:"bg-gray-100 text-gray-700",other:"bg-yellow-100 text-yellow-700"})[N]||"bg-gray-100 text-gray-700";return t.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(J4,{className:"w-6 h-6 text-indigo-600"}),"RAG Knowledge Base"]}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Upload documents to enhance the AI Agent's knowledge. The AI will use these documents to provide accurate, context-aware responses."})]}),t.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[t.jsx("h3",{className:"font-semibold text-indigo-900 mb-2",children:"What is RAG?"}),t.jsxs("p",{className:"text-sm text-indigo-800",children:[t.jsx("strong",{children:"RAG (Retrieval-Augmented Generation)"})," allows the AI to search through your uploaded documents and use relevant information when responding to customers. This ensures accurate, up-to-date answers based on your actual policies, products, and procedures - eliminating AI hallucinations."]}),t.jsxs("ul",{className:"mt-2 text-sm text-indigo-700 list-disc list-inside",children:[t.jsx("li",{children:"Upload your policies, FAQs, and product information"}),t.jsx("li",{children:"AI searches documents for relevant context"}),t.jsx("li",{children:"Responses are grounded in your actual content"}),t.jsx("li",{children:"Update documents anytime to keep AI knowledge current"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload Document"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),t.jsx("select",{value:s,onChange:N=>r(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",children:_C.map(N=>t.jsxs("option",{value:N.value,children:[N.label," - ",N.description]},N.value))})]}),t.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${n?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:y,children:[t.jsx(Eb,{className:"w-10 h-10 mx-auto text-gray-400 mb-3"}),t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drag & drop a file here, or"}),t.jsxs("label",{className:"cursor-pointer",children:[t.jsx("span",{className:"px-4 py-2 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 inline-block",children:"Browse Files"}),t.jsx("input",{type:"file",className:"hidden",accept:".md,.txt,.pdf",onChange:b})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Supported: .md, .txt, .pdf (max 5MB)"})]}),i!=="idle"&&t.jsxs("div",{className:`mt-4 p-3 rounded-lg text-sm ${i==="uploading"?"bg-blue-50 text-blue-700":i==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[i==="uploading"&&t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Xi,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}),i==="success"&&t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(lt,{className:"w-4 h-4"}),o]}),i==="error"&&t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(yr,{className:"w-4 h-4"}),o]})]}),t.jsxs("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"w-full mt-4 px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2 disabled:opacity-50",children:[t.jsx(Xi,{className:`w-4 h-4 ${x.isPending?"animate-spin":""}`}),"Reprocess All Documents"]})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:t.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Uploaded Documents (",u.length,")"]})}),h?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(Xi,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading documents..."]}):u.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(tg,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.jsx("p",{children:"No documents uploaded yet"}),t.jsx("p",{className:"text-sm mt-1",children:"Upload your first document to get started"})]}):t.jsx("div",{className:"divide-y divide-gray-200",children:u.map(N=>{var P;return t.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(tg,{className:"w-5 h-5 text-gray-400 mt-0.5"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h4",{className:"font-medium text-gray-900",children:N.title||N.filename}),v(N.status)]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:N.filename}),t.jsxs("div",{className:"flex items-center gap-3 mt-2 flex-wrap",children:[t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${w(N.category)}`,children:N.category}),t.jsxs("span",{className:"text-xs text-gray-400",children:[(P=N.word_count)==null?void 0:P.toLocaleString()," words"]}),t.jsxs("span",{className:"text-xs text-gray-400",children:[" ",new Date(N.uploaded_at).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})," at ",new Date(N.uploaded_at).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"})]})]}),N.content_preview&&t.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:N.content_preview})]})]}),t.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this document?")&&j.mutate(N.id)},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete document",children:t.jsx(fi,{className:"w-4 h-4"})})]})},N.id)})})]})})]})]})}const Yr={role:"You are McCarthy AI, a friendly and professional customer service assistant for Amazing Transfers, an Australian company specializing in DTF (Direct to Film) and UV DTF transfers for custom printing.",personality:`- Warm, helpful, and professional
- Use Australian English (colour, metre, etc.)
- Friendly but not overly casual
- Patient and understanding
- Knowledgeable about DTF printing`,responsibilities:`- Answer questions about products, ordering, and policies
- Help customers with order inquiries
- Provide application instructions for DTF and UV DTF transfers
- Explain shipping, returns, and refund policies
- Assist with artwork requirements and file formats
- Escalate complex issues to human staff when needed`,dos:`- Always be polite and respectful
- Provide accurate information from the knowledge base
- Acknowledge customer frustrations with empathy
- Offer to escalate to human staff when you can't help
- Use the customer's name when known
- Confirm understanding before providing solutions`,donts:`- Never make up information or guess at policies
- Don't provide specific pricing (direct to website)
- Don't promise things you can't guarantee
- Never argue with customers
- Don't share internal business information
- Don't use American spelling (use colour not color)`,tone:"Professional yet friendly. Think of a knowledgeable colleague who genuinely wants to help. Not robotic, but not overly casual either. Match the customer's energy level.",custom_instructions:""};function MC(){const e=ct(),[s,r]=m.useState(Yr),[n,a]=m.useState("idle"),[i,l]=m.useState(""),[o,c]=m.useState(!1),{data:d,isLoading:h}=ue({queryKey:["ai-system-message"],queryFn:()=>Dd.getConfig().then(x=>x.data)});m.useEffect(()=>{d!=null&&d.config&&r({role:d.config.role||Yr.role,personality:d.config.personality||Yr.personality,responsibilities:d.config.responsibilities||Yr.responsibilities,dos:d.config.dos||Yr.dos,donts:d.config.donts||Yr.donts,tone:d.config.tone||Yr.tone,custom_instructions:d.config.custom_instructions||""})},[d]);const u=Ne({mutationFn:()=>Dd.updateConfig(s),onSuccess:()=>{a("success"),e.invalidateQueries({queryKey:["ai-system-message"]}),setTimeout(()=>a("idle"),3e3)},onError:x=>{var g,y;a("error"),l(((y=(g=x.response)==null?void 0:g.data)==null?void 0:y.error)||x.message||"Failed to save"),setTimeout(()=>a("idle"),5e3)}}),p=Ne({mutationFn:()=>Dd.resetToDefault(),onSuccess:()=>{r(Yr),e.invalidateQueries({queryKey:["ai-system-message"]})}}),j=()=>`# System Message for McCarthy AI

## Role
${s.role}

## Personality
${s.personality}

## Responsibilities
${s.responsibilities}

## Do's
${s.dos}

## Don'ts
${s.donts}

## Tone
${s.tone}

${s.custom_instructions?`## Custom Instructions
${s.custom_instructions}`:""}
`;return h?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):t.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(Zs,{className:"w-6 h-6 text-indigo-600"}),"AI System Message"]}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Configure the AI Agent's personality, role, and behavior guidelines. This defines how McCarthy AI interacts with customers."})]}),t.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[t.jsxs("h3",{className:"font-semibold text-indigo-900 mb-2 flex items-center gap-2",children:[t.jsx(Nm,{className:"w-4 h-4"}),"What is a System Message?"]}),t.jsxs("p",{className:"text-sm text-indigo-800",children:["The ",t.jsx("strong",{children:"System Message"})," (also called a system prompt) defines the AI's identity, personality, and behavioral guidelines. It's the foundation that shapes how the AI responds to customers - its tone, what it can/can't do, and how it handles different situations."]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Role Definition",t.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Who is the AI?"})]}),t.jsx("textarea",{value:s.role,onChange:x=>r({...s,role:x.target.value}),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"You are McCarthy AI, a customer service assistant..."})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Personality Traits",t.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"How should the AI behave?"})]}),t.jsx("textarea",{value:s.personality,onChange:x=>r({...s,personality:x.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Friendly and professional
- Patient and understanding...`})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Responsibilities",t.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"What should the AI do?"})]}),t.jsx("textarea",{value:s.responsibilities,onChange:x=>r({...s,responsibilities:x.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Answer product questions
- Help with orders...`})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Do's ",t.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Best practices to follow"})]}),t.jsx("textarea",{value:s.dos,onChange:x=>r({...s,dos:x.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Always be polite
- Provide accurate information...`})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Don'ts ",t.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Things to avoid"})]}),t.jsx("textarea",{value:s.donts,onChange:x=>r({...s,donts:x.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:`- Never make up information
- Don't promise things...`})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Tone of Voice",t.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"How should responses sound?"})]}),t.jsx("textarea",{value:s.tone,onChange:x=>r({...s,tone:x.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Professional yet friendly..."})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Custom Instructions",t.jsx("span",{className:"text-gray-500 font-normal ml-2",children:"Any additional guidelines"})]}),t.jsx("textarea",{value:s.custom_instructions,onChange:x=>r({...s,custom_instructions:x.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Add any specific instructions, business rules, or special handling..."}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use this for business-specific rules, special promotions, or temporary instructions."})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Actions"}),n==="success"&&t.jsxs("span",{className:"text-green-600 flex items-center gap-1 text-sm",children:[t.jsx(lt,{className:"w-4 h-4"})," Saved"]}),n==="error"&&t.jsxs("span",{className:"text-red-600 flex items-center gap-1 text-sm",children:[t.jsx(Xl,{className:"w-4 h-4"})," ",i]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:()=>u.mutate(),disabled:u.isPending,className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[t.jsx(Zl,{className:"w-4 h-4"}),u.isPending?"Saving...":"Save Configuration"]}),t.jsx("button",{onClick:()=>c(!o),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2",children:o?"Hide Preview":"Show Full Preview"}),t.jsxs("button",{onClick:()=>{confirm("Reset to default configuration? This will overwrite your current settings.")&&p.mutate()},disabled:p.isPending,className:"w-full px-4 py-2 border border-red-300 rounded-lg text-red-700 hover:bg-red-50 flex items-center justify-center gap-2 disabled:opacity-50",children:[t.jsx(Xi,{className:`w-4 h-4 ${p.isPending?"animate-spin":""}`}),"Reset to Default"]})]})]}),o&&t.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Full System Message Preview"}),t.jsx("div",{className:"bg-gray-900 rounded-lg p-4 text-sm font-mono text-green-400 overflow-auto max-h-96",children:t.jsx("pre",{className:"whitespace-pre-wrap",children:j()})})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:" Tips for Better AI Responses"}),t.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[t.jsx("li",{children:" Be specific about what the AI should and shouldn't do"}),t.jsx("li",{children:" Include examples of ideal responses in custom instructions"}),t.jsx("li",{children:" Update regularly based on common customer issues"}),t.jsx("li",{children:" Use bullet points for clarity"}),t.jsx("li",{children:" Test changes with sample conversations"})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Configuration Size"}),t.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[j().length.toLocaleString(),t.jsx("span",{className:"text-sm font-normal text-gray-500 ml-2",children:"characters"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: Keep under 4,000 characters for optimal performance"})]})]})]})]})}const TC={tenant_id:"default",business_name:"",business_email:"",business_phone:"",business_address:"",business_website:"",timezone:"Australia/Brisbane",language:"en-AU",measurement_system:"metric",currency:"AUD",currency_symbol:"$",date_format:"DD/MM/YYYY",time_format:"12h"};function AC(){var j,x;const e=ct(),[s,r]=m.useState(TC),[n,a]=m.useState(!1),{data:i,isLoading:l}=ue({queryKey:["tenant-settings"],queryFn:async()=>(await D.get("/api/tenant/settings")).data}),{data:o}=ue({queryKey:["tenant-settings-options"],queryFn:async()=>(await D.get("/api/tenant/settings/options")).data});m.useEffect(()=>{i&&r(i)},[i]);const c=Ne({mutationFn:async g=>(await D.put("/api/tenant/settings",g)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["tenant-settings"]}),alert("Settings saved successfully!")},onError:g=>{alert(`Failed to save settings: ${g.message}`)}}),d=()=>{c.mutate(s)},h=()=>{a(!0)},u=()=>{r({tenant_id:"default",business_name:"",business_email:"",business_phone:"",business_address:"",business_website:"",timezone:"Australia/Brisbane",language:"en-AU",measurement_system:"metric",currency:"AUD",currency_symbol:"$",date_format:"DD/MM/YYYY",time_format:"12h"}),a(!1)},p=g=>{const y=o==null?void 0:o.currencies.find(b=>b.value===g);r({...s,currency:g,currency_symbol:(y==null?void 0:y.symbol)||"$"})};return l?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"Loading settings..."})}):t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:t.jsx(gi,{className:"w-6 h-6 text-indigo-600"})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dartmouth OS Settings"})]}),t.jsx("p",{className:"text-gray-600",children:"Configure global settings for your Dartmouth OS instance. These settings apply to all agents unless overridden."})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(s3,{className:"w-5 h-5 text-gray-600"}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Business Information"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Business Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:s.business_name,onChange:g=>r({...s,business_name:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Amazing Transfers"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Email"}),t.jsx("input",{type:"email",value:s.business_email,onChange:g=>r({...s,business_email:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"support@amazingtransfers.com.au"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Phone"}),t.jsx("input",{type:"tel",value:s.business_phone,onChange:g=>r({...s,business_phone:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"+61 7 1234 5678"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),t.jsx("input",{type:"url",value:s.business_website,onChange:g=>r({...s,business_website:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"https://amazingtransfers.com.au"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Address"}),t.jsx("input",{type:"text",value:s.business_address,onChange:g=>r({...s,business_address:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"123 Transfer Lane, Brisbane QLD 4000"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(Uh,{className:"w-5 h-5 text-gray-600"}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Regional Settings"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(ga,{className:"w-4 h-4 inline mr-1"}),"Timezone"]}),t.jsx("select",{value:s.timezone,onChange:g=>r({...s,timezone:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.timezones.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(O3,{className:"w-4 h-4 inline mr-1"}),"Language / Spelling"]}),t.jsx("select",{value:s.language,onChange:g=>r({...s,language:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.languages.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(j=o==null?void 0:o.languages.find(g=>g.value===s.language))==null?void 0:j.spelling})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(Z3,{className:"w-4 h-4 inline mr-1"}),"Measurement System"]}),t.jsx("select",{value:s.measurement_system,onChange:g=>r({...s,measurement_system:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.measurementSystems.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(j3,{className:"w-4 h-4 inline mr-1"}),"Currency"]}),t.jsx("select",{value:s.currency,onChange:g=>p(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.currencies.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(yb,{className:"w-5 h-5 text-gray-600"}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Date & Time Formats"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),t.jsx("select",{value:s.date_format,onChange:g=>r({...s,date_format:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.dateFormats.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),t.jsx("select",{value:s.time_format,onChange:g=>r({...s,time_format:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:o==null?void 0:o.timeFormats.map(g=>t.jsx("option",{value:g.value,children:g.label},g.value))})]})]})]}),t.jsxs("div",{className:"bg-indigo-50 rounded-xl border border-indigo-200 p-6 mb-6",children:[t.jsx("h3",{className:"text-sm font-semibold text-indigo-900 mb-3",children:"Preview - How AI Will Format Responses"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-indigo-600 font-medium",children:"Date:"}),t.jsx("p",{className:"text-indigo-900",children:((x=o==null?void 0:o.dateFormats.find(g=>g.value===s.date_format))==null?void 0:x.example)||"31/12/2025"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-indigo-600 font-medium",children:"Time:"}),t.jsx("p",{className:"text-indigo-900",children:s.time_format==="12h"?"2:30 PM":"14:30"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-indigo-600 font-medium",children:"Currency:"}),t.jsxs("p",{className:"text-indigo-900",children:[s.currency_symbol,"99.95 ",s.currency]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-indigo-600 font-medium",children:"Measurement:"}),t.jsx("p",{className:"text-indigo-900",children:s.measurement_system==="metric"?"50 cm, 2.5 kg":"20 in, 5.5 lb"})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[t.jsx(Cb,{className:"w-4 h-4"}),"Reset to Defaults"]}),t.jsxs("button",{onClick:d,disabled:c.isPending,className:"flex items-center gap-2 px-6 py-2 text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[t.jsx(Zl,{className:"w-4 h-4"}),c.isPending?"Saving...":"Save Settings"]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Reset to Factory Defaults?"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This will reset all settings to their factory defaults:"}),t.jsxs("ul",{className:"text-sm text-gray-600 mb-4 list-disc list-inside",children:[t.jsx("li",{children:"Timezone: Australia/Brisbane"}),t.jsx("li",{children:"Language: Australian English"}),t.jsx("li",{children:"Measurement: Metric"}),t.jsx("li",{children:"Currency: AUD ($)"}),t.jsx("li",{children:"Date Format: DD/MM/YYYY"}),t.jsx("li",{children:"Time Format: 12-hour"}),t.jsx("li",{children:"Business information will be cleared"})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:u,className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Reset Settings"})]})]})})]})}function PC(){var p,j;const e=ct(),[s,r]=m.useState({agent_id:"customer-service-agent",timezone:null,language:null,measurement_system:null,currency:null,currency_symbol:null,date_format:null,time_format:null}),{data:n}=ue({queryKey:["tenant-settings"],queryFn:async()=>(await D.get("/api/tenant/settings")).data}),{data:a,isLoading:i}=ue({queryKey:["agent-overrides"],queryFn:async()=>(await D.get("/api/ai-agent/regional-overrides")).data}),{data:l}=ue({queryKey:["tenant-settings-options"],queryFn:async()=>(await D.get("/api/tenant/settings/options")).data});m.useEffect(()=>{a&&r(a)},[a]);const o=Ne({mutationFn:async x=>(await D.put("/api/ai-agent/regional-overrides",x)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["agent-overrides"]}),alert("Overrides saved successfully!")},onError:x=>{alert(`Failed to save overrides: ${x.message}`)}}),c=()=>{o.mutate(s)},d=()=>{r({agent_id:"customer-service-agent",timezone:null,language:null,measurement_system:null,currency:null,currency_symbol:null,date_format:null,time_format:null})},h=x=>{const g=s[x];return g!==null&&g!==""?g:(n==null?void 0:n[x])||""},u=x=>s[x]!==null&&s[x]!=="";return i?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"Loading overrides..."})}):t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs(Je,{to:"/ai-agent/system-message",className:"text-sm text-indigo-600 hover:text-indigo-800 flex items-center gap-1 mb-4",children:[t.jsx(Q4,{className:"w-4 h-4"}),"Back to AI Agent Settings"]}),t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:t.jsx(Uh,{className:"w-6 h-6 text-purple-600"})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agent Regional Overrides"})]}),t.jsx("p",{className:"text-gray-600",children:"Override tenant-level regional settings for this specific agent. Leave fields empty to inherit from Dartmouth OS Settings."})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"How it works:"}),' Settings left as "Inherit from tenant" will use the values from',t.jsx(Je,{to:"/settings/dartmouth-os",className:"text-blue-600 hover:underline mx-1",children:"Dartmouth OS Settings"}),". Only set overrides if this agent needs different regional settings (e.g., for a US market)."]})}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(gi,{className:"w-5 h-5 text-gray-600"}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Regional Overrides"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Timezone",u("timezone")&&t.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),t.jsxs("select",{value:s.timezone||"",onChange:x=>r({...s,timezone:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[t.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.timezone,")"]}),l==null?void 0:l.timezones.map(x=>t.jsx("option",{value:x.value,children:x.label},x.value))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Language / Spelling",u("language")&&t.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),t.jsxs("select",{value:s.language||"",onChange:x=>r({...s,language:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[t.jsxs("option",{value:"",children:["Inherit from tenant (",(p=l==null?void 0:l.languages.find(x=>x.value===(n==null?void 0:n.language)))==null?void 0:p.label,")"]}),l==null?void 0:l.languages.map(x=>t.jsx("option",{value:x.value,children:x.label},x.value))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Measurement System",u("measurement_system")&&t.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),t.jsxs("select",{value:s.measurement_system||"",onChange:x=>r({...s,measurement_system:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[t.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.measurement_system,")"]}),l==null?void 0:l.measurementSystems.map(x=>t.jsx("option",{value:x.value,children:x.label},x.value))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Currency",u("currency")&&t.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),t.jsxs("select",{value:s.currency||"",onChange:x=>{const g=l==null?void 0:l.currencies.find(y=>y.value===x.target.value);r({...s,currency:x.target.value||null,currency_symbol:(g==null?void 0:g.symbol)||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[t.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.currency,")"]}),l==null?void 0:l.currencies.map(x=>t.jsx("option",{value:x.value,children:x.label},x.value))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date Format",u("date_format")&&t.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),t.jsxs("select",{value:s.date_format||"",onChange:x=>r({...s,date_format:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[t.jsxs("option",{value:"",children:["Inherit from tenant (",n==null?void 0:n.date_format,")"]}),l==null?void 0:l.dateFormats.map(x=>t.jsx("option",{value:x.value,children:x.label},x.value))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Time Format",u("time_format")&&t.jsx("span",{className:"ml-2 text-xs text-purple-600 bg-purple-100 px-1.5 py-0.5 rounded",children:"Overridden"})]}),t.jsxs("select",{value:s.time_format||"",onChange:x=>r({...s,time_format:x.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[t.jsxs("option",{value:"",children:["Inherit from tenant (",(n==null?void 0:n.time_format)==="12h"?"12-hour":"24-hour",")"]}),l==null?void 0:l.timeFormats.map(x=>t.jsx("option",{value:x.value,children:x.label},x.value))]})]})]})]}),t.jsxs("div",{className:"bg-purple-50 rounded-xl border border-purple-200 p-6 mb-6",children:[t.jsx("h3",{className:"text-sm font-semibold text-purple-900 mb-3",children:"Effective Settings for This Agent"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-purple-600 font-medium",children:"Timezone:"}),t.jsx("p",{className:"text-purple-900",children:h("timezone")})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-purple-600 font-medium",children:"Language:"}),t.jsx("p",{className:"text-purple-900",children:((j=l==null?void 0:l.languages.find(x=>x.value===h("language")))==null?void 0:j.label)||h("language")})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-purple-600 font-medium",children:"Measurement:"}),t.jsx("p",{className:"text-purple-900",children:h("measurement_system")})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-purple-600 font-medium",children:"Currency:"}),t.jsx("p",{className:"text-purple-900",children:h("currency")})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-purple-600 font-medium",children:"Date Format:"}),t.jsx("p",{className:"text-purple-900",children:h("date_format")})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-purple-600 font-medium",children:"Time Format:"}),t.jsx("p",{className:"text-purple-900",children:h("time_format")==="12h"?"12-hour":"24-hour"})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[t.jsx(Cb,{className:"w-4 h-4"}),"Clear All Overrides"]}),t.jsxs("button",{onClick:c,disabled:o.isPending,className:"flex items-center gap-2 px-6 py-2 text-white bg-purple-600 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[t.jsx(Zl,{className:"w-4 h-4"}),o.isPending?"Saving...":"Save Overrides"]})]})]})}function RC(){var p,j;const e=ct(),[s,r]=m.useState({enabled:!1,maxAssignedTickets:8,refillThreshold:3,priorityOrder:"priority_first",channels:["email","chat"],businessHoursOnly:!0}),{data:n,isLoading:a}=ue({queryKey:["autoAssignmentConfig"],queryFn:async()=>(await No.getConfig()).data}),{data:i,isLoading:l}=ue({queryKey:["autoAssignmentHistory"],queryFn:async()=>(await No.getHistory(50)).data});m.useEffect(()=>{n!=null&&n.config&&r(n.config)},[n]);const o=Ne({mutationFn:x=>No.updateConfig(x),onSuccess:()=>{e.invalidateQueries({queryKey:["autoAssignmentConfig"]})}}),c=Ne({mutationFn:()=>No.runNow(),onSuccess:()=>{e.invalidateQueries({queryKey:["autoAssignmentHistory"]})}}),d=()=>{o.mutate(s)},h=()=>{c.mutate()},u=x=>{const g=s.channels.includes(x)?s.channels.filter(y=>y!==x):[...s.channels,x];r({...s,channels:g})};return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"max-w-4xl mx-auto py-6 px-4",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Auto-Assignment Settings"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Configure automatic ticket assignment to online staff members"})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6 pb-6 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Auto-Assignment"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Automatically assign unassigned tickets to online staff"})]}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:s.enabled,onChange:x=>r({...s,enabled:x.target.checked}),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max Tickets per Staff"}),t.jsx("input",{type:"number",min:"1",max:"50",value:s.maxAssignedTickets,onChange:x=>r({...s,maxAssignedTickets:parseInt(x.target.value)||8}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Maximum tickets auto-assigned per staff member"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Refill Threshold"}),t.jsx("input",{type:"number",min:"0",max:"20",value:s.refillThreshold,onChange:x=>r({...s,refillThreshold:parseInt(x.target.value)||3}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Auto-assign more when staff drops below this count"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Assignment Priority"}),t.jsxs("select",{value:s.priorityOrder,onChange:x=>r({...s,priorityOrder:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[t.jsx("option",{value:"priority_first",children:"High Priority First"}),t.jsx("option",{value:"oldest_first",children:"Oldest First (FIFO)"}),t.jsx("option",{value:"newest_first",children:"Newest First"})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Order in which unassigned tickets are assigned"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Business Hours Only"}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer mt-2",children:[t.jsx("input",{type:"checkbox",checked:s.businessHoursOnly,onChange:x=>r({...s,businessHoursOnly:x.target.checked}),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),t.jsx("span",{className:"ml-3 text-sm text-gray-600 dark:text-gray-400",children:"Only assign during business hours"})]})]})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Channels to Auto-Assign"}),t.jsx("div",{className:"flex gap-4",children:["email","chat","phone"].map(x=>t.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:s.channels.includes(x),onChange:()=>u(x),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),t.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300 capitalize",children:x})]},x))})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[t.jsxs("button",{onClick:d,disabled:o.isPending,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[o.isPending?t.jsx(ng,{className:"h-4 w-4 mr-2 animate-spin"}):t.jsx(OS,{className:"h-4 w-4 mr-2"}),"Save Settings"]}),t.jsxs("button",{onClick:h,disabled:c.isPending||!s.enabled,className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[c.isPending?t.jsx(ng,{className:"h-4 w-4 mr-2 animate-spin"}):t.jsx(VS,{className:"h-4 w-4 mr-2"}),"Run Now"]})]}),c.isSuccess&&c.data&&t.jsxs("div",{className:"mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:[t.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200",children:[" ",c.data.data.message]}),((p=c.data.data.results)==null?void 0:p.length)>0&&t.jsx("ul",{className:"mt-2 text-sm text-green-700 dark:text-green-300",children:c.data.data.results.map((x,g)=>t.jsxs("li",{children:[" ",x.ticketNumber,"  ",x.staffName]},g))})]}),o.isSuccess&&t.jsx("div",{className:"mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:t.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:" Settings saved successfully"})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(Sm,{className:"h-5 w-5"}),"Assignment History"]}),t.jsx("button",{onClick:()=>e.invalidateQueries({queryKey:["autoAssignmentHistory"]}),className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Refresh"})]}),l?t.jsx("div",{className:"flex items-center justify-center h-32",children:t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):((j=i==null?void 0:i.history)==null?void 0:j.length)>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Ticket"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Assigned To"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reason"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Staff Queue"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Time"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:i.history.map(x=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:x.ticket_number}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:[x.staff_first_name," ",x.staff_last_name||""]}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${x.reason==="auto_refill"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"}`,children:x.reason==="auto_refill"?"Refill":"Initial"})}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:[x.staff_ticket_count," tickets"]}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(x.assigned_at).toLocaleString()})]},x.id))})]})}):t.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[t.jsx(Sm,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No auto-assignments yet"}),t.jsx("p",{className:"text-sm mt-1",children:"Enable auto-assignment and assignments will appear here"})]})]})]})}const LC=[{title:"Dartmouth OS",description:"Global system settings including timezone, language, currency, and regional preferences",path:"/settings/dartmouth-os",category:"System"},{title:"Operational Hours",description:"Set your business operating hours for live chat availability",path:"/settings/business-hours",category:"Business"},{title:"Auto-Assignment",description:"Configure automatic ticket assignment to online staff members",path:"/settings/auto-assignment",category:"Business"},{title:"Group Chat",description:"Configure Group Chat channels, permissions, and edit/delete timeframes",path:"/settings/group-chat",category:"Business"},{title:"Widget & Embed",description:"Configure the chat widget appearance and get embed code for your website",path:"/ai-agent/widget",category:"AI Agent"},{title:"RAG Knowledge",description:"Upload and manage documents for AI to reference when answering questions",path:"/ai-agent/knowledge",category:"AI Agent"},{title:"System Message",description:"Define AI agent personality, role, responsibilities, and guidelines",path:"/ai-agent/system-message",category:"AI Agent"},{title:"Regional Overrides",description:"Override regional settings for specific AI agents",path:"/ai-agent/regional-overrides",category:"AI Agent"},{title:"Print ERP",description:"Connect and configure your Print ERP system integration",path:"/settings/integrations/perp",category:"Integrations"},{title:"Shopify",description:"Connect and configure your Shopify store integration",path:"/settings/integrations/shopify",category:"Integrations"},{title:"Facebook",description:"Connect your Facebook page for customer support",path:"/settings/meta/facebook",category:"Meta"},{title:"Instagram",description:"Connect your Instagram business account for DMs",path:"/settings/meta/instagram",category:"Meta"},{title:"Messenger",description:"Configure Facebook Messenger integration",path:"/settings/meta/messenger",category:"Meta"},{title:"WhatsApp",description:"Connect WhatsApp Business for customer messaging",path:"/settings/meta/whatsapp",category:"Meta"},{title:"Auth & Security",description:"Authentication settings, password policies, and security options",path:"/settings/general/auth",category:"General"},{title:"Templates",description:"Manage email templates and canned responses",path:"/settings/general/templates",category:"General"},{title:"Tags",description:"Configure AI auto-tagging, tag suggestions, and display preferences",path:"/settings/tags",category:"General"},{title:"Subscription",description:"Manage your subscription plan and billing details",path:"/settings/billing/subscription",category:"Billing"},{title:"Transactions",description:"View billing history and transaction records",path:"/settings/billing/transactions",category:"Billing"}];function $C(){const e=vr(),s=LC.reduce((a,i)=>(a[i.category]||(a[i.category]=[]),a[i.category].push(i),a),{}),r=["System","Business","AI Agent","Integrations","Meta","General","Billing"],n=a=>{switch(a){case"System":return t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})});case"Business":return t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"AI Agent":return t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})});case"Integrations":return t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"})});case"Meta":return t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})});case"General":return t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});case"Billing":return t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})});default:return t.jsx(Ko,{className:"w-5 h-5"})}};return t.jsxs("div",{className:"max-w-5xl mx-auto py-8 px-4",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[t.jsx(Ko,{className:"h-8 w-8 text-indigo-600"}),"Settings"]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Configure your system settings and integrations"})]}),r.map(a=>s[a]&&t.jsxs("div",{className:"mb-8",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 border-b border-gray-200 dark:border-gray-700 pb-2 flex items-center gap-2",children:[n(a),a]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s[a].map(i=>t.jsxs("button",{onClick:()=>e(i.path),className:"flex items-start gap-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-md transition-all text-left group",children:[t.jsx("div",{className:"flex-shrink-0 p-2 bg-gray-100 dark:bg-gray-700 rounded-lg group-hover:bg-indigo-100 dark:group-hover:bg-indigo-900/30 transition-colors",children:t.jsx(Ko,{className:"h-6 w-6 text-gray-500 dark:text-gray-400 group-hover:text-indigo-600 dark:group-hover:text-indigo-400"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-medium text-gray-900 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400",children:i.title}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:i.description})]}),t.jsx("div",{className:"flex-shrink-0 self-center",children:t.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},i.path))})]},a))]})}const Zd={online:{color:"bg-green-500",label:"Online",description:"Available for chats and tickets"},away:{color:"bg-yellow-500",label:"Away",description:"Temporarily unavailable"},offline:{color:"bg-gray-400",label:"Offline",description:"Not available for new assignments"}};function FC(){var E,X,T;const{user:e}=ts(),s=ct(),[r,n]=m.useState(""),[a,i]=m.useState(""),l=m.useRef(null),[o,c]=m.useState({first_name:"",last_name:"",email:"",job_title:"",phone:"",department:""}),{data:d,isLoading:h}=ue({queryKey:["currentStaff"],queryFn:()=>rt.me().then(F=>F.data.staff),enabled:!!e}),{data:u}=ue({queryKey:["my-tasks-digest"],queryFn:async()=>(await D.get("/api/tickets",{params:{channel:"task",assigned_to:e==null?void 0:e.id,limit:100}})).data.tickets,enabled:!!e}),p=new Date,j=(u==null?void 0:u.filter(F=>F.status!=="completed"&&F.status!=="cancelled"))||[],x=j.filter(F=>F.sla_due_at&&new Date(F.sla_due_at)<p),g=j.filter(F=>{if(!F.sla_due_at)return!1;const Q=new Date(F.sla_due_at),Z=new Date(p.getTime()+24*60*60*1e3);return Q>p&&Q<=Z});m.useEffect(()=>{d&&c({first_name:d.first_name||"",last_name:d.last_name||"",email:d.email||"",job_title:d.job_title||"",phone:d.phone||"",department:d.department||""})},[d]);const y=Ne({mutationFn:F=>rt.update((e==null?void 0:e.id)||"",F),onSuccess:()=>{s.invalidateQueries({queryKey:["currentStaff"]}),n("Profile updated successfully!"),i(""),setTimeout(()=>n(""),3e3)},onError:F=>{var Q,Z;i(((Z=(Q=F.response)==null?void 0:Q.data)==null?void 0:Z.error)||"Failed to update profile"),n("")}}),b=Ne({mutationFn:F=>rt.updateAvailability((e==null?void 0:e.id)||"",F),onSuccess:()=>{s.invalidateQueries({queryKey:["currentStaff"]}),n("Status updated!"),setTimeout(()=>n(""),2e3)}}),f=Ne({mutationFn:F=>rt.uploadAvatar((e==null?void 0:e.id)||"",F),onSuccess:()=>{s.invalidateQueries({queryKey:["currentStaff"]}),s.invalidateQueries({queryKey:["staffUsers"]}),n("Photo uploaded successfully!"),setTimeout(()=>n(""),3e3)},onError:F=>{var Q,Z;i(((Z=(Q=F.response)==null?void 0:Q.data)==null?void 0:Z.error)||"Failed to upload photo")}}),v=Ne({mutationFn:()=>rt.deleteAvatar((e==null?void 0:e.id)||""),onSuccess:()=>{s.invalidateQueries({queryKey:["currentStaff"]}),s.invalidateQueries({queryKey:["staffUsers"]}),n("Photo removed"),setTimeout(()=>n(""),2e3)},onError:F=>{var Q,Z;i(((Z=(Q=F.response)==null?void 0:Q.data)==null?void 0:Z.error)||"Failed to remove photo")}}),w=F=>{var Z;const Q=(Z=F.target.files)==null?void 0:Z[0];if(Q){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(Q.type)){i("Invalid file type. Please use JPEG, PNG, GIF, or WebP");return}if(Q.size>5*1024*1024){i("File too large. Maximum size is 5MB");return}f.mutate(Q)}l.current&&(l.current.value="")},N=F=>{F.preventDefault(),y.mutate(o)},P=F=>{c(Q=>({...Q,[F.target.name]:F.target.value}))},z=(d==null?void 0:d.availability_status)||"offline";return h?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):t.jsxs("div",{className:"py-6 px-4 sm:px-6 lg:px-8 max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Account"}),t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your profile information and availability status"})]}),r&&t.jsx("div",{className:"mb-6 rounded-md bg-green-50 p-4",children:t.jsxs("div",{className:"flex",children:[t.jsx(Ec,{className:"h-5 w-5 text-green-400"}),t.jsx("p",{className:"ml-3 text-sm font-medium text-green-800",children:r})]})}),a&&t.jsx("div",{className:"mb-6 rounded-md bg-red-50 p-4",children:t.jsxs("div",{className:"flex",children:[t.jsx(Mb,{className:"h-5 w-5 text-red-400"}),t.jsx("p",{className:"ml-3 text-sm font-medium text-red-800",children:a})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"relative group",children:[d!=null&&d.avatar_url?t.jsx("img",{src:rt.getAvatarUrl(d.avatar_url)||"",alt:`${d.first_name} ${d.last_name}`,className:"w-24 h-24 rounded-full object-cover"}):t.jsxs("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-3xl font-bold",children:[(E=d==null?void 0:d.first_name)==null?void 0:E[0],(X=d==null?void 0:d.last_name)==null?void 0:X[0]]}),t.jsx("div",{className:`absolute bottom-1 right-1 w-5 h-5 rounded-full border-2 border-white ${Zd[z].color}`}),t.jsxs("div",{className:"absolute inset-0 rounded-full bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:[t.jsx("button",{onClick:()=>{var F;return(F=l.current)==null?void 0:F.click()},className:"p-2 text-white hover:text-indigo-200 transition-colors",title:"Upload photo",children:t.jsx(FS,{className:"w-6 h-6"})}),(d==null?void 0:d.avatar_url)&&t.jsx("button",{onClick:()=>v.mutate(),className:"p-2 text-white hover:text-red-300 transition-colors",title:"Remove photo",children:t.jsx(JS,{className:"w-6 h-6"})})]}),t.jsx("input",{ref:l,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:w,className:"hidden"})]}),f.isPending&&t.jsxs("div",{className:"mt-2 text-sm text-indigo-600 flex items-center gap-1",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}),t.jsxs("h2",{className:"mt-4 text-lg font-semibold text-gray-900",children:[d==null?void 0:d.first_name," ",d==null?void 0:d.last_name]}),t.jsx("p",{className:"text-sm text-gray-500",children:(d==null?void 0:d.job_title)||"Team Member"}),t.jsx("span",{className:`mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(d==null?void 0:d.role)==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:(d==null?void 0:d.role)==="admin"?"Administrator":"Staff"})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Your Status"}),t.jsx("div",{className:"space-y-2",children:Object.keys(Zd).map(F=>{const Q=Zd[F],Z=F===z;return t.jsxs("button",{onClick:()=>b.mutate(F),disabled:b.isPending,className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-all ${Z?"bg-indigo-50 ring-2 ring-indigo-500":"hover:bg-gray-50 border border-gray-200"}`,children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${Q.color}`}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:`text-sm font-medium ${Z?"text-indigo-700":"text-gray-700"}`,children:Q.label}),t.jsx("p",{className:"text-xs text-gray-500",children:Q.description})]}),Z&&t.jsx(Ec,{className:"w-5 h-5 text-indigo-600"})]},F)})})]})]})}),t.jsxs("div",{className:"lg:col-span-2",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Profile Information"}),t.jsxs("form",{onSubmit:N,className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700",children:"First Name"}),t.jsx("input",{type:"text",id:"first_name",name:"first_name",value:o.first_name,onChange:P,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),t.jsx("input",{type:"text",id:"last_name",name:"last_name",value:o.last_name,onChange:P,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),t.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:P,disabled:!0,className:"mt-1 block w-full rounded-lg border-gray-300 bg-gray-50 shadow-sm sm:text-sm cursor-not-allowed"}),t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Email cannot be changed"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"job_title",className:"block text-sm font-medium text-gray-700",children:"Job Title"}),t.jsx("input",{type:"text",id:"job_title",name:"job_title",value:o.job_title,onChange:P,placeholder:"e.g. Customer Support Specialist",className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),t.jsx("input",{type:"tel",id:"phone",name:"phone",value:o.phone,onChange:P,placeholder:"e.g. 0412 345 678",className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700",children:"Department"}),t.jsxs("select",{id:"department",name:"department",value:o.department,onChange:P,className:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"Select a department"}),t.jsx("option",{value:"Customer Support",children:"Customer Support"}),t.jsx("option",{value:"Sales",children:"Sales"}),t.jsx("option",{value:"Production",children:"Production"}),t.jsx("option",{value:"Design",children:"Design"}),t.jsx("option",{value:"Management",children:"Management"}),t.jsx("option",{value:"Other",children:"Other"})]})]}),t.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:t.jsx("button",{type:"submit",disabled:y.isPending,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:y.isPending?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})})]})]}),t.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Account Information"}),t.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Account ID"}),t.jsxs("dd",{className:"mt-1 text-sm text-gray-900 font-mono",children:[(T=e==null?void 0:e.id)==null?void 0:T.slice(0,8),"..."]})]}),t.jsxs("div",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Role"}),t.jsx("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:(d==null?void 0:d.role)||"Staff"})]}),t.jsxs("div",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Member Since"}),t.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:d!=null&&d.created_at?new Date(d.created_at).toLocaleDateString():"N/A"})]}),t.jsxs("div",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),t.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:d!=null&&d.updated_at?new Date(d.updated_at).toLocaleDateString():"N/A"})]})]})]})]}),t.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[t.jsx(km,{className:"w-5 h-5 text-amber-600"}),"My Task Digest"]}),t.jsx(Je,{to:"/task-digest",className:"text-sm text-indigo-600 hover:text-indigo-800 font-medium",children:"View All Tasks "})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-amber-700 font-medium",children:"Open Tasks"}),t.jsx("p",{className:"text-2xl font-bold text-amber-900",children:j.length})]}),t.jsx(km,{className:"w-8 h-8 text-amber-500"})]})}),t.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Overdue"}),t.jsx("p",{className:"text-2xl font-bold text-red-900",children:x.length})]}),t.jsx(WS,{className:"w-8 h-8 text-red-500"})]})}),t.jsx("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Due in 24h"}),t.jsx("p",{className:"text-2xl font-bold text-orange-900",children:g.length})]}),t.jsx(Sm,{className:"w-8 h-8 text-orange-500"})]})})]}),(x.length>0||g.length>0)&&t.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:t.jsxs("p",{className:"text-sm text-yellow-800",children:[" You have ",x.length," overdue task",x.length!==1?"s":"",g.length>0&&` and ${g.length} due in the next 24 hours`,"."," ",t.jsx(Je,{to:"/task-digest",className:"font-medium underline hover:text-yellow-900",children:"Review now"})]})})]})]})]})]})}function IC(){var y,b,f,v,w,N,P,z,E,X,T;const e=ct(),[s,r]=m.useState(null),[n,a]=m.useState({}),{data:i,isLoading:l}=ue({queryKey:["integrations"],queryFn:async()=>(await D.get("/api/integrations")).data}),o=Ne({mutationFn:async F=>(await D.post(`/api/integrations/${F}/test`)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["integrations"]})}}),c=Ne({mutationFn:async({integrationId:F,settings:Q})=>(await D.post(`/api/integrations/${F}/settings`,Q)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["integrations"]}),r(null),a({})}}),d=[{id:"shopify",name:"Shopify",description:"Connect your Shopify store to view customer orders and data",icon:t.jsx(_b,{className:"w-6 h-6"}),status:(y=i==null?void 0:i.shopify)!=null&&y.connected?"connected":"disconnected",settings:[{key:"SHOPIFY_DOMAIN",label:"Store Domain",type:"url",value:((b=i==null?void 0:i.shopify)==null?void 0:b.domain)||"",placeholder:"your-store.myshopify.com",required:!0,helpText:"Your Shopify store domain (e.g., your-store.myshopify.com)"},{key:"SHOPIFY_ACCESS_TOKEN",label:"Admin API Access Token",type:"password",value:((f=i==null?void 0:i.shopify)==null?void 0:f.accessToken)||"",placeholder:"shpat_xxxxxxxxxxxxx",required:!0,helpText:"Create a custom app in Shopify Admin  Settings  Apps and sales channels  Develop apps"}]},{id:"cloudflare-r2",name:"Cloudflare R2",description:"Object storage for file attachments",icon:t.jsx(p3,{className:"w-6 h-6"}),status:(v=i==null?void 0:i.r2)!=null&&v.connected?"connected":"disconnected",settings:[{key:"R2_BUCKET_NAME",label:"Bucket Name",type:"text",value:((w=i==null?void 0:i.r2)==null?void 0:w.bucketName)||"dartmouth-attachments",placeholder:"dartmouth-attachments",required:!0,helpText:"Your Cloudflare R2 bucket name"}]},{id:"email",name:"Email (Gmail)",description:"Send and receive emails via Gmail",icon:t.jsx(sr,{className:"w-6 h-6"}),status:(N=i==null?void 0:i.email)!=null&&N.connected?"connected":"disconnected",settings:[{key:"GMAIL_CLIENT_ID",label:"Gmail Client ID",type:"text",value:((P=i==null?void 0:i.email)==null?void 0:P.clientId)||"",placeholder:"xxxxx.apps.googleusercontent.com",required:!0},{key:"GMAIL_CLIENT_SECRET",label:"Gmail Client Secret",type:"password",value:((z=i==null?void 0:i.email)==null?void 0:z.clientSecret)||"",placeholder:"GOCSPX-xxxxx",required:!0},{key:"GMAIL_REFRESH_TOKEN",label:"Gmail Refresh Token",type:"password",value:((E=i==null?void 0:i.email)==null?void 0:E.refreshToken)||"",placeholder:"1//xxxxx",required:!0}]},{id:"resend",name:"Resend",description:"Email service for transactional emails",icon:t.jsx(sr,{className:"w-6 h-6"}),status:(X=i==null?void 0:i.resend)!=null&&X.connected?"connected":"disconnected",settings:[{key:"RESEND_API_KEY",label:"Resend API Key",type:"password",value:((T=i==null?void 0:i.resend)==null?void 0:T.apiKey)||"",placeholder:"re_xxxxx",required:!0,helpText:"Get your API key from resend.com"}]}],h=(F,Q)=>{r(F);const Z={};Q.settings.forEach(xe=>{Z[xe.key]=xe.value}),a(Z)},u=F=>{c.mutate({integrationId:F,settings:n})},p=F=>{o.mutate(F)},j=F=>{switch(F){case"connected":return t.jsx(lt,{className:"w-5 h-5 text-green-600"});case"error":return t.jsx(yr,{className:"w-5 h-5 text-red-600"});default:return t.jsx(Xl,{className:"w-5 h-5 text-gray-400"})}},x=F=>{switch(F){case"connected":return"Connected";case"error":return"Error";default:return"Not Connected"}},g=F=>{switch(F){case"connected":return"text-green-600";case"error":return"text-red-600";default:return"text-gray-500"}};return l?t.jsx("div",{className:"flex items-center justify-center h-screen",children:t.jsx("div",{className:"text-gray-500",children:"Loading integrations..."})}):t.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Integrations"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Connect and manage your third-party integrations"})]}),t.jsx("div",{className:"space-y-4",children:d.map(F=>t.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"p-3 bg-blue-50 rounded-lg text-blue-600",children:F.icon}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:F.name}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:F.description}),t.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[j(F.status),t.jsx("span",{className:`text-sm font-medium ${g(F.status)}`,children:x(F.status)})]})]})]}),t.jsx("div",{className:"flex gap-2",children:s===F.id?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{r(null),a({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:()=>u(F.id),disabled:c.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:c.isPending?"Saving...":"Save"})]}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>p(F.id),disabled:o.isPending||F.status==="disconnected",className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:o.isPending?"Testing...":"Test Connection"}),t.jsx("button",{onClick:()=>h(F.id,F),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Configure"})]})})]})}),s===F.id&&t.jsx("div",{className:"p-6 bg-gray-50",children:t.jsx("div",{className:"space-y-4",children:F.settings.map(Q=>t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[Q.label,Q.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:Q.type,value:n[Q.key]||"",onChange:Z=>a({...n,[Q.key]:Z.target.value}),placeholder:Q.placeholder,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),Q.helpText&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Q.helpText})]},Q.key))})})]},F.id))}),t.jsxs("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Need Help?"}),t.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[t.jsxs("li",{children:[" ",t.jsx("strong",{children:"Shopify:"})," Create a custom app in your Shopify Admin to get API credentials"]}),t.jsxs("li",{children:[" ",t.jsx("strong",{children:"Cloudflare R2:"})," Configured via wrangler.toml and Cloudflare dashboard"]}),t.jsxs("li",{children:[" ",t.jsx("strong",{children:"Gmail:"})," Set up OAuth 2.0 credentials in Google Cloud Console"]}),t.jsxs("li",{children:[" ",t.jsx("strong",{children:"Resend:"})," Sign up at resend.com and create an API key"]})]})]})]})}function OC(){var X,T,F,Q;const e=ct(),[s,r]=m.useState("config"),[n,a]=m.useState(!1),[i,l]=m.useState(""),[o,c]=m.useState(""),[d,h]=m.useState(null),[u,p]=m.useState(null),{data:j,isLoading:x}=ue({queryKey:["integrations"],queryFn:async()=>(await D.get("/api/integrations")).data}),{data:g,refetch:y}=ue({queryKey:["integrations-debug"],queryFn:async()=>(await D.get("/api/integrations/debug")).data,enabled:!1}),b=Ne({mutationFn:async Z=>(await D.post("/api/integrations/shopify/settings",Z)).data,onSuccess:()=>{p({success:!0,message:"Settings saved successfully!"}),a(!1),e.invalidateQueries({queryKey:["integrations"]}),l(""),c("")},onError:Z=>{var xe,ve;p({success:!1,message:((ve=(xe=Z.response)==null?void 0:xe.data)==null?void 0:ve.message)||"Failed to save settings"})}}),f=Ne({mutationFn:async()=>(await D.post("/api/integrations/shopify/test")).data,onSuccess:Z=>{h(Z),e.invalidateQueries({queryKey:["integrations"]})},onError:Z=>{var xe,ve;h({success:!1,message:((ve=(xe=Z.response)==null?void 0:xe.data)==null?void 0:ve.message)||"Connection test failed"})}}),v=j==null?void 0:j.shopify,w=v==null?void 0:v.connected,N=()=>{var Z;a(!0),p(null),h(null),l(((Z=v==null?void 0:v.domain)==null?void 0:Z.replace(//g,""))||""),c("")},P=()=>{a(!1),l(""),c(""),p(null)},z=()=>{if(!i||!o){p({success:!1,message:"Both fields are required"});return}b.mutate({domain:i,accessToken:o})},E=()=>{h(null),f.mutate()};return x?t.jsx("div",{className:"flex items-center justify-center h-screen",children:t.jsx("div",{className:"text-gray-500",children:"Loading..."})}):t.jsxs("div",{className:"p-6 max-w-4xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Shopify Integration"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Connect your Shopify store to view customer orders and data in tickets"})]}),t.jsx("div",{className:"mb-6 border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex space-x-8",children:[t.jsx("button",{onClick:()=>r("config"),className:`py-4 px-1 border-b-2 font-medium text-sm ${s==="config"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Configuration"}),t.jsx("button",{onClick:()=>r("guide"),className:`py-4 px-1 border-b-2 font-medium text-sm ${s==="guide"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Installation Guide"})]})}),s==="config"&&t.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"p-3 bg-green-50 rounded-lg text-green-600",children:t.jsx(_b,{className:"w-6 h-6"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Shopify Store"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View customer order history, tracking info, and purchase data"}),t.jsx("div",{className:"flex items-center gap-2 mt-3",children:w?t.jsxs(t.Fragment,{children:[t.jsx(lt,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"text-sm font-medium text-green-600",children:"Connected"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Xl,{className:"w-5 h-5 text-gray-400"}),t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Not Connected"})]})})]})]}),t.jsx("div",{className:"flex gap-2",children:n?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:P,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:z,disabled:b.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:b.isPending?"Saving...":"Save"})]}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>y(),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Debug Info"}),t.jsx("button",{onClick:E,disabled:f.isPending||!w,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:f.isPending?"Testing...":"Test Connection"}),t.jsx("button",{onClick:N,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Configure"})]})})]})}),d&&t.jsx("div",{className:`p-4 border-b ${d.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[d.success?t.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5"}):t.jsx(yr,{className:"w-5 h-5 text-red-600 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-medium ${d.success?"text-green-900":"text-red-900"}`,children:d.success?"Connection Successful!":"Connection Failed"}),t.jsx("p",{className:`text-sm mt-1 ${d.success?"text-green-700":"text-red-700"}`,children:d.message})]})]})}),u&&t.jsx("div",{className:`p-4 border-b ${u.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[u.success?t.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5"}):t.jsx(yr,{className:"w-5 h-5 text-red-600 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-medium ${u.success?"text-green-900":"text-red-900"}`,children:u.success?"Saved Successfully!":"Save Failed"}),t.jsx("p",{className:`text-sm mt-1 ${u.success?"text-green-700":"text-red-700"}`,children:u.message})]})]})}),g&&t.jsxs("div",{className:"p-4 border-b bg-gray-50 border-gray-200",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Debug Information"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"KV Storage:"}),t.jsxs("p",{className:"text-gray-600",children:["Domain: ",((X=g.kv)==null?void 0:X.SHOPIFY_DOMAIN)||"not set"]}),t.jsxs("p",{className:"text-gray-600",children:["Token: ",((T=g.kv)==null?void 0:T.SHOPIFY_ACCESS_TOKEN)||"not set"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Secrets:"}),t.jsxs("p",{className:"text-gray-600",children:["Domain: ",((F=g.secrets)==null?void 0:F.SHOPIFY_DOMAIN)||"not set"]}),t.jsxs("p",{className:"text-gray-600",children:["Token: ",((Q=g.secrets)==null?void 0:Q.SHOPIFY_ACCESS_TOKEN)||"not set"]})]})]})]}),!n&&t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Current Settings"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Store Domain"}),t.jsx("div",{className:"text-sm text-gray-900",children:(v==null?void 0:v.domain)||"Not configured"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Access Token"}),t.jsx("div",{className:"text-sm text-gray-900",children:(v==null?void 0:v.accessToken)||"Not configured"})]})]})]}),n&&t.jsxs("div",{className:"p-6 bg-gray-50",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Shopify Configuration"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Store Domain ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:i,onChange:Z=>l(Z.target.value),placeholder:"your-store.myshopify.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Shopify store domain (e.g., your-store.myshopify.com)"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Admin API Access Token ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"password",value:o,onChange:Z=>c(Z.target.value),placeholder:"shpat_xxxxxxxxxxxxx",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Shopify Admin API access token (starts with shpat_)"})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"How to get your Shopify credentials:"}),t.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[t.jsx("li",{children:"Go to Shopify Admin  Settings  Apps and sales channels"}),t.jsx("li",{children:'Click "Develop apps"  "Create an app" (name it "Dartmouth OS")'}),t.jsxs("li",{children:["Configure Admin API scopes: ",t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_customers"}),", ",t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_orders"}),", ",t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"read_products"})]}),t.jsx("li",{children:'Click "Install app" and copy the Admin API access token'})]}),t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx(cl,{className:"w-4 h-4 text-blue-600"}),t.jsx("a",{href:"https://help.shopify.com/en/manual/apps/app-types/custom-apps",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 underline",children:"Shopify Custom Apps Documentation"})]})]})]})]}),t.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow border border-gray-200 p-6",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"What You'll Get"}),t.jsxs("ul",{className:"space-y-3",children:[t.jsxs("li",{className:"flex items-start gap-3",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Customer Order History"}),t.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"View all orders from a customer when viewing their ticket"})]})]}),t.jsxs("li",{className:"flex items-start gap-3",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Order Tracking"}),t.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"See tracking numbers and fulfillment status"})]})]}),t.jsxs("li",{className:"flex items-start gap-3",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Product Information"}),t.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"View product details and variants from orders"})]})]}),t.jsxs("li",{className:"flex items-start gap-3",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:"AI Agent Context"}),t.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"AI can reference customer's order history when responding"})]})]})]})]})]}),s==="guide"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Shopify Installation Guide"}),t.jsx("p",{className:"text-gray-700 mb-4",children:"Follow these steps to connect your Shopify store to Dartmouth OS. This will allow you to view customer order history, tracking information, and product details directly in your support tickets."}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Time required:"})," 5-10 minutes",t.jsx("br",{}),t.jsx("strong",{children:"Shopify plan:"})," Any plan (Basic, Shopify, Advanced, Plus)",t.jsx("br",{}),t.jsx("strong",{children:"Access needed:"}),' Store owner or staff with "Develop apps" permission']})})]}),t.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"1"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Shopify Admin"}),t.jsxs("ol",{className:"space-y-3 text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"1."}),t.jsx("span",{children:"Log in to your Shopify Admin panel"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"2."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Settings"})," (bottom left corner)"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"3."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Apps and sales channels"})]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"4."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Develop apps"})," (top right)"]})]})]}),t.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:t.jsxs("p",{className:"text-sm text-yellow-800",children:[t.jsx("strong",{children:"Note:"}),` If you don't see "Develop apps", you may need to enable it first. Click "Allow custom app development" and confirm.`]})})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"2"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Create Custom App"}),t.jsxs("ol",{className:"space-y-3 text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"1."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Create an app"})]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"2."}),t.jsxs("span",{children:["Enter app name: ",t.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"Dartmouth OS"})]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"3."}),t.jsx("span",{children:"Select an app developer (usually yourself)"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"4."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Create app"})]})]})]})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"3"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Configure API Scopes"}),t.jsxs("ol",{className:"space-y-3 text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"1."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Configure Admin API scopes"})]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"2."}),t.jsx("span",{children:"Search for and enable these scopes:"})]})]}),t.jsxs("div",{className:"mt-3 ml-6 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600"}),t.jsx("code",{className:"font-mono text-sm",children:"read_customers"}),t.jsx("span",{className:"text-xs text-gray-600",children:"- View customer information"})]}),t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600"}),t.jsx("code",{className:"font-mono text-sm",children:"read_orders"}),t.jsx("span",{className:"text-xs text-gray-600",children:"- View order history"})]}),t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[t.jsx(lt,{className:"w-5 h-5 text-green-600"}),t.jsx("code",{className:"font-mono text-sm",children:"read_products"}),t.jsx("span",{className:"text-xs text-gray-600",children:"- View product details"})]})]}),t.jsx("ol",{start:3,className:"space-y-3 text-gray-700 mt-3",children:t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"3."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Save"})]})]})}),t.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded",children:t.jsxs("p",{className:"text-sm text-red-800",children:[t.jsx("strong",{children:"Important:"})," Only enable these three scopes. Do not enable write permissions unless absolutely necessary."]})})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Install the App"}),t.jsxs("ol",{className:"space-y-3 text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"1."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Install app"})," (top right)"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"2."}),t.jsxs("span",{children:["Review the permissions and click ",t.jsx("strong",{children:"Install"})]})]})]}),t.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:t.jsxs("p",{className:"text-sm text-yellow-800",children:[t.jsx("strong",{children:"Note:"})," You must install the app before you can get the access token. If you skip this step, you'll get a 403 Forbidden error."]})})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:"5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Get API Credentials"}),t.jsxs("ol",{className:"space-y-3 text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"1."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"API credentials"})," tab"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"2."}),t.jsxs("span",{children:["Copy your ",t.jsx("strong",{children:"Admin API access token"})," (starts with ",t.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"shpat_"}),")"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"3."}),t.jsxs("span",{children:["Note your store domain (e.g., ",t.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"your-store.myshopify.com"}),")"]})]})]}),t.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded",children:t.jsxs("p",{className:"text-sm text-red-800",children:[t.jsx("strong",{children:"Security Warning:"})," The access token is shown only once! Copy it immediately and store it securely. If you lose it, you'll need to uninstall and reinstall the app to get a new token."]})})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center font-bold",children:"6"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Connect to Dartmouth OS"}),t.jsxs("ol",{className:"space-y-3 text-gray-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"1."}),t.jsxs("span",{children:["Go to the ",t.jsx("strong",{children:"Configuration"})," tab above"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"2."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Configure"})]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"3."}),t.jsx("span",{children:"Enter your Store Domain and Admin API Access Token"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"4."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Save"})]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"font-medium",children:"5."}),t.jsxs("span",{children:["Click ",t.jsx("strong",{children:"Test Connection"})," to verify everything works"]})]})]}),t.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:t.jsxs("p",{className:"text-sm text-green-800",children:[t.jsx("strong",{children:"Success!"})," If the test passes, you're all set. Customer order data will now appear in your support tickets."]})})]})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Troubleshooting Common Issues"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[t.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"403 Forbidden Error"}),t.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This usually means:"}),t.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 ml-4",children:[t.jsx("li",{children:" The app wasn't installed (Step 4)"}),t.jsx("li",{children:" Wrong API scopes were configured"}),t.jsx("li",{children:" You copied the API Key instead of the Access Token"})]}),t.jsxs("p",{className:"text-sm text-gray-700 mt-2",children:[t.jsx("strong",{children:"Solution:"})," Go back to Step 3 and verify the scopes, then reinstall the app."]})]}),t.jsxs("div",{className:"border-l-4 border-yellow-500 pl-4",children:[t.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"401 Unauthorized Error"}),t.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This means the access token is invalid."}),t.jsxs("p",{className:"text-sm text-gray-700",children:[t.jsx("strong",{children:"Solution:"})," Double-check you copied the entire token (starts with shpat_). If still failing, uninstall and reinstall the app to get a new token."]})]}),t.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[t.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Connection Timeout"}),t.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"This means the domain is incorrect."}),t.jsxs("p",{className:"text-sm text-gray-700",children:[t.jsx("strong",{children:"Solution:"})," Verify your store domain is in the format: your-store.myshopify.com (not your custom domain)."]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Resources"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("a",{href:"https://help.shopify.com/en/manual/apps/app-types/custom-apps",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[t.jsx(cl,{className:"w-4 h-4"}),"Shopify Custom Apps Documentation"]}),t.jsxs("a",{href:"https://shopify.dev/docs/api/admin-rest",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[t.jsx(cl,{className:"w-4 h-4"}),"Shopify Admin API Reference"]})]})]})]})]})}function DC(){var yt,Ei,In,Wr;const{user:e}=ts(),s=ct(),[r]=Bl(),n=m.useRef(null),a=m.useRef(null),[i,l]=m.useState(null),[o,c]=m.useState(null),[d,h]=m.useState(""),[u,p]=m.useState([]),[j,x]=m.useState(!1),[g,y]=m.useState(!0),[b,f]=m.useState(""),[v,w]=m.useState(""),[N,P]=m.useState(null),[z,E]=m.useState(null),[X,T]=m.useState(""),[F,Q]=m.useState(!1),[Z,xe]=m.useState(null),[ve,ke]=m.useState(null),[q,R]=m.useState(!1),[G,K]=m.useState(""),[ee,ae]=m.useState(0),ne=m.useRef(null),[fe,Le]=m.useState(null),[L,ye]=m.useState(!1),[_e,_]=m.useState(null),[Y,W]=m.useState(""),[J,B]=m.useState(null),[me,Ie]=m.useState(null),[pe,ie]=m.useState(!1),U=m.useRef(null),[Me,Te]=m.useState(""),[$,se]=m.useState([]),[le,Ce]=m.useState(0),[Ee,We]=m.useState(!1),{data:et}=ue({queryKey:["group-chat-channels"],queryFn:async()=>(await xt.listChannels()).data,refetchInterval:5e3}),it=(et==null?void 0:et.channels)||[],{data:kt}=ue({queryKey:["group-chat-time-limit"],queryFn:async()=>(await xt.getTimeLimit()).data}),Gt=(kt==null?void 0:kt.timeLimit)??10,rs=S=>{if((e==null?void 0:e.role)==="admin"||Gt===0)return!0;const je=new Date(S.created_at).getTime(),be=Date.now(),Re=Gt*60*1e3;return S.sender_id===(e==null?void 0:e.id)&&be-je<=Re},Et=()=>{n.current&&n.current.scrollIntoView({behavior:"smooth",block:"end"})},ns=S=>{c(S),setTimeout(()=>{const je=document.getElementById(`message-${S}`);je&&je.scrollIntoView({behavior:"smooth",block:"center"})},100),setTimeout(()=>{c(null)},5e3)},Hs=S=>{if(Te(S),!S.trim()||!de.length){se([]),Ce(0);return}const je=S.toLowerCase(),be=[];[...de].reverse().forEach(Re=>{let He=!1;Re.content.toLowerCase().includes(je)&&(He=!0),Re.tags&&Re.tags.split(",").map(dt=>dt.trim().toLowerCase()).some(dt=>dt.includes(je))&&(He=!0),He&&be.push(Re.id)}),se(be),Ce(0),be.length>0&&ns(be[0])},Ns=()=>{if($.length===0)return;const S=(le+1)%$.length;Ce(S),ns($[S])},jr=()=>{if($.length===0)return;const S=le===0?$.length-1:le-1;Ce(S),ns($[S])};m.useEffect(()=>{!i&&it.length>0&&l(it[0].id)},[it,i]),m.useEffect(()=>{const S=r.get("channel"),je=r.get("message");S&&l(S),je&&(c(je),setTimeout(()=>{const be=document.getElementById(`message-${je}`);be&&be.scrollIntoView({behavior:"smooth",block:"center"})},500),setTimeout(()=>{c(null)},5e3))},[r]),m.useEffect(()=>{const S=U.current;if(!S)return;const je=()=>{const{scrollTop:be,scrollHeight:Re,clientHeight:He}=S,st=Re-be-He<100;ie(!st)};return S.addEventListener("scroll",je),()=>S.removeEventListener("scroll",je)},[i]);const{data:As}=ue({queryKey:["group-chat-messages",i],queryFn:async()=>i?(await xt.getMessages(i,{limit:50})).data:{messages:[]},enabled:!!i,refetchInterval:5e3,refetchOnWindowFocus:!1}),de=(As==null?void 0:As.messages)||[];m.useEffect(()=>{if(de.length>0){const S=de[de.length-1];S.id!==N&&(P(S.id),i&&xt.markAsRead(i,S.id))}},[de,N,i]);const{data:wr}=ue({queryKey:["group-chat-members",i],queryFn:async()=>i?(await xt.getMembers(i)).data:{members:[]},enabled:!!i}),hs=(wr==null?void 0:wr.members)||[],Ps=hs.find(S=>S.staff_id===(e==null?void 0:e.id)),nr=(Ps==null?void 0:Ps.role)==="admin";m.useEffect(()=>{n.current&&n.current.scrollIntoView({behavior:"smooth",block:"end"})},[de]),m.useEffect(()=>{const S=setTimeout(()=>{n.current&&n.current.scrollIntoView({behavior:"auto",block:"end"})},100);return()=>clearTimeout(S)},[]),m.useEffect(()=>{const S=()=>Le(null);if(fe)return document.addEventListener("click",S),()=>document.removeEventListener("click",S)},[fe]);const ks=Ne({mutationFn:async S=>{if(!i)throw new Error("No active channel");return xt.sendMessage(i,S)},onSuccess:()=>{h(""),p([]),s.invalidateQueries({queryKey:["group-chat-messages",i]}),s.invalidateQueries({queryKey:["group-chat-channels"]})}}),Ze=Ne({mutationFn:S=>xt.createChannel(S),onSuccess:()=>{x(!1),f(""),w(""),s.invalidateQueries({queryKey:["group-chat-channels"]})}}),I=Ne({mutationFn:({messageId:S,content:je,deleteAttachment:be})=>xt.editMessage(S,je,be),onSuccess:()=>{E(null),Q(!1),T(""),s.invalidateQueries({queryKey:["group-chat-messages",i]})}}),ge=Ne({mutationFn:S=>xt.deleteMessage(S),onSuccess:()=>{s.invalidateQueries({queryKey:["group-chat-messages",i]})}}),Fe=Ne({mutationFn:({messageId:S,emoji:je})=>xt.addReaction(S,je),onSuccess:()=>{s.invalidateQueries({queryKey:["group-chat-messages",i]}),xe(null)}}),ze=async()=>{if(!d.trim()&&u.length===0||ks.isPending)return;let S=[];if(u.length>0)for(const be of u){const Re=await Rt(be);S.push({name:be.name,content:Re,type:be.type,size:be.size})}let je=d;me&&(je=` Replying to ${me.first_name}: "${me.content.substring(0,50)}${me.content.length>50?"...":""}" [msg:${me.id}]

${d}`),ks.mutate({content:je,attachments:S.length>0?S:void 0}),Ie(null)},at=S=>{S.target.files&&S.target.files.length>0&&p(Array.from(S.target.files))},Rt=S=>new Promise((je,be)=>{const Re=new FileReader;Re.readAsDataURL(S),Re.onload=()=>je(Re.result),Re.onerror=He=>be(He)}),Fn=async(S,je)=>{try{const Re=await(await fetch(S)).blob(),He=window.URL.createObjectURL(Re),st=document.createElement("a");st.href=He,st.download=je,document.body.appendChild(st),st.click(),document.body.removeChild(st),window.URL.revokeObjectURL(He)}catch(be){console.error("Error downloading file:",be)}},M=()=>{b.trim()&&Ze.mutate({name:b,description:v||void 0,channelType:"public"})},A=S=>S.startsWith("http")?S:`https://dartmouth-os-worker.dartmouth.workers.dev/api/attachments/${S}`,Ae=S=>S.split(/(@\w+|@\d+|#\d+|TKT-\d+|ticket\s+\d+|\*\d+(?:-\d+)?|TSK-\d+(?:-\d+)?)/gi).map((be,Re)=>{if(be.match(/^@\w+$/)&&!be.match(/^@\d+$/))return t.jsx("span",{className:"bg-blue-100 text-blue-700 font-semibold px-1 rounded",children:be},Re);const He=be.match(/^@(\d+)$|^#(\d+)$|^TKT-(\d+)$|^ticket\s+(\d+)$/i);if(He){const dt=He[1]||He[2]||He[3]||He[4];return t.jsx("a",{href:`/tickets?search=TKT-${dt}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline font-medium",onClick:Lt=>{Lt.stopPropagation()},children:be},Re)}const st=be.match(/^\*(\d+)(?:-(\d+))?$|^TSK-(\d+)(?:-(\d+))?$/i);if(st){const dt=st[1]||st[3],Lt=st[2]||st[4],ar=Lt?`TSK-${dt}-${Lt}`:`TSK-${dt}`;return t.jsx("a",{href:`/tickets?search=${ar}`,target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:text-amber-800 hover:underline font-medium",onClick:Ke=>{Ke.stopPropagation()},children:be},Re)}return be}),Pe=S=>{const je=S.content,be=je.match(/^ Replying to (\w+): "(.+?)" \[msg:([^\]]+)\]\n\n([\s\S]*)$/);if(be){const[,Re,He,st,dt]=be;return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mb-2 pb-2 border-b border-gray-300",children:t.jsxs("button",{onClick:()=>{ns(st)},className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 hover:underline",title:"Click to view original message",children:[t.jsx("span",{className:"text-base",children:""}),t.jsxs("span",{children:["Replying to ",Re,': "',He,'"']})]})}),t.jsx("div",{children:Ae(dt)})]})}return Ae(je)},Ge=it.find(S=>S.id===i);return t.jsxs("div",{className:"w-full flex bg-gray-50",style:{height:"calc(100vh - 3.5rem)"},children:[t.jsxs("div",{className:"w-64 bg-white border-r border-gray-200 flex flex-col flex-shrink-0 h-full overflow-hidden",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",style:{height:"73px"},children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Team Chat"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Internal Communication"})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:t.jsxs("div",{className:"p-2",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[t.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Channels"}),nr&&t.jsx("button",{onClick:()=>x(!0),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",title:"Create new channel (Admin only)",children:t.jsx(ad,{className:"w-4 h-4"})})]}),it.map(S=>t.jsxs("button",{onClick:()=>l(S.id),className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg text-left transition-colors border ${i===S.id?"bg-indigo-50 text-indigo-900 font-semibold border-indigo-300":"text-gray-700 hover:bg-gray-50 border-transparent"}`,children:[t.jsx(Ot,{className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{className:"flex-1 truncate font-medium",children:S.name}),S.unread_count>0&&t.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5",children:S.unread_count})]},S.id))]})})]}),t.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative",children:Ge?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",style:{minHeight:"73px"},children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[t.jsx(Ot,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:Ge.name}),Ge.description&&t.jsx("p",{className:"text-sm text-gray-500 truncate",children:Ge.description})]})]}),t.jsx("button",{onClick:()=>We(!Ee),className:`p-2 rounded-lg flex-shrink-0 ${Ee?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Search messages",children:t.jsx(xi,{className:"w-5 h-5"})}),t.jsxs("button",{onClick:()=>y(!g),className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg flex-shrink-0",children:[t.jsx(_i,{className:"w-5 h-5"}),t.jsxs("span",{className:"text-sm font-medium",children:[hs.length," members"]})]})]}),Ee&&t.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("input",{type:"text",value:Me,onChange:S=>Hs(S.target.value),placeholder:"Search messages and tags... (e.g., James Scott, #james-scott)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),$.length>0&&t.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2 bg-white px-2",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:[le+1," / ",$.length]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:jr,className:"p-1 hover:bg-gray-100 rounded",title:"Previous result",children:t.jsx(dr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:Ns,className:"p-1 hover:bg-gray-100 rounded",title:"Next result",children:t.jsx(Ws,{className:"w-4 h-4"})})]})]})]}),t.jsx("button",{onClick:()=>{We(!1),Te(""),se([]),Ce(0)},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Close search",children:t.jsx(_t,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{ref:U,className:"flex-1 overflow-y-auto p-6 space-y-3 relative",children:[de.map(S=>{var st,dt,Lt,ar;const je=S.sender_id===(e==null?void 0:e.id),be=S.reactions?JSON.parse(S.reactions):[],Re=z===S.id,He=o===S.id;return t.jsxs("div",{id:`message-${S.id}`,className:`group flex gap-3 -mx-2 px-2 py-1 rounded transition-all duration-300 ${He?"bg-yellow-100 border-l-4 border-yellow-500 pl-1":"hover:bg-gray-50"}`,onContextMenu:Ke=>{Ke.preventDefault(),Le({x:Ke.clientX,y:Ke.clientY,messageId:S.id})},children:[t.jsxs("div",{className:"flex-shrink-0",children:[S.profile_picture&&rt.getAvatarUrl(S.profile_picture)?t.jsx("img",{src:rt.getAvatarUrl(S.profile_picture)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-10 h-10 rounded-full object-cover",onError:Ke=>{var Mt;Ke.currentTarget.style.display="none",(Mt=Ke.currentTarget.nextElementSibling)==null||Mt.classList.remove("hidden")}}):null,t.jsxs("div",{className:`w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-semibold ${S.profile_picture&&rt.getAvatarUrl(S.profile_picture)?"hidden":""}`,children:[(st=S.first_name)==null?void 0:st[0],(dt=S.last_name)==null?void 0:dt[0]]})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[t.jsxs("span",{className:"font-semibold text-gray-900 text-sm",children:[S.first_name," ",S.last_name]}),t.jsx("span",{className:"text-xs text-gray-500",children:(()=>{const Ke=new Date(S.created_at),Mt=new Date;return Ke.toDateString()===Mt.toDateString()?Ke.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):Ke.toLocaleString([],{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})()}),S.edited_at&&t.jsxs("span",{className:"text-xs text-gray-400 italic",title:`Edited at ${new Date(S.edited_at).toLocaleString()}`,children:["(edited ",new Date(S.edited_at).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),")"]}),je&&!Re&&rs(S)&&t.jsxs("div",{className:"ml-auto opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1",children:[t.jsx("button",{onClick:()=>{E(S.id),T(S.content),Q(!1)},className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",title:"Edit message (within 10 mins)",children:t.jsx(Sb,{className:"w-3.5 h-3.5"})}),t.jsx("button",{onClick:()=>ke(S.id),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Delete message (within 10 mins)",children:t.jsx(fi,{className:"w-3.5 h-3.5"})})]})]}),Re?t.jsxs("div",{className:"space-y-2",children:[t.jsx("textarea",{value:X,onChange:Ke=>T(Ke.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3,autoFocus:!0}),S.attachment_url&&!F&&t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded border border-gray-200",children:[(Lt=S.attachment_type)!=null&&Lt.startsWith("image/")?t.jsx(Cc,{className:"w-4 h-4 text-gray-500"}):t.jsx(Wo,{className:"w-4 h-4 text-gray-500"}),t.jsx("span",{className:"text-sm text-gray-700 flex-1",children:S.attachment_name}),t.jsx("button",{onClick:()=>Q(!0),className:"p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded",title:"Remove attachment",children:t.jsx(_t,{className:"w-4 h-4"})})]}),F&&t.jsx("div",{className:"text-xs text-gray-500 italic",children:"Attachment will be removed when you save"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{I.mutate({messageId:S.id,content:X,deleteAttachment:F})},className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Save"}),t.jsx("button",{onClick:()=>{E(null),T(""),Q(!1)},className:"px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300",children:"Cancel"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg px-4 py-2.5 border border-gray-200",children:[t.jsx("div",{className:"text-gray-900 text-sm whitespace-pre-wrap break-words",children:Pe(S)}),S.attachment_url&&t.jsx("div",{className:"mt-2",children:(ar=S.attachment_type)!=null&&ar.startsWith("image/")?t.jsxs("div",{className:"relative inline-block",children:[t.jsx("a",{href:A(S.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"block",children:t.jsx("img",{src:A(S.attachment_url),alt:S.attachment_name||"Attachment",className:"max-w-md rounded border border-gray-300"})}),t.jsx("button",{onClick:()=>S.attachment_url&&Fn(A(S.attachment_url),S.attachment_name||"image.png"),className:"absolute top-2 right-2 p-2 bg-white/90 hover:bg-white text-gray-700 hover:text-blue-600 rounded-lg shadow-md border border-gray-200",title:"Download image",children:t.jsx(Sc,{className:"w-4 h-4"})})]}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("a",{href:A(S.attachment_url),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 hover:underline",children:[t.jsx(Wo,{className:"w-4 h-4"}),t.jsx("span",{children:S.attachment_name}),S.attachment_size&&t.jsxs("span",{className:"text-xs text-gray-500",children:["(",(S.attachment_size/1024).toFixed(1)," KB)"]})]}),t.jsx("button",{onClick:()=>S.attachment_url&&Fn(A(S.attachment_url),S.attachment_name||"download"),className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Download file",children:t.jsx(Sc,{className:"w-4 h-4"})})]})}),S.tags&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:eo(S.tags).map((Ke,Mt)=>t.jsxs(Je,{to:`/tags?tag=${encodeURIComponent(Ke)}`,className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors",children:[t.jsx(Ot,{className:"w-3 h-3"}),Ke]},Mt))})]}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[be.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(be.reduce((Ke,Mt)=>(Ke[Mt.emoji]=(Ke[Mt.emoji]||0)+1,Ke),{})).map(([Ke,Mt])=>t.jsxs("button",{onClick:()=>Fe.mutate({messageId:S.id,emoji:Ke}),className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-full text-xs",children:[t.jsx("span",{children:Ke}),t.jsx("span",{className:"text-blue-600 font-medium",children:Mt})]},Ke))}),t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>xe(Z===S.id?null:S.id),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",title:"Add reaction",children:t.jsx(oS,{className:"w-4 h-4"})}),Z===S.id&&t.jsx("div",{className:"absolute bottom-full left-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex gap-1 z-10",children:["","","","","","",""].map(Ke=>t.jsx("button",{onClick:()=>Fe.mutate({messageId:S.id,emoji:Ke}),className:"text-2xl hover:bg-gray-100 rounded p-1",children:Ke},Ke))})]})]})]})]})]},S.id)}),t.jsx("div",{ref:n})]}),pe&&t.jsx("button",{onClick:Et,className:"absolute bottom-28 right-8 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-3 shadow-lg transition-all duration-200 z-50",title:"Scroll to bottom",children:t.jsx(K4,{className:"w-5 h-5"})}),t.jsxs("div",{className:"bg-white pt-8 pb-4 px-4",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-2",children:Pb}),u.length>0&&t.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:u.map((S,je)=>t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-2",children:[S.type.startsWith("image/")?t.jsx(Cc,{className:"w-4 h-4 text-gray-600"}):t.jsx(Wo,{className:"w-4 h-4 text-gray-600"}),t.jsx("span",{className:"text-sm text-gray-700",children:S.name}),t.jsx("button",{onClick:()=>p(u.filter((be,Re)=>Re!==je)),className:"text-gray-400 hover:text-gray-600",children:t.jsx(_t,{className:"w-4 h-4"})})]},je))}),me&&t.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 border-l-4 border-blue-500",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"text-xs text-blue-600 font-semibold",children:["Replying to ",me.first_name," ",me.last_name]}),t.jsx("div",{className:"text-sm text-gray-600 truncate",children:me.content})]}),t.jsx("button",{onClick:()=>Ie(null),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded",children:t.jsx(_t,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"file",ref:a,onChange:at,className:"hidden",multiple:!0}),t.jsx("button",{onClick:()=>{var S;return(S=a.current)==null?void 0:S.click()},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:t.jsx(St,{className:"w-5 h-5"})}),t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("input",{ref:ne,type:"text",value:d,onChange:S=>{const je=S.target.value;h(je);const be=S.target.selectionStart||0,He=je.substring(0,be).match(/@(\w*)$/);He?(K(He[1].toLowerCase()),ae(be),R(!0)):R(!1)},onKeyDown:S=>{S.key==="Enter"&&!q?(S.preventDefault(),ze()):S.key==="Escape"&&q&&R(!1)},placeholder:"Type a message... Use @ to mention, #keyword to add tags",className:"w-full px-4 h-[42px] border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),q&&hs.length>0&&t.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-50",children:[hs.filter(S=>{const je=`${S.first_name} ${S.last_name}`.toLowerCase(),be=S.first_name.toLowerCase();return je.includes(G)||be.includes(G)}).map(S=>t.jsxs("button",{onClick:()=>{var He;const je=d.substring(0,ee).replace(/@\w*$/,""),be=d.substring(ee),Re=`${je}@${S.first_name.toLowerCase()} ${be}`;h(Re),R(!1),(He=ne.current)==null||He.focus()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-2",children:[S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?t.jsx("img",{src:rt.getAvatarUrl(S.avatar_url)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-8 h-8 rounded-full object-cover",onError:je=>{var be;je.currentTarget.style.display="none",(be=je.currentTarget.nextElementSibling)==null||be.classList.remove("hidden")}}):null,t.jsxs("div",{className:`w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center text-sm font-semibold ${S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?"hidden":""}`,children:[S.first_name[0],S.last_name[0]]}),t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium text-sm",children:[S.first_name," ",S.last_name]}),t.jsxs("div",{className:"text-xs text-gray-500",children:["@",S.first_name.toLowerCase()]})]})]},S.staff_id)),("mccarthy".includes(G)||"mc".includes(G))&&t.jsxs("button",{onClick:()=>{var Re;const S=d.substring(0,ee).replace(/@\w*$/,""),je=d.substring(ee),be=`${S}@mccarthy ${je}`;h(be),R(!1),(Re=ne.current)==null||Re.focus()},className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-2 border-t border-gray-200",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-500 text-white flex items-center justify-center text-sm font-semibold",children:"AI"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-sm",children:"McCarthy AI"}),t.jsx("div",{className:"text-xs text-gray-500",children:"@mccarthy"})]})]})]})]}),t.jsx("button",{onClick:ze,disabled:!d.trim()&&u.length===0||ks.isPending,className:"px-4 py-2.5 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 h-[42px]",children:ks.isPending?t.jsxs(t.Fragment,{children:[t.jsx(Nb,{className:"w-5 h-5 animate-spin"}),t.jsx("span",{children:"Uploading..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(id,{className:"w-5 h-5"}),t.jsx("span",{children:"Send"})]})})]})]})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Ot,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),t.jsx("p",{className:"text-lg font-medium",children:"No channel selected"}),t.jsx("p",{className:"text-sm",children:"Select a channel from the sidebar to start chatting"})]})})}),g&&Ge&&t.jsxs("div",{className:"w-64 bg-white border-l border-gray-200 flex flex-col flex-shrink-0 h-full overflow-hidden",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",style:{height:"73px"},children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:"Members"}),t.jsxs("p",{className:"text-sm text-gray-500",children:[hs.length," in this channel"]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:hs.map(S=>{var je,be;return t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"relative",children:[S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?t.jsx("img",{src:rt.getAvatarUrl(S.avatar_url)||"",alt:`${S.first_name} ${S.last_name}`,className:"w-8 h-8 rounded-full object-cover",onError:Re=>{var He;Re.currentTarget.style.display="none",(He=Re.currentTarget.nextElementSibling)==null||He.classList.remove("hidden")}}):null,t.jsxs("div",{className:`w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold ${S.avatar_url&&rt.getAvatarUrl(S.avatar_url)?"hidden":""}`,children:[(je=S.first_name)==null?void 0:je[0],(be=S.last_name)==null?void 0:be[0]]}),S.availability_status==="available"&&t.jsx("div",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-white"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[S.first_name," ",S.last_name]}),S.role==="admin"&&t.jsx("span",{className:"text-xs text-blue-600",children:"Admin"})]})]},S.id)})})]}),j&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Channel"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),t.jsx("input",{type:"text",value:b,onChange:S=>f(S.target.value),placeholder:"e.g., general, support, sales",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),t.jsx("textarea",{value:v,onChange:S=>w(S.target.value),placeholder:"What is this channel for?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{x(!1),f(""),w("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:M,disabled:!b.trim(),className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Channel"})]})]})}),ve&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Message"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this message? This action cannot be undone."}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>ke(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:()=>{ge.mutate(ve),ke(null)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),fe&&t.jsxs("div",{className:"fixed bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",style:{top:fe.y,left:fe.x},onClick:S=>S.stopPropagation(),children:[t.jsxs("button",{onClick:()=>{var je;const S=de.find(be=>be.id===fe.messageId);S&&(Ie(S),Le(null),(je=ne.current)==null||je.focus())},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[t.jsx("span",{children:""})," Reply"]}),t.jsxs("button",{onClick:()=>{_(fe.messageId),ye(!0),Le(null)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[t.jsx("span",{children:""})," Share"]}),t.jsxs("button",{onClick:()=>{const S=de.find(je=>je.id===fe.messageId);S&&(navigator.clipboard.writeText(S.content),Le(null))},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[t.jsx("span",{children:""})," Copy Message"]})]}),L&&_e&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Share Message"}),J?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Sharing to: ",t.jsx("span",{className:"font-semibold",children:J==="MEMOS"?"@Memos":`#${(yt=it.find(S=>S.id===J))==null?void 0:yt.name}`})]}),t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Original message:"}),t.jsx("p",{className:"text-sm text-gray-900 line-clamp-3",children:(Ei=de.find(S=>S.id===_e))==null?void 0:Ei.content}),((In=de.find(S=>S.id===_e))==null?void 0:In.attachment_name)&&t.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 mt-2",children:[t.jsx(St,{className:"w-3 h-3"}),t.jsx("span",{children:(Wr=de.find(S=>S.id===_e))==null?void 0:Wr.attachment_name})]})]}),t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:J==="MEMOS"?"Add your note (optional):":"Add your comment (optional - use @ to mention someone):"}),t.jsx("textarea",{value:Y,onChange:S=>W(S.target.value),placeholder:J==="MEMOS"?"Add a note about this shared message...":"@gaille can you review this?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>{B(null),W("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Back"}),t.jsx("button",{onClick:async()=>{var je,be;const S=de.find(Re=>Re.id===_e);if(S&&i&&J&&e)if(J==="MEMOS"){const Re=(je=it.find(dt=>dt.id===i))==null?void 0:je.name;let He="";Y.trim()?He=`${Y}

 Shared from #${Re}:
${S.content}`:He=` Shared from #${Re}:

${S.content}`;let st;if(S.attachment_url&&S.attachment_name)try{const Lt=await(await fetch(A(S.attachment_url))).blob(),ar=await new Promise(Ke=>{const Mt=new FileReader;Mt.onloadend=()=>Ke(Mt.result),Mt.readAsDataURL(Lt)});st={name:S.attachment_name,data:ar,type:S.attachment_type||"application/octet-stream",size:S.attachment_size||0}}catch(dt){console.error("Error fetching attachment:",dt)}console.log("[Share to Memos] Creating memo with:",{content:He,attachment:st}),Gi.createMemo({content:He,attachment:st}).then(()=>{ye(!1),_(null),B(null),W(""),s.invalidateQueries({queryKey:["memos"]})}).catch(dt=>{console.error("Error creating memo:",dt),alert("Failed to share to @Memos. Please try again.")})}else{const Re=(be=it.find(Lt=>Lt.id===i))==null?void 0:be.name,He=`${e.firstName} ${e.lastName}`;let st="";Y.trim()?st=`${Y}

 ${He} shared from #${Re}:
${S.content}`:st=` ${He} shared from #${Re}:

${S.content}`;let dt;if(S.attachment_url&&S.attachment_name)try{const ar=await(await fetch(A(S.attachment_url))).blob(),Ke=await new Promise(Mt=>{const ba=new FileReader;ba.onloadend=()=>Mt(ba.result),ba.readAsDataURL(ar)});dt=[{name:S.attachment_name,content:Ke,type:S.attachment_type||"application/octet-stream",size:S.attachment_size||0}]}catch(Lt){console.error("Error fetching attachment:",Lt)}xt.sendMessage(J,{content:st,attachments:dt}).then(()=>{ye(!1),_(null),B(null),W(""),s.invalidateQueries({queryKey:["group-chat-channels"]})}).catch(Lt=>{console.error("Error sharing message:",Lt),alert("Failed to share message. Please try again.")})}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Share"})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select where to share this message:"}),t.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4",children:[it.filter(S=>S.id!==i).map(S=>t.jsxs("button",{onClick:()=>B(S.id),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded border border-gray-200 flex items-center gap-2",children:[t.jsx(Ot,{className:"w-4 h-4 text-gray-500"}),t.jsx("span",{children:S.name})]},S.id)),t.jsxs("button",{onClick:()=>B("MEMOS"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 rounded border border-gray-200 flex items-center gap-2",children:[t.jsx(_c,{className:"w-4 h-4 text-yellow-600"}),t.jsx("span",{children:"@Memos (Personal notes)"})]})]}),t.jsx("div",{className:"flex gap-3 justify-end",children:t.jsx("button",{onClick:()=>{ye(!1),_(null),B(null),W("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"})})]})]})})]})}function zC(){const e=ct(),[s,r]=m.useState("channels"),[n,a]=m.useState(null),[i,l]=m.useState(!1),[o,c]=m.useState(!1),[d,h]=m.useState(!1),[u,p]=m.useState(""),[j,x]=m.useState(""),[g,y]=m.useState(""),[b,f]=m.useState(""),[v,w]=m.useState(!0),[N,P]=m.useState(!0),[z,E]=m.useState(!0),[X,T]=m.useState(10),[F,Q]=m.useState(12),{data:Z}=ue({queryKey:["group-chat-channels-settings"],queryFn:async()=>(await xt.listChannels()).data}),xe=(Z==null?void 0:Z.channels)||[],{data:ve}=ue({queryKey:["group-chat-time-limit"],queryFn:async()=>(await xt.getTimeLimit()).data});m.useState(()=>{(ve==null?void 0:ve.timeLimit)!==void 0&&T(ve.timeLimit)});const ke=Ne({mutationFn:B=>xt.setTimeLimit(B),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-time-limit"]})}}),{data:q}=ue({queryKey:["mentions-auto-archive"],queryFn:async()=>(await xt.getAutoArchiveHours()).data});m.useState(()=>{(q==null?void 0:q.hours)!==void 0&&Q(q.hours)});const R=Ne({mutationFn:B=>xt.setAutoArchiveHours(B),onSuccess:()=>{e.invalidateQueries({queryKey:["mentions-auto-archive"]})}}),{data:G}=ue({queryKey:["group-chat-members-settings",n==null?void 0:n.id],queryFn:async()=>n?(await xt.getMembers(n.id)).data:{members:[]},enabled:!!n}),K=(G==null?void 0:G.members)||[],{data:ee}=ue({queryKey:["staff-list"],queryFn:async()=>(await rt.list()).data}),ae=(ee==null?void 0:ee.staff)||[],ne=Ne({mutationFn:B=>xt.updateChannel(B.channelId,{name:B.name,description:B.description,allow_message_editing:B.allow_message_editing,allow_message_deletion:B.allow_message_deletion,allow_file_deletion:B.allow_file_deletion}),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-channels-settings"]}),l(!1),a(null)}}),fe=Ne({mutationFn:B=>xt.archiveChannel(B),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-channels-settings"]}),a(null)}}),Le=Ne({mutationFn:B=>xt.addMember(B.channelId,B.staffId),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-members-settings",n==null?void 0:n.id]})}}),L=Ne({mutationFn:B=>xt.removeMember(B.channelId,B.staffId),onSuccess:()=>{e.invalidateQueries({queryKey:["group-chat-members-settings",n==null?void 0:n.id]})}}),ye=Ne({mutationFn:B=>xt.createChannel(B),onSuccess:()=>{h(!1),y(""),f(""),e.invalidateQueries({queryKey:["group-chat-channels-settings"]})}}),_e=()=>{!n||!u.trim()||ne.mutate({channelId:n.id,name:u,description:j,allow_message_editing:v,allow_message_deletion:N,allow_file_deletion:z})},_=B=>{n&&Le.mutate({channelId:n.id,staffId:B})},Y=B=>{n&&confirm("Are you sure you want to remove this member from the channel?")&&L.mutate({channelId:n.id,staffId:B})},W=ae.filter(B=>!K.some(me=>me.staff_id===B.id)),J=()=>{g.trim()&&ye.mutate({name:g,description:b||void 0,channelType:"public"})};return t.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Group Chat Settings"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage channels, members, and group chat configuration"})]}),t.jsx("div",{className:"mb-6 border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex space-x-8",children:[t.jsxs("button",{onClick:()=>r("channels"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="channels"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.jsx(Ot,{className:"w-4 h-4 inline-block mr-2"}),"Channels"]}),t.jsxs("button",{onClick:()=>r("global"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="global"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.jsx(gi,{className:"w-4 h-4 inline-block mr-2"}),"Global Settings"]}),t.jsx("button",{onClick:()=>r("mentions"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="mentions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"@Mentions"})]})}),s==="channels"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mb-6",children:t.jsxs("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx(ad,{className:"w-4 h-4"}),"Create Channel"]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(Ot,{className:"w-5 h-5"}),"Channels"]}),xe.length===0?t.jsx("p",{className:"text-gray-500 text-center py-8",children:"No channels yet. Create one to get started!"}):t.jsx("div",{className:"space-y-2",children:xe.map(B=>t.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[t.jsx(Ot,{className:"w-4 h-4"}),B.name,B.is_archived===1&&t.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:"Archived"})]}),B.description&&t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:B.description})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>{a(B),c(!0)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Manage Members",children:t.jsx(_i,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{a(B),p(B.name),x(B.description||""),l(!0)},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Edit Channel",children:t.jsx(Bh,{className:"w-4 h-4"})}),B.is_archived===0&&t.jsx("button",{onClick:()=>{confirm(`Archive channel "${B.name}"?`)&&fe.mutate(B.id)},className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded",title:"Archive Channel",children:t.jsx(fi,{className:"w-4 h-4"})})]})]},B.id))})]})})]}),s==="global"&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(gi,{className:"w-5 h-5"}),"Global Settings"]}),t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Edit/Delete Time Limit"}),t.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"How long staff members can edit or delete their messages. Admins can always edit/delete."}),t.jsxs("select",{value:X,onChange:B=>{const me=parseInt(B.target.value,10);T(me),ke.mutate(me)},className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:5,children:"5 minutes"}),t.jsx("option",{value:10,children:"10 minutes (default)"}),t.jsx("option",{value:15,children:"15 minutes"}),t.jsx("option",{value:30,children:"30 minutes"}),t.jsx("option",{value:60,children:"1 hour"}),t.jsx("option",{value:0,children:"No limit (always allow)"})]}),ke.isPending&&t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Saving..."}),ke.isSuccess&&t.jsx("p",{className:"text-xs text-green-600 mt-2",children:" Saved successfully"})]})})]}),s==="mentions"&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"@Mentions Settings"}),t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto Archive Mentions"}),t.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Automatically archive Read mentions after the specified time. This keeps your Mentions page clean and focused on active items."}),t.jsxs("select",{value:F,onChange:B=>{const me=parseInt(B.target.value,10);Q(me),R.mutate(me)},className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:12,children:"12 Hours (default)"}),t.jsx("option",{value:24,children:"24 Hours"}),t.jsx("option",{value:36,children:"36 Hours"}),t.jsx("option",{value:48,children:"48 Hours"}),t.jsx("option",{value:72,children:"72 Hours"}),t.jsx("option",{value:0,children:"Never Archive"})]}),R.isPending&&t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Saving..."}),R.isSuccess&&t.jsx("p",{className:"text-xs text-green-600 mt-2",children:" Saved successfully"})]})})]}),i&&n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Channel"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),t.jsx("input",{type:"text",value:u,onChange:B=>p(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),t.jsx("textarea",{value:j,onChange:B=>x(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),t.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Channel Permissions"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Message Editing"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Members can edit their own messages"})]}),t.jsx("input",{type:"checkbox",checked:v,onChange:B=>w(B.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("label",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow Message Deletion"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Members can delete their own messages"})]}),t.jsx("input",{type:"checkbox",checked:N,onChange:B=>P(B.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("label",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow File Deletion"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Members can delete attached files"})]}),t.jsx("input",{type:"checkbox",checked:z,onChange:B=>E(B.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]})]})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{l(!1),a(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:_e,disabled:!u.trim(),className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Changes"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Channel"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Channel Name"}),t.jsx("input",{type:"text",value:g,onChange:B=>y(B.target.value),placeholder:"e.g., general, support, sales",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),t.jsx("textarea",{value:b,onChange:B=>f(B.target.value),placeholder:"What is this channel for?",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{h(!1),y(""),f("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:J,disabled:!g.trim()||ye.isPending,className:"flex-1 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:ye.isPending?"Creating...":"Create Channel"})]})]})}),o&&n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Manage Members - #",n.name]}),t.jsx("button",{onClick:()=>{c(!1),a(null)},className:"text-gray-400 hover:text-gray-600",children:t.jsx(_t,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Current Members (",K.length,")"]}),t.jsx("div",{className:"space-y-2",children:K.map(B=>{var me,Ie;return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold",children:[(me=B.first_name)==null?void 0:me[0],(Ie=B.last_name)==null?void 0:Ie[0]]}),t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium text-gray-900",children:[B.first_name," ",B.last_name]}),t.jsx("p",{className:"text-xs text-gray-500",children:B.email})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[B.role==="admin"&&t.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded",children:"Admin"}),t.jsx("button",{onClick:()=>Y(B.staff_id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove member",children:t.jsx(_t,{className:"w-4 h-4"})})]})]},B.id)})})]}),W.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:["Add Members (",W.length," available)"]}),t.jsx("div",{className:"space-y-2",children:W.map(B=>{var me,Ie;return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white text-sm font-semibold",children:[(me=B.first_name)==null?void 0:me[0],(Ie=B.last_name)==null?void 0:Ie[0]]}),t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium text-gray-900",children:[B.first_name," ",B.last_name]}),t.jsx("p",{className:"text-xs text-gray-500",children:B.email})]})]}),t.jsxs("button",{onClick:()=>_(B.id),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-800 text-white rounded-lg hover:bg-gray-900",children:[t.jsx(Pl,{className:"w-4 h-4"}),t.jsx("span",{children:"Add"})]})]},B.id)})})]}),W.length===0&&K.length>0&&t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"All staff members are already in this channel"})]})})]})}function UC(){const[e,s]=m.useState(null),[r,n]=m.useState(""),[a,i]=m.useState(0),{data:l,isLoading:o}=ue({queryKey:["tags",r],queryFn:async()=>(await qx.getAllTags(r||void 0)).data}),{data:c,isLoading:d}=ue({queryKey:["tag-content",e],queryFn:async()=>e?(await qx.searchTags(e)).data:{results:[]},enabled:!!e}),h=(l==null?void 0:l.tags)||[],u=(c==null?void 0:c.results)||[],p=u[a],j=()=>{a>0&&i(a-1)},x=()=>{a<u.length-1&&i(a+1)};return t.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[t.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(rg,{className:"w-6 h-6 text-blue-600"}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tags"})]}),t.jsxs("div",{className:"text-sm text-gray-500",children:[h.length," ",h.length===1?"tag":"tags"," found"]})]}),t.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(xi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("input",{type:"text",value:r,onChange:g=>n(g.target.value),placeholder:"Filter tags by name... (e.g., james-scott, urgent, team)",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r&&t.jsx("button",{onClick:()=>n(""),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",title:"Clear search",children:t.jsx(_t,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t.jsx("div",{className:"max-w-6xl mx-auto",children:o?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading tags..."})]}):h.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(rg,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tags yet"}),t.jsx("p",{className:"text-gray-600",children:"Tags will appear here when you add them to memos or group chat messages."})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(g=>t.jsxs("button",{onClick:()=>{const y=g.name===e?null:g.name;s(y),i(0)},className:`p-4 rounded-lg border-2 transition-all text-left ${e===g.name?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-50"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"font-semibold text-gray-900",children:g.name})]}),t.jsx("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded",children:g.count})]}),t.jsxs("p",{className:"text-sm text-gray-600",children:[g.count," ",g.count===1?"reference":"references"]})]},g.name))}),e&&t.jsx("div",{className:"mt-8",children:t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["#",e]}),t.jsxs("span",{className:"text-sm text-gray-500",children:["(",u.length," ",u.length===1?"reference":"references",")"]})]}),t.jsx("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-600",children:t.jsx(_t,{className:"w-5 h-5"})})]}),d?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-2 text-gray-600",children:"Loading content..."})]}):u.length===0?t.jsx("p",{className:"text-center text-gray-500 py-8",children:"No content found with this tag."}):t.jsxs(t.Fragment,{children:[u.length>1&&t.jsxs("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-gray-200",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",a+1," of ",u.length]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:j,disabled:a===0,className:"p-2 text-blue-600 hover:bg-blue-50 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous",children:t.jsx(hi,{className:"w-5 h-5"})}),t.jsx("button",{onClick:x,disabled:a===u.length-1,className:"p-2 text-blue-600 hover:bg-blue-50 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Next",children:t.jsx(Jl,{className:"w-5 h-5"})})]})]}),p&&t.jsx("div",{children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"flex-shrink-0",children:p.type==="memo"?t.jsx(_c,{className:"w-6 h-6 text-yellow-600"}):p.type==="group_chat"?t.jsx(Hr,{className:"w-6 h-6 text-blue-600"}):t.jsx(fS,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-500 uppercase",children:p.type==="memo"?"@Memos":p.type==="group_chat"?"Group Chat":"Ticket"}),t.jsx("span",{className:"text-sm text-gray-400",children:""}),t.jsx("span",{className:"text-sm text-gray-500",children:new Date(p.created_at).toLocaleString()})]}),t.jsx("p",{className:"text-gray-900 whitespace-pre-wrap mb-4",children:p.content}),p.tags&&t.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:p.tags.split(",").map((g,y)=>t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-sm rounded",children:[t.jsx(Ot,{className:"w-3 h-3"}),g.trim()]},y))}),p.type==="memo"&&t.jsx(Je,{to:"/memos",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"View in @Memos "}),p.type==="group_chat"&&p.channel_id&&t.jsx(Je,{to:`/group-chat/${p.channel_id}`,className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"View in Group Chat "})]})]})})]})]})})]})})})]})}function HC(){const e=ct(),[s,r]=m.useState(!1),[n,a]=m.useState(!1),{data:i,isLoading:l}=ue({queryKey:["tag-settings"],queryFn:async()=>({ai_auto_tagging_enabled:!0,tag_suggestions_enabled:!0,tag_display_position:"below"})}),[o,c]=m.useState({ai_auto_tagging_enabled:!0,tag_suggestions_enabled:!0,tag_display_position:"below"});$e.useEffect(()=>{i&&c(i)},[i]);const d=async()=>{r(!0);try{await new Promise(h=>setTimeout(h,500)),e.invalidateQueries({queryKey:["tag-settings"]}),a(!0),setTimeout(()=>a(!1),3e3)}catch(h){console.error("Error saving tag settings:",h),alert("Failed to save settings")}finally{r(!1)}};return l?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("div",{className:"text-gray-500",children:"Loading settings..."})}):t.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[t.jsxs("header",{className:"flex-shrink-0 bg-white border-b border-gray-200 px-6 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ot,{className:"w-6 h-6 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Tags Settings"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Configure tagging behavior and display options"})]})]}),t.jsxs("button",{onClick:d,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(Zl,{className:"w-4 h-4"}),s?"Saving...":"Save Changes"]})]}),n&&t.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-800 text-sm",children:" Settings saved successfully"})]}),t.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:t.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"McCarthy AI Auto-Tagging"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enable McCarthy AI to automatically tag tickets, Live Chat conversations, and Group Chat messages based on content analysis, sentiment, intent, and customer behavior (RFM)."}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 bg-blue-50 p-3 rounded-lg",children:[t.jsx(Nm,{className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{children:"McCarthy AI analyzes content in real-time and suggests relevant tags. You can always manually add or remove tags."})]})]}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[t.jsx("input",{type:"checkbox",checked:o.ai_auto_tagging_enabled,onChange:h=>c({...o,ai_auto_tagging_enabled:h.target.checked}),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tag Suggestions"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Show tag suggestions while typing in Group Chat, Live Chat, and ticket notes. Suggestions are based on previously used tags and McCarthy AI recommendations."})]}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[t.jsx("input",{type:"checkbox",checked:o.tag_suggestions_enabled,onChange:h=>c({...o,tag_suggestions_enabled:h.target.checked}),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tag Display Position"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose how tags are displayed in messages and posts."}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[t.jsx("input",{type:"radio",name:"tag_display_position",value:"below",checked:o.tag_display_position==="below",onChange:()=>c({...o,tag_display_position:"below"}),className:"w-4 h-4 text-blue-600"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900",children:"Below Message"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Tags appear as blue pills below the message content (recommended)"})]})]}),t.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[t.jsx("input",{type:"radio",name:"tag_display_position",value:"inline",checked:o.tag_display_position==="inline",onChange:()=>c({...o,tag_display_position:"inline"}),className:"w-4 h-4 text-blue-600"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900",children:"Inline with Message"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Tags appear within the message text as #keywords"})]})]})]})]})}),t.jsxs("div",{className:"bg-gray-100 rounded-lg border border-gray-300 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[t.jsx(Nm,{className:"w-5 h-5"}),"Coming Soon"]}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Advanced tagging features currently in development:"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-600",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"AI Confidence Threshold:"})," Set minimum confidence level for auto-tagging"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-600",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Tag Categories:"})," Organize tags into predefined categories (Customer Type, Product, Issue Type, etc.)"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-600",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"RFM Integration:"})," Auto-tag VIP customers based on Recency, Frequency, Monetary analysis"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-600",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Shopify Integration:"})," Map product categories to tags and auto-tag based on purchase history"]})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-600",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Tag Cleanup:"})," Auto-merge similar tags and archive unused ones"]})]})]})]})]})})]})}function BC(){const e=ct(),{user:s}=ts(),[r,n]=m.useState(""),[a,i]=m.useState(""),[l,o]=m.useState(!1),c=m.useRef(null),[d,h]=m.useState("Amazing Transfers"),[u,p]=m.useState("info@amazingtransfers.com.au"),[j,x]=m.useState("amazingtransfers.com"),{data:g,isLoading:y}=ue({queryKey:["email-signature-settings"],queryFn:async()=>(await ko.getSettings()).data});m.useEffect(()=>{g&&(i(g.logoUrl??""),h(g.companyName??"Amazing Transfers"),p(g.email??"info@amazingtransfers.com.au"),x(g.website??"amazingtransfers.com"))},[g]);const{data:b}=ue({queryKey:["email-signature-preview",a,d,u,j],queryFn:async()=>(await ko.getPreviewFromSettings({logoUrl:a,companyName:d,email:u,website:j})).data,enabled:!!d&&!!u});m.useEffect(()=>{b!=null&&b.signatureHtml&&n(b.signatureHtml)},[b]);const f=Ne({mutationFn:()=>ko.saveSettings({logoUrl:a,companyName:d,email:u,website:j}),onSuccess:()=>{e.invalidateQueries({queryKey:["email-signature-settings"]}),e.invalidateQueries({queryKey:["email-signature-preview"]})}}),v=()=>{f.mutate()},w=async N=>{var z;const P=(z=N.target.files)==null?void 0:z[0];if(P){if(!P.type.startsWith("image/")){alert("Please upload an image file (PNG, JPG, etc.)");return}if(P.size>2*1024*1024){alert("Logo file size must be less than 2MB");return}o(!0);try{const E=new FileReader;E.onload=async()=>{const X=E.result,F=(await ko.uploadLogo({name:P.name,data:X,type:P.type,size:P.size})).data.logoUrl;i(F),alert(`Logo uploaded successfully!

URL: ${F}

You can now use this URL in your signature template.`)},E.readAsDataURL(P)}catch(E){console.error("Logo upload failed:",E),alert("Failed to upload logo. Please try again.")}finally{o(!1),c.current&&(c.current.value="")}}};return t.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(sr,{className:"w-7 h-7"}),"Email Settings"]}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Configure email signature template for all staff members"})]}),y?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading settings..."})]}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(gi,{className:"w-5 h-5"}),"Signature Builder"]}),t.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsxs("h3",{className:"text-sm font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[t.jsx(Cc,{className:"w-4 h-4"}),"Company Logo"]}),t.jsx("p",{className:"text-xs text-blue-800 mb-3",children:"Upload your logo - it will be hosted on Cloudflare and automatically included in your signature."}),t.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:w,className:"hidden"}),t.jsxs("button",{onClick:()=>{var N;return(N=c.current)==null?void 0:N.click()},disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[t.jsx(Eb,{className:"w-4 h-4"}),l?"Uploading...":a?"Change Logo":"Upload Logo"]}),a&&t.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[t.jsx("img",{src:a,alt:"Logo",className:"w-16 h-16 object-contain border border-gray-300 rounded bg-white p-1"}),t.jsx("p",{className:"text-xs text-green-700",children:" Logo uploaded"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[t.jsx(pb,{className:"w-4 h-4"}),"Company Name"]}),t.jsx("input",{type:"text",value:d,onChange:N=>h(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Amazing Transfers"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[t.jsx(sr,{className:"w-4 h-4"}),"Email Address"]}),t.jsx("input",{type:"email",value:u,onChange:N=>p(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., info@amazingtransfers.com.au"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[t.jsx(Uh,{className:"w-4 h-4"}),"Website"]}),t.jsx("input",{type:"text",value:j,onChange:N=>x(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., amazingtransfers.com"})]}),t.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:t.jsxs("p",{className:"text-xs text-blue-700",children:[t.jsx("strong",{children:"Note:"})," Staff names and job titles are automatically pulled from their profile settings."]})})]}),t.jsxs("div",{className:"mt-6",children:[t.jsxs("button",{onClick:v,disabled:f.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[t.jsx(Zl,{className:"w-5 h-5"}),f.isPending?"Saving...":"Save Signature"]}),f.isSuccess&&t.jsx("p",{className:"text-sm text-green-600 mt-2 text-center",children:" Signature saved successfully!"}),f.isError&&t.jsx("p",{className:"text-sm text-red-600 mt-2 text-center",children:" Failed to save signature."})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx(C3,{className:"w-5 h-5"}),"Preview (Your Signature)"]}),t.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["This is how the signature will appear for ",t.jsxs("strong",{children:[s==null?void 0:s.firstName," ",s==null?void 0:s.lastName]})]}),t.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:t.jsx("div",{dangerouslySetInnerHTML:{__html:r},className:"prose prose-sm max-w-none"})}),t.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:" How it works:"}),t.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[t.jsx("li",{children:" Upload your company logo (stored on Cloudflare)"}),t.jsx("li",{children:" Set your company name, email, and website"}),t.jsx("li",{children:" Staff names and job titles are pulled from their profiles automatically"}),t.jsx("li",{children:" Signatures are auto-appended to all email ticket replies"}),t.jsx("li",{children:" Each staff member gets a personalized signature"})]})]})]})]})]})}function qC(){const{user:e}=ts(),[s,r]=m.useState("week"),{data:n,isLoading:a}=ue({queryKey:["task-manager-analytics",s],queryFn:async()=>(await D.get("/api/tickets",{params:{channel:"task",limit:1e3}})).data.tickets,refetchInterval:3e4}),i=n||[],l=new Date,o=i.filter(E=>E.status!=="completed"&&E.status!=="cancelled"),c=o.filter(E=>E.sla_due_at&&new Date(E.sla_due_at)<l),d=o.filter(E=>E.sla_due_at?new Date(E.sla_due_at).toDateString()===l.toDateString():!1),h=o.filter(E=>{if(!E.sla_due_at)return!1;const X=new Date(E.sla_due_at),T=new Date(l.getTime()+7*24*60*60*1e3);return X>l&&X<=T}),u=new Date(l.getTime()-7*24*60*60*1e3),p=i.filter(E=>E.status==="completed"&&E.updated_at&&new Date(E.updated_at)>=u),j=o.filter(E=>E.priority==="critical"),x=o.filter(E=>E.priority==="high"),g=o.filter(E=>E.priority==="normal"),y=o.filter(E=>E.priority==="low"),b=i.filter(E=>E.status==="open"),f=i.filter(E=>E.status==="in-progress"),v=i.filter(E=>E.status==="pending"),w=i.filter(E=>E.status==="completed"),N={};o.forEach(E=>{E.assigned_to&&(N[E.assigned_to]=(N[E.assigned_to]||0)+1)});const P=p.length>0?"2.5 days":"N/A",z={lastRun:new Date(l.getTime()-3*60*1e3).toLocaleTimeString(),nextRun:new Date(l.getTime()+2*60*1e3).toLocaleTimeString(),notificationsSent:12,escalationsTriggered:3};return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(gr,{className:"w-6 h-6 text-amber-600"}),"Task Manager Dashboard"]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Analytics, monitoring, and task overview"})]}),t.jsxs("div",{className:"mb-6 flex gap-2",children:[t.jsx("button",{onClick:()=>r("today"),className:`px-4 py-2 rounded-lg text-sm font-medium ${s==="today"?"bg-indigo-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Today"}),t.jsx("button",{onClick:()=>r("week"),className:`px-4 py-2 rounded-lg text-sm font-medium ${s==="week"?"bg-indigo-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"This Week"}),t.jsx("button",{onClick:()=>r("month"),className:`px-4 py-2 rounded-lg text-sm font-medium ${s==="month"?"bg-indigo-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"This Month"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-amber-500",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Active Tasks"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]}),t.jsx(gr,{className:"w-8 h-8 text-amber-500"})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-red-500",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),t.jsx("p",{className:"text-2xl font-bold text-red-600",children:c.length})]}),t.jsx(Xl,{className:"w-8 h-8 text-red-500"})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-orange-500",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Due Today"}),t.jsx("p",{className:"text-2xl font-bold text-orange-600",children:d.length})]}),t.jsx(ga,{className:"w-8 h-8 text-orange-500"})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-green-500",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Completed This Week"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:p.length})]}),t.jsx(lt,{className:"w-8 h-8 text-green-500"})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Due This Week"}),t.jsx(ga,{className:"w-5 h-5 text-yellow-500"})]}),t.jsx("p",{className:"text-xl font-bold text-gray-900",children:h.length})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Avg Completion Time"}),t.jsx(bS,{className:"w-5 h-5 text-blue-500"})]}),t.jsx("p",{className:"text-xl font-bold text-gray-900",children:P})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Active Assignees"}),t.jsx(_i,{className:"w-5 h-5 text-purple-500"})]}),t.jsx("p",{className:"text-xl font-bold text-gray-900",children:Object.keys(N).length})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Tasks by Priority"})}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Critical"}),t.jsx("p",{className:"text-3xl font-bold text-red-600",children:j.length})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"High"}),t.jsx("p",{className:"text-3xl font-bold text-orange-600",children:x.length})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Normal"}),t.jsx("p",{className:"text-3xl font-bold text-blue-600",children:g.length})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Low"}),t.jsx("p",{className:"text-3xl font-bold text-gray-600",children:y.length})]})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Tasks by Status"})}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Open"}),t.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:b.length})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"In Progress"}),t.jsx("p",{className:"text-3xl font-bold text-blue-600",children:f.length})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Pending"}),t.jsx("p",{className:"text-3xl font-bold text-purple-600",children:v.length})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Completed"}),t.jsx("p",{className:"text-3xl font-bold text-green-600",children:w.length})]})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx(B4,{className:"w-5 h-5 text-green-500"}),"Task Manager Agent Status"]}),t.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded",children:"Active"})]}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Last Run"}),t.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.lastRun})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Next Run"}),t.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.nextRun})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Notifications Sent (24h)"}),t.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.notificationsSent})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Escalations (24h)"}),t.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.escalationsTriggered})]})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"})}),t.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs(Je,{to:"/task-digest",className:"p-4 border border-gray-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-colors",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:"View Daily Digest"}),t.jsx("p",{className:"text-sm text-gray-600",children:"See all tasks in table format with filters"})]}),t.jsxs(Je,{to:"/settings/task-manager",className:"p-4 border border-gray-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-colors",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:"Task Manager Settings"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Configure reminders, escalation, and automation"})]}),t.jsxs(Je,{to:"/group-chat",className:"p-4 border border-gray-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-colors",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:"Task Group Chat"}),t.jsx("p",{className:"text-sm text-gray-600",children:"View task notifications and discussions"})]})]})]})]})})}function WC(){const{user:e}=ts(),[s,r]=m.useState("all"),[n,a]=m.useState("all"),[i,l]=m.useState("all"),[o,c]=m.useState("all"),[d,h]=m.useState("all"),[u,p]=m.useState("all"),{data:j,isLoading:x}=ue({queryKey:["task-digest-table"],queryFn:async()=>(await D.get("/api/tickets",{params:{channel:"task",limit:1e3}})).data.tickets,refetchInterval:3e4}),{data:g}=ue({queryKey:["staff-list"],queryFn:async()=>(await D.get("/api/staff")).data.staff}),y=j||[],b=g||[],f=new Date,v=m.useMemo(()=>y.filter(T=>{if(s!=="all"&&T.status!==s||n!=="all"&&T.priority!==n||i!=="all"&&(i==="me"&&T.assigned_to!==(e==null?void 0:e.id)||i!=="me"&&T.assigned_to!==i))return!1;if(o!=="all"){if(!T.sla_due_at)return!1;const F=new Date(T.sla_due_at);if(o==="overdue"&&F>=f||o==="today"&&F.toDateString()!==f.toDateString())return!1;if(o==="week"){const Q=new Date(f.getTime()+6048e5);if(F<f||F>Q)return!1}if(o==="month"){const Q=new Date(f.getTime()+2592e6);if(F<f||F>Q)return!1}}return!(d!=="all"&&(d==="parent"&&T.parent_task_id||d==="subtask"&&!T.parent_task_id))}),[y,s,n,i,o,d,u,e,f]),w=T=>{const F=T.match(/^([A-Z]+)-?(\d+)-(\d+)$/);if(F){const ke=F[1],q=parseInt(F[2],10),R=parseInt(F[3],10);return`${ke}-${q}-${R}`}const Q=T.match(/^([A-Z]+)-?/),Z=T.match(/\d+/);if(!Z)return T;const xe=Q?Q[1]:"TSK",ve=parseInt(Z[0],10);return`${xe}-${ve}`},N=T=>{switch(T){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"normal":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},P=T=>{switch(T){case"completed":return"bg-green-100 text-green-800";case"in-progress":return"bg-blue-100 text-blue-800";case"open":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},z=T=>{const F=b.find(Q=>Q.id===T);return F?`${F.first_name} ${F.last_name}`:"Unassigned"},E=T=>T?new Date(T)<f:!1,X=(e==null?void 0:e.role)==="manager"||(e==null?void 0:e.role)==="admin";return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-full mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[t.jsx(gr,{className:"w-6 h-6 text-amber-600"}),"Daily Digest"]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:X?"All team tasks":"Your assigned tasks"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(jb,{className:"w-5 h-5 text-gray-600"}),t.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Filters"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),t.jsxs("select",{value:s,onChange:T=>r(T.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"open",children:"Open"}),t.jsx("option",{value:"in-progress",children:"In Progress"}),t.jsx("option",{value:"pending",children:"Pending"}),t.jsx("option",{value:"completed",children:"Completed"}),t.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),t.jsxs("select",{value:n,onChange:T=>a(T.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"critical",children:"Critical"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"low",children:"Low"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Assignee"}),t.jsxs("select",{value:i,onChange:T=>l(T.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"me",children:"My Tasks"}),b.map(T=>t.jsxs("option",{value:T.id,children:[T.first_name," ",T.last_name]},T.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Deadline"}),t.jsxs("select",{value:o,onChange:T=>c(T.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"overdue",children:"Overdue"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"week",children:"This Week"}),t.jsx("option",{value:"month",children:"This Month"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Type"}),t.jsxs("select",{value:d,onChange:T=>h(T.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"parent",children:"Parent Tasks"}),t.jsx("option",{value:"subtask",children:"Sub-Tasks Only"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Flags"}),t.jsxs("select",{value:u,onChange:T=>p(T.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"merged",children:"Merged"}),t.jsx("option",{value:"snoozed",children:"Snoozed"}),t.jsx("option",{value:"escalated",children:"Escalated"})]})]})]})]}),t.jsxs("div",{className:"mb-4 text-sm text-gray-600",children:["Showing ",v.length," of ",y.length," tasks"]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Task ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assignee"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deadline"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Parent/Child"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Flags"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x?t.jsx("tr",{children:t.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"Loading..."})}):v.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"No tasks found"})}):v.map(T=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsx(Je,{to:`/tickets?search=${T.ticket_number}`,className:"text-sm font-medium text-amber-600 hover:text-amber-800",children:w(T.ticket_number)})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:T.subject})}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${P(T.status)}`,children:T.status})}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${N(T.priority)}`,children:T.priority})}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:z(T.assigned_to)}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:T.sla_due_at?t.jsxs("div",{className:`text-xs ${E(T.sla_due_at)?"text-red-600 font-medium":"text-gray-600"}`,children:[new Date(T.sla_due_at).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),E(T.sla_due_at)&&t.jsxs("div",{className:"text-xs text-red-600",children:[Os(new Date(T.sla_due_at))," ago"]})]}):t.jsx("span",{className:"text-xs text-gray-400",children:"No deadline"})}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-xs text-gray-600",children:T.parent_task_id?t.jsx("span",{className:"text-purple-600",children:"Sub-task"}):t.jsx("span",{className:"text-gray-600",children:"Parent"})}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsxs("div",{className:"flex gap-1",children:[E(T.sla_due_at)&&t.jsx("span",{title:"Overdue",children:""}),T.escalation_level>0&&t.jsx("span",{title:"Escalated",children:""})]})}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-xs text-gray-500",children:Os(new Date(T.created_at),{addSuffix:!0})})]},T.ticket_id))})]})})})]})})}function KC(){const e=ct(),[s,r]=m.useState(""),[n,a]=m.useState(""),{data:i,isLoading:l}=ue({queryKey:["task-manager-settings"],queryFn:async()=>(await D.get("/api/settings/task-manager")).data.settings}),[o,c]=m.useState({agentEnabled:!0,agentInterval:5,businessHoursOnly:!1,businessHoursStart:"09:00",businessHoursEnd:"17:00",timezone:"Australia/Sydney",taskStartingNumber:100,taskMinDigits:3,defaultDeadline:"none",customDeadlineHours:24,reminder24h:!0,reminder4h:!0,reminder1h:!1,reminder30m:!1,reminderCustomEnabled:!1,reminderCustomHours:2,firstAlertMinutes:60,repeatAlertHours:4,escalationEnabled:!0,firstEscalationHours:1,escalationIntervalHours:4,maxEscalationLevel:3,escalationBusinessHoursOnly:!0,autoSyncNotes:!0,notifyOnSubTaskCompletion:!0,autoCloseParent:!1,inheritParentDeadline:!1,inheritParentPriority:!0,inheritParentAssignee:!1,aiEnabled:!0,aiAutoGenerateDrafts:!0,aiModel:"llama-3.1",aiConfidenceThreshold:70,aiRequireApproval:"always",aiCanAddNotes:!0,aiCanUpdateStatus:!1,aiCanChangePriority:!1,aiCanSendEmails:!1,aiCanCloseTasks:!1,aiCanCreateSubTasks:!1,slaCritical:4,slaHigh:24,slaNormal:72,slaLow:168,slaCalculateFrom:"creation",notifyOnCreated:"assignee",notifyOnAssigned:"both",notifyOnStatusChanged:"assignee",notifyOnPriorityChanged:"both",notifyOnCompleted:"both",notifyOnMention:"mentioned",autoAssignmentEnabled:!0,autoAssignmentMethod:"round-robin",maxTasksPerStaff:10});m.useEffect(()=>{i&&c({...o,...i})},[i]);const d=Ne({mutationFn:async u=>await D.put("/api/settings/task-manager",u),onSuccess:()=>{e.invalidateQueries({queryKey:["task-manager-settings"]}),r("Settings saved successfully!"),a(""),setTimeout(()=>r(""),3e3)},onError:u=>{var p,j;a(((j=(p=u.response)==null?void 0:p.data)==null?void 0:j.error)||"Failed to save settings"),r("")}}),h=u=>{u.preventDefault(),d.mutate(o)};return l?t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsx("div",{className:"text-center py-12",children:"Loading settings..."})})}):t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Task Manager Settings"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure automation, reminders, escalation, and McCarthy AI"})]}),s&&t.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-2",children:[t.jsx(Ec,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"text-green-800",children:s})]}),n&&t.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-2",children:[t.jsx(Mb,{className:"w-5 h-5 text-red-600"}),t.jsx("span",{className:"text-red-800",children:n})]}),t.jsxs("form",{onSubmit:h,children:[t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"General Settings"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable Task Manager Agent"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Automated monitoring and notifications"})]}),t.jsx("input",{type:"checkbox",checked:o.agentEnabled,onChange:u=>c({...o,agentEnabled:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Agent Run Interval"}),t.jsxs("select",{value:o.agentInterval,onChange:u=>c({...o,agentInterval:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:5,children:"5 minutes"}),t.jsx("option",{value:15,children:"15 minutes"}),t.jsx("option",{value:30,children:"30 minutes"}),t.jsx("option",{value:60,children:"1 hour"})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Business Hours Only"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Only send notifications during business hours"})]}),t.jsx("input",{type:"checkbox",checked:o.businessHoursOnly,onChange:u=>c({...o,businessHoursOnly:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),o.businessHoursOnly&&t.jsxs("div",{className:"grid grid-cols-2 gap-4 ml-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),t.jsx("input",{type:"time",value:o.businessHoursStart,onChange:u=>c({...o,businessHoursStart:u.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),t.jsx("input",{type:"time",value:o.businessHoursEnd,onChange:u=>c({...o,businessHoursEnd:u.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Task Numbering"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Starting Number"}),t.jsx("input",{type:"number",value:o.taskStartingNumber,onChange:u=>c({...o,taskStartingNumber:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",min:1}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Tasks will start from TSK-",o.taskStartingNumber]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Digits"}),t.jsx("input",{type:"number",value:o.taskMinDigits,onChange:u=>c({...o,taskMinDigits:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",min:1,max:6}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Format: TSK-",String(o.taskStartingNumber).padStart(o.taskMinDigits,"0")]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Deadline & Reminders"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Task Deadline"}),t.jsxs("select",{value:o.defaultDeadline,onChange:u=>c({...o,defaultDeadline:u.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"none",children:"None"}),t.jsx("option",{value:"24h",children:"24 hours"}),t.jsx("option",{value:"48h",children:"48 hours"}),t.jsx("option",{value:"1week",children:"1 week"}),t.jsx("option",{value:"custom",children:"Custom"})]})]}),o.defaultDeadline==="custom"&&t.jsxs("div",{className:"ml-6",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Hours"}),t.jsx("input",{type:"number",value:o.customDeadlineHours,onChange:u=>c({...o,customDeadlineHours:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",min:1})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reminder Times"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.reminder24h,onChange:u=>c({...o,reminder24h:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"24 hours before deadline"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.reminder4h,onChange:u=>c({...o,reminder4h:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"4 hours before deadline"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.reminder1h,onChange:u=>c({...o,reminder1h:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"1 hour before deadline"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.reminder30m,onChange:u=>c({...o,reminder30m:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"30 minutes before deadline"})]})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Overdue Task Settings"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Alert After (minutes)"}),t.jsxs("select",{value:o.firstAlertMinutes,onChange:u=>c({...o,firstAlertMinutes:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:15,children:"15 minutes"}),t.jsx("option",{value:30,children:"30 minutes"}),t.jsx("option",{value:60,children:"1 hour"}),t.jsx("option",{value:120,children:"2 hours"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Repeat Alerts Every (hours)"}),t.jsxs("select",{value:o.repeatAlertHours,onChange:u=>c({...o,repeatAlertHours:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:1,children:"1 hour"}),t.jsx("option",{value:2,children:"2 hours"}),t.jsx("option",{value:4,children:"4 hours"}),t.jsx("option",{value:8,children:"8 hours"})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Escalation Settings"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable Auto-Escalation"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Automatically escalate overdue tasks"})]}),t.jsx("input",{type:"checkbox",checked:o.escalationEnabled,onChange:u=>c({...o,escalationEnabled:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),o.escalationEnabled&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Escalation Delay (hours)"}),t.jsxs("select",{value:o.firstEscalationHours,onChange:u=>c({...o,firstEscalationHours:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:1,children:"1 hour"}),t.jsx("option",{value:2,children:"2 hours"}),t.jsx("option",{value:4,children:"4 hours"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Escalation Interval (hours)"}),t.jsxs("select",{value:o.escalationIntervalHours,onChange:u=>c({...o,escalationIntervalHours:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:2,children:"2 hours"}),t.jsx("option",{value:4,children:"4 hours"}),t.jsx("option",{value:8,children:"8 hours"}),t.jsx("option",{value:24,children:"24 hours"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Escalation Level"}),t.jsxs("select",{value:o.maxEscalationLevel,onChange:u=>c({...o,maxEscalationLevel:parseInt(u.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:1,children:"1 (Team Leader only)"}),t.jsx("option",{value:2,children:"2 (Team Leader  Manager)"}),t.jsx("option",{value:3,children:"3 (Team Leader  Manager  Admin)"})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Business Hours Only"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Only escalate during business hours"})]}),t.jsx("input",{type:"checkbox",checked:o.escalationBusinessHoursOnly,onChange:u=>c({...o,escalationBusinessHoursOnly:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Sub-Task Settings"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Auto-Sync Notes"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Sync notes between parent and child tasks"})]}),t.jsx("input",{type:"checkbox",checked:o.autoSyncNotes,onChange:u=>c({...o,autoSyncNotes:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notify on Sub-Task Completion"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Notify parent task owner when sub-task is completed"})]}),t.jsx("input",{type:"checkbox",checked:o.notifyOnSubTaskCompletion,onChange:u=>c({...o,notifyOnSubTaskCompletion:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Auto-Close Parent"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Automatically close parent when all sub-tasks are completed"})]}),t.jsx("input",{type:"checkbox",checked:o.autoCloseParent,onChange:u=>c({...o,autoCloseParent:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Inherit Parent Deadline"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Sub-tasks inherit deadline from parent"})]}),t.jsx("input",{type:"checkbox",checked:o.inheritParentDeadline,onChange:u=>c({...o,inheritParentDeadline:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Inherit Parent Priority"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Sub-tasks inherit priority from parent"})]}),t.jsx("input",{type:"checkbox",checked:o.inheritParentPriority,onChange:u=>c({...o,inheritParentPriority:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Inherit Parent Assignee"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Sub-tasks inherit assignee from parent"})]}),t.jsx("input",{type:"checkbox",checked:o.inheritParentAssignee,onChange:u=>c({...o,inheritParentAssignee:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"McCarthy AI Settings"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable AI Task Execution"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Allow McCarthy AI to assist with tasks"})]}),t.jsx("input",{type:"checkbox",checked:o.aiEnabled,onChange:u=>c({...o,aiEnabled:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),o.aiEnabled&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Auto-Generate Drafts"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Automatically generate AI drafts for tasks"})]}),t.jsx("input",{type:"checkbox",checked:o.aiAutoGenerateDrafts,onChange:u=>c({...o,aiAutoGenerateDrafts:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AI Model"}),t.jsxs("select",{value:o.aiModel,onChange:u=>c({...o,aiModel:u.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"llama-3.1",children:"Llama 3.1 (Fast)"}),t.jsx("option",{value:"gpt-4",children:"GPT-4 (Advanced)"}),t.jsx("option",{value:"claude-3",children:"Claude 3 (Balanced)"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confidence Threshold: ",o.aiConfidenceThreshold,"%"]}),t.jsx("input",{type:"range",min:0,max:100,value:o.aiConfidenceThreshold,onChange:u=>c({...o,aiConfidenceThreshold:parseInt(u.target.value)}),className:"w-full"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Minimum confidence for AI suggestions"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Require Approval"}),t.jsxs("select",{value:o.aiRequireApproval,onChange:u=>c({...o,aiRequireApproval:u.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[t.jsx("option",{value:"always",children:"Always (Human-in-the-Loop)"}),t.jsx("option",{value:"high-confidence",children:"High Confidence Only"}),t.jsx("option",{value:"never",children:"Never (Fully Automated)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Can Execute"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.aiCanAddNotes,onChange:u=>c({...o,aiCanAddNotes:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Add internal notes"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.aiCanUpdateStatus,onChange:u=>c({...o,aiCanUpdateStatus:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Update task status"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.aiCanChangePriority,onChange:u=>c({...o,aiCanChangePriority:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Change priority"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.aiCanSendEmails,onChange:u=>c({...o,aiCanSendEmails:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded",disabled:!0}),t.jsx("span",{className:"text-sm text-gray-400",children:"Send customer emails (always requires approval)"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.aiCanCloseTasks,onChange:u=>c({...o,aiCanCloseTasks:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Close tasks"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:o.aiCanCreateSubTasks,onChange:u=>c({...o,aiCanCreateSubTasks:u.target.checked}),className:"h-4 w-4 text-indigo-600 rounded"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Create sub-tasks"})]})]})]})]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{type:"submit",disabled:d.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:d.isPending?"Saving...":"Save Settings"})})]})]})})}function VC({children:e}){const{token:s}=ts();return s?t.jsx(t.Fragment,{children:e}):t.jsx(fy,{to:"/login",replace:!0})}function QC(){return t.jsx(rw,{children:t.jsxs(G1,{children:[t.jsx(Ye,{path:"/login",element:t.jsx(jk,{})}),t.jsxs(Ye,{path:"/",element:t.jsx(VC,{children:t.jsx(n6,{})}),children:[t.jsx(Ye,{index:!0,element:t.jsx(fy,{to:"/tickets",replace:!0})}),t.jsx(Ye,{path:"tickets",element:t.jsx(tC,{})}),t.jsx(Ye,{path:"tickets/:id",element:t.jsx(uC,{})}),t.jsx(Ye,{path:"mentions",element:t.jsx(mC,{})}),t.jsx(Ye,{path:"memo",element:t.jsx(hC,{})}),t.jsx(Ye,{path:"tags",element:t.jsx(UC,{})}),t.jsx(Ye,{path:"task-manager",element:t.jsx(qC,{})}),t.jsx(Ye,{path:"task-digest",element:t.jsx(WC,{})}),t.jsx(Ye,{path:"analytics/ai-agent",element:t.jsx(xC,{})}),t.jsx(Ye,{path:"settings",element:t.jsx($C,{})}),t.jsx(Ye,{path:"settings/tags",element:t.jsx(HC,{})}),t.jsx(Ye,{path:"settings/email",element:t.jsx(BC,{})}),t.jsx(Ye,{path:"settings/business-hours",element:t.jsx(fC,{})}),t.jsx(Ye,{path:"settings/chat-widget",element:t.jsx(pC,{})}),t.jsx(Ye,{path:"settings/chat-embed",element:t.jsx(SC,{})}),t.jsx(Ye,{path:"ai-agent/widget",element:t.jsx(CC,{})}),t.jsx(Ye,{path:"ai-agent/knowledge",element:t.jsx(EC,{})}),t.jsx(Ye,{path:"ai-agent/system-message",element:t.jsx(MC,{})}),t.jsx(Ye,{path:"ai-agent/regional-overrides",element:t.jsx(PC,{})}),t.jsx(Ye,{path:"settings/dartmouth-os",element:t.jsx(AC,{})}),t.jsx(Ye,{path:"settings/auto-assignment",element:t.jsx(RC,{})}),t.jsx(Ye,{path:"staff",element:t.jsx(yC,{})}),t.jsx(Ye,{path:"staff/performance",element:t.jsx(bC,{})}),t.jsx(Ye,{path:"chat",element:t.jsx(vC,{})}),t.jsx(Ye,{path:"chat-ticket/:id",element:t.jsx(kC,{})}),t.jsx(Ye,{path:"group-chat",element:t.jsx(DC,{})}),t.jsx(Ye,{path:"settings/group-chat",element:t.jsx(zC,{})}),t.jsx(Ye,{path:"settings/task-manager",element:t.jsx(KC,{})}),t.jsx(Ye,{path:"integrations",element:t.jsx(IC,{})}),t.jsx(Ye,{path:"settings/integrations/shopify",element:t.jsx(OC,{})}),t.jsx(Ye,{path:"account",element:t.jsx(FC,{})})]})]})})}const GC=new H2({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});eu.createRoot(document.getElementById("root")).render(t.jsx($e.StrictMode,{children:t.jsx(B2,{client:GC,children:t.jsx(QC,{})})}));
